/*! For license information please see ufst.basemap.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.UFST=e():t.UFST=e()}(this,(()=>(()=>{var t={4:function(t){t.exports=function(){"use strict";function t(t,e){var i,n,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var e=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function i(t,e){return t>e?1:t<e?-1:0}function n(t,i,n){for(var r=new e(null,null),s=r,o=r;;){var a=n(t,i.key);if(a<0){if(null===i.left)break;if(n(t,i.left.key)<0){var l=i.left;if(i.left=l.right,l.right=i,null===(i=l).left)break}o.left=i,o=i,i=i.left}else{if(!(a>0))break;if(null===i.right)break;if(n(t,i.right.key)>0&&(l=i.right,i.right=l.left,l.left=i,null===(i=l).right))break;s.right=i,s=i,i=i.right}}return s.right=i.left,o.left=i.right,i.left=r.right,i.right=r.left,i}function r(t,i,r,s){var o=new e(t,i);if(null===r)return o.left=o.right=null,o;var a=s(t,(r=n(t,r,s)).key);return a<0?(o.left=r.left,o.right=r,r.left=null):a>=0&&(o.right=r.right,o.left=r,r.right=null),o}function s(t,e,i){var r=null,s=null;if(e){var o=i((e=n(t,e,i)).key,t);0===o?(r=e.left,s=e.right):o<0?(s=e.right,e.right=null,r=e):(r=e.left,e.left=null,s=e)}return{left:r,right:s}}function o(t,e,i,n,r){if(t){n(e+(i?"└── ":"├── ")+r(t)+"\n");var s=e+(i?"    ":"│   ");t.left&&o(t.left,s,!1,n,r),t.right&&o(t.right,s,!0,n,r)}}var a=function(){function a(t){void 0===t&&(t=i),this._root=null,this._size=0,this._comparator=t}return a.prototype.insert=function(t,e){return this._size++,this._root=r(t,e,this._root,this._comparator)},a.prototype.add=function(t,i){var r=new e(t,i);null===this._root&&(r.left=r.right=null,this._size++,this._root=r);var s=this._comparator,o=n(t,this._root,s),a=s(t,o.key);return 0===a?this._root=o:(a<0?(r.left=o.left,r.right=o,o.left=null):a>0&&(r.right=o.right,r.left=o,o.right=null),this._size++,this._root=r),this._root},a.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},a.prototype._remove=function(t,e,i){var r;return null===e?null:0===i(t,(e=n(t,e,i)).key)?(null===e.left?r=e.right:(r=n(t,e.left,i)).right=e.right,this._size--,r):e},a.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=n(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},a.prototype.findStatic=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return e;e=n<0?e.left:e.right}return null},a.prototype.find=function(t){return this._root&&(this._root=n(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},a.prototype.contains=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},a.prototype.forEach=function(t,e){for(var i=this._root,n=[],r=!1;!r;)null!==i?(n.push(i),i=i.left):0!==n.length?(i=n.pop(),t.call(e,i),i=i.right):r=!0;return this},a.prototype.range=function(t,e,i,n){for(var r=[],s=this._comparator,o=this._root;0!==r.length||o;)if(o)r.push(o),o=o.left;else{if(s((o=r.pop()).key,e)>0)break;if(s(o.key,t)>=0&&i.call(n,o))return this;o=o.right}return this},a.prototype.keys=function(){var t=[];return this.forEach((function(e){var i=e.key;return t.push(i)})),t},a.prototype.values=function(){var t=[];return this.forEach((function(e){var i=e.data;return t.push(i)})),t},a.prototype.min=function(){return this._root?this.minNode(this._root).key:null},a.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},a.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},a.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},a.prototype.at=function(t){for(var e=this._root,i=!1,n=0,r=[];!i;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),n===t)return e;n++,e=e.right}else i=!0;return null},a.prototype.next=function(t){var e=this._root,i=null;if(t.right){for(i=t.right;i.left;)i=i.left;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?(i=e,e=e.left):e=e.right}return i},a.prototype.prev=function(t){var e=this._root,i=null;if(null!==t.left){for(i=t.left;i.right;)i=i.right;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?e=e.left:(i=e,e=e.right)}return i},a.prototype.clear=function(){return this._root=null,this._size=0,this},a.prototype.toList=function(){return function(t){for(var i=t,n=[],r=!1,s=new e(null,null),o=s;!r;)i?(n.push(i),i=i.left):n.length>0?i=(i=o=o.next=n.pop()).right:r=!0;return o.next=null,s.next}(this._root)},a.prototype.load=function(t,i,n){void 0===i&&(i=[]),void 0===n&&(n=!1);var r=t.length,s=this._comparator;if(n&&u(t,i,0,r-1,s),null===this._root)this._root=l(t,i,0,r),this._size=r;else{var o=function(t,i,n){for(var r=new e(null,null),s=r,o=t,a=i;null!==o&&null!==a;)n(o.key,a.key)<0?(s.next=o,o=o.next):(s.next=a,a=a.next),s=s.next;return null!==o?s.next=o:null!==a&&(s.next=a),r.next}(this.toList(),function(t,i){for(var n=new e(null,null),r=n,s=0;s<t.length;s++)r=r.next=new e(t[s],i[s]);return r.next=null,n.next}(t,i),s);r=this._size+r,this._root=h({head:o},0,r)}return this},a.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),a.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return o(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},a.prototype.update=function(t,e,i){var o=this._comparator,a=s(t,this._root,o),l=a.left,h=a.right;o(t,e)<0?h=r(e,i,h,o):l=r(e,i,l,o),this._root=function(t,e,i){return null===e?t:(null===t||((e=n(t.key,e,i)).left=t),e)}(l,h,o)},a.prototype.split=function(t){return s(t,this._root,this._comparator)},a.prototype[Symbol.iterator]=function(){var e,i,n;return t(this,(function(t){switch(t.label){case 0:e=this._root,i=[],n=!1,t.label=1;case 1:return n?[3,6]:null===e?[3,2]:(i.push(e),e=e.left,[3,5]);case 2:return 0===i.length?[3,4]:[4,e=i.pop()];case 3:return t.sent(),e=e.right,[3,5];case 4:n=!0,t.label=5;case 5:return[3,1];case 6:return[2]}}))},a}();function l(t,i,n,r){var s=r-n;if(s>0){var o=n+Math.floor(s/2),a=t[o],h=i[o],u=new e(a,h);return u.left=l(t,i,n,o),u.right=l(t,i,o+1,r),u}return null}function h(t,e,i){var n=i-e;if(n>0){var r=e+Math.floor(n/2),s=h(t,e,r),o=t.head;return o.left=s,t.head=t.head.next,o.right=h(t,r+1,i),o}return null}function u(t,e,i,n,r){if(!(i>=n)){for(var s=t[i+n>>1],o=i-1,a=n+1;;){do{o++}while(r(t[o],s)<0);do{a--}while(r(t[a],s)>0);if(o>=a)break;var l=t[o];t[o]=t[a],t[a]=l,l=e[o],e[o]=e[a],e[a]=l}u(t,e,i,a,r),u(t,e,a+1,n,r)}}const c=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,p=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;const i=t.ll.x<e.ll.x?e.ll.x:t.ll.x,n=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:i,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:n,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}};let d=Number.EPSILON;void 0===d&&(d=Math.pow(2,-52));const g=d*d,f=(t,e)=>{if(-d<t&&t<d&&-d<e&&e<d)return 0;const i=t-e;return i*i<g*t*e?0:t<e?-1:1};class y{constructor(){this.tree=new a,this.round(0)}round(t){const e=this.tree.add(t),i=this.tree.prev(e);if(null!==i&&0===f(e.key,i.key))return this.tree.remove(t),i.key;const n=this.tree.next(e);return null!==n&&0===f(e.key,n.key)?(this.tree.remove(t),n.key):t}}const m=new class{constructor(){this.reset()}reset(){this.xRounder=new y,this.yRounder=new y}round(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}},_=11102230246251565e-32,v=134217729,C=(3+8*_)*_;function x(t,e,i,n,r){let s,o,a,l,h=e[0],u=n[0],c=0,p=0;u>h==u>-h?(s=h,h=e[++c]):(s=u,u=n[++p]);let d=0;if(c<t&&p<i)for(u>h==u>-h?(o=h+s,a=s-(o-h),h=e[++c]):(o=u+s,a=s-(o-u),u=n[++p]),s=o,0!==a&&(r[d++]=a);c<t&&p<i;)u>h==u>-h?(o=s+h,l=o-s,a=s-(o-l)+(h-l),h=e[++c]):(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=n[++p]),s=o,0!==a&&(r[d++]=a);for(;c<t;)o=s+h,l=o-s,a=s-(o-l)+(h-l),h=e[++c],s=o,0!==a&&(r[d++]=a);for(;p<i;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=n[++p],s=o,0!==a&&(r[d++]=a);return 0===s&&0!==d||(r[d++]=s),d}function w(t){return new Float64Array(t)}const M=w(4),E=w(8),I=w(12),S=w(16),L=w(4);function b(t,e,i,n,r,s){const o=(e-s)*(i-r),a=(t-r)*(n-s),l=o-a,h=Math.abs(o+a);return Math.abs(l)>=33306690738754716e-32*h?l:-function(t,e,i,n,r,s,o){let a,l,h,u,c,p,d,g,f,y,m,_,w,b,R,N,A,T;const P=t-r,O=i-r,D=e-s,k=n-s;b=P*k,p=v*P,d=p-(p-P),g=P-d,p=v*k,f=p-(p-k),y=k-f,R=g*y-(b-d*f-g*f-d*y),N=D*O,p=v*D,d=p-(p-D),g=D-d,p=v*O,f=p-(p-O),y=O-f,A=g*y-(N-d*f-g*f-d*y),m=R-A,c=R-m,M[0]=R-(m+c)+(c-A),_=b+m,c=_-b,w=b-(_-c)+(m-c),m=w-N,c=w-m,M[1]=w-(m+c)+(c-N),T=_+m,c=T-_,M[2]=_-(T-c)+(m-c),M[3]=T;let F=function(t,e){let i=e[0];for(let n=1;n<t;n++)i+=e[n];return i}(4,M),G=22204460492503146e-32*o;if(F>=G||-F>=G)return F;if(c=t-P,a=t-(P+c)+(c-r),c=i-O,h=i-(O+c)+(c-r),c=e-D,l=e-(D+c)+(c-s),c=n-k,u=n-(k+c)+(c-s),0===a&&0===l&&0===h&&0===u)return F;if(G=11093356479670487e-47*o+C*Math.abs(F),F+=P*u+k*a-(D*h+O*l),F>=G||-F>=G)return F;b=a*k,p=v*a,d=p-(p-a),g=a-d,p=v*k,f=p-(p-k),y=k-f,R=g*y-(b-d*f-g*f-d*y),N=l*O,p=v*l,d=p-(p-l),g=l-d,p=v*O,f=p-(p-O),y=O-f,A=g*y-(N-d*f-g*f-d*y),m=R-A,c=R-m,L[0]=R-(m+c)+(c-A),_=b+m,c=_-b,w=b-(_-c)+(m-c),m=w-N,c=w-m,L[1]=w-(m+c)+(c-N),T=_+m,c=T-_,L[2]=_-(T-c)+(m-c),L[3]=T;const H=x(4,M,4,L,E);b=P*u,p=v*P,d=p-(p-P),g=P-d,p=v*u,f=p-(p-u),y=u-f,R=g*y-(b-d*f-g*f-d*y),N=D*h,p=v*D,d=p-(p-D),g=D-d,p=v*h,f=p-(p-h),y=h-f,A=g*y-(N-d*f-g*f-d*y),m=R-A,c=R-m,L[0]=R-(m+c)+(c-A),_=b+m,c=_-b,w=b-(_-c)+(m-c),m=w-N,c=w-m,L[1]=w-(m+c)+(c-N),T=_+m,c=T-_,L[2]=_-(T-c)+(m-c),L[3]=T;const V=x(H,E,4,L,I);b=a*u,p=v*a,d=p-(p-a),g=a-d,p=v*u,f=p-(p-u),y=u-f,R=g*y-(b-d*f-g*f-d*y),N=l*h,p=v*l,d=p-(p-l),g=l-d,p=v*h,f=p-(p-h),y=h-f,A=g*y-(N-d*f-g*f-d*y),m=R-A,c=R-m,L[0]=R-(m+c)+(c-A),_=b+m,c=_-b,w=b-(_-c)+(m-c),m=w-N,c=w-m,L[1]=w-(m+c)+(c-N),T=_+m,c=T-_,L[2]=_-(T-c)+(m-c),L[3]=T;const j=x(V,I,4,L,S);return S[j-1]}(t,e,i,n,r,s,h)}const R=(t,e)=>t.x*e.y-t.y*e.x,N=(t,e)=>t.x*e.x+t.y*e.y,A=(t,e,i)=>{const n=b(t.x,t.y,e.x,e.y,i.x,i.y);return n>0?-1:n<0?1:0},T=t=>Math.sqrt(N(t,t)),P=(t,e,i)=>{const n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y};return R(r,n)/T(r)/T(n)},O=(t,e,i)=>{const n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y};return N(r,n)/T(r)/T(n)},D=(t,e,i)=>0===e.y?null:{x:t.x+e.x/e.y*(i-t.y),y:i},k=(t,e,i)=>0===e.x?null:{x:i,y:t.y+e.y/e.x*(i-t.x)};class F{static compare(t,e){const i=F.comparePoints(t.point,e.point);return 0!==i?i:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:H.compare(t.segment,e.segment))}static comparePoints(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}constructor(t,e){void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let t=0,i=e.length;t<i;t++){const i=e[t];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const i=this.point.events[e];if(void 0===i.segment.consumedBy)for(let n=e+1;n<t;n++){const t=this.point.events[n];void 0===t.consumedBy&&i.otherSE.point.events===t.otherSE.point.events&&i.segment.consume(t.segment)}}}getAvailableLinkedEvents(){const t=[];for(let e=0,i=this.point.events.length;e<i;e++){const i=this.point.events[e];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}getLeftmostComparator(t){const e=new Map,i=i=>{const n=i.otherSE;e.set(i,{sine:P(this.point,t.point,n.point),cosine:O(this.point,t.point,n.point)})};return(t,n)=>{e.has(t)||i(t),e.has(n)||i(n);const{sine:r,cosine:s}=e.get(t),{sine:o,cosine:a}=e.get(n);return r>=0&&o>=0?s<a?1:s>a?-1:0:r<0&&o<0?s<a?-1:s>a?1:0:o<r?-1:o>r?1:0}}}let G=0;class H{static compare(t,e){const i=t.leftSE.point.x,n=e.leftSE.point.x,r=t.rightSE.point.x,s=e.rightSE.point.x;if(s<i)return 1;if(r<n)return-1;const o=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,h=e.rightSE.point.y;if(i<n){if(a<o&&a<l)return 1;if(a>o&&a>l)return-1;const i=t.comparePoint(e.leftSE.point);if(i<0)return 1;if(i>0)return-1;const n=e.comparePoint(t.rightSE.point);return 0!==n?n:-1}if(i>n){if(o<a&&o<h)return-1;if(o>a&&o>h)return 1;const i=e.comparePoint(t.leftSE.point);if(0!==i)return i;const n=t.comparePoint(e.rightSE.point);return n<0?1:n>0?-1:1}if(o<a)return-1;if(o>a)return 1;if(r<s){const i=e.comparePoint(t.rightSE.point);if(0!==i)return i}if(r>s){const i=t.comparePoint(e.rightSE.point);if(i<0)return 1;if(i>0)return-1}if(r!==s){const t=l-o,e=r-i,u=h-a,c=s-n;if(t>e&&u<c)return 1;if(t<e&&u>c)return-1}return r>s?1:r<s||l<h?-1:l>h?1:t.id<e.id?-1:t.id>e.id?1:0}constructor(t,e,i,n){this.id=++G,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=i,this.windings=n}static fromRing(t,e,i){let n,r,s;const o=F.comparePoints(t,e);if(o<0)n=t,r=e,s=1;else{if(!(o>0))throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);n=e,r=t,s=-1}const a=new F(n,!0),l=new F(r,!1);return new H(a,l,[i],[s])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}comparePoint(t){if(this.isAnEndpoint(t))return 0;const e=this.leftSE.point,i=this.rightSE.point,n=this.vector();if(e.x===i.x)return t.x===e.x?0:t.x<e.x?1:-1;const r=(t.y-e.y)/n.y,s=e.x+r*n.x;if(t.x===s)return 0;const o=(t.x-e.x)/n.x,a=e.y+o*n.y;return t.y===a?0:t.y<a?-1:1}getIntersection(t){const e=this.bbox(),i=t.bbox(),n=p(e,i);if(null===n)return null;const r=this.leftSE.point,s=this.rightSE.point,o=t.leftSE.point,a=t.rightSE.point,l=c(e,o)&&0===this.comparePoint(o),h=c(i,r)&&0===t.comparePoint(r),u=c(e,a)&&0===this.comparePoint(a),d=c(i,s)&&0===t.comparePoint(s);if(h&&l)return d&&!u?s:!d&&u?a:null;if(h)return u&&r.x===a.x&&r.y===a.y?null:r;if(l)return d&&s.x===o.x&&s.y===o.y?null:o;if(d&&u)return null;if(d)return s;if(u)return a;const g=((t,e,i,n)=>{if(0===e.x)return k(i,n,t.x);if(0===n.x)return k(t,e,i.x);if(0===e.y)return D(i,n,t.y);if(0===n.y)return D(t,e,i.y);const r=R(e,n);if(0==r)return null;const s={x:i.x-t.x,y:i.y-t.y},o=R(s,e)/r,a=R(s,n)/r;return{x:(t.x+a*e.x+(i.x+o*n.x))/2,y:(t.y+a*e.y+(i.y+o*n.y))/2}})(r,this.vector(),o,t.vector());return null===g?null:c(n,g)?m.round(g.x,g.y):null}split(t){const e=[],i=void 0!==t.events,n=new F(t,!0),r=new F(t,!1),s=this.rightSE;this.replaceRightSE(r),e.push(r),e.push(n);const o=new H(n,s,this.rings.slice(),this.windings.slice());return F.comparePoints(o.leftSE.point,o.rightSE.point)>0&&o.swapEvents(),F.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(n.checkForConsuming(),r.checkForConsuming()),e}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,e=this.windings.length;t<e;t++)this.windings[t]*=-1}consume(t){let e=this,i=t;for(;e.consumedBy;)e=e.consumedBy;for(;i.consumedBy;)i=i.consumedBy;const n=H.compare(e,i);if(0!==n){if(n>0){const t=e;e=i,i=t}if(e.prev===i){const t=e;e=i,i=t}for(let t=0,n=i.rings.length;t<n;t++){const n=i.rings[t],r=i.windings[t],s=e.rings.indexOf(n);-1===s?(e.rings.push(n),e.windings.push(r)):e.windings[s]+=r}i.rings=null,i.windings=null,i.consumedBy=e,i.leftSE.consumedBy=e.leftSE,i.rightSE.consumedBy=e.rightSE}}prevInResult(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}beforeState(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}afterState(){if(void 0!==this._afterState)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys;for(let t=0,n=this.rings.length;t<n;t++){const n=this.rings[t],r=this.windings[t],s=e.indexOf(n);-1===s?(e.push(n),i.push(r)):i[s]+=r}const r=[],s=[];for(let t=0,n=e.length;t<n;t++){if(0===i[t])continue;const n=e[t],o=n.poly;if(-1===s.indexOf(o))if(n.isExterior)r.push(o);else{-1===s.indexOf(o)&&s.push(o);const t=r.indexOf(n.poly);-1!==t&&r.splice(t,1)}}for(let t=0,e=r.length;t<e;t++){const e=r[t].multiPoly;-1===n.indexOf(e)&&n.push(e)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(q.type){case"union":{const i=0===t.length,n=0===e.length;this._isInResult=i!==n;break}case"intersection":{let i,n;t.length<e.length?(i=t.length,n=e.length):(i=e.length,n=t.length),this._isInResult=n===q.numMultiPolys&&i<n;break}case"xor":{const i=Math.abs(t.length-e.length);this._isInResult=i%2==1;break}case"difference":{const i=t=>1===t.length&&t[0].isSubject;this._isInResult=i(t)!==i(e);break}default:throw new Error(`Unrecognized operation type found ${q.type}`)}return this._isInResult}}class V{constructor(t,e,i){if(!Array.isArray(t)||0===t.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=i,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const n=m.round(t[0][0],t[0][1]);this.bbox={ll:{x:n.x,y:n.y},ur:{x:n.x,y:n.y}};let r=n;for(let e=1,i=t.length;e<i;e++){if("number"!=typeof t[e][0]||"number"!=typeof t[e][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let i=m.round(t[e][0],t[e][1]);i.x===r.x&&i.y===r.y||(this.segments.push(H.fromRing(r,i,this)),i.x<this.bbox.ll.x&&(this.bbox.ll.x=i.x),i.y<this.bbox.ll.y&&(this.bbox.ll.y=i.y),i.x>this.bbox.ur.x&&(this.bbox.ur.x=i.x),i.y>this.bbox.ur.y&&(this.bbox.ur.y=i.y),r=i)}n.x===r.x&&n.y===r.y||this.segments.push(H.fromRing(r,n,this))}getSweepEvents(){const t=[];for(let e=0,i=this.segments.length;e<i;e++){const i=this.segments[e];t.push(i.leftSE),t.push(i.rightSE)}return t}}class j{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new V(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let e=1,i=t.length;e<i;e++){const i=new V(t[e],this,!1);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=e}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let e=0,i=this.interiorRings.length;e<i;e++){const i=this.interiorRings[e].getSweepEvents();for(let e=0,n=i.length;e<n;e++)t.push(i[e])}return t}}class z{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let e=0,i=t.length;e<i;e++){const i=new j(t[e],this);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=e}getSweepEvents(){const t=[];for(let e=0,i=this.polys.length;e<i;e++){const i=this.polys[e].getSweepEvents();for(let e=0,n=i.length;e<n;e++)t.push(i[e])}return t}}class B{static factory(t){const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i];if(!n.isInResult()||n.ringOut)continue;let r=null,s=n.leftSE,o=n.rightSE;const a=[s],l=s.point,h=[];for(;r=s,s=o,a.push(s),s.point!==l;)for(;;){const t=s.getAvailableLinkedEvents();if(0===t.length){const t=a[0].point,e=a[a.length-1].point;throw new Error(`Unable to complete output ring starting at [${t.x}, ${t.y}]. Last matching segment found ends at [${e.x}, ${e.y}].`)}if(1===t.length){o=t[0].otherSE;break}let i=null;for(let t=0,e=h.length;t<e;t++)if(h[t].point===s.point){i=t;break}if(null!==i){const t=h.splice(i)[0],n=a.splice(t.index);n.unshift(n[0].otherSE),e.push(new B(n.reverse()));continue}h.push({index:a.length,point:s.point});const n=s.getLeftmostComparator(r);o=t.sort(n)[0].otherSE;break}e.push(new B(a))}return e}constructor(t){this.events=t;for(let e=0,i=t.length;e<i;e++)t[e].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point;const e=[t];for(let i=1,n=this.events.length-1;i<n;i++){const n=this.events[i].point,r=this.events[i+1].point;0!==A(n,t,r)&&(e.push(n),t=n)}if(1===e.length)return null;const i=e[0],n=e[1];0===A(i,t,n)&&e.shift(),e.push(e[0]);const r=this.isExteriorRing()?1:-1,s=this.isExteriorRing()?0:e.length-1,o=this.isExteriorRing()?e.length:-1,a=[];for(let t=s;t!=o;t+=r)a.push([e[t].x,e[t].y]);return a}isExteriorRing(){if(void 0===this._isExteriorRing){const t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}enclosingRing(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let e=1,i=this.events.length;e<i;e++){const i=this.events[e];F.compare(t,i)>0&&(t=i)}let e=t.segment.prevInResult(),i=e?e.prevInResult():null;for(;;){if(!e)return null;if(!i)return e.ringOut;if(i.ringOut!==e.ringOut)return i.ringOut.enclosingRing()!==e.ringOut?e.ringOut:e.ringOut.enclosingRing();e=i.prevInResult(),i=e?e.prevInResult():null}}}class U{constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(let e=0,i=this.interiorRings.length;e<i;e++){const i=this.interiorRings[e].getGeom();null!==i&&t.push(i)}return t}}class Z{constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let e=0,i=this.polys.length;e<i;e++){const i=this.polys[e].getGeom();null!==i&&t.push(i)}return t}_composePolys(t){const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i];if(!n.poly)if(n.isExteriorRing())e.push(new U(n));else{const t=n.enclosingRing();t.poly||e.push(new U(t)),t.poly.addInterior(n)}}return e}}class Y{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H.compare;this.queue=t,this.tree=new a(e),this.segments=[]}process(t){const e=t.segment,i=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),i;const n=t.isLeft?this.tree.add(e):this.tree.find(e);if(!n)throw new Error(`Unable to find segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] in SweepLine tree.`);let r,s,o=n,a=n;for(;void 0===r;)o=this.tree.prev(o),null===o?r=null:void 0===o.key.consumedBy&&(r=o.key);for(;void 0===s;)a=this.tree.next(a),null===a?s=null:void 0===a.key.consumedBy&&(s=a.key);if(t.isLeft){let n=null;if(r){const t=r.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(n=t),!r.isAnEndpoint(t))){const e=this._splitSafely(r,t);for(let t=0,n=e.length;t<n;t++)i.push(e[t])}}let o=null;if(s){const t=s.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(o=t),!s.isAnEndpoint(t))){const e=this._splitSafely(s,t);for(let t=0,n=e.length;t<n;t++)i.push(e[t])}}if(null!==n||null!==o){let t=null;t=null===n?o:null===o||F.comparePoints(n,o)<=0?n:o,this.queue.remove(e.rightSE),i.push(e.rightSE);const r=e.split(t);for(let t=0,e=r.length;t<e;t++)i.push(r[t])}i.length>0?(this.tree.remove(e),i.push(t)):(this.segments.push(e),e.prev=r)}else{if(r&&s){const t=r.getIntersection(s);if(null!==t){if(!r.isAnEndpoint(t)){const e=this._splitSafely(r,t);for(let t=0,n=e.length;t<n;t++)i.push(e[t])}if(!s.isAnEndpoint(t)){const e=this._splitSafely(s,t);for(let t=0,n=e.length;t<n;t++)i.push(e[t])}}}this.tree.remove(e)}return i}_splitSafely(t,e){this.tree.remove(t);const i=t.rightSE;this.queue.remove(i);const n=t.split(e);return n.push(i),void 0===t.consumedBy&&this.tree.add(t),n}}const W="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,X="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;const q=new class{run(t,e,i){q.type=t,m.reset();const n=[new z(e,!0)];for(let t=0,e=i.length;t<e;t++)n.push(new z(i[t],!1));if(q.numMultiPolys=n.length,"difference"===q.type){const t=n[0];let e=1;for(;e<n.length;)null!==p(n[e].bbox,t.bbox)?e++:n.splice(e,1)}if("intersection"===q.type)for(let t=0,e=n.length;t<e;t++){const e=n[t];for(let i=t+1,r=n.length;i<r;i++)if(null===p(e.bbox,n[i].bbox))return[]}const r=new a(F.compare);for(let t=0,e=n.length;t<e;t++){const e=n[t].getSweepEvents();for(let t=0,i=e.length;t<i;t++)if(r.insert(e[t]),r.size>W)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const s=new Y(r);let o=r.size,l=r.pop();for(;l;){const t=l.key;if(r.size===o){const e=t.segment;throw new Error(`Unable to pop() ${t.isLeft?"left":"right"} SweepEvent [${t.point.x}, ${t.point.y}] from segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] from queue.`)}if(r.size>W)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(s.segments.length>X)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const e=s.process(t);for(let t=0,i=e.length;t<i;t++){const i=e[t];void 0===i.consumedBy&&r.insert(i)}o=r.size,l=r.pop()}m.reset();const h=B.factory(s.segments);return new Z(h).getGeom()}};return{union:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return q.run("union",t,i)},intersection:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return q.run("intersection",t,i)},xor:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return q.run("xor",t,i)},difference:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return q.run("difference",t,i)}}}()},341:function(t){t.exports=function(){"use strict";function t(t,n,r,s,o){!function t(i,n,r,s,o){for(;s>r;){if(s-r>600){var a=s-r+1,l=n-r+1,h=Math.log(a),u=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*u*(a-u)/a)*(l-a/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-l*u/a+c)),Math.min(s,Math.floor(n+(a-l)*u/a+c)),o)}var p=i[n],d=r,g=s;for(e(i,r,n),o(i[s],p)>0&&e(i,r,s);d<g;){for(e(i,d,g),d++,g--;o(i[d],p)<0;)d++;for(;o(i[g],p)>0;)g--}0===o(i[r],p)?e(i,r,g):e(i,++g,s),g<=n&&(r=g+1),n<=g&&(s=g-1)}}(t,n,r||0,s||t.length-1,o||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){o(t,0,t.children.length,e,t)}function o(t,e,i,n,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s=e;s<i;s++){var o=t.children[s];a(r,t.leaf?n(o):o)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function f(e,i,n,r,s){for(var o=[i,n];o.length;)if(!((n=o.pop())-(i=o.pop())<=r)){var a=i+Math.ceil((n-i)/r/2)*r;t(e,a,i,n,s),o.push(i,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!d(t,e))return i;for(var n=this.toBBox,r=[];e;){for(var s=0;s<e.children.length;s++){var o=e.children[s],a=e.leaf?n(o):o;d(t,a)&&(e.leaf?i.push(o):p(t,a)?this._all(o,i):r.push(o))}e=r.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var r=e.children[n],s=e.leaf?this.toBBox(r):r;if(d(t,s)){if(e.leaf||p(t,s))return!0;i.push(r)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=g([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,s,o=this.data,a=this.toBBox(t),l=[],h=[];o||l.length;){if(o||(o=l.pop(),n=l[l.length-1],i=h.pop(),s=!0),o.leaf){var u=r(t,o.children,e);if(-1!==u)return o.children.splice(u,1),l.push(o),this._condense(l),this}s||o.leaf||!p(o,a)?n?(i++,o=n.children[i],s=!1):o=null:(l.push(o),h.push(i),i=0,n=o,o=o.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var r,o=i-e+1,a=this._maxEntries;if(o<=a)return s(r=g(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(r=g([])).leaf=!1,r.height=n;var l=Math.ceil(o/a),h=l*Math.ceil(Math.sqrt(a));f(t,e,i,h,this.compareMinX);for(var u=e;u<=i;u+=h){var c=Math.min(u+h-1,i);f(t,u,c,l,this.compareMinY);for(var p=u;p<=c;p+=l){var d=Math.min(p+l-1,c);r.children.push(this._build(t,p,d,n-1))}}return s(r,this.toBBox),r},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var r=1/0,s=1/0,o=void 0,a=0;a<e.children.length;a++){var l=e.children[a],h=u(l),c=(p=t,d=l,(Math.max(d.maxX,p.maxX)-Math.min(d.minX,p.minX))*(Math.max(d.maxY,p.maxY)-Math.min(d.minY,p.minY))-h);c<s?(s=c,r=h<r?h:r,o=l):c===s&&h<r&&(r=h,o=l)}e=o||e.children[0]}var p,d;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),r=[],s=this._chooseSubtree(n,this.data,e,r);for(s.children.push(t),a(s,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),a=g(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},n.prototype._splitRoot=function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,r,s,a,l,h,c,p=1/0,d=1/0,g=e;g<=i-e;g++){var f=o(t,0,g,this.toBBox),y=o(t,g,i,this.toBBox),m=(r=f,s=y,void 0,void 0,void 0,void 0,a=Math.max(r.minX,s.minX),l=Math.max(r.minY,s.minY),h=Math.min(r.maxX,s.maxX),c=Math.min(r.maxY,s.maxY),Math.max(0,h-a)*Math.max(0,c-l)),_=u(f)+u(y);m<p?(p=m,n=g,d=_<d?_:d):m===p&&_<d&&(d=_,n=g)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var r=this.toBBox,s=o(t,0,e,r),l=o(t,i-e,i,r),h=c(s)+c(l),u=e;u<i-e;u++){var p=t.children[u];a(s,t.leaf?r(p):p),h+=c(s)}for(var d=i-e-1;d>=e;d--){var g=t.children[d];a(l,t.leaf?r(g):g),h+=c(l)}return h},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():s(t[e],this.toBBox)},n}()},39:function(t,e){!function(t){"use strict";function e(){}function i(t){this.message=t||""}function n(t){this.message=t||""}function r(t){this.message=t||""}function s(){}function o(t){return null===t?Ot:t.color}function a(t){return null===t?null:t.parent}function l(t,e){null!==t&&(t.color=e)}function h(t){return null===t?null:t.left}function u(t){return null===t?null:t.right}function c(){this.root_=null,this.size_=0}function p(){}function d(){this.array_=[],arguments[0]instanceof Ct&&this.addAll(arguments[0])}function g(){}function f(t){this.message=t||""}function y(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),i=Math.max(Math.min(e.length,9007199254740991),0)||0,n=1 in arguments&&parseInt(Number(arguments[1]),10)||0;n=n<0?Math.max(i+n,0):Math.min(n,i);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:i;for(r=r<0?Math.max(i+arguments[2],0):Math.min(r,i);n<r;)e[n]=t,++n;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var m=function(){};m.prototype.interfaces_=function(){return[]},m.prototype.getClass=function(){return m},m.prototype.equalsWithTolerance=function(t,e,i){return Math.abs(t-e)<=i};var _=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),v=function(){},C={MAX_VALUE:{configurable:!0}};v.isNaN=function(t){return Number.isNaN(t)},v.doubleToLongBits=function(t){return t},v.longBitsToDouble=function(t){return t},v.isInfinite=function(t){return!Number.isFinite(t)},C.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(v,C);var x=function(){},w=function(){},M=function(){},E=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},I={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};E.prototype.setOrdinate=function(t,e){switch(t){case E.X:this.x=e;break;case E.Y:this.y=e;break;case E.Z:this.z=e;break;default:throw new _("Invalid ordinate index: "+t)}},E.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!m.equalsWithTolerance(this.x,e.x,i)&&!!m.equalsWithTolerance(this.y,e.y,i)}},E.prototype.getOrdinate=function(t){switch(t){case E.X:return this.x;case E.Y:return this.y;case E.Z:return this.z}throw new _("Invalid ordinate index: "+t)},E.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||v.isNaN(this.z))&&v.isNaN(t.z)},E.prototype.equals=function(t){return t instanceof E&&this.equals2D(t)},E.prototype.equalInZ=function(t,e){return m.equalsWithTolerance(this.z,t.z,e)},E.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},E.prototype.clone=function(){},E.prototype.copy=function(){return new E(this)},E.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},E.prototype.distance3D=function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+i*i+n*n)},E.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},E.prototype.hashCode=function(){var t=17;return 37*(t=37*t+E.hashCode(this.x))+E.hashCode(this.y)},E.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},E.prototype.interfaces_=function(){return[x,w,e]},E.prototype.getClass=function(){return E},E.hashCode=function(){if(1===arguments.length)return v.doubleToLongBits(arguments[0]),Math.trunc(0)},I.DimensionalComparator.get=function(){return S},I.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},I.NULL_ORDINATE.get=function(){return v.NaN},I.X.get=function(){return 0},I.Y.get=function(){return 1},I.Z.get=function(){return 2},Object.defineProperties(E,I);var S=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new _("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};S.prototype.compare=function(t,e){var i=t,n=e,r=S.compare(i.x,n.x);if(0!==r)return r;var s=S.compare(i.y,n.y);return 0!==s?s:this._dimensionsToTest<=2?0:S.compare(i.z,n.z)},S.prototype.interfaces_=function(){return[M]},S.prototype.getClass=function(){return S},S.compare=function(t,e){return t<e?-1:t>e?1:v.isNaN(t)?v.isNaN(e)?0:-1:v.isNaN(e)?1:0};var L=function(){};L.prototype.create=function(){},L.prototype.interfaces_=function(){return[]},L.prototype.getClass=function(){return L};var b=function(){},R={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};b.prototype.interfaces_=function(){return[]},b.prototype.getClass=function(){return b},b.toLocationSymbol=function(t){switch(t){case b.EXTERIOR:return"e";case b.BOUNDARY:return"b";case b.INTERIOR:return"i";case b.NONE:return"-"}throw new _("Unknown location value: "+t)},R.INTERIOR.get=function(){return 0},R.BOUNDARY.get=function(){return 1},R.EXTERIOR.get=function(){return 2},R.NONE.get=function(){return-1},Object.defineProperties(b,R);var N=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},A=function(){},T={LOG_10:{configurable:!0}};A.prototype.interfaces_=function(){return[]},A.prototype.getClass=function(){return A},A.log10=function(t){var e=Math.log(t);return v.isInfinite(e)||v.isNaN(e)?e:e/A.LOG_10},A.min=function(t,e,i,n){var r=t;return e<r&&(r=e),i<r&&(r=i),n<r&&(r=n),r},A.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],i=arguments[2];return t<e?e:t>i?i:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var n=arguments[0],r=arguments[1],s=arguments[2];return n<r?r:n>s?s:n}},A.wrap=function(t,e){return t<0?e- -t%e:t%e},A.max=function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],i=arguments[0];return t>i&&(i=t),e>i&&(i=e),i}if(4===arguments.length){var n=arguments[1],r=arguments[2],s=arguments[3],o=arguments[0];return n>o&&(o=n),r>o&&(o=r),s>o&&(o=s),o}},A.average=function(t,e){return(t+e)/2},T.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(A,T);var P=function(t){this.str=t};P.prototype.append=function(t){this.str+=t},P.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},P.prototype.toString=function(t){return this.str};var O=function(t){this.value=t};O.prototype.intValue=function(){return this.value},O.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},O.isNaN=function(t){return Number.isNaN(t)};var D=function(){};D.isWhitespace=function(t){return t<=32&&t>=0||127===t},D.toUpperCase=function(t){return t.toUpperCase()};var k=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length)if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var i=arguments[0];this.init(i)}else"string"==typeof arguments[0]&&t.call(this,t.parse(arguments[0]));else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n,r)}},F={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};k.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},k.prototype.extractSignificantDigits=function(t,e){var i=this.abs(),n=k.magnitude(i._hi),r=k.TEN.pow(n);(i=i.divide(r)).gt(k.TEN)?(i=i.divide(k.TEN),n+=1):i.lt(k.ONE)&&(i=i.multiply(k.TEN),n-=1);for(var s=n+1,o=new P,a=k.MAX_PRINT_DIGITS-1,l=0;l<=a;l++){t&&l===s&&o.append(".");var h=Math.trunc(i._hi);if(h<0)break;var u=!1,c=0;h>9?(u=!0,c="9"):c="0"+h,o.append(c),i=i.subtract(k.valueOf(h)).multiply(k.TEN),u&&i.selfAdd(k.TEN);var p=!0,d=k.magnitude(i._hi);if(d<0&&Math.abs(d)>=a-l&&(p=!1),!p)break}return e[0]=n,o.toString()},k.prototype.sqr=function(){return this.multiply(this)},k.prototype.doubleValue=function(){return this._hi+this._lo},k.prototype.subtract=function(){if(arguments[0]instanceof k){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},k.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},k.prototype.isZero=function(){return 0===this._hi&&0===this._lo},k.prototype.selfSubtract=function(){if(arguments[0]instanceof k){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},k.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},k.prototype.min=function(t){return this.le(t)?this:t},k.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof k){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var i,n,r,s,o=arguments[0],a=arguments[1],l=null,h=null,u=null,c=null;return r=this._hi/o,c=(l=(u=k.SPLIT*r)-(l=u-r))*(h=(c=k.SPLIT*o)-(h=c-o))-(s=r*o)+l*(n=o-h)+(i=r-l)*h+i*n,c=r+(u=(this._hi-s-c+this._lo-r*a)/o),this._hi=c,this._lo=r-c+u,this}},k.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},k.prototype.divide=function(){if(arguments[0]instanceof k){var t,e,i,n,r=arguments[0],s=null,o=null,a=null,l=null;return t=(i=this._hi/r._hi)-(s=(a=k.SPLIT*i)-(s=a-i)),l=s*(o=(l=k.SPLIT*r._hi)-(o=l-r._hi))-(n=i*r._hi)+s*(e=r._hi-o)+t*o+t*e,a=(this._hi-n-l+this._lo-i*r._lo)/r._hi,new k(l=i+a,i-l+a)}if("number"==typeof arguments[0]){var h=arguments[0];return v.isNaN(h)?k.createNaN():k.copy(this).selfDivide(h,0)}},k.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},k.prototype.pow=function(t){if(0===t)return k.valueOf(1);var e=new k(this),i=k.valueOf(1),n=Math.abs(t);if(n>1)for(;n>0;)n%2==1&&i.selfMultiply(e),(n/=2)>0&&(e=e.sqr());else i=e;return t<0?i.reciprocal():i},k.prototype.ceil=function(){if(this.isNaN())return k.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new k(t,e)},k.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},k.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},k.prototype.setValue=function(){if(arguments[0]instanceof k){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},k.prototype.max=function(t){return this.ge(t)?this:t},k.prototype.sqrt=function(){if(this.isZero())return k.valueOf(0);if(this.isNegative())return k.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,i=k.valueOf(e),n=this.subtract(i.sqr())._hi*(.5*t);return i.add(n)},k.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof k){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e,i,n,r,s,o=arguments[0],a=null;return a=(n=this._hi+o)-(r=n-this._hi),i=(s=(a=o-r+(this._hi-a))+this._lo)+(n-(e=n+s)),this._hi=e+i,this._lo=i+(e-this._hi),this}}else if(2===arguments.length){var l,h,u,c,p=arguments[0],d=arguments[1],g=null,f=null,y=null;u=this._hi+p,h=this._lo+d,f=u-(y=u-this._hi),g=h-(c=h-this._lo);var m=(l=u+(y=(f=p-y+(this._hi-f))+h))+(y=(g=d-c+(this._lo-g))+(y+(u-l))),_=y+(l-m);return this._hi=m,this._lo=_,this}},k.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof k){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var i,n,r=arguments[0],s=arguments[1],o=null,a=null,l=null,h=null;o=(l=k.SPLIT*this._hi)-this._hi,h=k.SPLIT*r,o=l-o,i=this._hi-o,a=h-r;var u=(l=this._hi*r)+(h=o*(a=h-a)-l+o*(n=r-a)+i*a+i*n+(this._hi*s+this._lo*r)),c=h+(o=l-u);return this._hi=u,this._lo=c,this}},k.prototype.selfSqr=function(){return this.selfMultiply(this)},k.prototype.floor=function(){if(this.isNaN())return k.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new k(t,e)},k.prototype.negate=function(){return this.isNaN()?this:new k(-this._hi,-this._lo)},k.prototype.clone=function(){},k.prototype.multiply=function(){if(arguments[0]instanceof k){var t=arguments[0];return t.isNaN()?k.createNaN():k.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return v.isNaN(e)?k.createNaN():k.copy(this).selfMultiply(e,0)}},k.prototype.isNaN=function(){return v.isNaN(this._hi)},k.prototype.intValue=function(){return Math.trunc(this._hi)},k.prototype.toString=function(){var t=k.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},k.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!0,e),n=e[0]+1,r=i;if("."===i.charAt(0))r="0"+i;else if(n<0)r="0."+k.stringOfChar("0",-n)+i;else if(-1===i.indexOf(".")){var s=n-i.length;r=i+k.stringOfChar("0",s)+".0"}return this.isNegative()?"-"+r:r},k.prototype.reciprocal=function(){var t,e,i,n,r=null,s=null,o=null,a=null;t=(i=1/this._hi)-(r=(o=k.SPLIT*i)-(r=o-i)),s=(a=k.SPLIT*this._hi)-this._hi;var l=i+(o=(1-(n=i*this._hi)-(a=r*(s=a-s)-n+r*(e=this._hi-s)+t*s+t*e)-i*this._lo)/this._hi);return new k(l,i-l+o)},k.prototype.toSciNotation=function(){if(this.isZero())return k.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!1,e),n=k.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===i.charAt(0))throw new Error("Found leading zero: "+i);var r="";i.length>1&&(r=i.substring(1));var s=i.charAt(0)+"."+r;return this.isNegative()?"-"+s+n:s+n},k.prototype.abs=function(){return this.isNaN()?k.NaN:this.isNegative()?this.negate():new k(this)},k.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},k.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},k.prototype.add=function(){if(arguments[0]instanceof k){var t=arguments[0];return k.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return k.copy(this).selfAdd(e)}},k.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof k){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this._hi=i,this._lo=n}},k.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},k.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},k.prototype.trunc=function(){return this.isNaN()?k.NaN:this.isPositive()?this.floor():this.ceil()},k.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},k.prototype.interfaces_=function(){return[e,x,w]},k.prototype.getClass=function(){return k},k.sqr=function(t){return k.valueOf(t).selfMultiply(t)},k.valueOf=function(){return"string"==typeof arguments[0]?k.parse(arguments[0]):"number"==typeof arguments[0]?new k(arguments[0]):void 0},k.sqrt=function(t){return k.valueOf(t).sqrt()},k.parse=function(t){for(var e=0,i=t.length;D.isWhitespace(t.charAt(e));)e++;var n=!1;if(e<i){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(n=!0))}for(var s=new k,o=0,a=0,l=0;!(e>=i);){var h=t.charAt(e);if(e++,D.isDigit(h)){var u=h-"0";s.selfMultiply(k.TEN),s.selfAdd(u),o++}else{if("."!==h){if("e"===h||"E"===h){var c=t.substring(e);try{l=O.parseInt(c)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+c+" in string "+t):e}break}throw new Error("Unexpected character '"+h+"' at position "+e+" in string "+t)}a=o}}var p=s,d=o-a-l;if(0===d)p=s;else if(d>0){var g=k.TEN.pow(d);p=s.divide(g)}else if(d<0){var f=k.TEN.pow(-d);p=s.multiply(f)}return n?p.negate():p},k.createNaN=function(){return new k(v.NaN,v.NaN)},k.copy=function(t){return new k(t)},k.magnitude=function(t){var e=Math.abs(t),i=Math.log(e)/Math.log(10),n=Math.trunc(Math.floor(i));return 10*Math.pow(10,n)<=e&&(n+=1),n},k.stringOfChar=function(t,e){for(var i=new P,n=0;n<e;n++)i.append(t);return i.toString()},F.PI.get=function(){return new k(3.141592653589793,12246467991473532e-32)},F.TWO_PI.get=function(){return new k(6.283185307179586,24492935982947064e-32)},F.PI_2.get=function(){return new k(1.5707963267948966,6123233995736766e-32)},F.E.get=function(){return new k(2.718281828459045,14456468917292502e-32)},F.NaN.get=function(){return new k(v.NaN,v.NaN)},F.EPS.get=function(){return 123259516440783e-46},F.SPLIT.get=function(){return 134217729},F.MAX_PRINT_DIGITS.get=function(){return 32},F.TEN.get=function(){return k.valueOf(10)},F.ONE.get=function(){return k.valueOf(1)},F.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},F.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(k,F);var G=function(){},H={DP_SAFE_EPSILON:{configurable:!0}};G.prototype.interfaces_=function(){return[]},G.prototype.getClass=function(){return G},G.orientationIndex=function(t,e,i){var n=G.orientationIndexFilter(t,e,i);if(n<=1)return n;var r=k.valueOf(e.x).selfAdd(-t.x),s=k.valueOf(e.y).selfAdd(-t.y),o=k.valueOf(i.x).selfAdd(-e.x),a=k.valueOf(i.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(s.selfMultiply(o)).signum()},G.signOfDet2x2=function(t,e,i,n){return t.multiply(n).selfSubtract(e.multiply(i)).signum()},G.intersection=function(t,e,i,n){var r=k.valueOf(n.y).selfSubtract(i.y).selfMultiply(k.valueOf(e.x).selfSubtract(t.x)),s=k.valueOf(n.x).selfSubtract(i.x).selfMultiply(k.valueOf(e.y).selfSubtract(t.y)),o=r.subtract(s),a=k.valueOf(n.x).selfSubtract(i.x).selfMultiply(k.valueOf(t.y).selfSubtract(i.y)),l=k.valueOf(n.y).selfSubtract(i.y).selfMultiply(k.valueOf(t.x).selfSubtract(i.x)),h=a.subtract(l).selfDivide(o).doubleValue(),u=k.valueOf(t.x).selfAdd(k.valueOf(e.x).selfSubtract(t.x).selfMultiply(h)).doubleValue(),c=k.valueOf(e.x).selfSubtract(t.x).selfMultiply(k.valueOf(t.y).selfSubtract(i.y)),p=k.valueOf(e.y).selfSubtract(t.y).selfMultiply(k.valueOf(t.x).selfSubtract(i.x)),d=c.subtract(p).selfDivide(o).doubleValue(),g=k.valueOf(i.y).selfAdd(k.valueOf(n.y).selfSubtract(i.y).selfMultiply(d)).doubleValue();return new E(u,g)},G.orientationIndexFilter=function(t,e,i){var n=null,r=(t.x-i.x)*(e.y-i.y),s=(t.y-i.y)*(e.x-i.x),o=r-s;if(r>0){if(s<=0)return G.signum(o);n=r+s}else{if(!(r<0))return G.signum(o);if(s>=0)return G.signum(o);n=-r-s}var a=G.DP_SAFE_EPSILON*n;return o>=a||-o>=a?G.signum(o):2},G.signum=function(t){return t>0?1:t<0?-1:0},H.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(G,H);var V=function(){},j={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};j.X.get=function(){return 0},j.Y.get=function(){return 1},j.Z.get=function(){return 2},j.M.get=function(){return 3},V.prototype.setOrdinate=function(t,e,i){},V.prototype.size=function(){},V.prototype.getOrdinate=function(t,e){},V.prototype.getCoordinate=function(){},V.prototype.getCoordinateCopy=function(t){},V.prototype.getDimension=function(){},V.prototype.getX=function(t){},V.prototype.clone=function(){},V.prototype.expandEnvelope=function(t){},V.prototype.copy=function(){},V.prototype.getY=function(t){},V.prototype.toCoordinateArray=function(){},V.prototype.interfaces_=function(){return[w]},V.prototype.getClass=function(){return V},Object.defineProperties(V,j);var z=function(){},B=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(z),U=function(){};U.arraycopy=function(t,e,i,n,r){for(var s=0,o=e;o<e+r;o++)i[n+s]=t[o],s++},U.getProperty=function(t){return{"line.separator":"\n"}[t]};var Z=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var i=arguments[0],n=arguments[1];this.x=i,this.y=n,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],s=arguments[1];this.x=r.y*s.w-s.y*r.w,this.y=s.x*r.w-r.x*s.w,this.w=r.x*s.y-s.x*r.y}else if(arguments[0]instanceof E&&arguments[1]instanceof E){var o=arguments[0],a=arguments[1];this.x=o.y-a.y,this.y=a.x-o.x,this.w=o.x*a.y-a.x*o.y}}else if(3===arguments.length){var l=arguments[0],h=arguments[1],u=arguments[2];this.x=l,this.y=h,this.w=u}else if(4===arguments.length){var c=arguments[0],p=arguments[1],d=arguments[2],g=arguments[3],f=c.y-p.y,y=p.x-c.x,m=c.x*p.y-p.x*c.y,_=d.y-g.y,v=g.x-d.x,C=d.x*g.y-g.x*d.y;this.x=y*C-v*m,this.y=_*m-f*C,this.w=f*v-_*y}};Z.prototype.getY=function(){var t=this.y/this.w;if(v.isNaN(t)||v.isInfinite(t))throw new B;return t},Z.prototype.getX=function(){var t=this.x/this.w;if(v.isNaN(t)||v.isInfinite(t))throw new B;return t},Z.prototype.getCoordinate=function(){var t=new E;return t.x=this.getX(),t.y=this.getY(),t},Z.prototype.interfaces_=function(){return[]},Z.prototype.getClass=function(){return Z},Z.intersection=function(t,e,i,n){var r=t.y-e.y,s=e.x-t.x,o=t.x*e.y-e.x*t.y,a=i.y-n.y,l=n.x-i.x,h=i.x*n.y-n.x*i.y,u=r*l-a*s,c=(s*h-l*o)/u,p=(a*o-r*h)/u;if(v.isNaN(c)||v.isInfinite(c)||v.isNaN(p)||v.isInfinite(p))throw new B;return new E(c,p)};var Y=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof E){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var i=arguments[0];this.init(i)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(4===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2],l=arguments[3];this.init(s,o,a,l)}},W={serialVersionUID:{configurable:!0}};Y.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Y.prototype.equals=function(t){if(!(t instanceof Y))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},Y.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new Y;var e=this._minx>t._minx?this._minx:t._minx,i=this._miny>t._miny?this._miny:t._miny,n=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new Y(e,n,i,r)},Y.prototype.isNull=function(){return this._maxx<this._minx},Y.prototype.getMaxX=function(){return this._maxx},Y.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof Y){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return!this.isNull()&&i>=this._minx&&i<=this._maxx&&n>=this._miny&&n<=this._maxy}},Y.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Y){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof E){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return!this.isNull()&&!(i>this._maxx||i<this._minx||n>this._maxy||n<this._miny)}},Y.prototype.getMinY=function(){return this._miny},Y.prototype.getMinX=function(){return this._minx},Y.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof Y){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.isNull()?(this._minx=i,this._maxx=i,this._miny=n,this._maxy=n):(i<this._minx&&(this._minx=i),i>this._maxx&&(this._maxx=i),n<this._miny&&(this._miny=n),n>this._maxy&&(this._maxy=n))}},Y.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},Y.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Y.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},Y.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},Y.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Y.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Y.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Y.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},Y.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=i,this._maxy+=i,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Y.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof Y){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof E){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return this.covers(i,n)}},Y.prototype.centre=function(){return this.isNull()?null:new E((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Y.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Y){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.init(i.x,n.x,i.y,n.y)}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];r<s?(this._minx=r,this._maxx=s):(this._minx=s,this._maxx=r),o<a?(this._miny=o,this._maxy=a):(this._miny=a,this._maxy=o)}},Y.prototype.getMaxY=function(){return this._maxy},Y.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var i=0;return this._maxy<t._miny?i=t._miny-this._maxy:this._miny>t._maxy&&(i=this._miny-t._maxy),0===e?i:0===i?e:Math.sqrt(e*e+i*i)},Y.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+E.hashCode(this._minx))+E.hashCode(this._maxx))+E.hashCode(this._miny))+E.hashCode(this._maxy)},Y.prototype.interfaces_=function(){return[x,e]},Y.prototype.getClass=function(){return Y},Y.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2];return i.x>=(t.x<e.x?t.x:e.x)&&i.x<=(t.x>e.x?t.x:e.x)&&i.y>=(t.y<e.y?t.y:e.y)&&i.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var n=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],a=Math.min(s.x,o.x),l=Math.max(s.x,o.x),h=Math.min(n.x,r.x),u=Math.max(n.x,r.x);return!(h>l||u<a||(a=Math.min(s.y,o.y),l=Math.max(s.y,o.y),h=Math.min(n.y,r.y),u=Math.max(n.y,r.y),h>l||u<a))}},W.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(Y,W);var X={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},q=function(t){this.geometryFactory=t||new me};q.prototype.read=function(t){var e,i,n;t=t.replace(/[\n\r]/g," ");var r=X.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=X.emptyTypeStr.exec(t))[2]=void 0),r&&(i=r[1].toLowerCase(),n=r[2],J[i]&&(e=J[i].apply(this,[n]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},q.prototype.write=function(t){return this.extractGeometry(t)},q.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!K[e])return null;var i=e.toUpperCase();return t.isEmpty()?i+" EMPTY":i+"("+K[e].apply(this,[t])+")"};var K={coordinate:function(t){return t.x+" "+t.y},point:function(t){return K.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+K.point.apply(this,[t._geometries[i]])+")");return e.join(",")},linestring:function(t){for(var e=[],i=0,n=t._points._coordinates.length;i<n;++i)e.push(K.coordinate.apply(this,[t._points._coordinates[i]]));return e.join(",")},linearring:function(t){for(var e=[],i=0,n=t._points._coordinates.length;i<n;++i)e.push(K.coordinate.apply(this,[t._points._coordinates[i]]));return e.join(",")},multilinestring:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+K.linestring.apply(this,[t._geometries[i]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+K.linestring.apply(this,[t._shell])+")");for(var i=0,n=t._holes.length;i<n;++i)e.push("("+K.linestring.apply(this,[t._holes[i]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+K.polygon.apply(this,[t._geometries[i]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push(this.extractGeometry(t._geometries[i]));return e.join(",")}},J={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(X.spaces);return this.geometryFactory.createPoint(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,i=t.trim().split(","),n=[],r=0,s=i.length;r<s;++r)e=i[r].replace(X.trimParens,"$1"),n.push(J.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(n)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,i=t.trim().split(","),n=[],r=0,s=i.length;r<s;++r)e=i[r].trim().split(X.spaces),n.push(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(n)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,i=t.trim().split(","),n=[],r=0,s=i.length;r<s;++r)e=i[r].trim().split(X.spaces),n.push(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(n)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,i=t.trim().split(X.parenComma),n=[],r=0,s=i.length;r<s;++r)e=i[r].replace(X.trimParens,"$1"),n.push(J.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(n)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,i,n,r,s=t.trim().split(X.parenComma),o=[],a=0,l=s.length;a<l;++a)e=s[a].replace(X.trimParens,"$1"),i=J.linestring.apply(this,[e]),n=this.geometryFactory.createLinearRing(i._points),0===a?r=n:o.push(n);return this.geometryFactory.createPolygon(r,o)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,i=t.trim().split(X.doubleParenComma),n=[],r=0,s=i.length;r<s;++r)e=i[r].replace(X.trimParens,"$1"),n.push(J.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(n)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),i=[],n=0,r=e.length;n<r;++n)i.push(this.read(e[n]));return this.geometryFactory.createGeometryCollection(i)}},Q=function(t){this.parser=new q(t)};Q.prototype.write=function(t){return this.parser.write(t)},Q.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var $=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),tt=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}($),et=function(){};et.prototype.interfaces_=function(){return[]},et.prototype.getClass=function(){return et},et.shouldNeverReachHere=function(){if(0===arguments.length)et.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new tt("Should never reach here"+(null!==t?": "+t:""))}},et.isTrue=function(){var t;if(1===arguments.length)et.isTrue(arguments[0],null);else if(2===arguments.length&&(t=arguments[1],!arguments[0]))throw null===t?new tt:new tt(t)},et.equals=function(){var t,e,i;if(2===arguments.length)et.equals(t=arguments[0],e=arguments[1],null);else if(3===arguments.length&&(t=arguments[0],i=arguments[2],!(e=arguments[1]).equals(t)))throw new tt("Expected "+t+" but encountered "+e+(null!==i?": "+i:""))};var it=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new E,this._intPt[1]=new E,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},nt={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};it.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},it.prototype.getTopologySummary=function(){var t=new P;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},it.prototype.computeIntersection=function(t,e,i,n){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=i,this._inputLines[1][1]=n,this._result=this.computeIntersect(t,e,i,n)},it.prototype.getIntersectionNum=function(){return this._result},it.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},it.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},it.prototype.setPrecisionModel=function(t){this._precisionModel=t},it.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},it.prototype.getIntersection=function(t){return this._intPt[t]},it.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},it.prototype.hasIntersection=function(){return this._result!==it.NO_INTERSECTION},it.prototype.getEdgeDistance=function(t,e){return it.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},it.prototype.isCollinear=function(){return this._result===it.COLLINEAR_INTERSECTION},it.prototype.toString=function(){return Q.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Q.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},it.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},it.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},it.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},it.prototype.interfaces_=function(){return[]},it.prototype.getClass=function(){return it},it.computeEdgeDistance=function(t,e,i){var n=Math.abs(i.x-e.x),r=Math.abs(i.y-e.y),s=-1;if(t.equals(e))s=0;else if(t.equals(i))s=n>r?n:r;else{var o=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(s=n>r?o:a)||t.equals(e)||(s=Math.max(o,a))}return et.isTrue(!(0===s&&!t.equals(e)),"Bad distance calculation"),s},it.nonRobustComputeEdgeDistance=function(t,e,i){var n=t.x-e.x,r=t.y-e.y,s=Math.sqrt(n*n+r*r);return et.isTrue(!(0===s&&!t.equals(e)),"Invalid distance calculation"),s},nt.DONT_INTERSECT.get=function(){return 0},nt.DO_INTERSECT.get=function(){return 1},nt.COLLINEAR.get=function(){return 2},nt.NO_INTERSECTION.get=function(){return 0},nt.POINT_INTERSECTION.get=function(){return 1},nt.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(it,nt);var rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new Y(this._inputLines[0][0],this._inputLines[0][1]),i=new Y(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&i.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],i=arguments[1],n=arguments[2];if(this._isProper=!1,Y.intersects(i,n,e)&&0===at.orientationIndex(i,n,e)&&0===at.orientationIndex(n,i,e))return this._isProper=!0,(e.equals(i)||e.equals(n))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,i,n,r){r.x=this.smallestInAbsValue(t.x,e.x,i.x,n.x),r.y=this.smallestInAbsValue(t.y,e.y,i.y,n.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,i.x-=r.x,i.y-=r.y,n.x-=r.x,n.y-=r.y},e.prototype.safeHCoordinateIntersection=function(t,i,n,r){var s=null;try{s=Z.intersection(t,i,n,r)}catch(o){if(!(o instanceof B))throw o;s=e.nearestEndpoint(t,i,n,r)}return s},e.prototype.intersection=function(t,i,n,r){var s=this.intersectionWithNormalization(t,i,n,r);return this.isInSegmentEnvelopes(s)||(s=new E(e.nearestEndpoint(t,i,n,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(s),s},e.prototype.smallestInAbsValue=function(t,e,i,n){var r=t,s=Math.abs(r);return Math.abs(e)<s&&(r=e,s=Math.abs(e)),Math.abs(i)<s&&(r=i,s=Math.abs(i)),Math.abs(n)<s&&(r=n),r},e.prototype.checkDD=function(t,e,i,n,r){var s=G.intersection(t,e,i,n),o=this.isInSegmentEnvelopes(s);U.out.println("DD in env = "+o+"  --------------------- "+s),r.distance(s)>1e-4&&U.out.println("Distance = "+r.distance(s))},e.prototype.intersectionWithNormalization=function(t,e,i,n){var r=new E(t),s=new E(e),o=new E(i),a=new E(n),l=new E;this.normalizeToEnvCentre(r,s,o,a,l);var h=this.safeHCoordinateIntersection(r,s,o,a);return h.x+=l.x,h.y+=l.y,h},e.prototype.computeCollinearIntersection=function(e,i,n,r){var s=Y.intersects(e,i,n),o=Y.intersects(e,i,r),a=Y.intersects(n,r,e),l=Y.intersects(n,r,i);return s&&o?(this._intPt[0]=n,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):a&&l?(this._intPt[0]=e,this._intPt[1]=i,t.COLLINEAR_INTERSECTION):s&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||o||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&l?(this._intPt[0]=n,this._intPt[1]=i,!n.equals(i)||o||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||s||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&l?(this._intPt[0]=r,this._intPt[1]=i,!r.equals(i)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,i,n,r){var s=t.x<e.x?t.x:e.x,o=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,h=i.x<n.x?i.x:n.x,u=i.y<n.y?i.y:n.y,c=i.x>n.x?i.x:n.x,p=i.y>n.y?i.y:n.y,d=((s>h?s:h)+(a<c?a:c))/2,g=((o>u?o:u)+(l<p?l:p))/2;r.x=d,r.y=g,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,i.x-=r.x,i.y-=r.y,n.x-=r.x,n.y-=r.y},e.prototype.computeIntersect=function(e,i,n,r){if(this._isProper=!1,!Y.intersects(e,i,n,r))return t.NO_INTERSECTION;var s=at.orientationIndex(e,i,n),o=at.orientationIndex(e,i,r);if(s>0&&o>0||s<0&&o<0)return t.NO_INTERSECTION;var a=at.orientationIndex(n,r,e),l=at.orientationIndex(n,r,i);return a>0&&l>0||a<0&&l<0?t.NO_INTERSECTION:0===s&&0===o&&0===a&&0===l?this.computeCollinearIntersection(e,i,n,r):(0===s||0===o||0===a||0===l?(this._isProper=!1,e.equals2D(n)||e.equals2D(r)?this._intPt[0]=e:i.equals2D(n)||i.equals2D(r)?this._intPt[0]=i:0===s?this._intPt[0]=new E(n):0===o?this._intPt[0]=new E(r):0===a?this._intPt[0]=new E(e):0===l&&(this._intPt[0]=new E(i))):(this._isProper=!0,this._intPt[0]=this.intersection(e,i,n,r)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,i,n){var r=t,s=at.distancePointLine(t,i,n),o=at.distancePointLine(e,i,n);return o<s&&(s=o,r=e),(o=at.distancePointLine(i,t,e))<s&&(s=o,r=i),(o=at.distancePointLine(n,t,e))<s&&(s=o,r=n),r},e}(it),st=function(){};st.prototype.interfaces_=function(){return[]},st.prototype.getClass=function(){return st},st.orientationIndex=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,s=i.x-e.x,o=i.y-e.y;return st.signOfDet2x2(n,r,s,o)},st.signOfDet2x2=function(t,e,i,n){var r=null,s=null,o=null;if(r=1,0===t||0===n)return 0===e||0===i?0:e>0?i>0?-r:r:i>0?r:-r;if(0===e||0===i)return n>0?t>0?r:-r:t>0?-r:r;if(e>0?n>0?e<=n||(r=-r,s=t,t=i,i=s,s=e,e=n,n=s):e<=-n?(r=-r,i=-i,n=-n):(s=t,t=-i,i=s,s=e,e=-n,n=s):n>0?-e<=n?(r=-r,t=-t,e=-e):(s=-t,t=i,i=s,s=-e,e=n,n=s):e>=n?(t=-t,e=-e,i=-i,n=-n):(r=-r,s=-t,t=-i,i=s,s=-e,e=-n,n=s),t>0){if(!(i>0))return r;if(!(t<=i))return r}else{if(i>0)return-r;if(!(t>=i))return-r;r=-r,t=-t,i=-i}for(;;){if((n-=(o=Math.floor(i/t))*e)<0)return-r;if(n>e)return r;if(t>(i-=o*t)+i){if(e<n+n)return r}else{if(e>n+n)return-r;i=t-i,n=e-n,r=-r}if(0===n)return 0===i?0:-r;if(0===i)return r;if((e-=(o=Math.floor(t/i))*n)<0)return r;if(e>n)return-r;if(i>(t-=o*i)+t){if(n<e+e)return-r}else{if(n>e+e)return r;t=i-t,e=n-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var ot=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};ot.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var i=t.x,n=e.x;return i>n&&(i=e.x,n=t.x),this._p.x>=i&&this._p.x<=n&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,s=t.y-this._p.y,o=e.x-this._p.x,a=e.y-this._p.y,l=st.signOfDet2x2(r,s,o,a);if(0===l)return this._isPointOnSegment=!0,null;a<s&&(l=-l),l>0&&this._crossingCount++}},ot.prototype.isPointInPolygon=function(){return this.getLocation()!==b.EXTERIOR},ot.prototype.getLocation=function(){return this._isPointOnSegment?b.BOUNDARY:this._crossingCount%2==1?b.INTERIOR:b.EXTERIOR},ot.prototype.isOnSegment=function(){return this._isPointOnSegment},ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.locatePointInRing=function(){if(arguments[0]instanceof E&&N(arguments[1],V)){for(var t=arguments[1],e=new ot(arguments[0]),i=new E,n=new E,r=1;r<t.size();r++)if(t.getCoordinate(r,i),t.getCoordinate(r-1,n),e.countSegment(i,n),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof E&&arguments[1]instanceof Array){for(var s=arguments[1],o=new ot(arguments[0]),a=1;a<s.length;a++){var l=s[a],h=s[a-1];if(o.countSegment(l,h),o.isOnSegment())return o.getLocation()}return o.getLocation()}};var at=function(){},lt={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.orientationIndex=function(t,e,i){return G.orientationIndex(t,e,i)},at.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,i=t[0].x,n=1;n<t.length-1;n++){var r=t[n].x-i,s=t[n+1].y;e+=r*(t[n-1].y-s)}return e/2}if(N(arguments[0],V)){var o=arguments[0],a=o.size();if(a<3)return 0;var l=new E,h=new E,u=new E;o.getCoordinate(0,h),o.getCoordinate(1,u);var c=h.x;u.x-=c;for(var p=0,d=1;d<a-1;d++)l.y=h.y,h.x=u.x,h.y=u.y,o.getCoordinate(d+1,u),u.x-=c,p+=h.x*(l.y-u.y);return p/2}},at.distanceLineLine=function(t,e,i,n){if(t.equals(e))return at.distancePointLine(t,i,n);if(i.equals(n))return at.distancePointLine(n,t,e);var r=!1;if(Y.intersects(t,e,i,n)){var s=(e.x-t.x)*(n.y-i.y)-(e.y-t.y)*(n.x-i.x);if(0===s)r=!0;else{var o=(t.y-i.y)*(n.x-i.x)-(t.x-i.x)*(n.y-i.y),a=((t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y))/s,l=o/s;(l<0||l>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?A.min(at.distancePointLine(t,i,n),at.distancePointLine(e,i,n),at.distancePointLine(i,t,e),at.distancePointLine(n,t,e)):0},at.isPointInRing=function(t,e){return at.locatePointInRing(t,e)!==b.EXTERIOR},at.computeLength=function(t){var e=t.size();if(e<=1)return 0;var i=0,n=new E;t.getCoordinate(0,n);for(var r=n.x,s=n.y,o=1;o<e;o++){t.getCoordinate(o,n);var a=n.x,l=n.y,h=a-r,u=l-s;i+=Math.sqrt(h*h+u*u),r=a,s=l}return i},at.isCCW=function(t){var e=t.length-1;if(e<3)throw new _("Ring has fewer than 4 points, so orientation cannot be determined");for(var i=t[0],n=0,r=1;r<=e;r++){var s=t[r];s.y>i.y&&(i=s,n=r)}var o=n;do{(o-=1)<0&&(o=e)}while(t[o].equals2D(i)&&o!==n);var a=n;do{a=(a+1)%e}while(t[a].equals2D(i)&&a!==n);var l=t[o],h=t[a];if(l.equals2D(i)||h.equals2D(i)||l.equals2D(h))return!1;var u=at.computeOrientation(l,i,h);return 0===u?l.x>h.x:u>0},at.locatePointInRing=function(t,e){return ot.locatePointInRing(t,e)},at.distancePointLinePerpendicular=function(t,e,i){var n=(i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y),r=((e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y))/n;return Math.abs(r)*Math.sqrt(n)},at.computeOrientation=function(t,e,i){return at.orientationIndex(t,e,i)},at.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new _("Line array must contain at least one vertex");for(var i=t.distance(e[0]),n=0;n<e.length-1;n++){var r=at.distancePointLine(t,e[n],e[n+1]);r<i&&(i=r)}return i}if(3===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2];if(o.x===a.x&&o.y===a.y)return s.distance(o);var l=(a.x-o.x)*(a.x-o.x)+(a.y-o.y)*(a.y-o.y),h=((s.x-o.x)*(a.x-o.x)+(s.y-o.y)*(a.y-o.y))/l;if(h<=0)return s.distance(o);if(h>=1)return s.distance(a);var u=((o.y-s.y)*(a.x-o.x)-(o.x-s.x)*(a.y-o.y))/l;return Math.abs(u)*Math.sqrt(l)}},at.isOnLine=function(t,e){for(var i=new rt,n=1;n<e.length;n++){var r=e[n-1],s=e[n];if(i.computeIntersection(t,r,s),i.hasIntersection())return!0}return!1},lt.CLOCKWISE.get=function(){return-1},lt.RIGHT.get=function(){return at.CLOCKWISE},lt.COUNTERCLOCKWISE.get=function(){return 1},lt.LEFT.get=function(){return at.COUNTERCLOCKWISE},lt.COLLINEAR.get=function(){return 0},lt.STRAIGHT.get=function(){return at.COLLINEAR},Object.defineProperties(at,lt);var ht=function(){};ht.prototype.filter=function(t){},ht.prototype.interfaces_=function(){return[]},ht.prototype.getClass=function(){return ht};var ut=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},ct={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ut.prototype.isGeometryCollection=function(){return this.getSortIndex()===ut.SORTINDEX_GEOMETRYCOLLECTION},ut.prototype.getFactory=function(){return this._factory},ut.prototype.getGeometryN=function(t){return this},ut.prototype.getArea=function(){return 0},ut.prototype.isRectangle=function(){return!1},ut.prototype.equals=function(){if(arguments[0]instanceof ut){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof ut))return!1;var i=e;return this.equalsExact(i)}},ut.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},ut.prototype.geometryChanged=function(){this.apply(ut.geometryChangedFilter)},ut.prototype.geometryChangedAction=function(){this._envelope=null},ut.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},ut.prototype.getLength=function(){return 0},ut.prototype.getNumGeometries=function(){return 1},ut.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var i=arguments[0],n=arguments[1];return this.getSortIndex()!==i.getSortIndex()?this.getSortIndex()-i.getSortIndex():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(i,n)}},ut.prototype.getUserData=function(){return this._userData},ut.prototype.getSRID=function(){return this._SRID},ut.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},ut.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===ut.SORTINDEX_GEOMETRYCOLLECTION)throw new _("This method does not support GeometryCollection arguments")},ut.prototype.equal=function(t,e,i){return 0===i?t.equals(e):t.distance(e)<=i},ut.prototype.norm=function(){var t=this.copy();return t.normalize(),t},ut.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},ut.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new Y(this._envelope)},ut.prototype.setSRID=function(t){this._SRID=t},ut.prototype.setUserData=function(t){this._userData=t},ut.prototype.compare=function(t,e){for(var i=t.iterator(),n=e.iterator();i.hasNext()&&n.hasNext();){var r=i.next(),s=n.next(),o=r.compareTo(s);if(0!==o)return o}return i.hasNext()?1:n.hasNext()?-1:0},ut.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},ut.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ut.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ut.SORTINDEX_MULTIPOINT||this.getSortIndex()===ut.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ut.SORTINDEX_MULTIPOLYGON},ut.prototype.interfaces_=function(){return[w,x,e]},ut.prototype.getClass=function(){return ut},ut.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},ut.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},ct.serialVersionUID.get=function(){return 0x799ea46522854c00},ct.SORTINDEX_POINT.get=function(){return 0},ct.SORTINDEX_MULTIPOINT.get=function(){return 1},ct.SORTINDEX_LINESTRING.get=function(){return 2},ct.SORTINDEX_LINEARRING.get=function(){return 3},ct.SORTINDEX_MULTILINESTRING.get=function(){return 4},ct.SORTINDEX_POLYGON.get=function(){return 5},ct.SORTINDEX_MULTIPOLYGON.get=function(){return 6},ct.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},ct.geometryChangedFilter.get=function(){return pt},Object.defineProperties(ut,ct);var pt=function(){};pt.interfaces_=function(){return[ht]},pt.filter=function(t){t.geometryChangedAction()};var dt=function(){};dt.prototype.filter=function(t){},dt.prototype.interfaces_=function(){return[]},dt.prototype.getClass=function(){return dt};var gt=function(){},ft={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};gt.prototype.isInBoundary=function(t){},gt.prototype.interfaces_=function(){return[]},gt.prototype.getClass=function(){return gt},ft.Mod2BoundaryNodeRule.get=function(){return yt},ft.EndPointBoundaryNodeRule.get=function(){return mt},ft.MultiValentEndPointBoundaryNodeRule.get=function(){return _t},ft.MonoValentEndPointBoundaryNodeRule.get=function(){return vt},ft.MOD2_BOUNDARY_RULE.get=function(){return new yt},ft.ENDPOINT_BOUNDARY_RULE.get=function(){return new mt},ft.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new _t},ft.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new vt},ft.OGC_SFS_BOUNDARY_RULE.get=function(){return gt.MOD2_BOUNDARY_RULE},Object.defineProperties(gt,ft);var yt=function(){};yt.prototype.isInBoundary=function(t){return t%2==1},yt.prototype.interfaces_=function(){return[gt]},yt.prototype.getClass=function(){return yt};var mt=function(){};mt.prototype.isInBoundary=function(t){return t>0},mt.prototype.interfaces_=function(){return[gt]},mt.prototype.getClass=function(){return mt};var _t=function(){};_t.prototype.isInBoundary=function(t){return t>1},_t.prototype.interfaces_=function(){return[gt]},_t.prototype.getClass=function(){return _t};var vt=function(){};vt.prototype.isInBoundary=function(t){return 1===t},vt.prototype.interfaces_=function(){return[gt]},vt.prototype.getClass=function(){return vt};var Ct=function(){};Ct.prototype.add=function(){},Ct.prototype.addAll=function(){},Ct.prototype.isEmpty=function(){},Ct.prototype.iterator=function(){},Ct.prototype.size=function(){},Ct.prototype.toArray=function(){},Ct.prototype.remove=function(){},(i.prototype=new Error).name="IndexOutOfBoundsException";var xt=function(){};xt.prototype.hasNext=function(){},xt.prototype.next=function(){},xt.prototype.remove=function(){};var wt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(Ct);(n.prototype=new Error).name="NoSuchElementException";var Mt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ct&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,Ct]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var i=this.array_[t];return this.array_[t]=e,i},e.prototype.iterator=function(){return new Et(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new i;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,i=0,n=this.array_.length;i<n;i++)if(this.array_[i]===t){this.array_.splice(i,1),e=!0;break}return e},e}(wt),Et=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new n;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(xt),It=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.ensureCapacity(i.length),this.add(i,n)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={coordArrayType:{configurable:!0}};return i.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[1],i=!1,n=arguments[0].iterator();n.hasNext();)this.add(n.next(),e),i=!0;return i}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),i=0;i<this.size();i++)e.add(i,this.get(i).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var i=arguments[0],n=arguments[1];return this.add(i,n,!0),!0}if(arguments[0]instanceof E&&"boolean"==typeof arguments[1]){var r=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(r))return null;t.prototype.add.call(this,r)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var s=arguments[0],o=arguments[1];return this.add(s,o),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var a=arguments[0],l=arguments[1];if(arguments[2])for(var h=0;h<a.length;h++)this.add(a[h],l);else for(var u=a.length-1;u>=0;u--)this.add(a[u],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof E){var c=arguments[0],p=arguments[1];if(!arguments[2]){var d=this.size();if(d>0){if(c>0&&this.get(c-1).equals2D(p))return null;if(c<d&&this.get(c).equals2D(p))return null}}t.prototype.add.call(this,c,p)}}else if(4===arguments.length){var g=arguments[0],f=arguments[1],y=arguments[2],m=arguments[3],_=1;y>m&&(_=-1);for(var v=y;v!==m;v+=_)this.add(g[v],f);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new E(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,i),e}(Mt),St=function(){},Lt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Lt.ForwardComparator.get=function(){return bt},Lt.BidirectionalComparator.get=function(){return Rt},Lt.coordArrayType.get=function(){return new Array(0).fill(null)},St.prototype.interfaces_=function(){return[]},St.prototype.getClass=function(){return St},St.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},St.ptNotInList=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];if(St.indexOf(n,e)<0)return n}return null},St.scroll=function(t,e){var i=St.indexOf(e,t);if(i<0)return null;var n=new Array(t.length).fill(null);U.arraycopy(t,i,n,0,t.length-i),U.arraycopy(t,0,n,t.length-i,i),U.arraycopy(n,0,t,0,t.length)},St.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(!t[i].equals(e[i]))return!1;return!0}if(3===arguments.length){var n=arguments[0],r=arguments[1],s=arguments[2];if(n===r)return!0;if(null===n||null===r)return!1;if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(0!==s.compare(n[o],r[o]))return!1;return!0}},St.intersection=function(t,e){for(var i=new It,n=0;n<t.length;n++)e.intersects(t[n])&&i.add(t[n],!0);return i.toCoordinateArray()},St.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},St.removeRepeatedPoints=function(t){return St.hasRepeatedPoints(t)?new It(t,!1).toCoordinateArray():t},St.reverse=function(t){for(var e=t.length-1,i=Math.trunc(e/2),n=0;n<=i;n++){var r=t[n];t[n]=t[e-n],t[e-n]=r}},St.removeNull=function(t){for(var e=0,i=0;i<t.length;i++)null!==t[i]&&e++;var n=new Array(e).fill(null);if(0===e)return n;for(var r=0,s=0;s<t.length;s++)null!==t[s]&&(n[r++]=t[s]);return n},St.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),i=0;i<t.length;i++)e[i]=new E(t[i]);return e}if(5===arguments.length)for(var n=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4],l=0;l<a;l++)s[o+l]=new E(n[r+l])},St.isEqualReversed=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=e[t.length-i-1];if(0!==n.compareTo(r))return!1}return!0},St.envelope=function(t){for(var e=new Y,i=0;i<t.length;i++)e.expandToInclude(t[i]);return e},St.toCoordinateArray=function(t){return t.toArray(St.coordArrayType)},St.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},St.indexOf=function(t,e){for(var i=0;i<e.length;i++)if(t.equals(e[i]))return i;return-1},St.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var i=t.length-1-e,n=t[e].compareTo(t[i]);if(0!==n)return n}return 1},St.compare=function(t,e){for(var i=0;i<t.length&&i<e.length;){var n=t[i].compareTo(e[i]);if(0!==n)return n;i++}return i<e.length?-1:i<t.length?1:0},St.minCoordinate=function(t){for(var e=null,i=0;i<t.length;i++)(null===e||e.compareTo(t[i])>0)&&(e=t[i]);return e},St.extract=function(t,e,i){e=A.clamp(e,0,t.length);var n=(i=A.clamp(i,-1,t.length))-e+1;i<0&&(n=0),e>=t.length&&(n=0),i<e&&(n=0);var r=new Array(n).fill(null);if(0===n)return r;for(var s=0,o=e;o<=i;o++)r[s++]=t[o];return r},Object.defineProperties(St,Lt);var bt=function(){};bt.prototype.compare=function(t,e){return St.compare(t,e)},bt.prototype.interfaces_=function(){return[M]},bt.prototype.getClass=function(){return bt};var Rt=function(){};Rt.prototype.compare=function(t,e){var i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(0===i.length)return 0;var r=St.compare(i,n);return St.isEqualReversed(i,n)?0:r},Rt.prototype.OLDcompare=function(t,e){var i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(0===i.length)return 0;for(var r=St.increasingDirection(i),s=St.increasingDirection(n),o=r>0?0:i.length-1,a=s>0?0:i.length-1,l=0;l<i.length;l++){var h=i[o].compareTo(n[a]);if(0!==h)return h;o+=r,a+=s}return 0},Rt.prototype.interfaces_=function(){return[M]},Rt.prototype.getClass=function(){return Rt};var Nt=function(){};Nt.prototype.get=function(){},Nt.prototype.put=function(){},Nt.prototype.size=function(){},Nt.prototype.values=function(){},Nt.prototype.entrySet=function(){};var At=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nt);(r.prototype=new Error).name="OperationNotSupported",(s.prototype=new Ct).contains=function(){};var Tt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ct&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,i=this.array_.length;e<i;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Pt(this)},e}(s),Pt=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new n;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new r},e}(xt),Ot=0;(c.prototype=new At).get=function(t){for(var e=this.root_;null!==e;){var i=t.compareTo(e.key);if(i<0)e=e.left;else{if(!(i>0))return e.value;e=e.right}}return null},c.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Ot,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var i,n,r=this.root_;do{if(i=r,(n=t.compareTo(r.key))<0)r=r.left;else{if(!(n>0)){var s=r.value;return r.value=e,s}r=r.right}}while(null!==r);var o={key:t,left:null,right:null,value:e,parent:i,color:Ot,getValue:function(){return this.value},getKey:function(){return this.key}};return n<0?i.left=o:i.right=o,this.fixAfterInsertion(o),this.size_++,null},c.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(a(t)===h(a(a(t)))){var e=u(a(a(t)));1===o(e)?(l(a(t),Ot),l(e,Ot),l(a(a(t)),1),t=a(a(t))):(t===u(a(t))&&(t=a(t),this.rotateLeft(t)),l(a(t),Ot),l(a(a(t)),1),this.rotateRight(a(a(t))))}else{var i=h(a(a(t)));1===o(i)?(l(a(t),Ot),l(i,Ot),l(a(a(t)),1),t=a(a(t))):(t===h(a(t))&&(t=a(t),this.rotateRight(t)),l(a(t),Ot),l(a(a(t)),1),this.rotateLeft(a(a(t))))}this.root_.color=Ot},c.prototype.values=function(){var t=new Mt,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=c.successor(e));)t.add(e.value);return t},c.prototype.entrySet=function(){var t=new Tt,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=c.successor(e));)t.add(e);return t},c.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},c.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},c.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},c.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var i=t.parent,n=t;null!==i&&n===i.right;)n=i,i=i.parent;return i},c.prototype.size=function(){return this.size_};var Dt=function(){};Dt.prototype.interfaces_=function(){return[]},Dt.prototype.getClass=function(){return Dt},p.prototype=new s,(d.prototype=new p).contains=function(t){for(var e=0,i=this.array_.length;e<i;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},d.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,i=this.array_.length;e<i;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},d.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},d.prototype.remove=function(t){throw new r},d.prototype.size=function(){return this.array_.length},d.prototype.isEmpty=function(){return 0===this.array_.length},d.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},d.prototype.iterator=function(){return new kt(this)};var kt=function(t){this.treeSet_=t,this.position_=0};kt.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new n;return this.treeSet_.array_[this.position_++]},kt.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},kt.prototype.remove=function(){throw new r};var Ft=function(){};Ft.sort=function(){var t,e,i,n,r=arguments[0];if(1===arguments.length)n=function(t,e){return t.compareTo(e)},r.sort(n);else if(2===arguments.length)i=arguments[1],n=function(t,e){return i.compare(t,e)},r.sort(n);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var s=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<s.length;t++)r.push(s[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),i=arguments[3],n=function(t,e){return i.compare(t,e)},e.sort(n),s=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<s.length;t++)r.push(s[t])},Ft.asList=function(t){for(var e=new Mt,i=0,n=t.length;i<n;i++)e.add(t[i]);return e};var Gt=function(){},Ht={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Ht.P.get=function(){return 0},Ht.L.get=function(){return 1},Ht.A.get=function(){return 2},Ht.FALSE.get=function(){return-1},Ht.TRUE.get=function(){return-2},Ht.DONTCARE.get=function(){return-3},Ht.SYM_FALSE.get=function(){return"F"},Ht.SYM_TRUE.get=function(){return"T"},Ht.SYM_DONTCARE.get=function(){return"*"},Ht.SYM_P.get=function(){return"0"},Ht.SYM_L.get=function(){return"1"},Ht.SYM_A.get=function(){return"2"},Gt.prototype.interfaces_=function(){return[]},Gt.prototype.getClass=function(){return Gt},Gt.toDimensionSymbol=function(t){switch(t){case Gt.FALSE:return Gt.SYM_FALSE;case Gt.TRUE:return Gt.SYM_TRUE;case Gt.DONTCARE:return Gt.SYM_DONTCARE;case Gt.P:return Gt.SYM_P;case Gt.L:return Gt.SYM_L;case Gt.A:return Gt.SYM_A}throw new _("Unknown dimension value: "+t)},Gt.toDimensionValue=function(t){switch(D.toUpperCase(t)){case Gt.SYM_FALSE:return Gt.FALSE;case Gt.SYM_TRUE:return Gt.TRUE;case Gt.SYM_DONTCARE:return Gt.DONTCARE;case Gt.SYM_P:return Gt.P;case Gt.SYM_L:return Gt.L;case Gt.SYM_A:return Gt.A}throw new _("Unknown dimension symbol: "+t)},Object.defineProperties(Gt,Ht);var Vt=function(){};Vt.prototype.filter=function(t){},Vt.prototype.interfaces_=function(){return[]},Vt.prototype.getClass=function(){return Vt};var jt=function(){};jt.prototype.filter=function(t,e){},jt.prototype.isDone=function(){},jt.prototype.isGeometryChanged=function(){},jt.prototype.interfaces_=function(){return[]},jt.prototype.getClass=function(){return jt};var zt=function(t){function e(e,i){if(t.call(this,i),this._geometries=e||[],t.hasNullElements(this._geometries))throw new _("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new Y,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,i=0;i<this._geometries.length;i++)for(var n=this._geometries[i].getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];if(!this.isEquivalentClass(e))return!1;var n=e;if(this._geometries.length!==n._geometries.length)return!1;for(var r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(n._geometries[r],i))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Ft.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=Gt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=Gt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[i]=this._geometries[i].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new d(Ft.asList(this._geometries)),i=new d(Ft.asList(t._geometries));return this.compare(e,i)}if(2===arguments.length){for(var n=arguments[1],r=arguments[0],s=this.getNumGeometries(),o=r.getNumGeometries(),a=0;a<s&&a<o;){var l=this.getGeometryN(a),h=r.getGeometryN(a),u=l.compareToSameClass(h,n);if(0!==u)return u;a++}return a<s?1:a<o?-1:0}},e.prototype.apply=function(){if(N(arguments[0],dt))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(N(arguments[0],jt)){var i=arguments[0];if(0===this._geometries.length)return null;for(var n=0;n<this._geometries.length&&(this._geometries[n].apply(i),!i.isDone());n++);i.isGeometryChanged()&&this.geometryChanged()}else if(N(arguments[0],Vt)){var r=arguments[0];r.filter(this);for(var s=0;s<this._geometries.length;s++)this._geometries[s].apply(r)}else if(N(arguments[0],ht)){var o=arguments[0];o.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(o)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),et.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var i=0;i<this._geometries.length;i++)e._geometries[i]=this._geometries[i].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,i),e}(ut),Bt=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ut.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Gt.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[t-1-i]=this._geometries[i].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new Ut(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Dt]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,i),e}(zt),Ut=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=gt.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this._geom=i,this._geomFact=i.getFactory(),this._bnRule=n}};Ut.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},Ut.prototype.getBoundary=function(){return this._geom instanceof qt?this.boundaryLineString(this._geom):this._geom instanceof Bt?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Ut.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},Ut.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Ut.prototype.computeBoundaryCoordinates=function(t){var e=new Mt;this._endpointMap=new c;for(var i=0;i<t.getNumGeometries();i++){var n=t.getGeometryN(i);0!==n.getNumPoints()&&(this.addEndpoint(n.getCoordinateN(0)),this.addEndpoint(n.getCoordinateN(n.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var s=r.next(),o=s.getValue().count;this._bnRule.isInBoundary(o)&&e.add(s.getKey())}return St.toCoordinateArray(e)},Ut.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Zt,this._endpointMap.put(t,e)),e.count++},Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut},Ut.getBoundary=function(){return 1===arguments.length?new Ut(arguments[0]).getBoundary():2===arguments.length?new Ut(arguments[0],arguments[1]).getBoundary():void 0};var Zt=function(){this.count=null};Zt.prototype.interfaces_=function(){return[]},Zt.prototype.getClass=function(){return Zt};var Yt=function(){},Wt={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Yt.prototype.interfaces_=function(){return[]},Yt.prototype.getClass=function(){return Yt},Yt.chars=function(t,e){for(var i=new Array(e).fill(null),n=0;n<e;n++)i[n]=t;return String(i)},Yt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},i=new function(){}(e);return t.printStackTrace(i),e.toString()}if(2===arguments.length){for(var n=arguments[1],r="",s=new function(){}(new function(){}(Yt.getStackTrace(arguments[0]))),o=0;o<n;o++)try{r+=s.readLine()+Yt.NEWLINE}catch(t){if(!(t instanceof g))throw t;et.shouldNeverReachHere()}return r}},Yt.split=function(t,e){for(var i=e.length,n=new Mt,r=""+t,s=r.indexOf(e);s>=0;){var o=r.substring(0,s);n.add(o),s=(r=r.substring(s+i)).indexOf(e)}r.length>0&&n.add(r);for(var a=new Array(n.size()).fill(null),l=0;l<a.length;l++)a[l]=n.get(l);return a},Yt.toString=function(){if(1===arguments.length){var t=arguments[0];return Yt.SIMPLE_ORDINATE_FORMAT.format(t)}},Yt.spaces=function(t){return Yt.chars(" ",t)},Wt.NEWLINE.get=function(){return U.getProperty("line.separator")},Wt.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Yt,Wt);var Xt=function(){};Xt.prototype.interfaces_=function(){return[]},Xt.prototype.getClass=function(){return Xt},Xt.copyCoord=function(t,e,i,n){for(var r=Math.min(t.getDimension(),i.getDimension()),s=0;s<r;s++)i.setOrdinate(n,s,t.getOrdinate(e,s))},Xt.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,V.X)===t.getOrdinate(e-1,V.X)&&t.getOrdinate(0,V.Y)===t.getOrdinate(e-1,V.Y)},Xt.isEqual=function(t,e){var i=t.size();if(i!==e.size())return!1;for(var n=Math.min(t.getDimension(),e.getDimension()),r=0;r<i;r++)for(var s=0;s<n;s++){var o=t.getOrdinate(r,s),a=e.getOrdinate(r,s);if(!(t.getOrdinate(r,s)===e.getOrdinate(r,s)||v.isNaN(o)&&v.isNaN(a)))return!1}return!0},Xt.extend=function(t,e,i){var n=t.create(i,e.getDimension()),r=e.size();if(Xt.copy(e,0,n,0,r),r>0)for(var s=r;s<i;s++)Xt.copy(e,r-1,n,s,1);return n},Xt.reverse=function(t){for(var e=t.size()-1,i=Math.trunc(e/2),n=0;n<=i;n++)Xt.swap(t,n,e-n)},Xt.swap=function(t,e,i){if(e===i)return null;for(var n=0;n<t.getDimension();n++){var r=t.getOrdinate(e,n);t.setOrdinate(e,n,t.getOrdinate(i,n)),t.setOrdinate(i,n,r)}},Xt.copy=function(t,e,i,n,r){for(var s=0;s<r;s++)Xt.copyCoord(t,e+s,i,n+s)},Xt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var i=t.getDimension(),n=new P;n.append("(");for(var r=0;r<e;r++){r>0&&n.append(" ");for(var s=0;s<i;s++)s>0&&n.append(","),n.append(Yt.toString(t.getOrdinate(r,s)))}return n.append(")"),n.toString()}},Xt.ensureValidRing=function(t,e){var i=e.size();return 0===i?e:i<=3?Xt.createClosedRing(t,e,4):e.getOrdinate(0,V.X)===e.getOrdinate(i-1,V.X)&&e.getOrdinate(0,V.Y)===e.getOrdinate(i-1,V.Y)?e:Xt.createClosedRing(t,e,i+1)},Xt.createClosedRing=function(t,e,i){var n=t.create(i,e.getDimension()),r=e.size();Xt.copy(e,0,n,0,r);for(var s=r;s<i;s++)Xt.copy(e,0,n,s,1);return n};var qt=function(t){function e(e,i){t.call(this,i),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Y:this._points.expandEnvelope(new Y)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];if(!this.isEquivalentClass(e))return!1;var n=e;if(this._points.size()!==n._points.size())return!1;for(var r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),n._points.getCoordinate(r),i))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&Xt.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Gt.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return at.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Xt.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,i=0;e<this._points.size()&&i<t._points.size();){var n=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(i));if(0!==n)return n;e++,i++}return e<this._points.size()?1:i<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(N(arguments[0],dt))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(N(arguments[0],jt)){var i=arguments[0];if(0===this._points.size())return null;for(var n=0;n<this._points.size()&&(i.filter(this._points,n),!i.isDone());n++);i.isGeometryChanged()&&this.geometryChanged()}else(N(arguments[0],Vt)||N(arguments[0],ht))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new Ut(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new _("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Dt]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,i),e}(ut),Kt=function(){};Kt.prototype.interfaces_=function(){return[]},Kt.prototype.getClass=function(){return Kt};var Jt=function(t){function e(e,i){t.call(this,i),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Y;var t=new Y;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),i))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return Gt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(N(arguments[0],dt)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(N(arguments[0],jt)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(N(arguments[0],Vt)||N(arguments[0],ht))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),et.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Kt]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,i),e}(ut),Qt=function(){};Qt.prototype.interfaces_=function(){return[]},Qt.prototype.getClass=function(){return Qt};var $t=function(t){function e(e,i,n){if(t.call(this,n),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===i&&(i=[]),t.hasNullElements(i))throw new _("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(i))throw new _("shell is empty but holes are not");this._shell=e,this._holes=i}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,i=this._shell.getCoordinates(),n=0;n<i.length;n++)t[++e]=i[n];for(var r=0;r<this._holes.length;r++)for(var s=this._holes[r].getCoordinates(),o=0;o<s.length;o++)t[++e]=s[o];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(at.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(at.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),i=0;i<5;i++){var n=t.getX(i);if(n!==e.getMinX()&&n!==e.getMaxX())return!1;var r=t.getY(i);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var s=t.getX(0),o=t.getY(0),a=1;a<=4;a++){var l=t.getX(a),h=t.getY(a);if(l!==s==(h!==o))return!1;s=l,o=h}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];if(!this.isEquivalentClass(e))return!1;var n=e,r=this._shell,s=n._shell;if(!r.equalsExact(s,i))return!1;if(this._holes.length!==n._holes.length)return!1;for(var o=0;o<this._holes.length;o++)if(!this._holes[o].equalsExact(n._holes[o],i))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);Ft.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(e.isEmpty())return null;var n=new Array(e.getCoordinates().length-1).fill(null);U.arraycopy(e.getCoordinates(),0,n,0,n.length);var r=St.minCoordinate(e.getCoordinates());St.scroll(n,r),U.arraycopy(n,0,e.getCoordinates(),0,n.length),e.getCoordinates()[n.length]=n[0],at.isCCW(e.getCoordinates())===i&&St.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,i=t._shell;return e.compareToSameClass(i)}if(2===arguments.length){var n=arguments[1],r=arguments[0],s=this._shell,o=r._shell,a=s.compareToSameClass(o,n);if(0!==a)return a;for(var l=this.getNumInteriorRing(),h=r.getNumInteriorRing(),u=0;u<l&&u<h;){var c=this.getInteriorRingN(u),p=r.getInteriorRingN(u),d=c.compareToSameClass(p,n);if(0!==d)return d;u++}return u<l?1:u<h?-1:0}},e.prototype.apply=function(t){if(N(t,dt)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(N(t,jt)){if(this._shell.apply(t),!t.isDone())for(var i=0;i<this._holes.length&&(this._holes[i].apply(t),!t.isDone());i++);t.isGeometryChanged()&&this.geometryChanged()}else if(N(t,Vt))t.filter(this);else if(N(t,ht)){t.filter(this),this._shell.apply(t);for(var n=0;n<this._holes.length;n++)this._holes[n].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var i=0;i<this._holes.length;i++)e._holes[i]=this._holes[i].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),i=new Array(this._holes.length).fill(null),n=0;n<i.length;n++)i[n]=this._holes[n].copy();return new e(t,i,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[Qt]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,i),e}(ut),te=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ut.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return Gt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Kt]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,i),e}(zt),ee=function(t){function e(e,i){e instanceof E&&i instanceof me&&(e=i.getCoordinateSequenceFactory().create(e)),t.call(this,e,i),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ut.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return Gt.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Xt.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new _("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new _("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.MINIMUM_VALID_SIZE.get=function(){return 4},i.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,i),e}(qt),ie=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ut.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[i]=this._geometries[i].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new Mt,e=0;e<this._geometries.length;e++)for(var i=this._geometries[e].getBoundary(),n=0;n<i.getNumGeometries();n++)t.add(i.getGeometryN(n));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Qt]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,i),e}(zt),ne=function(t){this._factory=t||null,this._isUserDataCopied=!1},re={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ne.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},ne.prototype.edit=function(t,e){if(null===t)return null;var i=this.editInternal(t,e);return this._isUserDataCopied&&i.setUserData(t.getUserData()),i},ne.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof zt?this.editGeometryCollection(t,e):t instanceof $t?this.editPolygon(t,e):t instanceof Jt||t instanceof qt?e.edit(t,this._factory):(et.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},ne.prototype.editGeometryCollection=function(t,e){for(var i=e.edit(t,this._factory),n=new Mt,r=0;r<i.getNumGeometries();r++){var s=this.edit(i.getGeometryN(r),e);null===s||s.isEmpty()||n.add(s)}return i.getClass()===te?this._factory.createMultiPoint(n.toArray([])):i.getClass()===Bt?this._factory.createMultiLineString(n.toArray([])):i.getClass()===ie?this._factory.createMultiPolygon(n.toArray([])):this._factory.createGeometryCollection(n.toArray([]))},ne.prototype.editPolygon=function(t,e){var i=e.edit(t,this._factory);if(null===i&&(i=this._factory.createPolygon(null)),i.isEmpty())return i;var n=this.edit(i.getExteriorRing(),e);if(null===n||n.isEmpty())return this._factory.createPolygon();for(var r=new Mt,s=0;s<i.getNumInteriorRing();s++){var o=this.edit(i.getInteriorRingN(s),e);null===o||o.isEmpty()||r.add(o)}return this._factory.createPolygon(n,r.toArray([]))},ne.prototype.interfaces_=function(){return[]},ne.prototype.getClass=function(){return ne},ne.GeometryEditorOperation=function(){},re.NoOpGeometryOperation.get=function(){return se},re.CoordinateOperation.get=function(){return oe},re.CoordinateSequenceOperation.get=function(){return ae},Object.defineProperties(ne,re);var se=function(){};se.prototype.edit=function(t,e){return t},se.prototype.interfaces_=function(){return[ne.GeometryEditorOperation]},se.prototype.getClass=function(){return se};var oe=function(){};oe.prototype.edit=function(t,e){var i=this.editCoordinates(t.getCoordinates(),t);return null===i?t:t instanceof ee?e.createLinearRing(i):t instanceof qt?e.createLineString(i):t instanceof Jt?i.length>0?e.createPoint(i[0]):e.createPoint():t},oe.prototype.interfaces_=function(){return[ne.GeometryEditorOperation]},oe.prototype.getClass=function(){return oe};var ae=function(){};ae.prototype.edit=function(t,e){return t instanceof ee?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof qt?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Jt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},ae.prototype.interfaces_=function(){return[ne.GeometryEditorOperation]},ae.prototype.getClass=function(){return ae};var le=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new E}else if(N(arguments[0],V)){var i=arguments[0];if(null===i)return this._coordinates=new Array(0).fill(null),null;this._dimension=i.getDimension(),this._coordinates=new Array(i.size()).fill(null);for(var n=0;n<this._coordinates.length;n++)this._coordinates[n]=i.getCoordinateCopy(n)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],s=arguments[1];this._coordinates=r,this._dimension=s,null===r&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var o=arguments[0],a=arguments[1];this._coordinates=new Array(o).fill(null),this._dimension=a;for(var l=0;l<o;l++)this._coordinates[l]=new E}},he={serialVersionUID:{configurable:!0}};le.prototype.setOrdinate=function(t,e,i){switch(e){case V.X:this._coordinates[t].x=i;break;case V.Y:this._coordinates[t].y=i;break;case V.Z:this._coordinates[t].z=i;break;default:throw new _("invalid ordinateIndex")}},le.prototype.size=function(){return this._coordinates.length},le.prototype.getOrdinate=function(t,e){switch(e){case V.X:return this._coordinates[t].x;case V.Y:return this._coordinates[t].y;case V.Z:return this._coordinates[t].z}return v.NaN},le.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],i=arguments[1];i.x=this._coordinates[e].x,i.y=this._coordinates[e].y,i.z=this._coordinates[e].z}},le.prototype.getCoordinateCopy=function(t){return new E(this._coordinates[t])},le.prototype.getDimension=function(){return this._dimension},le.prototype.getX=function(t){return this._coordinates[t].x},le.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new le(t,this._dimension)},le.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},le.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new le(t,this._dimension)},le.prototype.toString=function(){if(this._coordinates.length>0){var t=new P(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},le.prototype.getY=function(t){return this._coordinates[t].y},le.prototype.toCoordinateArray=function(){return this._coordinates},le.prototype.interfaces_=function(){return[V,e]},le.prototype.getClass=function(){return le},he.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(le,he);var ue=function(){},ce={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};ue.prototype.readResolve=function(){return ue.instance()},ue.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new le(arguments[0]);if(N(arguments[0],V))return new le(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new le(t):new le(t,e)}},ue.prototype.interfaces_=function(){return[L,e]},ue.prototype.getClass=function(){return ue},ue.instance=function(){return ue.instanceObject},ce.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},ce.instanceObject.get=function(){return new ue},Object.defineProperties(ue,ce);var pe=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new Mt,e=this.map_.values(),i=e.next();!i.done;)t.add(i.value),i=e.next();return t},e.prototype.entrySet=function(){var t=new Tt;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(Nt),de=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof fe){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var i=arguments[0];this._modelType=t.FIXED,this.setScale(i)}else if(arguments[0]instanceof t){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}},ge={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};de.prototype.equals=function(t){if(!(t instanceof de))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},de.prototype.compareTo=function(t){var e=t,i=this.getMaximumSignificantDigits(),n=e.getMaximumSignificantDigits();return new O(i).compareTo(new O(n))},de.prototype.getScale=function(){return this._scale},de.prototype.isFloating=function(){return this._modelType===de.FLOATING||this._modelType===de.FLOATING_SINGLE},de.prototype.getType=function(){return this._modelType},de.prototype.toString=function(){var t="UNKNOWN";return this._modelType===de.FLOATING?t="Floating":this._modelType===de.FLOATING_SINGLE?t="Floating-Single":this._modelType===de.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},de.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return v.isNaN(t)||this._modelType===de.FLOATING_SINGLE?t:this._modelType===de.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof E){var e=arguments[0];if(this._modelType===de.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},de.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===de.FLOATING?t=16:this._modelType===de.FLOATING_SINGLE?t=6:this._modelType===de.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},de.prototype.setScale=function(t){this._scale=Math.abs(t)},de.prototype.interfaces_=function(){return[e,x]},de.prototype.getClass=function(){return de},de.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},ge.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},ge.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(de,ge);var fe=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},ye={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};fe.prototype.readResolve=function(){return fe.nameToTypeMap.get(this._name)},fe.prototype.toString=function(){return this._name},fe.prototype.interfaces_=function(){return[e]},fe.prototype.getClass=function(){return fe},ye.serialVersionUID.get=function(){return-552860263173159e4},ye.nameToTypeMap.get=function(){return new pe},Object.defineProperties(fe,ye),de.Type=fe,de.FIXED=new fe("FIXED"),de.FLOATING=new fe("FLOATING"),de.FLOATING_SINGLE=new fe("FLOATING SINGLE");var me=function t(){this._precisionModel=new de,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?N(arguments[0],L)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof de&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},_e={serialVersionUID:{configurable:!0}};me.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new E(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new E(t.getMinX(),t.getMinY()),new E(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new E(t.getMinX(),t.getMinY()),new E(t.getMinX(),t.getMaxY()),new E(t.getMaxX(),t.getMaxY()),new E(t.getMaxX(),t.getMinY()),new E(t.getMinX(),t.getMinY())]),null)},me.prototype.createLineString=function(t){return t?t instanceof Array?new qt(this.getCoordinateSequenceFactory().create(t),this):N(t,V)?new qt(t,this):void 0:new qt(this.getCoordinateSequenceFactory().create([]),this)},me.prototype.createMultiLineString=function(){return 0===arguments.length?new Bt(null,this):1===arguments.length?new Bt(arguments[0],this):void 0},me.prototype.buildGeometry=function(t){for(var e=null,i=!1,n=!1,r=t.iterator();r.hasNext();){var s=r.next(),o=s.getClass();null===e&&(e=o),o!==e&&(i=!0),s.isGeometryCollectionOrDerived()&&(n=!0)}if(null===e)return this.createGeometryCollection();if(i||n)return this.createGeometryCollection(me.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof $t)return this.createMultiPolygon(me.toPolygonArray(t));if(a instanceof qt)return this.createMultiLineString(me.toLineStringArray(t));if(a instanceof Jt)return this.createMultiPoint(me.toPointArray(t));et.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},me.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},me.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(N(arguments[0],V))return new Jt(arguments[0],this)}},me.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},me.prototype.createPolygon=function(){if(0===arguments.length)return new $t(null,null,this);if(1===arguments.length){if(N(arguments[0],V)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ee){var i=arguments[0];return this.createPolygon(i,null)}}else if(2===arguments.length)return new $t(arguments[0],arguments[1],this)},me.prototype.getSRID=function(){return this._SRID},me.prototype.createGeometryCollection=function(){return 0===arguments.length?new zt(null,this):1===arguments.length?new zt(arguments[0],this):void 0},me.prototype.createGeometry=function(t){return new ne(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},me.prototype.getPrecisionModel=function(){return this._precisionModel},me.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(N(arguments[0],V))return new ee(arguments[0],this)}},me.prototype.createMultiPolygon=function(){return 0===arguments.length?new ie(null,this):1===arguments.length?new ie(arguments[0],this):void 0},me.prototype.createMultiPoint=function(){if(0===arguments.length)return new te(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new te(arguments[0],this);if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(N(arguments[0],V)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var i=new Array(e.size()).fill(null),n=0;n<e.size();n++){var r=this.getCoordinateSequenceFactory().create(1,e.getDimension());Xt.copy(e,n,r,0,1),i[n]=this.createPoint(r)}return this.createMultiPoint(i)}}},me.prototype.interfaces_=function(){return[e]},me.prototype.getClass=function(){return me},me.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},me.getDefaultCoordinateSequenceFactory=function(){return ue.instance()},me.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},_e.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(me,_e);var ve=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Ce=function(t){this.geometryFactory=t||new me};Ce.prototype.read=function(t){var e,i=(e="string"==typeof t?JSON.parse(t):t).type;if(!xe[i])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==ve.indexOf(i)?xe[i].apply(this,[e.coordinates]):"GeometryCollection"===i?xe[i].apply(this,[e.geometries]):xe[i].apply(this,[e])},Ce.prototype.write=function(t){var e=t.getGeometryType();if(!we[e])throw new Error("Geometry is not supported");return we[e].apply(this,[t])};var xe={Feature:function(t){var e={};for(var i in t)e[i]=t[i];if(t.geometry){var n=t.geometry.type;if(!xe[n])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=xe.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var i=0;i<t.features.length;++i)e.features.push(this.read(t.features[i]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(new E(n[0],n[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new E(t[0],t[1]),new E(t[2],t[1]),new E(t[2],t[3]),new E(t[0],t[3]),new E(t[0],t[1])])},Point:function(t){var e=new E(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],i=0;i<t.length;++i)e.push(xe.Point.apply(this,[t[i]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=xe.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],i=0;i<t.length;++i)e.push(xe.LineString.apply(this,[t[i]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=xe.coordinates.apply(this,[t[0]]),i=this.geometryFactory.createLinearRing(e),n=[],r=1;r<t.length;++r){var s=t[r],o=xe.coordinates.apply(this,[s]),a=this.geometryFactory.createLinearRing(o);n.push(a)}return this.geometryFactory.createPolygon(i,n)},MultiPolygon:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(xe.Polygon.apply(this,[n]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(this.read(n))}return this.geometryFactory.createGeometryCollection(e)}},we={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:we.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=we.Point.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],i=t.getCoordinates(),n=0;n<i.length;++n){var r=i[n];e.push(we.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=we.LineString.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],i=we.LineString.apply(this,[t._shell]);e.push(i.coordinates);for(var n=0;n<t._holes.length;++n){var r=t._holes[n],s=we.LineString.apply(this,[r]);e.push(s.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=we.Polygon.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=n.getGeometryType();e.push(we[r].apply(this,[n]))}return{type:"GeometryCollection",geometries:e}}},Me=function(t){this.geometryFactory=t||new me,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Ce(this.geometryFactory)};Me.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===de.FIXED&&this.reducePrecision(e),e},Me.prototype.reducePrecision=function(t){var e,i;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,i=t.points.length;e<i;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,i=t.geometries.length;e<i;e++)this.reducePrecision(t.geometries[e])};var Ee=function(){this.parser=new Ce(this.geometryFactory)};Ee.prototype.write=function(t){return this.parser.write(t)};var Ie=function(){},Se={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Ie.prototype.interfaces_=function(){return[]},Ie.prototype.getClass=function(){return Ie},Ie.opposite=function(t){return t===Ie.LEFT?Ie.RIGHT:t===Ie.RIGHT?Ie.LEFT:t},Se.ON.get=function(){return 0},Se.LEFT.get=function(){return 1},Se.RIGHT.get=function(){return 2},Object.defineProperties(Ie,Se),(f.prototype=new Error).name="EmptyStackException",(y.prototype=new wt).add=function(t){return this.array_.push(t),!0},y.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},y.prototype.push=function(t){return this.array_.push(t),t},y.prototype.pop=function(t){if(0===this.array_.length)throw new f;return this.array_.pop()},y.prototype.peek=function(){if(0===this.array_.length)throw new f;return this.array_[this.array_.length-1]},y.prototype.empty=function(){return 0===this.array_.length},y.prototype.isEmpty=function(){return this.empty()},y.prototype.search=function(t){return this.array_.indexOf(t)},y.prototype.size=function(){return this.array_.length},y.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t};var Le=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Le.prototype.getCoordinate=function(){return this._minCoord},Le.prototype.getRightmostSide=function(t,e){var i=this.getRightmostSideOfSegment(t,e);return i<0&&(i=this.getRightmostSideOfSegment(t,e-1)),i<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),i},Le.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();et.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],i=t[this._minIndex+1],n=at.computeOrientation(this._minCoord,i,e),r=!1;(e.y<this._minCoord.y&&i.y<this._minCoord.y&&n===at.COUNTERCLOCKWISE||e.y>this._minCoord.y&&i.y>this._minCoord.y&&n===at.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Le.prototype.getRightmostSideOfSegment=function(t,e){var i=t.getEdge().getCoordinates();if(e<0||e+1>=i.length)return-1;if(i[e].y===i[e+1].y)return-1;var n=Ie.LEFT;return i[e].y<i[e+1].y&&(n=Ie.RIGHT),n},Le.prototype.getEdge=function(){return this._orientedDe},Le.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),i=0;i<e.length-1;i++)(null===this._minCoord||e[i].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=i,this._minCoord=e[i])},Le.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Le.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next();i.isForward()&&this.checkForRightmostCoordinate(i)}et.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Ie.LEFT&&(this._orientedDe=this._minDe.getSym())},Le.prototype.interfaces_=function(){return[]},Le.prototype.getClass=function(){return Le};var be=function(t){function e(i,n){t.call(this,e.msgWithCoord(i,n)),this.pt=n?new E(n):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}($),Re=function(){this.array_=[]};Re.prototype.addLast=function(t){this.array_.push(t)},Re.prototype.removeFirst=function(){return this.array_.shift()},Re.prototype.isEmpty=function(){return 0===this.array_.length};var Ne=function(){this._finder=null,this._dirEdgeList=new Mt,this._nodes=new Mt,this._rightMostCoord=null,this._env=null,this._finder=new Le};Ne.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Ne.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Ne.prototype.computeNodeDepth=function(t){for(var e=null,i=t.getEdges().iterator();i.hasNext();){var n=i.next();if(n.isVisited()||n.getSym().isVisited()){e=n;break}}if(null===e)throw new be("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var s=r.next();s.setVisited(!0),this.copySymDepths(s)}},Ne.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Ie.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Ne.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Ne.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Ie.RIGHT)>=1&&e.getDepth(Ie.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Ne.prototype.computeDepths=function(t){var e=new Tt,i=new Re,n=t.getNode();for(i.addLast(n),e.add(n),t.setVisited(!0);!i.isEmpty();){var r=i.removeFirst();e.add(r),this.computeNodeDepth(r);for(var s=r.getEdges().iterator();s.hasNext();){var o=s.next().getSym();if(!o.isVisited()){var a=o.getNode();e.contains(a)||(i.addLast(a),e.add(a))}}}},Ne.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Ne.prototype.getEnvelope=function(){if(null===this._env){for(var t=new Y,e=this._dirEdgeList.iterator();e.hasNext();)for(var i=e.next().getEdge().getCoordinates(),n=0;n<i.length-1;n++)t.expandToInclude(i[n]);this._env=t}return this._env},Ne.prototype.addReachable=function(t){var e=new y;for(e.add(t);!e.empty();){var i=e.pop();this.add(i,e)}},Ne.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Ie.LEFT,t.getDepth(Ie.RIGHT)),e.setDepth(Ie.RIGHT,t.getDepth(Ie.LEFT))},Ne.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var i=t.getEdges().iterator();i.hasNext();){var n=i.next();this._dirEdgeList.add(n);var r=n.getSym().getNode();r.isVisited()||e.push(r)}},Ne.prototype.getNodes=function(){return this._nodes},Ne.prototype.getDirectedEdges=function(){return this._dirEdgeList},Ne.prototype.interfaces_=function(){return[x]},Ne.prototype.getClass=function(){return Ne};var Ae=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var i=arguments[0];this.init(1),this.location[Ie.ON]=i}else if(arguments[0]instanceof t){var n=arguments[0];if(this.init(n.location.length),null!==n)for(var r=0;r<this.location.length;r++)this.location[r]=n.location[r]}}else if(3===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2];this.init(3),this.location[Ie.ON]=s,this.location[Ie.LEFT]=o,this.location[Ie.RIGHT]=a}};Ae.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Ae.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==b.NONE)return!1;return!0},Ae.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===b.NONE&&(this.location[e]=t)},Ae.prototype.isLine=function(){return 1===this.location.length},Ae.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Ie.ON]=this.location[Ie.ON],e[Ie.LEFT]=b.NONE,e[Ie.RIGHT]=b.NONE,this.location=e}for(var i=0;i<this.location.length;i++)this.location[i]===b.NONE&&i<t.location.length&&(this.location[i]=t.location[i])},Ae.prototype.getLocations=function(){return this.location},Ae.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Ie.LEFT];this.location[Ie.LEFT]=this.location[Ie.RIGHT],this.location[Ie.RIGHT]=t},Ae.prototype.toString=function(){var t=new P;return this.location.length>1&&t.append(b.toLocationSymbol(this.location[Ie.LEFT])),t.append(b.toLocationSymbol(this.location[Ie.ON])),this.location.length>1&&t.append(b.toLocationSymbol(this.location[Ie.RIGHT])),t.toString()},Ae.prototype.setLocations=function(t,e,i){this.location[Ie.ON]=t,this.location[Ie.LEFT]=e,this.location[Ie.RIGHT]=i},Ae.prototype.get=function(t){return t<this.location.length?this.location[t]:b.NONE},Ae.prototype.isArea=function(){return this.location.length>1},Ae.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===b.NONE)return!0;return!1},Ae.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Ie.ON,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.location[e]=i}},Ae.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(b.NONE)},Ae.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Ae.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Ae.prototype.interfaces_=function(){return[]},Ae.prototype.getClass=function(){return Ae};var Te=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Ae(e),this.elt[1]=new Ae(e)}else if(arguments[0]instanceof t){var i=arguments[0];this.elt[0]=new Ae(i.elt[0]),this.elt[1]=new Ae(i.elt[1])}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.elt[0]=new Ae(b.NONE),this.elt[1]=new Ae(b.NONE),this.elt[n].setLocation(r)}else if(3===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2];this.elt[0]=new Ae(s,o,a),this.elt[1]=new Ae(s,o,a)}else if(4===arguments.length){var l=arguments[0],h=arguments[1],u=arguments[2],c=arguments[3];this.elt[0]=new Ae(b.NONE,b.NONE,b.NONE),this.elt[1]=new Ae(b.NONE,b.NONE,b.NONE),this.elt[l].setLocations(h,u,c)}};Te.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Te.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Te.prototype.isNull=function(t){return this.elt[t].isNull()},Te.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.elt[e].setAllLocationsIfNull(i)}},Te.prototype.isLine=function(t){return this.elt[t].isLine()},Te.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Ae(t.elt[e]):this.elt[e].merge(t.elt[e])},Te.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Te.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Ie.ON)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return this.elt[e].get(i)}},Te.prototype.toString=function(){var t=new P;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Te.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Te.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Te.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Ie.ON,e)}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this.elt[i].setLocation(n,r)}},Te.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Te.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Te.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Ae(this.elt[t].location[0]))},Te.prototype.interfaces_=function(){return[]},Te.prototype.getClass=function(){return Te},Te.toLineLabel=function(t){for(var e=new Te(b.NONE),i=0;i<2;i++)e.setLocation(i,t.getLocation(i));return e};var Pe=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Mt,this._pts=new Mt,this._label=new Te(b.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Mt,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Pe.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=at.isCCW(this._ring.getCoordinates())},Pe.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Pe.prototype.computePoints=function(t){this._startDe=t;var e=t,i=!0;do{if(null===e)throw new be("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new be("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var n=e.getLabel();et.isTrue(n.isArea()),this.mergeLabel(n),this.addPoints(e.getEdge(),e.isForward(),i),i=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Pe.prototype.getLinearRing=function(){return this._ring},Pe.prototype.getCoordinate=function(t){return this._pts.get(t)},Pe.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Pe.prototype.addPoints=function(t,e,i){var n=t.getCoordinates();if(e){var r=1;i&&(r=0);for(var s=r;s<n.length;s++)this._pts.add(n[s])}else{var o=n.length-2;i&&(o=n.length-1);for(var a=o;a>=0;a--)this._pts.add(n[a])}},Pe.prototype.isHole=function(){return this._isHole},Pe.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},Pe.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!at.isPointInRing(t,e.getCoordinates()))return!1;for(var i=this._holes.iterator();i.hasNext();)if(i.next().containsPoint(t))return!1;return!0},Pe.prototype.addHole=function(t){this._holes.add(t)},Pe.prototype.isShell=function(){return null===this._shell},Pe.prototype.getLabel=function(){return this._label},Pe.prototype.getEdges=function(){return this._edges},Pe.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Pe.prototype.getShell=function(){return this._shell},Pe.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],i=arguments[0].getLocation(e,Ie.RIGHT);if(i===b.NONE)return null;if(this._label.getLocation(e)===b.NONE)return this._label.setLocation(e,i),null}},Pe.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},Pe.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),i=0;i<this._holes.size();i++)e[i]=this._holes.get(i).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Pe.prototype.interfaces_=function(){return[]},Pe.prototype.getClass=function(){return Pe};var Oe=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Pe),De=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new Mt,e=this._startDe;do{if(null===e.getMinEdgeRing()){var i=new Oe(e,this._geometryFactory);t.add(i)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Pe),ke=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};ke.prototype.setVisited=function(t){this._isVisited=t},ke.prototype.setInResult=function(t){this._isInResult=t},ke.prototype.isCovered=function(){return this._isCovered},ke.prototype.isCoveredSet=function(){return this._isCoveredSet},ke.prototype.setLabel=function(t){this._label=t},ke.prototype.getLabel=function(){return this._label},ke.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},ke.prototype.updateIM=function(t){et.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},ke.prototype.isInResult=function(){return this._isInResult},ke.prototype.isVisited=function(){return this._isVisited},ke.prototype.interfaces_=function(){return[]},ke.prototype.getClass=function(){return ke};var Fe=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],i=arguments[1];this._coord=e,this._edges=i,this._label=new Te(0,b.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var i=b.NONE;if(i=this._label.getLocation(e),!t.isNull(e)){var n=t.getLocation(e);i!==b.BOUNDARY&&(i=n)}return i},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],i=arguments[1];null===this._label?this._label=new Te(e,i):this._label.setLocation(e,i)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Te)for(var i=arguments[0],n=0;n<2;n++){var r=this.computeMergedLocation(i,n);this._label.getLocation(n)===b.NONE&&this._label.setLocation(n,r)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=b.NONE;null!==this._label&&(e=this._label.getLocation(t));var i=null;if(e===b.BOUNDARY)i=b.INTERIOR;else i=b.BOUNDARY;this._label.setLocation(t,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ke),Ge=function(){this.nodeMap=new c,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};Ge.prototype.find=function(t){return this.nodeMap.get(t)},Ge.prototype.addNode=function(){if(arguments[0]instanceof E){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof Fe){var i=arguments[0],n=this.nodeMap.get(i.getCoordinate());return null===n?(this.nodeMap.put(i.getCoordinate(),i),i):(n.mergeLabel(i),n)}},Ge.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},Ge.prototype.iterator=function(){return this.nodeMap.values().iterator()},Ge.prototype.values=function(){return this.nodeMap.values()},Ge.prototype.getBoundaryNodes=function(t){for(var e=new Mt,i=this.iterator();i.hasNext();){var n=i.next();n.getLabel().getLocation(t)===b.BOUNDARY&&e.add(n)}return e},Ge.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge};var He=function(){},Ve={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};He.prototype.interfaces_=function(){return[]},He.prototype.getClass=function(){return He},He.isNorthern=function(t){return t===He.NE||t===He.NW},He.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},He.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var i=t<e?t:e;return 0===i&&3===(t>e?t:e)?3:i},He.isInHalfPlane=function(t,e){return e===He.SE?t===He.SE||t===He.SW:t===e||t===e+1},He.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new _("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?He.NE:He.SE:e>=0?He.NW:He.SW}if(arguments[0]instanceof E&&arguments[1]instanceof E){var i=arguments[0],n=arguments[1];if(n.x===i.x&&n.y===i.y)throw new _("Cannot compute the quadrant for two identical points "+i);return n.x>=i.x?n.y>=i.y?He.NE:He.SE:n.y>=i.y?He.NW:He.SW}},Ve.NE.get=function(){return 0},Ve.NW.get=function(){return 1},Ve.SW.get=function(){return 2},Ve.SE.get=function(){return 3},Object.defineProperties(He,Ve);var je=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2];this._edge=e,this.init(i,n),this._label=null}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];this._edge=r,this.init(s,o),this._label=a}};je.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:at.computeOrientation(t._p0,t._p1,this._p1)},je.prototype.getDy=function(){return this._dy},je.prototype.getCoordinate=function(){return this._p0},je.prototype.setNode=function(t){this._node=t},je.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),i=this.getClass().getName(),n=i.lastIndexOf("."),r=i.substring(n+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},je.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},je.prototype.getDirectedCoordinate=function(){return this._p1},je.prototype.getDx=function(){return this._dx},je.prototype.getLabel=function(){return this._label},je.prototype.getEdge=function(){return this._edge},je.prototype.getQuadrant=function(){return this._quadrant},je.prototype.getNode=function(){return this._node},je.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),i=e.lastIndexOf(".");return"  "+e.substring(i+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},je.prototype.computeLabel=function(t){},je.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=He.quadrant(this._dx,this._dy),et.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},je.prototype.interfaces_=function(){return[x]},je.prototype.getClass=function(){return je};var ze=function(t){function e(){var e=arguments[0],i=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=i,i)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var n=e.getNumPoints()-1;this.init(e.getCoordinate(n),e.getCoordinate(n-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new Te(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new be("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Ie.LEFT)===b.INTERIOR&&this._label.getLocation(e,Ie.RIGHT)===b.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[Ie.LEFT]+"/"+this._depth[Ie.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,b.EXTERIOR),i=!this._label.isArea(1)||this._label.allPositionsEqual(1,b.EXTERIOR);return t&&e&&i},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var i=this.getEdge().getDepthDelta();this._isForward||(i=-i);var n=1;t===Ie.LEFT&&(n=-1);var r=Ie.opposite(t),s=e+i*n;this.setDepth(t,e),this.setDepth(r,s)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===b.EXTERIOR&&e===b.INTERIOR?1:t===b.INTERIOR&&e===b.EXTERIOR?-1:0},e}(je),Be=function(){};Be.prototype.createNode=function(t){return new Fe(t,null)},Be.prototype.interfaces_=function(){return[]},Be.prototype.getClass=function(){return Be};var Ue=function(){if(this._edges=new Mt,this._nodes=null,this._edgeEndList=new Mt,0===arguments.length)this._nodes=new Ge(new Be);else if(1===arguments.length){var t=arguments[0];this._nodes=new Ge(t)}};Ue.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var i=this._edges.get(e);i.print(t),i.eiList.print(t)}},Ue.prototype.find=function(t){return this._nodes.find(t)},Ue.prototype.addNode=function(){if(arguments[0]instanceof Fe){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof E){var e=arguments[0];return this._nodes.addNode(e)}},Ue.prototype.getNodeIterator=function(){return this._nodes.iterator()},Ue.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},Ue.prototype.debugPrintln=function(t){U.out.println(t)},Ue.prototype.isBoundaryNode=function(t,e){var i=this._nodes.find(e);if(null===i)return!1;var n=i.getLabel();return null!==n&&n.getLocation(t)===b.BOUNDARY},Ue.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},Ue.prototype.matchInSameDirection=function(t,e,i,n){return!!t.equals(i)&&at.computeOrientation(t,e,n)===at.COLLINEAR&&He.quadrant(t,e)===He.quadrant(i,n)},Ue.prototype.getEdgeEnds=function(){return this._edgeEndList},Ue.prototype.debugPrint=function(t){U.out.print(t)},Ue.prototype.getEdgeIterator=function(){return this._edges.iterator()},Ue.prototype.findEdgeInSameDirection=function(t,e){for(var i=0;i<this._edges.size();i++){var n=this._edges.get(i),r=n.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return n;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return n}return null},Ue.prototype.insertEdge=function(t){this._edges.add(t)},Ue.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var i=e.next();if(i.getEdge()===t)return i}return null},Ue.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this._edges.add(i);var n=new ze(i,!0),r=new ze(i,!1);n.setSym(r),r.setSym(n),this.add(n),this.add(r)}},Ue.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},Ue.prototype.getNodes=function(){return this._nodes.values()},Ue.prototype.findEdge=function(t,e){for(var i=0;i<this._edges.size();i++){var n=this._edges.get(i),r=n.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return n}return null},Ue.prototype.interfaces_=function(){return[]},Ue.prototype.getClass=function(){return Ue},Ue.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var Ze=function(){this._geometryFactory=null,this._shellList=new Mt;var t=arguments[0];this._geometryFactory=t};Ze.prototype.sortShellsAndHoles=function(t,e,i){for(var n=t.iterator();n.hasNext();){var r=n.next();r.isHole()?i.add(r):e.add(r)}},Ze.prototype.computePolygons=function(t){for(var e=new Mt,i=t.iterator();i.hasNext();){var n=i.next().toPolygon(this._geometryFactory);e.add(n)}return e},Ze.prototype.placeFreeHoles=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();if(null===n.getShell()){var r=this.findEdgeRingContaining(n,t);if(null===r)throw new be("unable to assign hole to a shell",n.getCoordinate(0));n.setShell(r)}}},Ze.prototype.buildMinimalEdgeRings=function(t,e,i){for(var n=new Mt,r=t.iterator();r.hasNext();){var s=r.next();if(s.getMaxNodeDegree()>2){s.linkDirectedEdgesForMinimalEdgeRings();var o=s.buildMinimalRings(),a=this.findShell(o);null!==a?(this.placePolygonHoles(a,o),e.add(a)):i.addAll(o)}else n.add(s)}return n},Ze.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},Ze.prototype.buildMaximalEdgeRings=function(t){for(var e=new Mt,i=t.iterator();i.hasNext();){var n=i.next();if(n.isInResult()&&n.getLabel().isArea()&&null===n.getEdgeRing()){var r=new De(n,this._geometryFactory);e.add(r),r.setInResult()}}return e},Ze.prototype.placePolygonHoles=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();n.isHole()&&n.setShell(t)}},Ze.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Ze.prototype.findEdgeRingContaining=function(t,e){for(var i=t.getLinearRing(),n=i.getEnvelopeInternal(),r=i.getCoordinateN(0),s=null,o=null,a=e.iterator();a.hasNext();){var l=a.next(),h=l.getLinearRing(),u=h.getEnvelopeInternal();null!==s&&(o=s.getLinearRing().getEnvelopeInternal());var c=!1;u.contains(n)&&at.isPointInRing(r,h.getCoordinates())&&(c=!0),c&&(null===s||o.contains(u))&&(s=l)}return s},Ze.prototype.findShell=function(t){for(var e=0,i=null,n=t.iterator();n.hasNext();){var r=n.next();r.isHole()||(i=r,e++)}return et.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),i},Ze.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0];Ue.linkResultDirectedEdges(arguments[1]);var i=this.buildMaximalEdgeRings(e),n=new Mt,r=this.buildMinimalEdgeRings(i,this._shellList,n);this.sortShellsAndHoles(r,this._shellList,n),this.placeFreeHoles(this._shellList,n)}},Ze.prototype.interfaces_=function(){return[]},Ze.prototype.getClass=function(){return Ze};var Ye=function(){};Ye.prototype.getBounds=function(){},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye};var We=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};We.prototype.getItem=function(){return this._item},We.prototype.getBounds=function(){return this._bounds},We.prototype.interfaces_=function(){return[Ye,e]},We.prototype.getClass=function(){return We};var Xe=function(){this._size=null,this._items=null,this._size=0,this._items=new Mt,this._items.add(null)};Xe.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},Xe.prototype.size=function(){return this._size},Xe.prototype.reorder=function(t){for(var e=null,i=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(i)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,i)},Xe.prototype.clear=function(){this._size=0,this._items.clear()},Xe.prototype.isEmpty=function(){return 0===this._size},Xe.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Xe.prototype.interfaces_=function(){return[]},Xe.prototype.getClass=function(){return Xe};var qe=function(){};qe.prototype.visitItem=function(t){},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe};var Ke=function(){};Ke.prototype.insert=function(t,e){},Ke.prototype.remove=function(t,e){},Ke.prototype.query=function(){},Ke.prototype.interfaces_=function(){return[]},Ke.prototype.getClass=function(){return Ke};var Je=function(){if(this._childBoundables=new Mt,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Qe={serialVersionUID:{configurable:!0}};Je.prototype.getLevel=function(){return this._level},Je.prototype.size=function(){return this._childBoundables.size()},Je.prototype.getChildBoundables=function(){return this._childBoundables},Je.prototype.addChildBoundable=function(t){et.isTrue(null===this._bounds),this._childBoundables.add(t)},Je.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Je.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Je.prototype.interfaces_=function(){return[Ye,e]},Je.prototype.getClass=function(){return Je},Qe.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Je,Qe);var $e=function(){};$e.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},$e.min=function(t){return $e.sort(t),t.get(0)},$e.sort=function(t,e){var i=t.toArray();e?Ft.sort(i,e):Ft.sort(i);for(var n=t.iterator(),r=0,s=i.length;r<s;r++)n.next(),n.set(i[r])},$e.singletonList=function(t){var e=new Mt;return e.add(t),e};var ti=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],i=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=i,this._distance=this.distance()};ti.prototype.expandToQueue=function(t,e){var i=ti.isComposite(this._boundable1),n=ti.isComposite(this._boundable2);if(i&&n)return ti.area(this._boundable1)>ti.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(i)return this.expand(this._boundable1,this._boundable2,t,e),null;if(n)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new _("neither boundable is composite")},ti.prototype.isLeaves=function(){return!(ti.isComposite(this._boundable1)||ti.isComposite(this._boundable2))},ti.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},ti.prototype.expand=function(t,e,i,n){for(var r=t.getChildBoundables().iterator();r.hasNext();){var s=r.next(),o=new ti(s,e,this._itemDistance);o.getDistance()<n&&i.add(o)}},ti.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},ti.prototype.getDistance=function(){return this._distance},ti.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},ti.prototype.interfaces_=function(){return[x]},ti.prototype.getClass=function(){return ti},ti.area=function(t){return t.getBounds().getArea()},ti.isComposite=function(t){return t instanceof Je};var ei=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new Mt,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var i=arguments[0];et.isTrue(i>1,"Node capacity must be greater than 1"),this._nodeCapacity=i}},ii={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};ei.prototype.getNodeCapacity=function(){return this._nodeCapacity},ei.prototype.lastNode=function(t){return t.get(t.size()-1)},ei.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var i=e.next();i instanceof Je?t+=this.size(i):i instanceof We&&(t+=1)}return t}},ei.prototype.removeItem=function(t,e){for(var i=null,n=t.getChildBoundables().iterator();n.hasNext();){var r=n.next();r instanceof We&&r.getItem()===e&&(i=r)}return null!==i&&(t.getChildBoundables().remove(i),!0)},ei.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new Mt:t}if(1===arguments.length){for(var e=arguments[0],i=new Mt,n=e.getChildBoundables().iterator();n.hasNext();){var r=n.next();if(r instanceof Je){var s=this.itemsTree(r);null!==s&&i.add(s)}else r instanceof We?i.add(r.getItem()):et.shouldNeverReachHere()}return i.size()<=0?null:i}},ei.prototype.insert=function(t,e){et.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new We(t,e))},ei.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new Mt;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];if(et.isTrue(i>-2),n.getLevel()===i)return r.add(n),null;for(var s=n.getChildBoundables().iterator();s.hasNext();){var o=s.next();o instanceof Je?this.boundablesAtLevel(i,o,r):(et.isTrue(o instanceof We),-1===i&&r.add(o))}return null}},ei.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new Mt;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var i=arguments[0],n=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),i)&&this.query(i,this._root,n)}else if(3===arguments.length)if(N(arguments[2],qe)&&arguments[0]instanceof Object&&arguments[1]instanceof Je)for(var r=arguments[0],s=arguments[2],o=arguments[1].getChildBoundables(),a=0;a<o.size();a++){var l=o.get(a);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof Je?this.query(r,l,s):l instanceof We?s.visitItem(l.getItem()):et.shouldNeverReachHere())}else if(N(arguments[2],wt)&&arguments[0]instanceof Object&&arguments[1]instanceof Je)for(var h=arguments[0],u=arguments[2],c=arguments[1].getChildBoundables(),p=0;p<c.size();p++){var d=c.get(p);this.getIntersectsOp().intersects(d.getBounds(),h)&&(d instanceof Je?this.query(h,d,u):d instanceof We?u.add(d.getItem()):et.shouldNeverReachHere())}},ei.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},ei.prototype.getRoot=function(){return this.build(),this._root},ei.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2],s=this.removeItem(n,r);if(s)return!0;for(var o=null,a=n.getChildBoundables().iterator();a.hasNext();){var l=a.next();if(this.getIntersectsOp().intersects(l.getBounds(),i)&&l instanceof Je&&(s=this.remove(i,l,r))){o=l;break}}return null!==o&&o.getChildBoundables().isEmpty()&&n.getChildBoundables().remove(o),s}},ei.prototype.createHigherLevels=function(t,e){et.isTrue(!t.isEmpty());var i=this.createParentBoundables(t,e+1);return 1===i.size()?i.get(0):this.createHigherLevels(i,e+1)},ei.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var i=e.next();if(i instanceof Je){var n=this.depth(i);n>t&&(t=n)}}return t+1}},ei.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var i=new Mt;i.add(this.createNode(e));var n=new Mt(t);$e.sort(n,this.getComparator());for(var r=n.iterator();r.hasNext();){var s=r.next();this.lastNode(i).getChildBoundables().size()===this.getNodeCapacity()&&i.add(this.createNode(e)),this.lastNode(i).addChildBoundable(s)}return i},ei.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},ei.prototype.interfaces_=function(){return[e]},ei.prototype.getClass=function(){return ei},ei.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},ii.IntersectsOp.get=function(){return ni},ii.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},ii.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(ei,ii);var ni=function(){},ri=function(){};ri.prototype.distance=function(t,e){},ri.prototype.interfaces_=function(){return[]},ri.prototype.getClass=function(){return ri};var si=function(t){function i(e){e=e||i.DEFAULT_NODE_CAPACITY,t.call(this,e)}t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return i.prototype.createParentBoundablesFromVerticalSlices=function(t,e){et.isTrue(t.length>0);for(var i=new Mt,n=0;n<t.length;n++)i.addAll(this.createParentBoundablesFromVerticalSlice(t[n],e));return i},i.prototype.createNode=function(t){return new oi(t)},i.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},i.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],i=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,i)},i.prototype.getIntersectsOp=function(){return i.intersectsOp},i.prototype.verticalSlices=function(t,e){for(var i=Math.trunc(Math.ceil(t.size()/e)),n=new Array(e).fill(null),r=t.iterator(),s=0;s<e;s++){n[s]=new Mt;for(var o=0;r.hasNext()&&o<i;){var a=r.next();n[s].add(a),o++}}return n},i.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var i=arguments[0],n=arguments[1];t.prototype.query.call(this,i,n)}else if(3===arguments.length)if(N(arguments[2],qe)&&arguments[0]instanceof Object&&arguments[1]instanceof Je){var r=arguments[0],s=arguments[1],o=arguments[2];t.prototype.query.call(this,r,s,o)}else if(N(arguments[2],wt)&&arguments[0]instanceof Object&&arguments[1]instanceof Je){var a=arguments[0],l=arguments[1],h=arguments[2];t.prototype.query.call(this,a,l,h)}},i.prototype.getComparator=function(){return i.yComparator},i.prototype.createParentBoundablesFromVerticalSlice=function(e,i){return t.prototype.createParentBoundables.call(this,e,i)},i.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return t.prototype.remove.call(this,e,i)}return t.prototype.remove.apply(this,arguments)},i.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},i.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new Mt(t);$e.sort(r,i.xComparator);var s=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(s,e)},i.prototype.nearestNeighbour=function(){if(1===arguments.length){if(N(arguments[0],ri)){var t=arguments[0],e=new ti(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof ti){var n=arguments[0];return this.nearestNeighbour(n,v.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof i&&N(arguments[1],ri)){var r=arguments[0],s=arguments[1],o=new ti(this.getRoot(),r.getRoot(),s);return this.nearestNeighbour(o)}if(arguments[0]instanceof ti&&"number"==typeof arguments[1]){var a=arguments[0],l=arguments[1],h=null,u=new Xe;for(u.add(a);!u.isEmpty()&&l>0;){var c=u.poll(),p=c.getDistance();if(p>=l)break;c.isLeaves()?(l=p,h=c):c.expandToQueue(u,l)}return[h.getBoundable(0).getItem(),h.getBoundable(1).getItem()]}}else if(3===arguments.length){var d=arguments[2],g=new We(arguments[0],arguments[1]),f=new ti(this.getRoot(),g,d);return this.nearestNeighbour(f)[0]}},i.prototype.interfaces_=function(){return[Ke,e]},i.prototype.getClass=function(){return i},i.centreX=function(t){return i.avg(t.getMinX(),t.getMaxX())},i.avg=function(t,e){return(t+e)/2},i.centreY=function(t){return i.avg(t.getMinY(),t.getMaxY())},n.STRtreeNode.get=function(){return oi},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[M]},compare:function(e,n){return t.compareDoubles(i.centreX(e.getBounds()),i.centreX(n.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[M]},compare:function(e,n){return t.compareDoubles(i.centreY(e.getBounds()),i.centreY(n.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(i,n),i}(ei),oi=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var i=e.next();null===t?t=new Y(i.getBounds()):t.expandToInclude(i.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Je),ai=function(){};ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai},ai.relativeSign=function(t,e){return t<e?-1:t>e?1:0},ai.compare=function(t,e,i){if(e.equals2D(i))return 0;var n=ai.relativeSign(e.x,i.x),r=ai.relativeSign(e.y,i.y);switch(t){case 0:return ai.compareValue(n,r);case 1:return ai.compareValue(r,n);case 2:return ai.compareValue(r,-n);case 3:return ai.compareValue(-n,r);case 4:return ai.compareValue(-n,-r);case 5:return ai.compareValue(-r,-n);case 6:return ai.compareValue(-r,n);case 7:return ai.compareValue(n,-r)}return et.shouldNeverReachHere("invalid octant value"),0},ai.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var li=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this._segString=t,this.coord=new E(e),this.segmentIndex=i,this._segmentOctant=n,this._isInterior=!e.equals2D(t.getCoordinate(i))};li.prototype.getCoordinate=function(){return this.coord},li.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},li.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:ai.compare(this._segmentOctant,this.coord,e.coord)},li.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},li.prototype.isInterior=function(){return this._isInterior},li.prototype.interfaces_=function(){return[x]},li.prototype.getClass=function(){return li};var hi=function(){this._nodeMap=new c,this._edge=null;var t=arguments[0];this._edge=t};hi.prototype.getSplitCoordinates=function(){var t=new It;this.addEndpoints();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next();this.addEdgeCoordinates(i,n,t),i=n}return t.toCoordinateArray()},hi.prototype.addCollapsedNodes=function(){var t=new Mt;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var i=e.next().intValue();this.add(this._edge.getCoordinate(i),i)}},hi.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},hi.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var i=this._edge.getCoordinate(e),n=this._edge.getCoordinate(e+2);i.equals2D(n)&&t.add(new O(e+1))}},hi.prototype.addEdgeCoordinates=function(t,e,i){var n=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(n);i.add(new E(t.coord),!1);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)i.add(this._edge.getCoordinate(s));r&&i.add(new E(e.coord))},hi.prototype.iterator=function(){return this._nodeMap.values().iterator()},hi.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(i,n);t.add(r),i=n}},hi.prototype.findCollapseIndex=function(t,e,i){if(!t.coord.equals2D(e.coord))return!1;var n=e.segmentIndex-t.segmentIndex;return e.isInterior()||n--,1===n&&(i[0]=t.segmentIndex+1,!0)},hi.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),i=this.iterator(),n=i.next();i.hasNext();){var r=i.next();this.findCollapseIndex(n,r,e)&&t.add(new O(e[0])),n=r}},hi.prototype.getEdge=function(){return this._edge},hi.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},hi.prototype.createSplitEdge=function(t,e){var i=e.segmentIndex-t.segmentIndex+2,n=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(n);r||i--;var s=new Array(i).fill(null),o=0;s[o++]=new E(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)s[o++]=this._edge.getCoordinate(a);return r&&(s[o]=new E(e.coord)),new di(s,this._edge.getData())},hi.prototype.add=function(t,e){var i=new li(this._edge,t,e,this._edge.getSegmentOctant(e)),n=this._nodeMap.get(i);return null!==n?(et.isTrue(n.coord.equals2D(t),"Found equal nodes with different coordinates"),n):(this._nodeMap.put(i,i),i)},hi.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),i=t.get(0).getCoordinate(0);if(!i.equals2D(e[0]))throw new $("bad split edge start point at "+i);var n=t.get(t.size()-1).getCoordinates(),r=n[n.length-1];if(!r.equals2D(e[e.length-1]))throw new $("bad split edge end point at "+r)},hi.prototype.interfaces_=function(){return[]},hi.prototype.getClass=function(){return hi};var ui=function(){};ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui},ui.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new _("Cannot compute the octant for point ( "+t+", "+e+" )");var i=Math.abs(t),n=Math.abs(e);return t>=0?e>=0?i>=n?0:1:i>=n?7:6:e>=0?i>=n?3:2:i>=n?4:5}if(arguments[0]instanceof E&&arguments[1]instanceof E){var r=arguments[0],s=arguments[1],o=s.x-r.x,a=s.y-r.y;if(0===o&&0===a)throw new _("Cannot compute the octant for two identical points "+r);return ui.octant(o,a)}};var ci=function(){};ci.prototype.getCoordinates=function(){},ci.prototype.size=function(){},ci.prototype.getCoordinate=function(t){},ci.prototype.isClosed=function(){},ci.prototype.setData=function(t){},ci.prototype.getData=function(){},ci.prototype.interfaces_=function(){return[]},ci.prototype.getClass=function(){return ci};var pi=function(){};pi.prototype.addIntersection=function(t,e){},pi.prototype.interfaces_=function(){return[ci]},pi.prototype.getClass=function(){return pi};var di=function(){this._nodeList=new hi(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};di.prototype.getCoordinates=function(){return this._pts},di.prototype.size=function(){return this._pts.length},di.prototype.getCoordinate=function(t){return this._pts[t]},di.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},di.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},di.prototype.setData=function(t){this._data=t},di.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:ui.octant(t,e)},di.prototype.getData=function(){return this._data},di.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var i=arguments[1],n=arguments[3],r=new E(arguments[0].getIntersection(n));this.addIntersection(r,i)}},di.prototype.toString=function(){return Q.toLineString(new le(this._pts))},di.prototype.getNodeList=function(){return this._nodeList},di.prototype.addIntersectionNode=function(t,e){var i=e,n=i+1;if(n<this._pts.length){var r=this._pts[n];t.equals2D(r)&&(i=n)}return this._nodeList.add(t,i)},di.prototype.addIntersections=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,i,n)},di.prototype.interfaces_=function(){return[pi]},di.prototype.getClass=function(){return di},di.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new Mt;return di.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var i=arguments[1],n=arguments[0].iterator();n.hasNext();)n.next().getNodeList().addSplitEdges(i)};var gi=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new E,this.p1=new E;else if(1===arguments.length){var t=arguments[0];this.p0=new E(t.p0),this.p1=new E(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2],r=arguments[3];this.p0=new E(e,i),this.p1=new E(n,r)}},fi={serialVersionUID:{configurable:!0}};gi.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},gi.prototype.orientationIndex=function(){if(arguments[0]instanceof gi){var t=arguments[0],e=at.orientationIndex(this.p0,this.p1,t.p0),i=at.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&i>=0||e<=0&&i<=0?Math.max(e,i):0}if(arguments[0]instanceof E){var n=arguments[0];return at.orientationIndex(this.p0,this.p1,n)}},gi.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},gi.prototype.isVertical=function(){return this.p0.x===this.p1.x},gi.prototype.equals=function(t){if(!(t instanceof gi))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},gi.prototype.intersection=function(t){var e=new rt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},gi.prototype.project=function(){if(arguments[0]instanceof E){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new E(t);var e=this.projectionFactor(t),i=new E;return i.x=this.p0.x+e*(this.p1.x-this.p0.x),i.y=this.p0.y+e*(this.p1.y-this.p0.y),i}if(arguments[0]instanceof gi){var n=arguments[0],r=this.projectionFactor(n.p0),s=this.projectionFactor(n.p1);if(r>=1&&s>=1)return null;if(r<=0&&s<=0)return null;var o=this.project(n.p0);r<0&&(o=this.p0),r>1&&(o=this.p1);var a=this.project(n.p1);return s<0&&(a=this.p0),s>1&&(a=this.p1),new gi(o,a)}},gi.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},gi.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},gi.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},gi.prototype.distancePerpendicular=function(t){return at.distancePointLinePerpendicular(t,this.p0,this.p1)},gi.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},gi.prototype.midPoint=function(){return gi.midPoint(this.p0,this.p1)},gi.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,n=e*e+i*i;return n<=0?v.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*i)/n},gi.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var i=new Array(2).fill(null),n=v.MAX_VALUE,r=null,s=this.closestPoint(t.p0);n=s.distance(t.p0),i[0]=s,i[1]=t.p0;var o=this.closestPoint(t.p1);(r=o.distance(t.p1))<n&&(n=r,i[0]=o,i[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<n&&(n=r,i[0]=this.p0,i[1]=a);var l=t.closestPoint(this.p1);return(r=l.distance(this.p1))<n&&(n=r,i[0]=this.p1,i[1]=l),i},gi.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},gi.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},gi.prototype.getLength=function(){return this.p0.distance(this.p1)},gi.prototype.compareTo=function(t){var e=t,i=this.p0.compareTo(e.p0);return 0!==i?i:this.p1.compareTo(e.p1)},gi.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},gi.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},gi.prototype.lineIntersection=function(t){try{return Z.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof B))throw t}return null},gi.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},gi.prototype.pointAlongOffset=function(t,e){var i=this.p0.x+t*(this.p1.x-this.p0.x),n=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,o=Math.sqrt(r*r+s*s),a=0,l=0;if(0!==e){if(o<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/o,l=e*s/o}return new E(i-l,n+a)},gi.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=i.x,this.p1.y=i.y}},gi.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||v.isNaN(e))&&(e=1),e},gi.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},gi.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},gi.prototype.distance=function(){if(arguments[0]instanceof gi){var t=arguments[0];return at.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof E){var e=arguments[0];return at.distancePointLine(e,this.p0,this.p1)}},gi.prototype.pointAlong=function(t){var e=new E;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},gi.prototype.hashCode=function(){var t=v.doubleToLongBits(this.p0.x);t^=31*v.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),i=v.doubleToLongBits(this.p1.x);return i^=31*v.doubleToLongBits(this.p1.y),e^Math.trunc(i)^Math.trunc(i>>32)},gi.prototype.interfaces_=function(){return[x,e]},gi.prototype.getClass=function(){return gi},gi.midPoint=function(t,e){return new E((t.x+e.x)/2,(t.y+e.y)/2)},fi.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(gi,fi);var yi=function(){this.tempEnv1=new Y,this.tempEnv2=new Y,this._overlapSeg1=new gi,this._overlapSeg2=new gi};yi.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[1],e=arguments[2],i=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi};var mi=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this._pts=t,this._start=e,this._end=i,this._context=n};mi.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},mi.prototype.computeSelect=function(t,e,i,n){var r=this._pts[e],s=this._pts[i];if(n.tempEnv1.init(r,s),i-e==1)return n.select(this,e),null;if(!t.intersects(n.tempEnv1))return null;var o=Math.trunc((e+i)/2);e<o&&this.computeSelect(t,e,o,n),o<i&&this.computeSelect(t,o,i,n)},mi.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,i=this._start;i<=this._end;i++)t[e++]=this._pts[i];return t},mi.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},mi.prototype.setId=function(t){this._id=t},mi.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},mi.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new Y(t,e)}return this._env},mi.prototype.getEndIndex=function(){return this._end},mi.prototype.getStartIndex=function(){return this._start},mi.prototype.getContext=function(){return this._context},mi.prototype.getId=function(){return this._id},mi.prototype.computeOverlapsInternal=function(t,e,i,n,r,s){var o=this._pts[t],a=this._pts[e],l=i._pts[n],h=i._pts[r];if(e-t==1&&r-n==1)return s.overlap(this,t,i,n),null;if(s.tempEnv1.init(o,a),s.tempEnv2.init(l,h),!s.tempEnv1.intersects(s.tempEnv2))return null;var u=Math.trunc((t+e)/2),c=Math.trunc((n+r)/2);t<u&&(n<c&&this.computeOverlapsInternal(t,u,i,n,c,s),c<r&&this.computeOverlapsInternal(t,u,i,c,r,s)),u<e&&(n<c&&this.computeOverlapsInternal(u,e,i,n,c,s),c<r&&this.computeOverlapsInternal(u,e,i,c,r,s))},mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi};var _i=function(){};_i.prototype.interfaces_=function(){return[]},_i.prototype.getClass=function(){return _i},_i.getChainStartIndices=function(t){var e=0,i=new Mt;i.add(new O(e));do{var n=_i.findChainEnd(t,e);i.add(new O(n)),e=n}while(e<t.length-1);return _i.toIntArray(i)},_i.findChainEnd=function(t,e){for(var i=e;i<t.length-1&&t[i].equals2D(t[i+1]);)i++;if(i>=t.length-1)return t.length-1;for(var n=He.quadrant(t[i],t[i+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||He.quadrant(t[r-1],t[r])===n);)r++;return r-1},_i.getChains=function(){if(1===arguments.length)return _i.getChains(arguments[0],null);if(2===arguments.length){for(var t=arguments[0],e=arguments[1],i=new Mt,n=_i.getChainStartIndices(t),r=0;r<n.length-1;r++){var s=new mi(t,n[r],n[r+1],e);i.add(s)}return i}},_i.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e};var vi=function(){};vi.prototype.computeNodes=function(t){},vi.prototype.getNodedSubstrings=function(){},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi};var Ci=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};Ci.prototype.setSegmentIntersector=function(t){this._segInt=t},Ci.prototype.interfaces_=function(){return[vi]},Ci.prototype.getClass=function(){return Ci};var xi=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new Mt,this._index=new si,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return di.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=_i.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var i=e.next();i.setId(this._idCounter++),this._index.insert(i.getEnvelope(),i),this._monoChains.add(i)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new wi(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var i=e.next(),n=this._index.query(i.getEnvelope()).iterator();n.hasNext();){var r=n.next();if(r.getId()>i.getId()&&(i.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.SegmentOverlapAction.get=function(){return wi},Object.defineProperties(e,i),e}(Ci),wi=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[1],i=arguments[2],n=arguments[3],r=arguments[0].getContext(),s=i.getContext();this._si.processIntersections(r,e,s,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(yi),Mi=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.setQuadrantSegments(i),this.setEndCapStyle(n)}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(s),this.setJoinStyle(o),this.setMitreLimit(a)}},Ei={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Mi.prototype.getEndCapStyle=function(){return this._endCapStyle},Mi.prototype.isSingleSided=function(){return this._isSingleSided},Mi.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=Mi.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Mi.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Mi.JOIN_ROUND&&(this._quadrantSegments=Mi.DEFAULT_QUADRANT_SEGMENTS)},Mi.prototype.getJoinStyle=function(){return this._joinStyle},Mi.prototype.setJoinStyle=function(t){this._joinStyle=t},Mi.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},Mi.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Mi.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Mi.prototype.setEndCapStyle=function(t){this._endCapStyle=t},Mi.prototype.getMitreLimit=function(){return this._mitreLimit},Mi.prototype.setMitreLimit=function(t){this._mitreLimit=t},Mi.prototype.setSingleSided=function(t){this._isSingleSided=t},Mi.prototype.interfaces_=function(){return[]},Mi.prototype.getClass=function(){return Mi},Mi.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Ei.CAP_ROUND.get=function(){return 1},Ei.CAP_FLAT.get=function(){return 2},Ei.CAP_SQUARE.get=function(){return 3},Ei.JOIN_ROUND.get=function(){return 1},Ei.JOIN_MITRE.get=function(){return 2},Ei.JOIN_BEVEL.get=function(){return 3},Ei.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Ei.DEFAULT_MITRE_LIMIT.get=function(){return 5},Ei.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(Mi,Ei);var Ii=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=at.COUNTERCLOCKWISE,this._inputLine=t||null},Si={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Ii.prototype.isDeletable=function(t,e,i,n){var r=this._inputLine[t],s=this._inputLine[e],o=this._inputLine[i];return!!this.isConcave(r,s,o)&&!!this.isShallow(r,s,o,n)&&this.isShallowSampled(r,s,t,i,n)},Ii.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),i=this.findNextNonDeletedIndex(e),n=!1;i<this._inputLine.length;){var r=!1;this.isDeletable(t,e,i,this._distanceTol)&&(this._isDeleted[e]=Ii.DELETE,r=!0,n=!0),t=r?i:e,e=this.findNextNonDeletedIndex(t),i=this.findNextNonDeletedIndex(e)}return n},Ii.prototype.isShallowConcavity=function(t,e,i,n){return at.computeOrientation(t,e,i)===this._angleOrientation&&at.distancePointLine(e,t,i)<n},Ii.prototype.isShallowSampled=function(t,e,i,n,r){var s=Math.trunc((n-i)/Ii.NUM_PTS_TO_CHECK);s<=0&&(s=1);for(var o=i;o<n;o+=s)if(!this.isShallow(t,e,this._inputLine[o],r))return!1;return!0},Ii.prototype.isConcave=function(t,e,i){return at.computeOrientation(t,e,i)===this._angleOrientation},Ii.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=at.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Ii.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Ii.DELETE;)e++;return e},Ii.prototype.isShallow=function(t,e,i,n){return at.distancePointLine(e,t,i)<n},Ii.prototype.collapseLine=function(){for(var t=new It,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Ii.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Ii.prototype.interfaces_=function(){return[]},Ii.prototype.getClass=function(){return Ii},Ii.simplify=function(t,e){return new Ii(t).simplify(e)},Si.INIT.get=function(){return 0},Si.DELETE.get=function(){return 1},Si.KEEP.get=function(){return 1},Si.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Ii,Si);var Li=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Mt},bi={COORDINATE_ARRAY_TYPE:{configurable:!0}};Li.prototype.getCoordinates=function(){return this._ptList.toArray(Li.COORDINATE_ARRAY_TYPE)},Li.prototype.setPrecisionModel=function(t){this._precisionModel=t},Li.prototype.addPt=function(t){var e=new E(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},Li.prototype.revere=function(){},Li.prototype.addPts=function(t,e){if(e)for(var i=0;i<t.length;i++)this.addPt(t[i]);else for(var n=t.length-1;n>=0;n--)this.addPt(t[n])},Li.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Li.prototype.toString=function(){return(new me).createLineString(this.getCoordinates()).toString()},Li.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new E(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},Li.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li},bi.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Li,bi);var Ri=function(){},Ni={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Ri.prototype.interfaces_=function(){return[]},Ri.prototype.getClass=function(){return Ri},Ri.toDegrees=function(t){return 180*t/Math.PI},Ri.normalize=function(t){for(;t>Math.PI;)t-=Ri.PI_TIMES_2;for(;t<=-Math.PI;)t+=Ri.PI_TIMES_2;return t},Ri.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],i=arguments[1],n=i.x-e.x,r=i.y-e.y;return Math.atan2(r,n)}},Ri.isAcute=function(t,e,i){var n=t.x-e.x,r=t.y-e.y;return n*(i.x-e.x)+r*(i.y-e.y)>0},Ri.isObtuse=function(t,e,i){var n=t.x-e.x,r=t.y-e.y;return n*(i.x-e.x)+r*(i.y-e.y)<0},Ri.interiorAngle=function(t,e,i){var n=Ri.angle(e,t),r=Ri.angle(e,i);return Math.abs(r-n)},Ri.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Ri.PI_TIMES_2;t>=Ri.PI_TIMES_2&&(t=0)}else{for(;t>=Ri.PI_TIMES_2;)t-=Ri.PI_TIMES_2;t<0&&(t=0)}return t},Ri.angleBetween=function(t,e,i){var n=Ri.angle(e,t),r=Ri.angle(e,i);return Ri.diff(n,r)},Ri.diff=function(t,e){var i=null;return(i=t<e?e-t:t-e)>Math.PI&&(i=2*Math.PI-i),i},Ri.toRadians=function(t){return t*Math.PI/180},Ri.getTurn=function(t,e){var i=Math.sin(e-t);return i>0?Ri.COUNTERCLOCKWISE:i<0?Ri.CLOCKWISE:Ri.NONE},Ri.angleBetweenOriented=function(t,e,i){var n=Ri.angle(e,t),r=Ri.angle(e,i)-n;return r<=-Math.PI?r+Ri.PI_TIMES_2:r>Math.PI?r-Ri.PI_TIMES_2:r},Ni.PI_TIMES_2.get=function(){return 2*Math.PI},Ni.PI_OVER_2.get=function(){return Math.PI/2},Ni.PI_OVER_4.get=function(){return Math.PI/4},Ni.COUNTERCLOCKWISE.get=function(){return at.COUNTERCLOCKWISE},Ni.CLOCKWISE.get=function(){return at.CLOCKWISE},Ni.NONE.get=function(){return at.COLLINEAR},Object.defineProperties(Ri,Ni);var Ai=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new gi,this._seg1=new gi,this._offset0=new gi,this._offset1=new gi,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],i=arguments[1],n=arguments[2];this._precisionModel=e,this._bufParams=i,this._li=new rt,this._filletAngleQuantum=Math.PI/2/i.getQuadrantSegments(),i.getQuadrantSegments()>=8&&i.getJoinStyle()===Mi.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)},Ti={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Ai.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var i=at.computeOrientation(this._s0,this._s1,this._s2),n=i===at.CLOCKWISE&&this._side===Ie.LEFT||i===at.COUNTERCLOCKWISE&&this._side===Ie.RIGHT;0===i?this.addCollinear(e):n?this.addOutsideTurn(i,e):this.addInsideTurn(i,e)},Ai.prototype.addLineEndCap=function(t,e){var i=new gi(t,e),n=new gi;this.computeOffsetSegment(i,Ie.LEFT,this._distance,n);var r=new gi;this.computeOffsetSegment(i,Ie.RIGHT,this._distance,r);var s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s);switch(this._bufParams.getEndCapStyle()){case Mi.CAP_ROUND:this._segList.addPt(n.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,at.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case Mi.CAP_FLAT:this._segList.addPt(n.p1),this._segList.addPt(r.p1);break;case Mi.CAP_SQUARE:var l=new E;l.x=Math.abs(this._distance)*Math.cos(a),l.y=Math.abs(this._distance)*Math.sin(a);var h=new E(n.p1.x+l.x,n.p1.y+l.y),u=new E(r.p1.x+l.x,r.p1.y+l.y);this._segList.addPt(h),this._segList.addPt(u)}},Ai.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Ai.prototype.addMitreJoin=function(t,e,i,n){var r=!0,s=null;try{s=Z.intersection(e.p0,e.p1,i.p0,i.p1),(n<=0?1:s.distance(t)/Math.abs(n))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof B))throw t;s=new E(0,0),r=!1}r?this._segList.addPt(s):this.addLimitedMitreJoin(e,i,n,this._bufParams.getMitreLimit())},Ai.prototype.addFilletCorner=function(t,e,i,n,r){var s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s),l=i.x-t.x,h=i.y-t.y,u=Math.atan2(h,l);n===at.CLOCKWISE?a<=u&&(a+=2*Math.PI):a>=u&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,u,n,r),this._segList.addPt(i)},Ai.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Ai.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Mi.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Mi.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},Ai.prototype.createSquare=function(t){this._segList.addPt(new E(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new E(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new E(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new E(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Ai.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Ai.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Ai.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Ai.prototype.initSideSegments=function(t,e,i){this._s1=t,this._s2=e,this._side=i,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,i,this._distance,this._offset1)},Ai.prototype.addLimitedMitreJoin=function(t,e,i,n){var r=this._seg0.p1,s=Ri.angle(r,this._seg0.p0),o=Ri.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=Ri.normalize(s+o),l=Ri.normalize(a+Math.PI),h=n*i,u=i-h*Math.abs(Math.sin(o)),c=r.x+h*Math.cos(l),p=r.y+h*Math.sin(l),d=new E(c,p),g=new gi(r,d),f=g.pointAlongOffset(1,u),y=g.pointAlongOffset(1,-u);this._side===Ie.LEFT?(this._segList.addPt(f),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(f))},Ai.prototype.computeOffsetSegment=function(t,e,i,n){var r=e===Ie.LEFT?1:-1,s=t.p1.x-t.p0.x,o=t.p1.y-t.p0.y,a=Math.sqrt(s*s+o*o),l=r*i*s/a,h=r*i*o/a;n.p0.x=t.p0.x-h,n.p0.y=t.p0.y+l,n.p1.x=t.p1.x-h,n.p1.y=t.p1.y+l},Ai.prototype.addFilletArc=function(t,e,i,n,r){var s=n===at.CLOCKWISE?-1:1,o=Math.abs(e-i),a=Math.trunc(o/this._filletAngleQuantum+.5);if(a<1)return null;for(var l=o/a,h=0,u=new E;h<o;){var c=e+s*h;u.x=t.x+r*Math.cos(c),u.y=t.y+r*Math.sin(c),this._segList.addPt(u),h+=l}},Ai.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Ai.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var i=new E((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i);var n=new E((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Ai.prototype.createCircle=function(t){var e=new E(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Ai.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Ai.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Li,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Ai.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Ai.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Mi.JOIN_BEVEL||this._bufParams.getJoinStyle()===Mi.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,at.CLOCKWISE,this._distance))},Ai.prototype.closeRing=function(){this._segList.closeRing()},Ai.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Ai.prototype.interfaces_=function(){return[]},Ai.prototype.getClass=function(){return Ai},Ti.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Ti.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Ti.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Ti.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Ai,Ti);var Pi=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};Pi.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var i=e<0,n=Math.abs(e),r=this.getSegGen(n);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,i,r);var s=r.getCoordinates();return i&&St.reverse(s),s},Pi.prototype.computeSingleSidedBufferCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);if(e){i.addSegments(t,!0);var r=Ii.simplify(t,-n),s=r.length-1;i.initSideSegments(r[s],r[s-1],Ie.LEFT),i.addFirstSegment();for(var o=s-2;o>=0;o--)i.addNextSegment(r[o],!0)}else{i.addSegments(t,!1);var a=Ii.simplify(t,n),l=a.length-1;i.initSideSegments(a[0],a[1],Ie.LEFT),i.addFirstSegment();for(var h=2;h<=l;h++)i.addNextSegment(a[h],!0)}i.addLastSegment(),i.closeRing()},Pi.prototype.computeRingBufferCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);e===Ie.RIGHT&&(n=-n);var r=Ii.simplify(t,n),s=r.length-1;i.initSideSegments(r[s-1],r[0],e);for(var o=1;o<=s;o++){var a=1!==o;i.addNextSegment(r[o],a)}i.closeRing()},Pi.prototype.computeLineBufferCurve=function(t,e){var i=this.simplifyTolerance(this._distance),n=Ii.simplify(t,i),r=n.length-1;e.initSideSegments(n[0],n[1],Ie.LEFT);for(var s=2;s<=r;s++)e.addNextSegment(n[s],!0);e.addLastSegment(),e.addLineEndCap(n[r-1],n[r]);var o=Ii.simplify(t,-i),a=o.length-1;e.initSideSegments(o[a],o[a-1],Ie.LEFT);for(var l=a-2;l>=0;l--)e.addNextSegment(o[l],!0);e.addLastSegment(),e.addLineEndCap(o[1],o[0]),e.closeRing()},Pi.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case Mi.CAP_ROUND:e.createCircle(t);break;case Mi.CAP_SQUARE:e.createSquare(t)}},Pi.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var i=Math.abs(e),n=this.getSegGen(i);if(t.length<=1)this.computePointCurve(t[0],n);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,n)}else this.computeLineBufferCurve(t,n);return n.getCoordinates()},Pi.prototype.getBufferParameters=function(){return this._bufParams},Pi.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},Pi.prototype.getRingCurve=function(t,e,i){if(this._distance=i,t.length<=2)return this.getLineCurve(t,i);if(0===i)return Pi.copyCoordinates(t);var n=this.getSegGen(i);return this.computeRingBufferCurve(t,e,n),n.getCoordinates()},Pi.prototype.computeOffsetCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);if(e){var r=Ii.simplify(t,-n),s=r.length-1;i.initSideSegments(r[s],r[s-1],Ie.LEFT),i.addFirstSegment();for(var o=s-2;o>=0;o--)i.addNextSegment(r[o],!0)}else{var a=Ii.simplify(t,n),l=a.length-1;i.initSideSegments(a[0],a[1],Ie.LEFT),i.addFirstSegment();for(var h=2;h<=l;h++)i.addNextSegment(a[h],!0)}i.addLastSegment()},Pi.prototype.getSegGen=function(t){return new Ai(this._precisionModel,this._bufParams,t)},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi},Pi.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),i=0;i<e.length;i++)e[i]=new E(t[i]);return e};var Oi=function(){this._subgraphs=null,this._seg=new gi,this._cga=new at;var t=arguments[0];this._subgraphs=t},Di={DepthSegment:{configurable:!0}};Oi.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new Mt,i=this._subgraphs.iterator();i.hasNext();){var n=i.next(),r=n.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,n.getDirectedEdges(),e)}return e}if(3===arguments.length)if(N(arguments[2],wt)&&arguments[0]instanceof E&&arguments[1]instanceof ze){for(var s=arguments[0],o=arguments[1],a=arguments[2],l=o.getEdge().getCoordinates(),h=0;h<l.length-1;h++)if(this._seg.p0=l[h],this._seg.p1=l[h+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<s.x||this._seg.isHorizontal()||s.y<this._seg.p0.y||s.y>this._seg.p1.y||at.computeOrientation(this._seg.p0,this._seg.p1,s)===at.RIGHT)){var u=o.getDepth(Ie.LEFT);this._seg.p0.equals(l[h])||(u=o.getDepth(Ie.RIGHT));var c=new ki(this._seg,u);a.add(c)}}else if(N(arguments[2],wt)&&arguments[0]instanceof E&&N(arguments[1],wt))for(var p=arguments[0],d=arguments[2],g=arguments[1].iterator();g.hasNext();){var f=g.next();f.isForward()&&this.findStabbedSegments(p,f,d)}},Oi.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:$e.min(e)._leftDepth},Oi.prototype.interfaces_=function(){return[]},Oi.prototype.getClass=function(){return Oi},Di.DepthSegment.get=function(){return ki},Object.defineProperties(Oi,Di);var ki=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new gi(t),this._leftDepth=e};ki.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var i=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==i||0!=(i=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?i:this._upwardSeg.compareTo(e._upwardSeg)},ki.prototype.compareX=function(t,e){var i=t.p0.compareTo(e.p0);return 0!==i?i:t.p1.compareTo(e.p1)},ki.prototype.toString=function(){return this._upwardSeg.toString()},ki.prototype.interfaces_=function(){return[x]},ki.prototype.getClass=function(){return ki};var Fi=function(t,e,i){this.p0=t||null,this.p1=e||null,this.p2=i||null};Fi.prototype.area=function(){return Fi.area(this.p0,this.p1,this.p2)},Fi.prototype.signedArea=function(){return Fi.signedArea(this.p0,this.p1,this.p2)},Fi.prototype.interpolateZ=function(t){if(null===t)throw new _("Supplied point is null.");return Fi.interpolateZ(t,this.p0,this.p1,this.p2)},Fi.prototype.longestSideLength=function(){return Fi.longestSideLength(this.p0,this.p1,this.p2)},Fi.prototype.isAcute=function(){return Fi.isAcute(this.p0,this.p1,this.p2)},Fi.prototype.circumcentre=function(){return Fi.circumcentre(this.p0,this.p1,this.p2)},Fi.prototype.area3D=function(){return Fi.area3D(this.p0,this.p1,this.p2)},Fi.prototype.centroid=function(){return Fi.centroid(this.p0,this.p1,this.p2)},Fi.prototype.inCentre=function(){return Fi.inCentre(this.p0,this.p1,this.p2)},Fi.prototype.interfaces_=function(){return[]},Fi.prototype.getClass=function(){return Fi},Fi.area=function(t,e,i){return Math.abs(((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2)},Fi.signedArea=function(t,e,i){return((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2},Fi.det=function(t,e,i,n){return t*n-e*i},Fi.interpolateZ=function(t,e,i,n){var r=e.x,s=e.y,o=i.x-r,a=n.x-r,l=i.y-s,h=n.y-s,u=o*h-a*l,c=t.x-r,p=t.y-s,d=(h*c-a*p)/u,g=(-l*c+o*p)/u;return e.z+d*(i.z-e.z)+g*(n.z-e.z)},Fi.longestSideLength=function(t,e,i){var n=t.distance(e),r=e.distance(i),s=i.distance(t),o=n;return r>o&&(o=r),s>o&&(o=s),o},Fi.isAcute=function(t,e,i){return!!Ri.isAcute(t,e,i)&&!!Ri.isAcute(e,i,t)&&!!Ri.isAcute(i,t,e)},Fi.circumcentre=function(t,e,i){var n=i.x,r=i.y,s=t.x-n,o=t.y-r,a=e.x-n,l=e.y-r,h=2*Fi.det(s,o,a,l),u=Fi.det(o,s*s+o*o,l,a*a+l*l),c=Fi.det(s,s*s+o*o,a,a*a+l*l);return new E(n-u/h,r+c/h)},Fi.perpendicularBisector=function(t,e){var i=e.x-t.x,n=e.y-t.y,r=new Z(t.x+i/2,t.y+n/2,1),s=new Z(t.x-n+i/2,t.y+i+n/2,1);return new Z(r,s)},Fi.angleBisector=function(t,e,i){var n=e.distance(t),r=n/(n+e.distance(i)),s=i.x-t.x,o=i.y-t.y;return new E(t.x+r*s,t.y+r*o)},Fi.area3D=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,s=e.z-t.z,o=i.x-t.x,a=i.y-t.y,l=i.z-t.z,h=r*l-s*a,u=s*o-n*l,c=n*a-r*o,p=h*h+u*u+c*c;return Math.sqrt(p)/2},Fi.centroid=function(t,e,i){var n=(t.x+e.x+i.x)/3,r=(t.y+e.y+i.y)/3;return new E(n,r)},Fi.inCentre=function(t,e,i){var n=e.distance(i),r=t.distance(i),s=t.distance(e),o=n+r+s,a=(n*t.x+r*e.x+s*i.x)/o,l=(n*t.y+r*e.y+s*i.y)/o;return new E(a,l)};var Gi=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Mt;var t=arguments[0],e=arguments[1],i=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=i};Gi.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,b.EXTERIOR,b.INTERIOR)},Gi.prototype.addPolygon=function(t){var e=this._distance,i=Ie.LEFT;this._distance<0&&(e=-this._distance,i=Ie.RIGHT);var n=t.getExteriorRing(),r=St.removeRepeatedPoints(n.getCoordinates());if(this._distance<0&&this.isErodedCompletely(n,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,i,b.EXTERIOR,b.INTERIOR);for(var s=0;s<t.getNumInteriorRing();s++){var o=t.getInteriorRingN(s),a=St.removeRepeatedPoints(o.getCoordinates());this._distance>0&&this.isErodedCompletely(o,-this._distance)||this.addPolygonRing(a,e,Ie.opposite(i),b.INTERIOR,b.EXTERIOR)}},Gi.prototype.isTriangleErodedCompletely=function(t,e){var i=new Fi(t[0],t[1],t[2]),n=i.inCentre();return at.distancePointLine(n,i.p0,i.p1)<Math.abs(e)},Gi.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=St.removeRepeatedPoints(t.getCoordinates()),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,b.EXTERIOR,b.INTERIOR)},Gi.prototype.addCurve=function(t,e,i){if(null===t||t.length<2)return null;var n=new di(t,new Te(0,b.BOUNDARY,e,i));this._curveList.add(n)},Gi.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Gi.prototype.addPolygonRing=function(t,e,i,n,r){if(0===e&&t.length<ee.MINIMUM_VALID_SIZE)return null;var s=n,o=r;t.length>=ee.MINIMUM_VALID_SIZE&&at.isCCW(t)&&(s=r,o=n,i=Ie.opposite(i));var a=this._curveBuilder.getRingCurve(t,i,e);this.addCurve(a,s,o)},Gi.prototype.add=function(t){if(t.isEmpty())return null;t instanceof $t?this.addPolygon(t):t instanceof qt?this.addLineString(t):t instanceof Jt?this.addPoint(t):(t instanceof te||t instanceof Bt||t instanceof ie||t instanceof zt)&&this.addCollection(t)},Gi.prototype.isErodedCompletely=function(t,e){var i=t.getCoordinates();if(i.length<4)return e<0;if(4===i.length)return this.isTriangleErodedCompletely(i,e);var n=t.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth());return e<0&&2*Math.abs(e)>r},Gi.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);this.add(i)}},Gi.prototype.interfaces_=function(){return[]},Gi.prototype.getClass=function(){return Gi};var Hi=function(){};Hi.prototype.locate=function(t){},Hi.prototype.interfaces_=function(){return[]},Hi.prototype.getClass=function(){return Hi};var Vi=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};Vi.prototype.next=function(){if(this._atStart)return this._atStart=!1,Vi.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new n;var t=this._parent.getGeometryN(this._index++);return t instanceof zt?(this._subcollectionIterator=new Vi(t),this._subcollectionIterator.next()):t},Vi.prototype.remove=function(){throw new Error(this.getClass().getName())},Vi.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Vi.prototype.interfaces_=function(){return[xt]},Vi.prototype.getClass=function(){return Vi},Vi.isAtomic=function(t){return!(t instanceof zt)};var ji=function(){this._geom=null;var t=arguments[0];this._geom=t};ji.prototype.locate=function(t){return ji.locate(t,this._geom)},ji.prototype.interfaces_=function(){return[Hi]},ji.prototype.getClass=function(){return ji},ji.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&at.isPointInRing(t,e.getCoordinates())},ji.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var i=e.getExteriorRing();if(!ji.isPointInRing(t,i))return!1;for(var n=0;n<e.getNumInteriorRing();n++){var r=e.getInteriorRingN(n);if(ji.isPointInRing(t,r))return!1}return!0},ji.containsPoint=function(t,e){if(e instanceof $t)return ji.containsPointInPolygon(t,e);if(e instanceof zt)for(var i=new Vi(e);i.hasNext();){var n=i.next();if(n!==e&&ji.containsPoint(t,n))return!0}return!1},ji.locate=function(t,e){return e.isEmpty()?b.EXTERIOR:ji.containsPoint(t,e)?b.INTERIOR:b.EXTERIOR};var zi=function(){this._edgeMap=new c,this._edgeList=null,this._ptInAreaLocation=[b.NONE,b.NONE]};zi.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),i=e-1;return 0===e&&(i=this._edgeList.size()-1),this._edgeList.get(i)},zi.prototype.propagateSideLabels=function(t){for(var e=b.NONE,i=this.iterator();i.hasNext();){var n=i.next().getLabel();n.isArea(t)&&n.getLocation(t,Ie.LEFT)!==b.NONE&&(e=n.getLocation(t,Ie.LEFT))}if(e===b.NONE)return null;for(var r=e,s=this.iterator();s.hasNext();){var o=s.next(),a=o.getLabel();if(a.getLocation(t,Ie.ON)===b.NONE&&a.setLocation(t,Ie.ON,r),a.isArea(t)){var l=a.getLocation(t,Ie.LEFT),h=a.getLocation(t,Ie.RIGHT);if(h!==b.NONE){if(h!==r)throw new be("side location conflict",o.getCoordinate());l===b.NONE&&et.shouldNeverReachHere("found single null side (at "+o.getCoordinate()+")"),r=l}else et.isTrue(a.getLocation(t,Ie.LEFT)===b.NONE,"found single null side"),a.setLocation(t,Ie.RIGHT,r),a.setLocation(t,Ie.LEFT,r)}}},zi.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},zi.prototype.print=function(t){U.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},zi.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},zi.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var i=e.size()-1,n=e.get(i).getLabel().getLocation(t,Ie.LEFT);et.isTrue(n!==b.NONE,"Found unlabelled area edge");for(var r=n,s=this.iterator();s.hasNext();){var o=s.next().getLabel();et.isTrue(o.isArea(t),"Found non-area edge");var a=o.getLocation(t,Ie.LEFT),l=o.getLocation(t,Ie.RIGHT);if(a===l)return!1;if(l!==r)return!1;r=a}return!0},zi.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},zi.prototype.iterator=function(){return this.getEdges().iterator()},zi.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Mt(this._edgeMap.values())),this._edgeList},zi.prototype.getLocation=function(t,e,i){return this._ptInAreaLocation[t]===b.NONE&&(this._ptInAreaLocation[t]=ji.locate(e,i[t].getGeometry())),this._ptInAreaLocation[t]},zi.prototype.toString=function(){var t=new P;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var i=e.next();t.append(i),t.append("\n")}return t.toString()},zi.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},zi.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],i=this.iterator();i.hasNext();)for(var n=i.next().getLabel(),r=0;r<2;r++)n.isLine(r)&&n.getLocation(r)===b.BOUNDARY&&(e[r]=!0);for(var s=this.iterator();s.hasNext();)for(var o=s.next(),a=o.getLabel(),l=0;l<2;l++)if(a.isAnyNull(l)){var h=b.NONE;if(e[l])h=b.EXTERIOR;else{var u=o.getCoordinate();h=this.getLocation(l,u,t)}a.setAllLocationsIfNull(l,h)}},zi.prototype.getDegree=function(){return this._edgeMap.size()},zi.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},zi.prototype.interfaces_=function(){return[]},zi.prototype.getClass=function(){return zi};var Bi=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,i=this._SCANNING_FOR_INCOMING,n=0;n<this._resultAreaEdgeList.size();n++){var r=this._resultAreaEdgeList.get(n),s=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),i){case this._SCANNING_FOR_INCOMING:if(!s.isInResult())continue;e=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),i=this._SCANNING_FOR_INCOMING}}if(i===this._LINKING_TO_OUTGOING){if(null===t)throw new be("no outgoing dirEdge found",this.getCoordinate());et.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var i=t.get(0);if(1===e)return i;var n=t.get(e-1),r=i.getQuadrant(),s=n.getQuadrant();return He.isNorthern(r)&&He.isNorthern(s)?i:He.isNorthern(r)||He.isNorthern(s)?0!==i.getDy()?i:0!==n.getDy()?n:(et.shouldNeverReachHere("found two horizontal edges incident on node"),null):n},e.prototype.print=function(t){U.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var i=e.next();t.print("out "),i.print(t),t.println(),t.print("in "),i.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Mt;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var i=e.next().getLabel();i.setAllLocationsIfNull(0,t.getLocation(0)),i.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,i=this._edgeList.size()-1;i>=0;i--){var n=this._edgeList.get(i),r=n.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=n}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),i=t.getDepth(Ie.LEFT),n=t.getDepth(Ie.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),i);if(this.computeDepths(0,e,r)!==n)throw new be("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var s=arguments[1],o=arguments[2],a=arguments[0];a<s;a++){var l=this._edgeList.get(a);l.setEdgeDepths(Ie.RIGHT,o),o=l.getDepth(Ie.LEFT)}return o}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,i=null,n=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;r>=0;r--){var s=this._resultAreaEdgeList.get(r),o=s.getSym();switch(null===e&&s.getEdgeRing()===t&&(e=s),n){case this._SCANNING_FOR_INCOMING:if(o.getEdgeRing()!==t)continue;i=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;i.setNextMin(s),n=this._SCANNING_FOR_INCOMING}}n===this._LINKING_TO_OUTGOING&&(et.isTrue(null!==e,"found null for first outgoing dirEdge"),et.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),i.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var i=arguments[0],n=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===i&&n++;return n}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=b.NONE,e=this.iterator();e.hasNext();){var i=e.next(),n=i.getSym();if(!i.isLineEdge()){if(i.isInResult()){t=b.INTERIOR;break}if(n.isInResult()){t=b.EXTERIOR;break}}}if(t===b.NONE)return null;for(var r=t,s=this.iterator();s.hasNext();){var o=s.next(),a=o.getSym();o.isLineEdge()?o.getEdge().setCovered(r===b.INTERIOR):(o.isInResult()&&(r=b.EXTERIOR),a.isInResult()&&(r=b.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new Te(b.NONE);for(var i=this.iterator();i.hasNext();)for(var n=i.next().getEdge().getLabel(),r=0;r<2;r++){var s=n.getLocation(r);s!==b.INTERIOR&&s!==b.BOUNDARY||this._label.setLocation(r,b.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(zi),Ui=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new Fe(t,new Bi)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Be),Zi=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Zi.prototype.compareTo=function(t){var e=t;return Zi.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Zi.prototype.interfaces_=function(){return[x]},Zi.prototype.getClass=function(){return Zi},Zi.orientation=function(t){return 1===St.increasingDirection(t)},Zi.compareOriented=function(t,e,i,n){for(var r=e?1:-1,s=n?1:-1,o=e?t.length:-1,a=n?i.length:-1,l=e?0:t.length-1,h=n?0:i.length-1;;){var u=t[l].compareTo(i[h]);if(0!==u)return u;var c=(l+=r)===o,p=(h+=s)===a;if(c&&!p)return-1;if(!c&&p)return 1;if(c&&p)return 0}};var Yi=function(){this._edges=new Mt,this._ocaMap=new c};Yi.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var i=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var n=i.getCoordinates(),r=0;r<n.length;r++)r>0&&t.print(","),t.print(n[r].x+" "+n[r].y);t.println(")")}t.print(")  ")},Yi.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Yi.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Yi.prototype.iterator=function(){return this._edges.iterator()},Yi.prototype.getEdges=function(){return this._edges},Yi.prototype.get=function(t){return this._edges.get(t)},Yi.prototype.findEqualEdge=function(t){var e=new Zi(t.getCoordinates());return this._ocaMap.get(e)},Yi.prototype.add=function(t){this._edges.add(t);var e=new Zi(t.getCoordinates());this._ocaMap.put(e,t)},Yi.prototype.interfaces_=function(){return[]},Yi.prototype.getClass=function(){return Yi};var Wi=function(){};Wi.prototype.processIntersections=function(t,e,i,n){},Wi.prototype.isDone=function(){},Wi.prototype.interfaces_=function(){return[]},Wi.prototype.getClass=function(){return Wi};var Xi=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Xi.prototype.isTrivialIntersection=function(t,e,i,n){if(t===i&&1===this._li.getIntersectionNum()){if(Xi.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&n===r||0===n&&e===r)return!0}}return!1},Xi.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Xi.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Xi.prototype.getLineIntersector=function(){return this._li},Xi.prototype.hasProperIntersection=function(){return this._hasProper},Xi.prototype.processIntersections=function(t,e,i,n){if(t===i&&e===n)return null;this.numTests++;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,i,n)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Xi.prototype.hasIntersection=function(){return this._hasIntersection},Xi.prototype.isDone=function(){return!1},Xi.prototype.hasInteriorIntersection=function(){return this._hasInterior},Xi.prototype.interfaces_=function(){return[Wi]},Xi.prototype.getClass=function(){return Xi},Xi.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var qi=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],i=arguments[2];this.coord=new E(t),this.segmentIndex=e,this.dist=i};qi.prototype.getSegmentIndex=function(){return this.segmentIndex},qi.prototype.getCoordinate=function(){return this.coord},qi.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},qi.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},qi.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},qi.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},qi.prototype.getDistance=function(){return this.dist},qi.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},qi.prototype.interfaces_=function(){return[x]},qi.prototype.getClass=function(){return qi};var Ki=function(){this._nodeMap=new c,this.edge=null;var t=arguments[0];this.edge=t};Ki.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Ki.prototype.iterator=function(){return this._nodeMap.values().iterator()},Ki.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(i,n);t.add(r),i=n}},Ki.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Ki.prototype.createSplitEdge=function(t,e){var i=e.segmentIndex-t.segmentIndex+2,n=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(n);r||i--;var s=new Array(i).fill(null),o=0;s[o++]=new E(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)s[o++]=this.edge.pts[a];return r&&(s[o]=e.coord),new en(s,new Te(this.edge._label))},Ki.prototype.add=function(t,e,i){var n=new qi(t,e,i),r=this._nodeMap.get(n);return null!==r?r:(this._nodeMap.put(n,n),n)},Ki.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Ki.prototype.interfaces_=function(){return[]},Ki.prototype.getClass=function(){return Ki};var Ji=function(){};Ji.prototype.getChainStartIndices=function(t){var e=0,i=new Mt;i.add(new O(e));do{var n=this.findChainEnd(t,e);i.add(new O(n)),e=n}while(e<t.length-1);return Ji.toIntArray(i)},Ji.prototype.findChainEnd=function(t,e){for(var i=He.quadrant(t[e],t[e+1]),n=e+1;n<t.length&&He.quadrant(t[n-1],t[n])===i;)n++;return n-1},Ji.prototype.interfaces_=function(){return[]},Ji.prototype.getClass=function(){return Ji},Ji.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e};var Qi=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Y,this.env2=new Y;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Ji;this.startIndex=e.getChainStartIndices(this.pts)};Qi.prototype.getCoordinates=function(){return this.pts},Qi.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e>i?e:i},Qi.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e<i?e:i},Qi.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[i],e.startIndex[i+1],n)}else if(6===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3],l=arguments[4],h=arguments[5],u=this.pts[r],c=this.pts[s],p=o.pts[a],d=o.pts[l];if(s-r==1&&l-a==1)return h.addIntersections(this.e,r,o.e,a),null;if(this.env1.init(u,c),this.env2.init(p,d),!this.env1.intersects(this.env2))return null;var g=Math.trunc((r+s)/2),f=Math.trunc((a+l)/2);r<g&&(a<f&&this.computeIntersectsForChain(r,g,o,a,f,h),f<l&&this.computeIntersectsForChain(r,g,o,f,l,h)),g<s&&(a<f&&this.computeIntersectsForChain(g,s,o,a,f,h),f<l&&this.computeIntersectsForChain(g,s,o,f,l,h))}},Qi.prototype.getStartIndexes=function(){return this.startIndex},Qi.prototype.computeIntersects=function(t,e){for(var i=0;i<this.startIndex.length-1;i++)for(var n=0;n<t.startIndex.length-1;n++)this.computeIntersectsForChain(i,t,n,e)},Qi.prototype.interfaces_=function(){return[]},Qi.prototype.getClass=function(){return Qi};var $i=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var i=0;i<3;i++)this._depth[e][i]=t.NULL_VALUE},tn={NULL_VALUE:{configurable:!0}};$i.prototype.getDepth=function(t,e){return this._depth[t][e]},$i.prototype.setDepth=function(t,e,i){this._depth[t][e]=i},$i.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==$i.NULL_VALUE)return!1;return!0}if(1===arguments.length){var i=arguments[0];return this._depth[i][1]===$i.NULL_VALUE}if(2===arguments.length){var n=arguments[0],r=arguments[1];return this._depth[n][r]===$i.NULL_VALUE}},$i.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var i=1;i<3;i++){var n=0;this._depth[t][i]>e&&(n=1),this._depth[t][i]=n}}},$i.prototype.getDelta=function(t){return this._depth[t][Ie.RIGHT]-this._depth[t][Ie.LEFT]},$i.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?b.EXTERIOR:b.INTERIOR},$i.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},$i.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var i=1;i<3;i++){var n=t.getLocation(e,i);n!==b.EXTERIOR&&n!==b.INTERIOR||(this.isNull(e,i)?this._depth[e][i]=$i.depthAtLocation(n):this._depth[e][i]+=$i.depthAtLocation(n))}else if(3===arguments.length){var r=arguments[0],s=arguments[1];arguments[2]===b.INTERIOR&&this._depth[r][s]++}},$i.prototype.interfaces_=function(){return[]},$i.prototype.getClass=function(){return $i},$i.depthAtLocation=function(t){return t===b.EXTERIOR?0:t===b.INTERIOR?1:$i.NULL_VALUE},tn.NULL_VALUE.get=function(){return-1},Object.defineProperties($i,tn);var en=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Ki(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new $i,this._depthDelta=0,1===arguments.length){var i=arguments[0];e.call(this,i,null)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.pts=n,this._label=r}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,Te.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var i=t;if(this.pts.length!==i.pts.length)return!1;for(var n=!0,r=!0,s=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(i.pts[o])||(n=!1),this.pts[o].equals2D(i.pts[--s])||(r=!1),!n&&!r)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Qi(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new Y;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,i,n){var r=new E(t.getIntersection(n)),s=e,o=t.getEdgeDistance(i,n),a=s+1;if(a<this.pts.length){var l=this.pts[a];r.equals2D(l)&&(s=a,o=0)}this.eiList.add(r,s,o)},e.prototype.toString=function(){var t=new P;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,i,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],i=arguments[1];i.setAtLeastIfValid(e.getLocation(0,Ie.ON),e.getLocation(1,Ie.ON),1),e.isArea()&&(i.setAtLeastIfValid(e.getLocation(0,Ie.LEFT),e.getLocation(1,Ie.LEFT),2),i.setAtLeastIfValid(e.getLocation(0,Ie.RIGHT),e.getLocation(1,Ie.RIGHT),2))},e}(ke),nn=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Yi,this._bufParams=t||null};nn.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},nn.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var i=e.getLabel(),n=t.getLabel();e.isPointwiseEqual(t)||(n=new Te(t.getLabel())).flip(),i.merge(n);var r=nn.depthDelta(n),s=e.getDepthDelta()+r;e.setDepthDelta(s)}else this._edgeList.add(t),t.setDepthDelta(nn.depthDelta(t.getLabel()))},nn.prototype.buildSubgraphs=function(t,e){for(var i=new Mt,n=t.iterator();n.hasNext();){var r=n.next(),s=r.getRightmostCoordinate(),o=new Oi(i).getDepth(s);r.computeDepth(o),r.findResultEdges(),i.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},nn.prototype.createSubgraphs=function(t){for(var e=new Mt,i=t.getNodes().iterator();i.hasNext();){var n=i.next();if(!n.isVisited()){var r=new Ne;r.create(n),e.add(r)}}return $e.sort(e,$e.reverseOrder()),e},nn.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},nn.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new xi,i=new rt;return i.setPrecisionModel(t),e.setSegmentIntersector(new Xi(i)),e},nn.prototype.buffer=function(t,e){var i=this._workingPrecisionModel;null===i&&(i=t.getPrecisionModel()),this._geomFact=t.getFactory();var n=new Pi(i,this._bufParams),r=new Gi(t,e,n).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,i),this._graph=new Ue(new Ui),this._graph.addEdges(this._edgeList.getEdges());var s=this.createSubgraphs(this._graph),o=new Ze(this._geomFact);this.buildSubgraphs(s,o);var a=o.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},nn.prototype.computeNodedEdges=function(t,e){var i=this.getNoder(e);i.computeNodes(t);for(var n=i.getNodedSubstrings().iterator();n.hasNext();){var r=n.next(),s=r.getCoordinates();if(2!==s.length||!s[0].equals2D(s[1])){var o=r.getData(),a=new en(r.getCoordinates(),new Te(o));this.insertUniqueEdge(a)}}},nn.prototype.setNoder=function(t){this._workingNoder=t},nn.prototype.interfaces_=function(){return[]},nn.prototype.getClass=function(){return nn},nn.depthDelta=function(t){var e=t.getLocation(0,Ie.LEFT),i=t.getLocation(0,Ie.RIGHT);return e===b.INTERIOR&&i===b.EXTERIOR?1:e===b.EXTERIOR&&i===b.INTERIOR?-1:0},nn.convertSegStrings=function(t){for(var e=new me,i=new Mt;t.hasNext();){var n=t.next(),r=e.createLineString(n.getCoordinates());i.add(r)}return e.buildGeometry(i)};var rn=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];this._noder=i,this._scaleFactor=n,this._offsetX=r,this._offsetY=s,this._isScaled=!this.isIntegerPrecision()}};rn.prototype.rescale=function(){if(N(arguments[0],Ct))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var i=arguments[0],n=0;n<i.length;n++)i[n].x=i[n].x/this._scaleFactor+this._offsetX,i[n].y=i[n].y/this._scaleFactor+this._offsetY;2===i.length&&i[0].equals2D(i[1])&&U.out.println(i)}},rn.prototype.scale=function(){if(N(arguments[0],Ct)){for(var t=arguments[0],e=new Mt,i=t.iterator();i.hasNext();){var n=i.next();e.add(new di(this.scale(n.getCoordinates()),n.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],s=new Array(r.length).fill(null),o=0;o<r.length;o++)s[o]=new E(Math.round((r[o].x-this._offsetX)*this._scaleFactor),Math.round((r[o].y-this._offsetY)*this._scaleFactor),r[o].z);return St.removeRepeatedPoints(s)}},rn.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},rn.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},rn.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},rn.prototype.interfaces_=function(){return[vi]},rn.prototype.getClass=function(){return rn};var sn=function(){this._li=new rt,this._segStrings=null;var t=arguments[0];this._segStrings=t},on={fact:{configurable:!0}};sn.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var i=arguments[0],n=arguments[1].iterator();n.hasNext();)for(var r=n.next().getCoordinates(),s=1;s<r.length-1;s++)if(r[s].equals(i))throw new $("found endpt/interior pt intersection at index "+s+" :pt "+i)},sn.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),i=this._segStrings.iterator();i.hasNext();){var n=i.next();this.checkInteriorIntersections(e,n)}else if(2===arguments.length)for(var r=arguments[0],s=arguments[1],o=r.getCoordinates(),a=s.getCoordinates(),l=0;l<o.length-1;l++)for(var h=0;h<a.length-1;h++)this.checkInteriorIntersections(r,l,s,h);else if(4===arguments.length){var u=arguments[0],c=arguments[1],p=arguments[2],d=arguments[3];if(u===p&&c===d)return null;var g=u.getCoordinates()[c],f=u.getCoordinates()[c+1],y=p.getCoordinates()[d],m=p.getCoordinates()[d+1];if(this._li.computeIntersection(g,f,y,m),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,g,f)||this.hasInteriorIntersection(this._li,y,m)))throw new $("found non-noded intersection at "+g+"-"+f+" and "+y+"-"+m)}},sn.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},sn.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var i=arguments[0].getCoordinates(),n=0;n<i.length-2;n++)this.checkCollapse(i[n],i[n+1],i[n+2])},sn.prototype.hasInteriorIntersection=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++){var r=t.getIntersection(n);if(!r.equals(e)&&!r.equals(i))return!0}return!1},sn.prototype.checkCollapse=function(t,e,i){if(t.equals(i))throw new $("found non-noded collapse at "+sn.fact.createLineString([t,e,i]))},sn.prototype.interfaces_=function(){return[]},sn.prototype.getClass=function(){return sn},on.fact.get=function(){return new me},Object.defineProperties(sn,on);var an=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],i=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=i,e<=0)throw new _("Scale factor must be non-zero");1!==e&&(this._pt=new E(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new E,this._p1Scaled=new E),this.initCorners(this._pt)},ln={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};an.prototype.intersectsScaled=function(t,e){var i=Math.min(t.x,e.x),n=Math.max(t.x,e.x),r=Math.min(t.y,e.y),s=Math.max(t.y,e.y),o=this._maxx<i||this._minx>n||this._maxy<r||this._miny>s;if(o)return!1;var a=this.intersectsToleranceSquare(t,e);return et.isTrue(!(o&&a),"Found bad envelope test"),a},an.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new E(this._maxx,this._maxy),this._corner[1]=new E(this._minx,this._maxy),this._corner[2]=new E(this._minx,this._miny),this._corner[3]=new E(this._maxx,this._miny)},an.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},an.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},an.prototype.getCoordinate=function(){return this._originalPt},an.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},an.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=an.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Y(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},an.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},an.prototype.intersectsToleranceSquare=function(t,e){var i=!1,n=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||i&&n||t.equals(this._pt)||e.equals(this._pt)))))},an.prototype.addSnappedNode=function(t,e){var i=t.getCoordinate(e),n=t.getCoordinate(e+1);return!!this.intersects(i,n)&&(t.addIntersection(this.getCoordinate(),e),!0)},an.prototype.interfaces_=function(){return[]},an.prototype.getClass=function(){return an},ln.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(an,ln);var hn=function(){this.tempEnv1=new Y,this.selectedSegment=new gi};hn.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}},hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn};var un=function(){this._index=null;var t=arguments[0];this._index=t},cn={HotPixelSnapAction:{configurable:!0}};un.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2],r=e.getSafeEnvelope(),s=new pn(e,i,n);return this._index.query(r,{interfaces_:function(){return[qe]},visitItem:function(t){t.select(r,s)}}),s.isNodeAdded()}},un.prototype.interfaces_=function(){return[]},un.prototype.getClass=function(){return un},cn.HotPixelSnapAction.get=function(){return pn},Object.defineProperties(un,cn);var pn=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],i=arguments[1],n=arguments[2];this._hotPixel=e,this._parentEdge=i,this._hotPixelVertexIndex=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[1],i=arguments[0].getContext();if(null!==this._parentEdge&&i===this._parentEdge&&e===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(i,e)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(hn),dn=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new Mt};dn.prototype.processIntersections=function(t,e,i,n){if(t===i&&e===n)return null;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=i.getCoordinates()[n],a=i.getCoordinates()[n+1];if(this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1)}},dn.prototype.isDone=function(){return!1},dn.prototype.getInteriorIntersections=function(){return this._interiorIntersections},dn.prototype.interfaces_=function(){return[Wi]},dn.prototype.getClass=function(){return dn};var gn=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new rt,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};gn.prototype.checkCorrectness=function(t){var e=di.getNodedSubstrings(t),i=new sn(e);try{i.checkValid()}catch(t){if(!(t instanceof z))throw t;t.printStackTrace()}},gn.prototype.getNodedSubstrings=function(){return di.getNodedSubstrings(this._nodedSegStrings)},gn.prototype.snapRound=function(t,e){var i=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(i),this.computeVertexSnaps(t)},gn.prototype.findInteriorIntersections=function(t,e){var i=new dn(e);return this._noder.setSegmentIntersector(i),this._noder.computeNodes(t),i.getInteriorIntersections()},gn.prototype.computeVertexSnaps=function(){if(N(arguments[0],Ct))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof di)for(var i=arguments[0],n=i.getCoordinates(),r=0;r<n.length;r++){var s=new an(n[r],this._scaleFactor,this._li);this._pointSnapper.snap(s,i,r)&&i.addIntersection(n[r],r)}},gn.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new xi,this._pointSnapper=new un(this._noder.getIndex()),this.snapRound(t,this._li)},gn.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next(),n=new an(i,this._scaleFactor,this._li);this._pointSnapper.snap(n)}},gn.prototype.interfaces_=function(){return[vi]},gn.prototype.getClass=function(){return gn};var fn=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Mi,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._argGeom=e,this._bufParams=i}},yn={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};fn.prototype.bufferFixedPrecision=function(t){var e=new rn(new gn(new de(1)),t.getScale()),i=new nn(this._bufParams);i.setWorkingPrecisionModel(t),i.setNoder(e),this._resultGeometry=i.buffer(this._argGeom,this._distance)},fn.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=fn.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof be))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var i=arguments[0],n=fn.precisionScaleFactor(this._argGeom,this._distance,i),r=new de(n);this.bufferFixedPrecision(r)}},fn.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===de.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},fn.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},fn.prototype.bufferOriginalPrecision=function(){try{var t=new nn(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof $))throw t;this._saveException=t}},fn.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},fn.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},fn.prototype.interfaces_=function(){return[]},fn.prototype.getClass=function(){return fn},fn.bufferOp=function(){if(2===arguments.length){var t=arguments[1];return new fn(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ut&&"number"==typeof arguments[1]){var e=arguments[1],i=arguments[2],n=new fn(arguments[0]);return n.setQuadrantSegments(i),n.getResultGeometry(e)}if(arguments[2]instanceof Mi&&arguments[0]instanceof ut&&"number"==typeof arguments[1]){var r=arguments[1];return new fn(arguments[0],arguments[2]).getResultGeometry(r)}}else if(4===arguments.length){var s=arguments[1],o=arguments[2],a=arguments[3],l=new fn(arguments[0]);return l.setQuadrantSegments(o),l.setEndCapStyle(a),l.getResultGeometry(s)}},fn.precisionScaleFactor=function(t,e,i){var n=t.getEnvelopeInternal(),r=A.max(Math.abs(n.getMaxX()),Math.abs(n.getMaxY()),Math.abs(n.getMinX()),Math.abs(n.getMinY()))+2*(e>0?e:0),s=i-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,s)},yn.CAP_ROUND.get=function(){return Mi.CAP_ROUND},yn.CAP_BUTT.get=function(){return Mi.CAP_FLAT},yn.CAP_FLAT.get=function(){return Mi.CAP_FLAT},yn.CAP_SQUARE.get=function(){return Mi.CAP_SQUARE},yn.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(fn,yn);var mn=function(){this._pt=[new E,new E],this._distance=v.NaN,this._isNull=!0};mn.prototype.getCoordinates=function(){return this._pt},mn.prototype.getCoordinate=function(t){return this._pt[t]},mn.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n<this._distance&&this.initialize(e,i,n)}},mn.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(n),this._distance=r,this._isNull=!1}},mn.prototype.getDistance=function(){return this._distance},mn.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n>this._distance&&this.initialize(e,i,n)}},mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn};var _n=function(){};_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n},_n.computeDistance=function(){if(arguments[2]instanceof mn&&arguments[0]instanceof qt&&arguments[1]instanceof E)for(var t=arguments[1],e=arguments[2],i=arguments[0].getCoordinates(),n=new gi,r=0;r<i.length-1;r++){n.setCoordinates(i[r],i[r+1]);var s=n.closestPoint(t);e.setMinimum(s,t)}else if(arguments[2]instanceof mn&&arguments[0]instanceof $t&&arguments[1]instanceof E){var o=arguments[0],a=arguments[1],l=arguments[2];_n.computeDistance(o.getExteriorRing(),a,l);for(var h=0;h<o.getNumInteriorRing();h++)_n.computeDistance(o.getInteriorRingN(h),a,l)}else if(arguments[2]instanceof mn&&arguments[0]instanceof ut&&arguments[1]instanceof E){var u=arguments[0],c=arguments[1],p=arguments[2];if(u instanceof qt)_n.computeDistance(u,c,p);else if(u instanceof $t)_n.computeDistance(u,c,p);else if(u instanceof zt)for(var d=u,g=0;g<d.getNumGeometries();g++){var f=d.getGeometryN(g);_n.computeDistance(f,c,p)}else p.setMinimum(u.getCoordinate(),c)}else if(arguments[2]instanceof mn&&arguments[0]instanceof gi&&arguments[1]instanceof E){var y=arguments[1],m=arguments[2],_=arguments[0].closestPoint(y);m.setMinimum(_,y)}};var vn=function(t){this._maxPtDist=new mn,this._inputGeom=t||null},Cn={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};vn.prototype.computeMaxMidpointDistance=function(t){var e=new wn(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},vn.prototype.computeMaxVertexDistance=function(t){var e=new xn(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},vn.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},vn.prototype.getDistancePoints=function(){return this._maxPtDist},vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn},Cn.MaxPointDistanceFilter.get=function(){return xn},Cn.MaxMidpointDistanceFilter.get=function(){return wn},Object.defineProperties(vn,Cn);var xn=function(t){this._maxPtDist=new mn,this._minPtDist=new mn,this._geom=t||null};xn.prototype.filter=function(t){this._minPtDist.initialize(),_n.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},xn.prototype.getMaxPointDistance=function(){return this._maxPtDist},xn.prototype.interfaces_=function(){return[dt]},xn.prototype.getClass=function(){return xn};var wn=function(t){this._maxPtDist=new mn,this._minPtDist=new mn,this._geom=t||null};wn.prototype.filter=function(t,e){if(0===e)return null;var i=t.getCoordinate(e-1),n=t.getCoordinate(e),r=new E((i.x+n.x)/2,(i.y+n.y)/2);this._minPtDist.initialize(),_n.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},wn.prototype.isDone=function(){return!1},wn.prototype.isGeometryChanged=function(){return!1},wn.prototype.getMaxPointDistance=function(){return this._maxPtDist},wn.prototype.interfaces_=function(){return[jt]},wn.prototype.getClass=function(){return wn};var Mn=function(t){this._comps=t||null};Mn.prototype.filter=function(t){t instanceof $t&&this._comps.add(t)},Mn.prototype.interfaces_=function(){return[Vt]},Mn.prototype.getClass=function(){return Mn},Mn.getPolygons=function(){if(1===arguments.length)return Mn.getPolygons(arguments[0],new Mt);if(2===arguments.length){var t=arguments[0],e=arguments[1];return t instanceof $t?e.add(t):t instanceof zt&&t.apply(new Mn(e)),e}};var En=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._lines=e,this._isForcedToLineString=i}};En.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ee){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof qt&&this._lines.add(t)},En.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},En.prototype.interfaces_=function(){return[ht]},En.prototype.getClass=function(){return En},En.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(En.getLines(t))}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e.getFactory().buildGeometry(En.getLines(e,i))}},En.getLines=function(){if(1===arguments.length)return En.getLines(arguments[0],!1);if(2===arguments.length){if(N(arguments[0],Ct)&&N(arguments[1],Ct)){for(var t=arguments[1],e=arguments[0].iterator();e.hasNext();){var i=e.next();En.getLines(i,t)}return t}if(arguments[0]instanceof ut&&"boolean"==typeof arguments[1]){var n=arguments[0],r=arguments[1],s=new Mt;return n.apply(new En(s,r)),s}if(arguments[0]instanceof ut&&N(arguments[1],Ct)){var o=arguments[0],a=arguments[1];return o instanceof qt?a.add(o):o.apply(new En(a)),a}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&N(arguments[0],Ct)&&N(arguments[1],Ct)){for(var l=arguments[1],h=arguments[2],u=arguments[0].iterator();u.hasNext();){var c=u.next();En.getLines(c,l,h)}return l}if("boolean"==typeof arguments[2]&&arguments[0]instanceof ut&&N(arguments[1],Ct)){var p=arguments[1],d=arguments[2];return arguments[0].apply(new En(p,d)),p}}};var In=function(){if(this._boundaryRule=gt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new _("Rule must be non-null");this._boundaryRule=t}};In.prototype.locateInternal=function(){if(arguments[0]instanceof E&&arguments[1]instanceof $t){var t=arguments[0],e=arguments[1];if(e.isEmpty())return b.EXTERIOR;var i=e.getExteriorRing(),n=this.locateInPolygonRing(t,i);if(n===b.EXTERIOR)return b.EXTERIOR;if(n===b.BOUNDARY)return b.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var s=e.getInteriorRingN(r),o=this.locateInPolygonRing(t,s);if(o===b.INTERIOR)return b.EXTERIOR;if(o===b.BOUNDARY)return b.BOUNDARY}return b.INTERIOR}if(arguments[0]instanceof E&&arguments[1]instanceof qt){var a=arguments[0],l=arguments[1];if(!l.getEnvelopeInternal().intersects(a))return b.EXTERIOR;var h=l.getCoordinates();return l.isClosed()||!a.equals(h[0])&&!a.equals(h[h.length-1])?at.isOnLine(a,h)?b.INTERIOR:b.EXTERIOR:b.BOUNDARY}if(arguments[0]instanceof E&&arguments[1]instanceof Jt){var u=arguments[0];return arguments[1].getCoordinate().equals2D(u)?b.INTERIOR:b.EXTERIOR}},In.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?at.locatePointInRing(t,e.getCoordinates()):b.EXTERIOR},In.prototype.intersects=function(t,e){return this.locate(t,e)!==b.EXTERIOR},In.prototype.updateLocationInfo=function(t){t===b.INTERIOR&&(this._isIn=!0),t===b.BOUNDARY&&this._numBoundaries++},In.prototype.computeLocation=function(t,e){if(e instanceof Jt&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof qt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof $t)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Bt)for(var i=e,n=0;n<i.getNumGeometries();n++){var r=i.getGeometryN(n);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof ie)for(var s=e,o=0;o<s.getNumGeometries();o++){var a=s.getGeometryN(o);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof zt)for(var l=new Vi(e);l.hasNext();){var h=l.next();h!==e&&this.computeLocation(t,h)}},In.prototype.locate=function(t,e){return e.isEmpty()?b.EXTERIOR:e instanceof qt||e instanceof $t?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?b.BOUNDARY:this._numBoundaries>0||this._isIn?b.INTERIOR:b.EXTERIOR)},In.prototype.interfaces_=function(){return[]},In.prototype.getClass=function(){return In};var Sn=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)t.call(this,arguments[0],t.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2];this._component=e,this._segIndex=i,this._pt=n}},Ln={INSIDE_AREA:{configurable:!0}};Sn.prototype.isInsideArea=function(){return this._segIndex===Sn.INSIDE_AREA},Sn.prototype.getCoordinate=function(){return this._pt},Sn.prototype.getGeometryComponent=function(){return this._component},Sn.prototype.getSegmentIndex=function(){return this._segIndex},Sn.prototype.interfaces_=function(){return[]},Sn.prototype.getClass=function(){return Sn},Ln.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Sn,Ln);var bn=function(t){this._pts=t||null};bn.prototype.filter=function(t){t instanceof Jt&&this._pts.add(t)},bn.prototype.interfaces_=function(){return[Vt]},bn.prototype.getClass=function(){return bn},bn.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Jt?$e.singletonList(t):bn.getPoints(t,new Mt)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e instanceof Jt?i.add(e):e instanceof zt&&e.apply(new bn(i)),i}};var Rn=function(){this._locations=null;var t=arguments[0];this._locations=t};Rn.prototype.filter=function(t){(t instanceof Jt||t instanceof qt||t instanceof $t)&&this._locations.add(new Sn(t,0,t.getCoordinate()))},Rn.prototype.interfaces_=function(){return[Vt]},Rn.prototype.getClass=function(){return Rn},Rn.getLocations=function(t){var e=new Mt;return t.apply(new Rn(e)),e};var Nn=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new In,this._minDistanceLocation=null,this._minDistance=v.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=i,this._geom[1]=n,this._terminateDistance=r}};Nn.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1],n=1-e,r=Mn.getPolygons(this._geom[e]);if(r.size()>0){var s=Rn.getLocations(this._geom[n]);if(this.computeContainmentDistance(s,r,i),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[n]=i[0],this._minDistanceLocation[e]=i[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&N(arguments[0],wt)&&N(arguments[1],wt)){for(var o=arguments[0],a=arguments[1],l=arguments[2],h=0;h<o.size();h++)for(var u=o.get(h),c=0;c<a.size();c++)if(this.computeContainmentDistance(u,a.get(c),l),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Sn&&arguments[1]instanceof $t){var p=arguments[0],d=arguments[1],g=arguments[2],f=p.getCoordinate();if(b.EXTERIOR!==this._ptLocator.locate(f,d))return this._minDistance=0,g[0]=p,g[1]=new Sn(d,f),null}},Nn.prototype.computeMinDistanceLinesPoints=function(t,e,i){for(var n=0;n<t.size();n++)for(var r=t.get(n),s=0;s<e.size();s++){var o=e.get(s);if(this.computeMinDistance(r,o,i),this._minDistance<=this._terminateDistance)return null}},Nn.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=En.getLines(this._geom[0]),i=En.getLines(this._geom[1]),n=bn.getPoints(this._geom[0]),r=bn.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(i,n,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(n,r,t),void this.updateMinDistance(t,!1))))},Nn.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Nn.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Nn.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Nn.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof qt&&arguments[1]instanceof Jt){var t=arguments[0],e=arguments[1],i=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var n=t.getCoordinates(),r=e.getCoordinate(),s=0;s<n.length-1;s++){var o=at.distancePointLine(r,n[s],n[s+1]);if(o<this._minDistance){this._minDistance=o;var a=new gi(n[s],n[s+1]).closestPoint(r);i[0]=new Sn(t,s,a),i[1]=new Sn(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof qt&&arguments[1]instanceof qt){var l=arguments[0],h=arguments[1],u=arguments[2];if(l.getEnvelopeInternal().distance(h.getEnvelopeInternal())>this._minDistance)return null;for(var c=l.getCoordinates(),p=h.getCoordinates(),d=0;d<c.length-1;d++)for(var g=0;g<p.length-1;g++){var f=at.distanceLineLine(c[d],c[d+1],p[g],p[g+1]);if(f<this._minDistance){this._minDistance=f;var y=new gi(c[d],c[d+1]),m=new gi(p[g],p[g+1]),_=y.closestPoints(m);u[0]=new Sn(l,d,_[0]),u[1]=new Sn(h,g,_[1])}if(this._minDistance<=this._terminateDistance)return null}}},Nn.prototype.computeMinDistancePoints=function(t,e,i){for(var n=0;n<t.size();n++)for(var r=t.get(n),s=0;s<e.size();s++){var o=e.get(s),a=r.getCoordinate().distance(o.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,i[0]=new Sn(r,0,r.getCoordinate()),i[1]=new Sn(o,0,o.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Nn.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new _("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Nn.prototype.computeMinDistanceLines=function(t,e,i){for(var n=0;n<t.size();n++)for(var r=t.get(n),s=0;s<e.size();s++){var o=e.get(s);if(this.computeMinDistance(r,o,i),this._minDistance<=this._terminateDistance)return null}},Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn},Nn.distance=function(t,e){return new Nn(t,e).distance()},Nn.isWithinDistance=function(t,e,i){return new Nn(t,e,i).distance()<=i},Nn.nearestPoints=function(t,e){return new Nn(t,e).nearestPoints()};var An=function(){this._pt=[new E,new E],this._distance=v.NaN,this._isNull=!0};An.prototype.getCoordinates=function(){return this._pt},An.prototype.getCoordinate=function(t){return this._pt[t]},An.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n<this._distance&&this.initialize(e,i,n)}},An.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(n),this._distance=r,this._isNull=!1}},An.prototype.toString=function(){return Q.toLineString(this._pt[0],this._pt[1])},An.prototype.getDistance=function(){return this._distance},An.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n>this._distance&&this.initialize(e,i,n)}},An.prototype.interfaces_=function(){return[]},An.prototype.getClass=function(){return An};var Tn=function(){};Tn.prototype.interfaces_=function(){return[]},Tn.prototype.getClass=function(){return Tn},Tn.computeDistance=function(){if(arguments[2]instanceof An&&arguments[0]instanceof qt&&arguments[1]instanceof E)for(var t=arguments[0],e=arguments[1],i=arguments[2],n=new gi,r=t.getCoordinates(),s=0;s<r.length-1;s++){n.setCoordinates(r[s],r[s+1]);var o=n.closestPoint(e);i.setMinimum(o,e)}else if(arguments[2]instanceof An&&arguments[0]instanceof $t&&arguments[1]instanceof E){var a=arguments[0],l=arguments[1],h=arguments[2];Tn.computeDistance(a.getExteriorRing(),l,h);for(var u=0;u<a.getNumInteriorRing();u++)Tn.computeDistance(a.getInteriorRingN(u),l,h)}else if(arguments[2]instanceof An&&arguments[0]instanceof ut&&arguments[1]instanceof E){var c=arguments[0],p=arguments[1],d=arguments[2];if(c instanceof qt)Tn.computeDistance(c,p,d);else if(c instanceof $t)Tn.computeDistance(c,p,d);else if(c instanceof zt)for(var g=c,f=0;f<g.getNumGeometries();f++){var y=g.getGeometryN(f);Tn.computeDistance(y,p,d)}else d.setMinimum(c.getCoordinate(),p)}else if(arguments[2]instanceof An&&arguments[0]instanceof gi&&arguments[1]instanceof E){var m=arguments[1],_=arguments[2],v=arguments[0].closestPoint(m);_.setMinimum(v,m)}};var Pn=function(){this._g0=null,this._g1=null,this._ptDist=new An,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},On={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Pn.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Pn.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new _("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Pn.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Pn.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Pn.prototype.computeOrientedDistance=function(t,e,i){var n=new Dn(e);if(t.apply(n),i.setMaximum(n.getMaxPointDistance()),this._densifyFrac>0){var r=new kn(e,this._densifyFrac);t.apply(r),i.setMaximum(r.getMaxPointDistance())}},Pn.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Pn.prototype.interfaces_=function(){return[]},Pn.prototype.getClass=function(){return Pn},Pn.distance=function(){if(2===arguments.length)return new Pn(arguments[0],arguments[1]).distance();if(3===arguments.length){var t=arguments[2],e=new Pn(arguments[0],arguments[1]);return e.setDensifyFraction(t),e.distance()}},On.MaxPointDistanceFilter.get=function(){return Dn},On.MaxDensifiedByFractionDistanceFilter.get=function(){return kn},Object.defineProperties(Pn,On);var Dn=function(){this._maxPtDist=new An,this._minPtDist=new An,this._euclideanDist=new Tn,this._geom=null;var t=arguments[0];this._geom=t};Dn.prototype.filter=function(t){this._minPtDist.initialize(),Tn.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Dn.prototype.getMaxPointDistance=function(){return this._maxPtDist},Dn.prototype.interfaces_=function(){return[dt]},Dn.prototype.getClass=function(){return Dn};var kn=function(){this._maxPtDist=new An,this._minPtDist=new An,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};kn.prototype.filter=function(t,e){if(0===e)return null;for(var i=t.getCoordinate(e-1),n=t.getCoordinate(e),r=(n.x-i.x)/this._numSubSegs,s=(n.y-i.y)/this._numSubSegs,o=0;o<this._numSubSegs;o++){var a=i.x+o*r,l=i.y+o*s,h=new E(a,l);this._minPtDist.initialize(),Tn.computeDistance(this._geom,h,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},kn.prototype.isDone=function(){return!1},kn.prototype.isGeometryChanged=function(){return!1},kn.prototype.getMaxPointDistance=function(){return this._maxPtDist},kn.prototype.interfaces_=function(){return[jt]},kn.prototype.getClass=function(){return kn};var Fn=function(t,e,i){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=i||null},Gn={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Fn.prototype.checkMaximumDistance=function(t,e,i){var n=new Pn(e,t);if(n.setDensifyFraction(.25),this._maxDistanceFound=n.orientedDistance(),this._maxDistanceFound>i){this._isValid=!1;var r=n.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Q.toLineString(r[0],r[1])+")"}},Fn.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Fn.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Fn.VERBOSE&&U.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Fn.prototype.checkNegativeValid=function(){if(!(this._input instanceof $t||this._input instanceof ie||this._input instanceof zt))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},Fn.prototype.getErrorIndicator=function(){return this._errorIndicator},Fn.prototype.checkMinimumDistance=function(t,e,i){var n=new Nn(t,e,i);if(this._minDistanceFound=n.distance(),this._minDistanceFound<i){this._isValid=!1;var r=n.nearestPoints();this._errorLocation=n.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Q.toLineString(r[0],r[1])+" )"}},Fn.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},Fn.prototype.getErrorLocation=function(){return this._errorLocation},Fn.prototype.getPolygonLines=function(t){for(var e=new Mt,i=new En(e),n=Mn.getPolygons(t).iterator();n.hasNext();)n.next().apply(i);return t.getFactory().buildGeometry(e)},Fn.prototype.getErrorMessage=function(){return this._errMsg},Fn.prototype.interfaces_=function(){return[]},Fn.prototype.getClass=function(){return Fn},Gn.VERBOSE.get=function(){return!1},Gn.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Fn,Gn);var Hn=function(t,e,i){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=i||null},Vn={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Hn.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Hn.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Hn.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new Y(this._input.getEnvelopeInternal());e.expandBy(this._distance);var i=new Y(this._result.getEnvelopeInternal());i.expandBy(t),i.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(i)),this.report("Envelope")},Hn.prototype.checkDistance=function(){var t=new Fn(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Hn.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Hn.prototype.checkPolygonal=function(){this._result instanceof $t||this._result instanceof ie||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Hn.prototype.getErrorIndicator=function(){return this._errorIndicator},Hn.prototype.getErrorLocation=function(){return this._errorLocation},Hn.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Hn.prototype.report=function(t){if(!Hn.VERBOSE)return null;U.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Hn.prototype.getErrorMessage=function(){return this._errorMsg},Hn.prototype.interfaces_=function(){return[]},Hn.prototype.getClass=function(){return Hn},Hn.isValidMsg=function(t,e,i){var n=new Hn(t,e,i);return n.isValid()?null:n.getErrorMessage()},Hn.isValid=function(t,e,i){return!!new Hn(t,e,i).isValid()},Vn.VERBOSE.get=function(){return!1},Vn.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Hn,Vn);var jn=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};jn.prototype.getCoordinates=function(){return this._pts},jn.prototype.size=function(){return this._pts.length},jn.prototype.getCoordinate=function(t){return this._pts[t]},jn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},jn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:ui.octant(this.getCoordinate(t),this.getCoordinate(t+1))},jn.prototype.setData=function(t){this._data=t},jn.prototype.getData=function(){return this._data},jn.prototype.toString=function(){return Q.toLineString(new le(this._pts))},jn.prototype.interfaces_=function(){return[ci]},jn.prototype.getClass=function(){return jn};var zn=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Mt,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};zn.prototype.getInteriorIntersection=function(){return this._interiorIntersection},zn.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},zn.prototype.getIntersectionSegments=function(){return this._intSegments},zn.prototype.count=function(){return this._intersectionCount},zn.prototype.getIntersections=function(){return this._intersections},zn.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},zn.prototype.setKeepIntersections=function(t){this._keepIntersections=t},zn.prototype.processIntersections=function(t,e,i,n){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===i&&e===n)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(i,n))return null;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=s,this._intSegments[2]=o,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},zn.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},zn.prototype.hasIntersection=function(){return null!==this._interiorIntersection},zn.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},zn.prototype.interfaces_=function(){return[Wi]},zn.prototype.getClass=function(){return zn},zn.createAllIntersectionsFinder=function(t){var e=new zn(t);return e.setFindAllIntersections(!0),e},zn.createAnyIntersectionFinder=function(t){return new zn(t)},zn.createIntersectionCounter=function(t){var e=new zn(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var Bn=function(){this._li=new rt,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Bn.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Bn.prototype.getIntersections=function(){return this._segInt.getIntersections()},Bn.prototype.isValid=function(){return this.execute(),this._isValid},Bn.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Bn.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new zn(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new xi;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Bn.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new be(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Bn.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Q.toLineString(t[0],t[1])+" and "+Q.toLineString(t[2],t[3])},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn},Bn.computeIntersections=function(t){var e=new Bn(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Un=function t(){this._nv=null;var e=arguments[0];this._nv=new Bn(t.toSegmentStrings(e))};Un.prototype.checkValid=function(){this._nv.checkValid()},Un.prototype.interfaces_=function(){return[]},Un.prototype.getClass=function(){return Un},Un.toSegmentStrings=function(t){for(var e=new Mt,i=t.iterator();i.hasNext();){var n=i.next();e.add(new jn(n.getCoordinates(),n))}return e},Un.checkValid=function(t){new Un(t).checkValid()};var Zn=function(t){this._mapOp=t};Zn.prototype.map=function(t){for(var e=new Mt,i=0;i<t.getNumGeometries();i++){var n=this._mapOp.map(t.getGeometryN(i));n.isEmpty()||e.add(n)}return t.getFactory().createGeometryCollection(me.toGeometryArray(e))},Zn.prototype.interfaces_=function(){return[]},Zn.prototype.getClass=function(){return Zn},Zn.map=function(t,e){return new Zn(e).map(t)};var Yn=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Mt,this._resultLineList=new Mt;var t=arguments[0],e=arguments[1],i=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=i};Yn.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var i=e.next();this.collectLineEdge(i,t,this._lineEdgesList),this.collectBoundaryTouchEdge(i,t,this._lineEdgesList)}},Yn.prototype.labelIsolatedLine=function(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,i)},Yn.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Yn.prototype.collectLineEdge=function(t,e,i){var n=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Sr.isResultOfOp(n,e)||r.isCovered()||(i.add(r),t.setVisitedEdge(!0)))},Yn.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var i=e.next(),n=i.getEdge();if(i.isLineEdge()&&!n.isCoveredSet()){var r=this._op.isCoveredByA(i.getCoordinate());n.setCovered(r)}}},Yn.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next(),n=i.getLabel();i.isIsolated()&&(n.isNull(0)?this.labelIsolatedLine(i,0):this.labelIsolatedLine(i,1))}},Yn.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var i=e.next(),n=this._geometryFactory.createLineString(i.getCoordinates());this._resultLineList.add(n),i.setInResult(!0)}},Yn.prototype.collectBoundaryTouchEdge=function(t,e,i){var n=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(et.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Sr.isResultOfOp(n,e)&&e===Sr.INTERSECTION&&(i.add(t.getEdge()),t.setVisitedEdge(!0))))},Yn.prototype.interfaces_=function(){return[]},Yn.prototype.getClass=function(){return Yn};var Wn=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Mt;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Wn.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var i=this._geometryFactory.createPoint(e);this._resultPointList.add(i)}},Wn.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var i=e.next();if(!(i.isInResult()||i.isIncidentEdgeInResult()||0!==i.getEdges().getDegree()&&t!==Sr.INTERSECTION)){var n=i.getLabel();Sr.isResultOfOp(n,t)&&this.filterCoveredNodeToPoint(i)}}},Wn.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Wn.prototype.interfaces_=function(){return[]},Wn.prototype.getClass=function(){return Wn};var Xn=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Xn.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Xn.prototype.transformPolygon=function(t,e){var i=!0,n=this.transformLinearRing(t.getExteriorRing(),t);null!==n&&n instanceof ee&&!n.isEmpty()||(i=!1);for(var r=new Mt,s=0;s<t.getNumInteriorRing();s++){var o=this.transformLinearRing(t.getInteriorRingN(s),t);null===o||o.isEmpty()||(o instanceof ee||(i=!1),r.add(o))}if(i)return this._factory.createPolygon(n,r.toArray([]));var a=new Mt;return null!==n&&a.add(n),a.addAll(r),this._factory.buildGeometry(a)},Xn.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Xn.prototype.getInputGeometry=function(){return this._inputGeom},Xn.prototype.transformMultiLineString=function(t,e){for(var i=new Mt,n=0;n<t.getNumGeometries();n++){var r=this.transformLineString(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},Xn.prototype.transformCoordinates=function(t,e){return this.copy(t)},Xn.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Xn.prototype.transformMultiPoint=function(t,e){for(var i=new Mt,n=0;n<t.getNumGeometries();n++){var r=this.transformPoint(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},Xn.prototype.transformMultiPolygon=function(t,e){for(var i=new Mt,n=0;n<t.getNumGeometries();n++){var r=this.transformPolygon(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},Xn.prototype.copy=function(t){return t.copy()},Xn.prototype.transformGeometryCollection=function(t,e){for(var i=new Mt,n=0;n<t.getNumGeometries();n++){var r=this.transform(t.getGeometryN(n));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||i.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(me.toGeometryArray(i)):this._factory.buildGeometry(i)},Xn.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Jt)return this.transformPoint(t,null);if(t instanceof te)return this.transformMultiPoint(t,null);if(t instanceof ee)return this.transformLinearRing(t,null);if(t instanceof qt)return this.transformLineString(t,null);if(t instanceof Bt)return this.transformMultiLineString(t,null);if(t instanceof $t)return this.transformPolygon(t,null);if(t instanceof ie)return this.transformMultiPolygon(t,null);if(t instanceof zt)return this.transformGeometryCollection(t,null);throw new _("Unknown Geometry subtype: "+t.getClass().getName())},Xn.prototype.transformLinearRing=function(t,e){var i=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===i)return this._factory.createLinearRing(null);var n=i.size();return n>0&&n<4&&!this._preserveType?this._factory.createLineString(i):this._factory.createLinearRing(i)},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn};var qn=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new gi,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof qt&&"number"==typeof arguments[1]){var e=arguments[1];t.call(this,arguments[0].getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var i=arguments[0],n=arguments[1];this._srcPts=i,this._isClosed=t.isClosed(i),this._snapTolerance=n}};qn.prototype.snapVertices=function(t,e){for(var i=this._isClosed?t.size()-1:t.size(),n=0;n<i;n++){var r=t.get(n),s=this.findSnapForVertex(r,e);null!==s&&(t.set(n,new E(s)),0===n&&this._isClosed&&t.set(t.size()-1,new E(s)))}},qn.prototype.findSnapForVertex=function(t,e){for(var i=0;i<e.length;i++){if(t.equals2D(e[i]))return null;if(t.distance(e[i])<this._snapTolerance)return e[i]}return null},qn.prototype.snapTo=function(t){var e=new It(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},qn.prototype.snapSegments=function(t,e){if(0===e.length)return null;var i=e.length;e[0].equals2D(e[e.length-1])&&(i=e.length-1);for(var n=0;n<i;n++){var r=e[n],s=this.findSegmentIndexToSnap(r,t);s>=0&&t.add(s+1,new E(r),!1)}},qn.prototype.findSegmentIndexToSnap=function(t,e){for(var i=v.MAX_VALUE,n=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var s=this._seg.distance(t);s<this._snapTolerance&&s<i&&(i=s,n=r)}return n},qn.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},qn.prototype.interfaces_=function(){return[]},qn.prototype.getClass=function(){return qn},qn.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Kn=function(t){this._srcGeom=t||null},Jn={SNAP_PRECISION_FACTOR:{configurable:!0}};Kn.prototype.snapTo=function(t,e){var i=this.extractTargetCoordinates(t);return new Qn(e,i).transform(this._srcGeom)},Kn.prototype.snapToSelf=function(t,e){var i=this.extractTargetCoordinates(this._srcGeom),n=new Qn(t,i,!0).transform(this._srcGeom),r=n;return e&&N(r,Qt)&&(r=n.buffer(0)),r},Kn.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Kn.prototype.extractTargetCoordinates=function(t){for(var e=new d,i=t.getCoordinates(),n=0;n<i.length;n++)e.add(i[n]);return e.toArray(new Array(0).fill(null))},Kn.prototype.computeMinimumSegmentLength=function(t){for(var e=v.MAX_VALUE,i=0;i<t.length-1;i++){var n=t[i].distance(t[i+1]);n<e&&(e=n)}return e},Kn.prototype.interfaces_=function(){return[]},Kn.prototype.getClass=function(){return Kn},Kn.snap=function(t,e,i){var n=new Array(2).fill(null),r=new Kn(t);n[0]=r.snapTo(e,i);var s=new Kn(e);return n[1]=s.snapTo(n[0],i),n},Kn.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Kn.computeSizeBasedSnapTolerance(t),i=t.getPrecisionModel();if(i.getType()===de.FIXED){var n=1/i.getScale()*2/1.415;n>e&&(e=n)}return e}if(2===arguments.length){var r=arguments[0],s=arguments[1];return Math.min(Kn.computeOverlaySnapTolerance(r),Kn.computeOverlaySnapTolerance(s))}},Kn.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Kn.SNAP_PRECISION_FACTOR},Kn.snapToSelf=function(t,e,i){return new Kn(t).snapToSelf(e,i)},Jn.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Kn,Jn);var Qn=function(t){function e(e,i,n){t.call(this),this._snapTolerance=e||null,this._snapPts=i||null,this._isSelfSnap=void 0!==n&&n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var i=new qn(t,this._snapTolerance);return i.setAllowSnappingToSourceVertices(this._isSelfSnap),i.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var i=t.toCoordinateArray(),n=this.snapLine(i,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Xn),$n=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};$n.prototype.getCommon=function(){return v.longBitsToDouble(this._commonBits)},$n.prototype.add=function(t){var e=v.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=$n.signExpBits(this._commonBits),this._isFirst=!1,null):$n.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=$n.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=$n.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},$n.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=v.longBitsToDouble(t),i="0000000000000000000000000000000000000000000000000000000000000000"+v.toBinaryString(t),n=i.substring(i.length-64);return n.substring(0,1)+"  "+n.substring(1,12)+"(exp) "+n.substring(12)+" [ "+e+" ]"}},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n},$n.getBit=function(t,e){return t&1<<e?1:0},$n.signExpBits=function(t){return t>>52},$n.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},$n.numCommonMostSigMantissaBits=function(t,e){for(var i=0,n=52;n>=0;n--){if($n.getBit(t,n)!==$n.getBit(e,n))return i;i++}return 52};var tr=function(){this._commonCoord=null,this._ccFilter=new ir},er={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};tr.prototype.addCommonBits=function(t){var e=new nr(this._commonCoord);t.apply(e),t.geometryChanged()},tr.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new E(this._commonCoord);e.x=-e.x,e.y=-e.y;var i=new nr(e);return t.apply(i),t.geometryChanged(),t},tr.prototype.getCommonCoordinate=function(){return this._commonCoord},tr.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},er.CommonCoordinateFilter.get=function(){return ir},er.Translater.get=function(){return nr},Object.defineProperties(tr,er);var ir=function(){this._commonBitsX=new $n,this._commonBitsY=new $n};ir.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},ir.prototype.getCommonCoordinate=function(){return new E(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},ir.prototype.interfaces_=function(){return[dt]},ir.prototype.getClass=function(){return ir};var nr=function(){this.trans=null;var t=arguments[0];this.trans=t};nr.prototype.filter=function(t,e){var i=t.getOrdinate(e,0)+this.trans.x,n=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,i),t.setOrdinate(e,1,n)},nr.prototype.isDone=function(){return!1},nr.prototype.isGeometryChanged=function(){return!0},nr.prototype.interfaces_=function(){return[jt]},nr.prototype.getClass=function(){return nr};var rr=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};rr.prototype.selfSnap=function(t){return new Kn(t).snapTo(t,this._snapTolerance)},rr.prototype.removeCommonBits=function(t){this._cbr=new tr,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},rr.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},rr.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),i=Sr.overlayOp(e[0],e[1],t);return this.prepareResult(i)},rr.prototype.checkValid=function(t){t.isValid()||U.out.println("Snapped geometry is invalid")},rr.prototype.computeSnapTolerance=function(){this._snapTolerance=Kn.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},rr.prototype.snap=function(t){var e=this.removeCommonBits(t);return Kn.snap(e[0],e[1],this._snapTolerance)},rr.prototype.interfaces_=function(){return[]},rr.prototype.getClass=function(){return rr},rr.overlayOp=function(t,e,i){return new rr(t,e).getResultGeometry(i)},rr.union=function(t,e){return rr.overlayOp(t,e,Sr.UNION)},rr.intersection=function(t,e){return rr.overlayOp(t,e,Sr.INTERSECTION)},rr.symDifference=function(t,e){return rr.overlayOp(t,e,Sr.SYMDIFFERENCE)},rr.difference=function(t,e){return rr.overlayOp(t,e,Sr.DIFFERENCE)};var sr=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};sr.prototype.getResultGeometry=function(t){var e=null,i=!1,n=null;try{e=Sr.overlayOp(this._geom[0],this._geom[1],t),i=!0}catch(t){if(!(t instanceof $))throw t;n=t}if(!i)try{e=rr.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof $?n:t}return e},sr.prototype.interfaces_=function(){return[]},sr.prototype.getClass=function(){return sr},sr.overlayOp=function(t,e,i){return new sr(t,e).getResultGeometry(i)},sr.union=function(t,e){return sr.overlayOp(t,e,Sr.UNION)},sr.intersection=function(t,e){return sr.overlayOp(t,e,Sr.INTERSECTION)},sr.symDifference=function(t,e){return sr.overlayOp(t,e,Sr.SYMDIFFERENCE)},sr.difference=function(t,e){return sr.overlayOp(t,e,Sr.DIFFERENCE)};var or=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};or.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or};var ar=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],i=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=i}else if(3===arguments.length){var n=arguments[0],r=arguments[1],s=arguments[2];this._eventType=t.INSERT,this._label=n,this._xValue=r,this._obj=s}},lr={INSERT:{configurable:!0},DELETE:{configurable:!0}};ar.prototype.isDelete=function(){return this._eventType===ar.DELETE},ar.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},ar.prototype.getObject=function(){return this._obj},ar.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},ar.prototype.getInsertEvent=function(){return this._insertEvent},ar.prototype.isInsert=function(){return this._eventType===ar.INSERT},ar.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},ar.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},ar.prototype.interfaces_=function(){return[x]},ar.prototype.getClass=function(){return ar},lr.INSERT.get=function(){return 1},lr.DELETE.get=function(){return 2},Object.defineProperties(ar,lr);var hr=function(){};hr.prototype.interfaces_=function(){return[]},hr.prototype.getClass=function(){return hr};var ur=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],i=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=i};ur.prototype.isTrivialIntersection=function(t,e,i,n){if(t===i&&1===this._li.getIntersectionNum()){if(ur.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&n===r||0===n&&e===r)return!0}}return!1},ur.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},ur.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},ur.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},ur.prototype.isBoundaryPointInternal=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next().getCoordinate();if(t.isIntersection(n))return!0}return!1},ur.prototype.hasProperIntersection=function(){return this._hasProper},ur.prototype.hasIntersection=function(){return this._hasIntersection},ur.prototype.isDone=function(){return this._isDone},ur.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},ur.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},ur.prototype.addIntersections=function(t,e,i,n){if(t===i&&e===n)return null;this.numTests++;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),i.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,i,n)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},ur.prototype.interfaces_=function(){return[]},ur.prototype.getClass=function(){return ur},ur.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var cr=function(t){function e(){t.call(this),this.events=new Mt,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){$e.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var i=this.events.get(e);if(i.isInsert()&&this.processOverlaps(e,i.getDeleteEventIndex(),i,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof ur&&N(arguments[0],wt)&&N(arguments[1],wt)){var n=arguments[0],r=arguments[1],s=arguments[2];this.addEdges(n,n),this.addEdges(r,r),this.computeIntersections(s)}else if("boolean"==typeof arguments[2]&&N(arguments[0],wt)&&arguments[1]instanceof ur){var o=arguments[0],a=arguments[1];arguments[2]?this.addEdges(o,null):this.addEdges(o),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var i=t.getMonotoneChainEdge(),n=i.getStartIndexes(),r=0;r<n.length-1;r++){var s=new or(i,r),o=new ar(e,i.getMinX(r),s);this.events.add(o),this.events.add(new ar(i.getMaxX(r),o))}},e.prototype.processOverlaps=function(t,e,i,n){for(var r=i.getObject(),s=t;s<e;s++){var o=this.events.get(s);if(o.isInsert()){var a=o.getObject();i.isSameLabel(o)||(r.computeIntersections(a,n),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var i=arguments[1],n=arguments[0].iterator();n.hasNext();){var r=n.next();this.addEdge(r,i)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(hr),pr=function(){this._min=v.POSITIVE_INFINITY,this._max=v.NEGATIVE_INFINITY},dr={NodeComparator:{configurable:!0}};pr.prototype.getMin=function(){return this._min},pr.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},pr.prototype.getMax=function(){return this._max},pr.prototype.toString=function(){return Q.toLineString(new E(this._min,0),new E(this._max,0))},pr.prototype.interfaces_=function(){return[]},pr.prototype.getClass=function(){return pr},dr.NodeComparator.get=function(){return gr},Object.defineProperties(pr,dr);var gr=function(){};gr.prototype.compare=function(t,e){var i=t,n=e,r=(i._min+i._max)/2,s=(n._min+n._max)/2;return r<s?-1:r>s?1:0},gr.prototype.interfaces_=function(){return[M]},gr.prototype.getClass=function(){return gr};var fr=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],i=arguments[1],n=arguments[2];this._min=e,this._max=i,this._item=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,i){if(!this.intersects(t,e))return null;i.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(pr),yr=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],i=arguments[1];this._node1=e,this._node2=i,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,i){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,i),null!==this._node2&&this._node2.query(t,e,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(pr),mr=function(){this._leaves=new Mt,this._root=null,this._level=0};mr.prototype.buildTree=function(){$e.sort(this._leaves,new pr.NodeComparator);for(var t=this._leaves,e=null,i=new Mt;;){if(this.buildLevel(t,i),1===i.size())return i.get(0);e=t,t=i,i=e}},mr.prototype.insert=function(t,e,i){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new fr(t,e,i))},mr.prototype.query=function(t,e,i){this.init(),this._root.query(t,e,i)},mr.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},mr.prototype.printNode=function(t){U.out.println(Q.toLineString(new E(t._min,this._level),new E(t._max,this._level)))},mr.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},mr.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var i=0;i<t.size();i+=2){var n=t.get(i);if(null===(i+1<t.size()?t.get(i):null))e.add(n);else{var r=new yr(t.get(i),t.get(i+1));e.add(r)}}},mr.prototype.interfaces_=function(){return[]},mr.prototype.getClass=function(){return mr};var _r=function(){this._items=new Mt};_r.prototype.visitItem=function(t){this._items.add(t)},_r.prototype.getItems=function(){return this._items},_r.prototype.interfaces_=function(){return[qe]},_r.prototype.getClass=function(){return _r};var vr=function(){this._index=null;var t=arguments[0];if(!N(t,Qt))throw new _("Argument must be Polygonal");this._index=new wr(t)},Cr={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};vr.prototype.locate=function(t){var e=new ot(t),i=new xr(e);return this._index.query(t.y,t.y,i),e.getLocation()},vr.prototype.interfaces_=function(){return[Hi]},vr.prototype.getClass=function(){return vr},Cr.SegmentVisitor.get=function(){return xr},Cr.IntervalIndexedGeometry.get=function(){return wr},Object.defineProperties(vr,Cr);var xr=function(){this._counter=null;var t=arguments[0];this._counter=t};xr.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},xr.prototype.interfaces_=function(){return[qe]},xr.prototype.getClass=function(){return xr};var wr=function(){this._index=new mr;var t=arguments[0];this.init(t)};wr.prototype.init=function(t){for(var e=En.getLines(t).iterator();e.hasNext();){var i=e.next().getCoordinates();this.addLine(i)}},wr.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var i=new gi(t[e-1],t[e]),n=Math.min(i.p0.y,i.p1.y),r=Math.max(i.p0.y,i.p1.y);this._index.insert(n,r,i)}},wr.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=new _r;return this._index.query(t,e,i),i.getItems()}if(3===arguments.length){var n=arguments[0],r=arguments[1],s=arguments[2];this._index.query(n,r,s)}},wr.prototype.interfaces_=function(){return[]},wr.prototype.getClass=function(){return wr};var Mr=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new pe,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new In,2===arguments.length){var e=arguments[0],i=arguments[1],n=gt.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=i,this._boundaryNodeRule=n,null!==i&&this.add(i)}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this._argIndex=r,this._parentGeom=s,this._boundaryNodeRule=o,null!==s&&this.add(s)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,i){var n=this._nodes.addNode(i).getLabel(),r=1;n.getLocation(t,Ie.ON)===b.BOUNDARY&&r++;var s=e.determineBoundary(this._boundaryNodeRule,r);n.setLocation(t,s)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var i=arguments[1],n=arguments[2],r=new ur(arguments[0],!0,!1);r.setIsDoneIfProperInt(n);var s=this.createEdgeSetIntersector(),o=this._parentGeom instanceof ee||this._parentGeom instanceof $t||this._parentGeom instanceof ie,a=i||!o;return s.computeIntersections(this._edges,r,a),this.addSelfIntersectionNodes(this._argIndex),r}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,i){var n=new ur(e,i,!0);return n.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,n),n},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Jt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,b.INTERIOR)}else if(arguments[0]instanceof E){var e=arguments[0];this.insertPoint(this._argIndex,e,b.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),b.EXTERIOR,b.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var i=t.getInteriorRingN(e);this.addPolygonRing(i,b.INTERIOR,b.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],b.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],b.BOUNDARY)},e.prototype.addLineString=function(t){var e=St.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var i=new en(e,new Te(this._argIndex,b.INTERIOR));this._lineEdgeMap.put(t,i),this.insertEdge(i),et.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),i=0,n=t.iterator();n.hasNext();){var r=n.next();e[i++]=r.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,i){if(this.isBoundaryNode(t,e))return null;i===b.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,i)},e.prototype.addPolygonRing=function(t,e,i){if(t.isEmpty())return null;var n=St.removeRepeatedPoints(t.getCoordinates());if(n.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=n[0],null;var r=e,s=i;at.isCCW(n)&&(r=i,s=e);var o=new en(n,new Te(this._argIndex,b.BOUNDARY,r,s));this._lineEdgeMap.put(t,o),this.insertEdge(o),this.insertPoint(this._argIndex,n[0],b.BOUNDARY)},e.prototype.insertPoint=function(t,e,i){var n=this._nodes.addNode(e),r=n.getLabel();null===r?n._label=new Te(t,i):r.setLocation(t,i)},e.prototype.createEdgeSetIntersector=function(){return new cr},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var i=e.next(),n=i.getLabel().getLocation(t),r=i.eiList.iterator();r.hasNext();){var s=r.next();this.addSelfIntersectionNode(t,s.coord,n)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof ie&&(this._useBoundaryDeterminationRule=!1),e instanceof $t)this.addPolygon(e);else if(e instanceof qt)this.addLineString(e);else if(e instanceof Jt)this.addPoint(e);else if(e instanceof te)this.addCollection(e);else if(e instanceof Bt)this.addCollection(e);else if(e instanceof ie)this.addCollection(e);else{if(!(e instanceof zt))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);this.add(i)}},e.prototype.locate=function(t){return N(this._parentGeom,Qt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new vr(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?b.BOUNDARY:b.INTERIOR},e}(Ue),Er=function(){if(this._li=new rt,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Mr(0,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1],n=gt.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(i.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Mr(0,e,n),this._arg[1]=new Mr(1,i,n)}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];r.getPrecisionModel().compareTo(s.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(s.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Mr(0,r,o),this._arg[1]=new Mr(1,s,o)}};Er.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Er.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Er.prototype.interfaces_=function(){return[]},Er.prototype.getClass=function(){return Er};var Ir=function(){};Ir.prototype.interfaces_=function(){return[]},Ir.prototype.getClass=function(){return Ir},Ir.map=function(){if(arguments[0]instanceof ut&&N(arguments[1],Ir.MapOp)){for(var t=arguments[0],e=arguments[1],i=new Mt,n=0;n<t.getNumGeometries();n++){var r=e.map(t.getGeometryN(n));null!==r&&i.add(r)}return t.getFactory().buildGeometry(i)}if(N(arguments[0],Ct)&&N(arguments[1],Ir.MapOp)){for(var s=arguments[0],o=arguments[1],a=new Mt,l=s.iterator();l.hasNext();){var h=l.next(),u=o.map(h);null!==u&&a.add(u)}return a}},Ir.MapOp=function(){};var Sr=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i),this._ptLocator=new In,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Yi,this._resultPolyList=new Mt,this._resultLineList=new Mt,this._resultPointList=new Mt,this._graph=new Ue(new Ui),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var i=e.getLabel(),n=t.getLabel();e.isPointwiseEqual(t)||(n=new Te(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(i),r.add(n),i.merge(n)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),i=e.getSym();e.isInResult()&&i.isInResult()&&(e.setInResult(!1),i.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,i,n,r){var s=new Mt;return s.addAll(t),s.addAll(i),s.addAll(n),s.isEmpty()?e.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(s)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();if(this._ptLocator.locate(t,n)!==b.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new Mt,e=this._edgeList.iterator();e.hasNext();){var i=e.next();i.isCollapsed()&&(e.remove(),t.add(i.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),i=e.getEdges().getLabel();e.getLabel().merge(i)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this.insertUniqueEdge(i)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new Mt;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Un.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var i=new Ze(this._geomFact);i.add(this._graph),this._resultPolyList=i.getPolygons();var n=new Yn(this,this._geomFact,this._ptLocator);this._resultLineList=n.build(t);var r=new Wn(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,i)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var i=e.next();this._graph.addNode(i.getCoordinate()).setLabel(t,i.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var i=this._graph.getEdgeEnds().iterator();i.hasNext();){var n=i.next(),r=n.getLabel();r.isArea()&&!n.isInteriorAreaEdge()&&e.isResultOfOp(r.getLocation(0,Ie.RIGHT),r.getLocation(1,Ie.RIGHT),t)&&n.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),i=e.getLabel(),n=e.getDepth();if(!n.isNull()){n.normalize();for(var r=0;r<2;r++)i.isNull(r)||!i.isArea()||n.isNull(r)||(0===n.getDelta(r)?i.toLine(r):(et.isTrue(!n.isNull(r,Ie.LEFT),"depth of LEFT side has not been initialized"),i.setLocation(r,Ie.LEFT,n.getLocation(r,Ie.LEFT)),et.isTrue(!n.isNull(r,Ie.RIGHT),"depth of RIGHT side has not been initialized"),i.setLocation(r,Ie.RIGHT,n.getLocation(r,Ie.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),i=e.getLabel();e.isIsolated()&&(i.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(i)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Er);Sr.overlayOp=function(t,e,i){return new Sr(t,e).getResultGeometry(i)},Sr.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Sr.createEmptyResult(Sr.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var i=e;return Zn.map(t,{interfaces_:function(){return[Ir.MapOp]},map:function(t){return t.intersection(i)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),sr.overlayOp(t,e,Sr.INTERSECTION)},Sr.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Sr.createEmptyResult(Sr.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),sr.overlayOp(t,e,Sr.SYMDIFFERENCE)},Sr.resultDimension=function(t,e,i){var n=e.getDimension(),r=i.getDimension(),s=-1;switch(t){case Sr.INTERSECTION:s=Math.min(n,r);break;case Sr.UNION:s=Math.max(n,r);break;case Sr.DIFFERENCE:s=n;break;case Sr.SYMDIFFERENCE:s=Math.max(n,r)}return s},Sr.createEmptyResult=function(t,e,i,n){var r=null;switch(Sr.resultDimension(t,e,i)){case-1:r=n.createGeometryCollection(new Array(0).fill(null));break;case 0:r=n.createPoint();break;case 1:r=n.createLineString();break;case 2:r=n.createPolygon()}return r},Sr.difference=function(t,e){return t.isEmpty()?Sr.createEmptyResult(Sr.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),sr.overlayOp(t,e,Sr.DIFFERENCE))},Sr.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=t.getLocation(0),n=t.getLocation(1);return Sr.isResultOfOp(i,n,e)}if(3===arguments.length){var r=arguments[0],s=arguments[1];switch(r===b.BOUNDARY&&(r=b.INTERIOR),s===b.BOUNDARY&&(s=b.INTERIOR),arguments[2]){case Sr.INTERSECTION:return r===b.INTERIOR&&s===b.INTERIOR;case Sr.UNION:return r===b.INTERIOR||s===b.INTERIOR;case Sr.DIFFERENCE:return r===b.INTERIOR&&s!==b.INTERIOR;case Sr.SYMDIFFERENCE:return r===b.INTERIOR&&s!==b.INTERIOR||r!==b.INTERIOR&&s===b.INTERIOR}return!1}},Sr.INTERSECTION=1,Sr.UNION=2,Sr.DIFFERENCE=3,Sr.SYMDIFFERENCE=4;var Lr=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new In,this._seg=new gi;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Lr.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var i=this._linework.getGeometryN(e).getCoordinateSequence(),n=0;n<i.size()-1;n++)if(i.getCoordinate(n,this._seg.p0),i.getCoordinate(n+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},Lr.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?b.BOUNDARY:this._ptLocator.locate(t,this._g)},Lr.prototype.extractLinework=function(t){var e=new br;t.apply(e);var i=e.getLinework(),n=me.toLineStringArray(i);return t.getFactory().createMultiLineString(n)},Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr};var br=function(){this._linework=null,this._linework=new Mt};br.prototype.getLinework=function(){return this._linework},br.prototype.filter=function(t){if(t instanceof $t){var e=t;this._linework.add(e.getExteriorRing());for(var i=0;i<e.getNumInteriorRing();i++)this._linework.add(e.getInteriorRingN(i))}},br.prototype.interfaces_=function(){return[Vt]},br.prototype.getClass=function(){return br};var Rr=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Rr.prototype.extractPoints=function(t,e,i){for(var n=t.getCoordinates(),r=0;r<n.length-1;r++)this.computeOffsetPoints(n[r],n[r+1],e,i)},Rr.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Rr.prototype.getPoints=function(t){for(var e=new Mt,i=En.getLines(this._g).iterator();i.hasNext();){var n=i.next();this.extractPoints(n,t,e)}return e},Rr.prototype.computeOffsetPoints=function(t,e,i,n){var r=e.x-t.x,s=e.y-t.y,o=Math.sqrt(r*r+s*s),a=i*r/o,l=i*s/o,h=(e.x+t.x)/2,u=(e.y+t.y)/2;if(this._doLeft){var c=new E(h-l,u+a);n.add(c)}if(this._doRight){var p=new E(h+l,u-a);n.add(p)}},Rr.prototype.interfaces_=function(){return[]},Rr.prototype.getClass=function(){return Rr};var Nr=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new Mt;var e=arguments[0],i=arguments[1],n=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,i),this._geom=[e,i,n],this._locFinder=[new Lr(this._geom[0],this._boundaryDistanceTolerance),new Lr(this._geom[1],this._boundaryDistanceTolerance),new Lr(this._geom[2],this._boundaryDistanceTolerance)]},Ar={TOLERANCE:{configurable:!0}};Nr.prototype.reportResult=function(t,e,i){U.out.println("Overlay result invalid - A:"+b.toLocationSymbol(e[0])+" B:"+b.toLocationSymbol(e[1])+" expected:"+(i?"i":"e")+" actual:"+b.toLocationSymbol(e[2]))},Nr.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Nr.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var i=this._testCoords.get(e);if(!this.checkValid(t,i))return this._invalidLocation=i,!1}return!0}if(2===arguments.length){var n=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!Nr.hasLocation(this._location,b.BOUNDARY)||this.isValidResult(n,this._location)}},Nr.prototype.addTestPts=function(t){var e=new Rr(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Nr.prototype.isValidResult=function(t,e){var i=Sr.isResultOfOp(e[0],e[1],t),n=!(i^e[2]===b.INTERIOR);return n||this.reportResult(t,e,i),n},Nr.prototype.getInvalidLocation=function(){return this._invalidLocation},Nr.prototype.interfaces_=function(){return[]},Nr.prototype.getClass=function(){return Nr},Nr.hasLocation=function(t,e){for(var i=0;i<3;i++)if(t[i]===e)return!0;return!1},Nr.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Kn.computeSizeBasedSnapTolerance(t),Kn.computeSizeBasedSnapTolerance(e))},Nr.isValid=function(t,e,i,n){return new Nr(t,e,n).isValid(i)},Ar.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Nr,Ar);var Tr=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Tr.prototype.extractElements=function(t,e){if(null===t)return null;for(var i=0;i<t.getNumGeometries();i++){var n=t.getGeometryN(i);this._skipEmpty&&n.isEmpty()||e.add(n)}},Tr.prototype.combine=function(){for(var t=new Mt,e=this._inputGeoms.iterator();e.hasNext();){var i=e.next();this.extractElements(i,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Tr.prototype.interfaces_=function(){return[]},Tr.prototype.getClass=function(){return Tr},Tr.combine=function(){return 1===arguments.length?new Tr(arguments[0]).combine():2===arguments.length?new Tr(Tr.createList(arguments[0],arguments[1])).combine():3===arguments.length?new Tr(Tr.createList(arguments[0],arguments[1],arguments[2])).combine():void 0},Tr.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Tr.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=new Mt;return i.add(t),i.add(e),i}if(3===arguments.length){var n=arguments[0],r=arguments[1],s=arguments[2],o=new Mt;return o.add(n),o.add(r),o.add(s),o}};var Pr=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new Mt)},Or={STRTREE_NODE_CAPACITY:{configurable:!0}};Pr.prototype.reduceToGeometries=function(t){for(var e=new Mt,i=t.iterator();i.hasNext();){var n=i.next(),r=null;N(n,wt)?r=this.unionTree(n):n instanceof ut&&(r=n),e.add(r)}return e},Pr.prototype.extractByEnvelope=function(t,e,i){for(var n=new Mt,r=0;r<e.getNumGeometries();r++){var s=e.getGeometryN(r);s.getEnvelopeInternal().intersects(t)?n.add(s):i.add(s)}return this._geomFactory.buildGeometry(n)},Pr.prototype.unionOptimized=function(t,e){var i=t.getEnvelopeInternal(),n=e.getEnvelopeInternal();if(!i.intersects(n))return Tr.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=i.intersection(n);return this.unionUsingEnvelopeIntersection(t,e,r)},Pr.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new si(Pr.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var i=e.next();t.insert(i.getEnvelopeInternal(),i)}this._inputPolys=null;var n=t.itemsTree();return this.unionTree(n)},Pr.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2];if(n-i<=1){var r=Pr.getGeometry(e,i);return this.unionSafe(r,null)}if(n-i==2)return this.unionSafe(Pr.getGeometry(e,i),Pr.getGeometry(e,i+1));var s=Math.trunc((n+i)/2),o=this.binaryUnion(e,i,s),a=this.binaryUnion(e,s,n);return this.unionSafe(o,a)}},Pr.prototype.repeatedUnion=function(t){for(var e=null,i=t.iterator();i.hasNext();){var n=i.next();e=null===e?n.copy():e.union(n)}return e},Pr.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Pr.prototype.unionActual=function(t,e){return Pr.restrictToPolygons(t.union(e))},Pr.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Pr.prototype.unionUsingEnvelopeIntersection=function(t,e,i){var n=new Mt,r=this.extractByEnvelope(i,t,n),s=this.extractByEnvelope(i,e,n),o=this.unionActual(r,s);return n.add(o),Tr.combine(n)},Pr.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e.getFactory().createGeometryCollection([e,i]).buffer(0)}},Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr},Pr.restrictToPolygons=function(t){if(N(t,Qt))return t;var e=Mn.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(me.toPolygonArray(e))},Pr.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Pr.union=function(t){return new Pr(t).union()},Or.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Pr,Or);var Dr=function(){};Dr.prototype.interfaces_=function(){return[]},Dr.prototype.getClass=function(){return Dr},Dr.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Sr.createEmptyResult(Sr.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),sr.overlayOp(t,e,Sr.UNION)},t.GeoJSONReader=Me,t.GeoJSONWriter=Ee,t.OverlayOp=Sr,t.UnionOp=Dr,t.BufferOp=fn,Object.defineProperty(t,"__esModule",{value:!0})}(e)}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{"use strict";var t="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==t&&t,e="URLSearchParams"in t,i="Symbol"in t&&"iterator"in Symbol,n="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),r="FormData"in t,s="ArrayBuffer"in t;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=ArrayBuffer.isView||function(t){return t&&o.indexOf(Object.prototype.toString.call(t))>-1};function l(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function h(t){return"string"!=typeof t&&(t=String(t)),t}function u(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return i&&(e[Symbol.iterator]=function(){return e}),e}function c(t){this.map={},t instanceof c?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function p(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function d(t){return new Promise((function(e,i){t.onload=function(){e(t.result)},t.onerror=function(){i(t.error)}}))}function g(t){var e=new FileReader,i=d(e);return e.readAsArrayBuffer(t),i}function f(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(t){var i;this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:n&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:r&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:e&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():s&&n&&(i=t)&&DataView.prototype.isPrototypeOf(i)?(this._bodyArrayBuffer=f(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(t)||a(t))?this._bodyArrayBuffer=f(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n&&(this.blob=function(){var t=p(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer)):this.blob().then(g)}),this.text=function(){var t,e,i,n=p(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,i=d(e=new FileReader),e.readAsText(t),i;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),i=new Array(e.length),n=0;n<e.length;n++)i[n]=String.fromCharCode(e[n]);return i.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}c.prototype.append=function(t,e){t=l(t),e=h(e);var i=this.map[t];this.map[t]=i?i+", "+e:e},c.prototype.delete=function(t){delete this.map[l(t)]},c.prototype.get=function(t){return t=l(t),this.has(t)?this.map[t]:null},c.prototype.has=function(t){return this.map.hasOwnProperty(l(t))},c.prototype.set=function(t,e){this.map[l(t)]=h(e)},c.prototype.forEach=function(t,e){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(e,this.map[i],i,this)},c.prototype.keys=function(){var t=[];return this.forEach((function(e,i){t.push(i)})),u(t)},c.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),u(t)},c.prototype.entries=function(){var t=[];return this.forEach((function(e,i){t.push([i,e])})),u(t)},i&&(c.prototype[Symbol.iterator]=c.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function _(t,e){if(!(this instanceof _))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var i,n,r=(e=e||{}).body;if(t instanceof _){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new c(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new c(e.headers)),this.method=(n=(i=e.method||this.method||"GET").toUpperCase(),m.indexOf(n)>-1?n:i),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache)){var s=/([?&])_=[^&]*/;s.test(this.url)?this.url=this.url.replace(s,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function v(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var i=t.split("="),n=i.shift().replace(/\+/g," "),r=i.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(r))}})),e}function C(t,e){if(!(this instanceof C))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===e.statusText?"":""+e.statusText,this.headers=new c(e.headers),this.url=e.url||"",this._initBody(t)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})},y.call(_.prototype),y.call(C.prototype),C.prototype.clone=function(){return new C(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},C.error=function(){var t=new C(null,{status:0,statusText:""});return t.type="error",t};var x=[301,302,303,307,308];C.redirect=function(t,e){if(-1===x.indexOf(e))throw new RangeError("Invalid status code");return new C(null,{status:e,headers:{location:t}})};var w=t.DOMException;try{new w}catch(t){(w=function(t,e){this.message=t,this.name=e;var i=Error(t);this.stack=i.stack}).prototype=Object.create(Error.prototype),w.prototype.constructor=w}function M(e,i){return new Promise((function(r,o){var a=new _(e,i);if(a.signal&&a.signal.aborted)return o(new w("Aborted","AbortError"));var l=new XMLHttpRequest;function u(){l.abort()}l.onload=function(){var t,e,i={status:l.status,statusText:l.statusText,headers:(t=l.getAllResponseHeaders()||"",e=new c,t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var i=t.split(":"),n=i.shift().trim();if(n){var r=i.join(":").trim();e.append(n,r)}})),e)};i.url="responseURL"in l?l.responseURL:i.headers.get("X-Request-URL");var n="response"in l?l.response:l.responseText;setTimeout((function(){r(new C(n,i))}),0)},l.onerror=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},l.ontimeout=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},l.onabort=function(){setTimeout((function(){o(new w("Aborted","AbortError"))}),0)},l.open(a.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(t){return e}}(a.url),!0),"include"===a.credentials?l.withCredentials=!0:"omit"===a.credentials&&(l.withCredentials=!1),"responseType"in l&&(n?l.responseType="blob":s&&a.headers.get("Content-Type")&&-1!==a.headers.get("Content-Type").indexOf("application/octet-stream")&&(l.responseType="arraybuffer")),!i||"object"!=typeof i.headers||i.headers instanceof c?a.headers.forEach((function(t,e){l.setRequestHeader(e,t)})):Object.getOwnPropertyNames(i.headers).forEach((function(t){l.setRequestHeader(t,h(i.headers[t]))})),a.signal&&(a.signal.addEventListener("abort",u),l.onreadystatechange=function(){4===l.readyState&&a.signal.removeEventListener("abort",u)}),l.send(void 0===a._bodyInit?null:a._bodyInit)}))}M.polyfill=!0,t.fetch||(t.fetch=M,t.Headers=c,t.Request=_,t.Response=C)})(),(()=>{"use strict";i.r(n),i.d(n,{BBRLegendControl:()=>vm,BBRLegendControlOptions:()=>_m,Control:()=>mc,ControlOptions:()=>yc,DragEventOptions:()=>s_,GeoLocationControl:()=>Ic,GeoLocationControlOptions:()=>Ec,Geometry:()=>Fy,GroupDaempetSkaermkortLayer:()=>Wm,GroupDefaultSkaermkortLayer:()=>Zm,GroupGraaaSkaermkortLayer:()=>Ym,GroupLayer:()=>Zg,GroupOrtofotoLayer:()=>Yg,GroupSkaermkortLayer:()=>Um,Hover:()=>Rm,HoverOptions:()=>bm,Layer:()=>Eg,LayerEventType:()=>wg,LayerOptions:()=>Mg,LegendControl:()=>ym,LegendControlOptions:()=>fm,Map:()=>jm,MapOptions:()=>Vm,MarkerDrag:()=>h_,MarkerDragOptions:()=>l_,MarkerIconProvider:()=>hc,MatrikelSelectorControl:()=>n_,MatrikelSelectorControlOptions:()=>e_,OverviewMapLayerSwitcherControl:()=>Dg,OverviewMapLayerSwitcherControlOptions:()=>Og,Polygon:()=>Hy,VectorBygningLayer:()=>$m,VectorBygningLayerEventOptions:()=>Jm,VectorBygningLayerOptions:()=>Qm,VectorLayer:()=>qg,VectorLayerOptions:()=>Xg,VectorMaskLayer:()=>By,VectorMaskLayerOptions:()=>zy,ViewOptions:()=>Hm,WMSAdresseLayer:()=>qm,WMSLayer:()=>Ng,WMSLayerOptions:()=>Rg,WMSMatrikelLayer:()=>Xm,WMSOrtofotoLayer:()=>Ag,WMSSkaermkortLayer:()=>Pg,WMSSkaermkortLayerOptions:()=>Tg,WMSVejnavnLayer:()=>Km,WMTSLayer:()=>Bg,WMTSLayerDAFOptions:()=>zg,WMTSLayerOptions:()=>jg,WMTSOrtofotoLayer:()=>Ug,WMTSSkaermkortLayer:()=>Bm,WMTSSkaermkortLayerOptions:()=>zm,getMarkerIcon:()=>c_,getVersion:()=>u_,markerStyle:()=>gm});const t=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},e="propertychange",r=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function s(t,e){return t>e?1:t<e?-1:0}function o(t,e,i){if(t[0]<=e)return 0;const n=t.length;if(e<=t[n-1])return n-1;if("function"==typeof i){for(let r=1;r<n;++r){const n=t[r];if(n===e)return r;if(n<e)return i(e,t[r-1],n)>0?r-1:r}return n-1}if(i>0){for(let i=1;i<n;++i)if(t[i]<e)return i-1;return n-1}if(i<0){for(let i=1;i<n;++i)if(t[i]<=e)return i;return n-1}for(let i=1;i<n;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return n-1}function a(t,e,i){for(;e<i;){const n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function l(t,e){const i=Array.isArray(e)?e:[e],n=i.length;for(let e=0;e<n;e++)t[t.length]=i[e]}function h(t,e){const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function u(){return!0}function c(){return!1}function p(){}function d(t){let e,i,n,r=!1;return function(){const s=Array.prototype.slice.call(arguments);return r&&this===n&&h(s,i)||(r=!0,n=this,i=s,e=t.apply(this,arguments)),e}}function g(t){for(const e in t)delete t[e]}function f(t){let e;for(e in t)return!1;return!e}const y=class extends r{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);n.includes(e)||n.push(e)}dispatchEvent(e){const i="string"==typeof e,n=i?e:e.type,r=this.listeners_&&this.listeners_[n];if(!r)return;const s=i?new t(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});let l;n in o||(o[n]=0,a[n]=0),++o[n];for(let t=0,e=r.length;t<e;++t)if(l="handleEvent"in r[t]?r[t].handleEvent(s):r[t].call(this,s),!1===l||s.propagationStopped){l=!1;break}if(0==--o[n]){let t=a[n];for(delete a[n];t--;)this.removeEventListener(n,p);delete o[n]}return l}disposeInternal(){this.listeners_&&g(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const n=i.indexOf(e);-1!==n&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=p,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}},m="change",_="contextmenu",v="click",C="keydown",x="keypress",w="touchmove",M="wheel";function E(t,e,i,n,r){if(n&&n!==t&&(i=i.bind(n)),r){const n=i;i=function(){t.removeEventListener(e,i),n.apply(this,arguments)}}const s={target:t,type:e,listener:i};return t.addEventListener(e,i),s}function I(t,e,i,n){return E(t,e,i,n,!0)}function S(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),g(t))}class L extends y{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(m)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=E(this,t[r],e);return n}return E(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const n=t.length;i=new Array(n);for(let r=0;r<n;++r)i[r]=I(this,t[r],e)}else i=I(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)b(i);else if(Array.isArray(t))for(let i=0,n=t.length;i<n;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)}}function b(t){if(Array.isArray(t))for(let e=0,i=t.length;e<i;++e)S(t[e]);else S(t)}L.prototype.on,L.prototype.once,L.prototype.un;const R=L;function N(){throw new Error("Unimplemented abstract method.")}let A=0;function T(t){return t.ol_uid||(t.ol_uid=String(++A))}class P extends t{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}const O=class extends R{constructor(t){super(),this.on,this.once,this.un,T(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,i){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new P(n,t,i)),n=e,this.hasListener(n)&&this.dispatchEvent(new P(n,t,i))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const n=this.values_||(this.values_={});if(i)n[t]=e;else{const i=n[t];n[t]=e,i!==e&&this.notify(t,i)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],f(this.values_)&&(this.values_=null),e||this.notify(t,i)}}},D="add",k="remove",F="length";class G extends t{constructor(t,e,i){super(t),this.element=e,this.index=i}}const H=class extends O{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(F)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new G(D,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new G(k,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new G(k,i,t)),this.dispatchEvent(new G(D,e,t))}updateLength_(){this.set(F,this.array_.length)}assertUnique_(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new Error("Duplicate item added to a unique collection")}},V="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",j=V.includes("firefox"),z=(V.includes("safari")&&!V.includes("chrom")&&(V.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(V)),V.includes("webkit")&&!V.includes("edge")),B=V.includes("macintosh"),U="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,Z="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Y="undefined"!=typeof Image&&Image.prototype.decode,W="function"==typeof createImageBitmap,X=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function q(t,e){if(!t)throw new Error(e)}function K(t,e){const i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function J(t,e,i,n,r,s,o,a){const l=Math.sin(s),h=Math.cos(s);return t[0]=n*h,t[1]=r*l,t[2]=-n*l,t[3]=r*h,t[4]=o*n*h-a*n*l+e,t[5]=o*r*l+a*r*h+i,t}function Q(t,e){const i=(n=e)[0]*n[3]-n[1]*n[2];var n;q(0!==i,"Transformation matrix cannot be inverted");const r=e[0],s=e[1],o=e[2],a=e[3],l=e[4],h=e[5];return t[0]=a/i,t[1]=-s/i,t[2]=-o/i,t[3]=r/i,t[4]=(o*h-a*l)/i,t[5]=-(r*h-s*l)/i,t}let $;function tt(t){const e="matrix("+t.join(", ")+")";if(Z)return e;const i=$||($=document.createElement("div"));return i.style.transform=e,i.style.transform}new Array(6);function et(t){const e=[1/0,1/0,-1/0,-1/0];for(let i=0,n=t.length;i<n;++i)ft(e,t[i]);return e}function it(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function nt(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function rt(t,e,i){let n,r;return n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0,n*n+r*r}function st(t,e){return at(t,e[0],e[1])}function ot(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function at(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function lt(t,e){const i=t[0],n=t[1],r=t[2],s=t[3],o=e[0],a=e[1];let l=0;return o<i?l|=16:o>r&&(l|=4),a<n?l|=8:a>s&&(l|=2),0===l&&(l=1),l}function ht(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function ut(t){return ht(1/0,1/0,-1/0,-1/0,t)}function ct(t,e){const i=t[0],n=t[1];return ht(i,n,i,n,e)}function pt(t,e,i,n,r){return yt(ut(r),t,e,i,n)}function dt(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function gt(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function ft(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function yt(t,e,i,n,r){for(;i<n;i+=r)mt(t,e[i],e[i+1]);return t}function mt(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function _t(t,e){let i;return i=e(Ct(t)),i||(i=e(xt(t)),i||(i=e(Rt(t)),i||(i=e(bt(t)),i||!1)))}function vt(t){let e=0;return Tt(t)||(e=Nt(t)*St(t)),e}function Ct(t){return[t[0],t[1]]}function xt(t){return[t[2],t[1]]}function wt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Mt(t,e){let i;if("bottom-left"===e)i=Ct(t);else if("bottom-right"===e)i=xt(t);else if("top-left"===e)i=bt(t);else{if("top-right"!==e)throw new Error("Invalid corner");i=Rt(t)}return i}function Et(t,e,i,n,r){const[s,o,a,l,h,u,c,p]=It(t,e,i,n);return ht(Math.min(s,a,h,c),Math.min(o,l,u,p),Math.max(s,a,h,c),Math.max(o,l,u,p),r)}function It(t,e,i,n){const r=e*n[0]/2,s=e*n[1]/2,o=Math.cos(i),a=Math.sin(i),l=r*o,h=r*a,u=s*o,c=s*a,p=t[0],d=t[1];return[p-l+c,d-h-u,p-l-c,d-h+u,p+l-c,d+h+u,p+l+c,d+h-u,p-l+c,d-h-u]}function St(t){return t[3]-t[1]}function Lt(t,e,i){const n=i||[1/0,1/0,-1/0,-1/0];return At(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):ut(n),n}function bt(t){return[t[0],t[3]]}function Rt(t){return[t[2],t[3]]}function Nt(t){return t[2]-t[0]}function At(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Tt(t){return t[2]<t[0]||t[3]<t[1]}function Pt(t,e){const i=e.getExtent(),n=wt(t);if(e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])){const e=Nt(i),r=Math.floor((n[0]-i[0])/e)*e;t[0]-=r,t[2]-=r}return t}const Ot={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var Dt={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};Dt.max=Dt.whitepoint[2].D65,Dt.rgb=function(t,e){e=e||Dt.whitepoint[2].E;var i,n,r,s=t[0]/e[0],o=t[1]/e[1],a=t[2]/e[2];return n=-.96924363628087*s+1.87596750150772*o+.041555057407175*a,r=.055630079696993*s+-.20397695888897*o+1.056971514242878*a,i=(i=3.240969941904521*s+-1.537383177570093*o+-.498610760293*a)>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,[255*(i=Math.min(Math.max(0,i),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]},Ot.xyz=function(t,e){var i=t[0]/255,n=t[1]/255,r=t[2]/255,s=.21263900587151*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.71516867876775*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.072192315360733*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92),o=.019330818715591*i+.11919477979462*n+.95053215224966*r;return[(.41239079926595*i+.35758433938387*n+.18048078840183*r)*(e=e||Dt.whitepoint[2].E)[0],s*e[1],o*e[2]]};const kt=Dt,Ft={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(t,e,i){var n,r,s,o,a,l,h,u,c;return s=t[0],o=t[1],a=t[2],0===s?[0,0,0]:(e=e||"D65",i=i||2,n=o/(13*s)+4*(h=kt.whitepoint[i][e][0])/(h+15*(u=kt.whitepoint[i][e][1])+3*(c=kt.whitepoint[i][e][2]))||0,r=a/(13*s)+9*u/(h+15*u+3*c)||0,[9*(l=s>8?u*Math.pow((s+16)/116,3):u*s*.0011070564598794539)*n/(4*r)||0,l,l*(12-3*n-20*r)/(4*r)||0])}};kt.luv=function(t,e,i){var n,r,s,o,a,l,h,u,c,p,d;e=e||"D65",i=i||2,p=4*(h=kt.whitepoint[i][e][0])/(h+15*(u=kt.whitepoint[i][e][1])+3*(c=kt.whitepoint[i][e][2])),d=9*u/(h+15*u+3*c),n=4*(o=t[0])/(o+15*(a=t[1])+3*(l=t[2]))||0,r=9*a/(o+15*a+3*l)||0;var g=a/u;return[s=g<=.008856451679035631?903.2962962962961*g:116*Math.pow(g,1/3)-16,13*s*(n-p),13*s*(r-d)]};var Gt={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(t){var e,i=t[0],n=t[1];return e=t[2]/360*2*Math.PI,[i,n*Math.cos(e),n*Math.sin(e)]},xyz:function(t){return Ft.xyz(Gt.luv(t))}};const Ht=Gt;Ft.lchuv=function(t){var e=t[0],i=t[1],n=t[2],r=Math.sqrt(i*i+n*n),s=360*Math.atan2(n,i)/2/Math.PI;return s<0&&(s+=360),[e,r,s]},kt.lchuv=function(t){return Ft.lchuv(kt.luv(t))};const Vt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var jt={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};const zt={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,i,n,r,s,o=t[0]/360,a=t[1]/100,l=t[2]/100,h=0;if(0===a)return[s=255*l,s,s];for(e=2*l-(i=l<.5?l*(1+a):l+a-l*a),r=[0,0,0];h<3;)(n=o+1/3*-(h-1))<0?n++:n>1&&n--,s=6*n<1?e+6*(i-e)*n:2*n<1?i:3*n<2?e+(i-e)*(2/3-n)*6:e,r[h++]=255*s;return r}};function Bt(t,e,i){return Math.min(Math.max(t,e),i)}function Ut(t,e,i,n,r,s){const o=r-i,a=s-n;if(0!==o||0!==a){const l=((t-i)*o+(e-n)*a)/(o*o+a*a);l>1?(i=r,n=s):l>0&&(i+=o*l,n+=a*l)}return Zt(t,e,i,n)}function Zt(t,e,i,n){const r=i-t,s=n-e;return r*r+s*s}function Yt(t){return 180*t/Math.PI}function Wt(t){return t*Math.PI/180}function Xt(t,e){const i=t%e;return i*e<0?i+e:i}function qt(t,e,i){return t+i*(e-t)}function Kt(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i}function Jt(t,e){return Math.round(Kt(t,e))}function Qt(t,e){return Math.floor(Kt(t,e))}function $t(t,e){return Math.ceil(Kt(t,e))}function te(t){return"string"==typeof t?t:le(t)}Ot.hsl=function(t){var e,i,n=t[0]/255,r=t[1]/255,s=t[2]/255,o=Math.min(n,r,s),a=Math.max(n,r,s),l=a-o;return a===o?e=0:n===a?e=(r-s)/l:r===a?e=2+(s-n)/l:s===a&&(e=4+(n-r)/l),(e=Math.min(60*e,360))<0&&(e+=360),i=(o+a)/2,[e,100*(a===o?0:i<=.5?l/(a+o):l/(2-a-o)),100*i]};const ee={};let ie=0;function ne(t){if(4===t.length)return t;const e=t.slice();return e[3]=1,e}function re(t){const e=kt.lchuv(Ot.xyz(t));return e[3]=t[3],e}function se(t){if(ee.hasOwnProperty(t))return ee[t];if(ie>=1024){let t=0;for(const e in ee)3&t++||(delete ee[e],--ie)}const e=function(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw(...arguments)),t instanceof Number&&(t=+t);var i=function(t){var e,i,n=[],r=1;if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),Vt[t])n=Vt[t].slice(),i="rgb";else if("transparent"===t)r=0,i="rgb",n=[0,0,0];else if("#"===t[0]){var s=t.slice(1),o=s.length;r=1,o<=4?(n=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===o&&(r=parseInt(s[3]+s[3],16)/255)):(n=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===o&&(r=parseInt(s[6]+s[7],16)/255)),n[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0),i="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var a=e[1],l="cmyk"===(i=a.replace(/a$/,""))?4:"gray"===i?1:3;n=e[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===i&&(i=n.shift()),r=(n=n.map((function(t,e){if("%"===t[t.length-1])return t=parseFloat(t)/100,3===e?t:"rgb"===i?255*t:"h"===i[0]?100*t:"l"!==i[0]||e?"lab"===i?125*t:"lch"===i?e<2?150*t:360*t:"o"!==i[0]||e?"oklab"===i?.4*t:"oklch"===i?e<2?.4*t:360*t:t:t:100*t;if("h"===i[e]||2===e&&"h"===i[i.length-1]){if(void 0!==jt[t])return jt[t];if(t.endsWith("deg"))return parseFloat(t);if(t.endsWith("turn"))return 360*parseFloat(t);if(t.endsWith("grad"))return 360*parseFloat(t)/400;if(t.endsWith("rad"))return 180*parseFloat(t)/Math.PI}return"none"===t?0:parseFloat(t)}))).length>l?n.pop():1}else/[0-9](?:\s|\/|,)/.test(t)&&(n=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),i=t.match(/([a-z])/gi)?.join("")?.toLowerCase()||"rgb");return{space:i,values:n,alpha:r}}(t);if(!i.space)return[];const n="h"===i.space[0]?zt.min:Ot.min,r="h"===i.space[0]?zt.max:Ot.max;return(e=Array(3))[0]=Math.min(Math.max(i.values[0],n[0]),r[0]),e[1]=Math.min(Math.max(i.values[1],n[1]),r[1]),e[2]=Math.min(Math.max(i.values[2],n[2]),r[2]),"h"===i.space[0]&&(e=zt.rgb(e)),e.push(Math.min(Math.max(i.alpha,0),1)),e}(t);if(4!==e.length)throw new Error('Failed to parse "'+t+'" as color');for(const i of e)if(isNaN(i))throw new Error('Failed to parse "'+t+'" as color');return ae(e),ee[t]=e,++ie,e}function oe(t){return Array.isArray(t)?t:se(t)}function ae(t){return t[0]=Bt(t[0]+.5|0,0,255),t[1]=Bt(t[1]+.5|0,0,255),t[2]=Bt(t[2]+.5|0,0,255),t[3]=Bt(t[3],0,1),t}function le(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let i=t[1];i!=(0|i)&&(i=i+.5|0);let n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}function he(t,e,i){return e+":"+t+":"+(i?te(i):"null")}const ue=new class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];3&t++||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,i){const n=he(t,e,i);return n in this.cache_?this.cache_[n]:null}set(t,e,i,n){const r=he(t,e,i);this.cache_[r]=n,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}},ce="opacity",pe="visible",de="extent",ge="zIndex",fe="maxResolution",ye="minResolution",me="maxZoom",_e="minZoom",ve="source",Ce=class extends O{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[ce]=void 0!==t.opacity?t.opacity:1,q("number"==typeof e[ce],"Layer opacity must be a number"),e[pe]=void 0===t.visible||t.visible,e[ge]=t.zIndex,e[fe]=void 0!==t.maxResolution?t.maxResolution:1/0,e[ye]=void 0!==t.minResolution?t.minResolution:0,e[_e]=void 0!==t.minZoom?t.minZoom:-1/0,e[me]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=Bt(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i||e.managed?i:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return N()}getLayerStatesArray(t){return N()}getExtent(){return this.get(de)}getMaxResolution(){return this.get(fe)}getMinResolution(){return this.get(ye)}getMinZoom(){return this.get(_e)}getMaxZoom(){return this.get(me)}getOpacity(){return this.get(ce)}getSourceState(){return N()}getVisible(){return this.get(pe)}getZIndex(){return this.get(ge)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(de,t)}setMaxResolution(t){this.set(fe,t)}setMinResolution(t){this.set(ye,t)}setMaxZoom(t){this.set(me,t)}setMinZoom(t){this.set(_e,t)}setOpacity(t){q("number"==typeof t,"Layer opacity must be a number"),this.set(ce,t)}setVisible(t){this.set(pe,t)}setZIndex(t){this.set(ge,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},xe="prerender",we="postrender",Me="precompose",Ee="rendercomplete",Ie={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},Se=256,Le={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},be=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Le[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},Re=6378137,Ne=Math.PI*Re,Ae=[-Ne,-Ne,Ne,Ne],Te=[-180,-85,180,85],Pe=Re*Math.log(Math.tan(Math.PI/2));class Oe extends be{constructor(t){super({code:t,units:"m",extent:Ae,global:!0,worldExtent:Te,getPointResolution:function(t,e){return t/Math.cosh(e[1]/Re)}})}}const De=[new Oe("EPSG:3857"),new Oe("EPSG:102100"),new Oe("EPSG:102113"),new Oe("EPSG:900913"),new Oe("http://www.opengis.net/def/crs/EPSG/0/3857"),new Oe("http://www.opengis.net/gml/srs/epsg.xml#3857")];const ke=[-180,-90,180,90],Fe=6378137*Math.PI/180;class Ge extends be{constructor(t,e){super({code:t,units:"degrees",extent:ke,axisOrientation:e,global:!0,metersPerUnit:Fe,worldExtent:ke})}}const He=[new Ge("CRS:84"),new Ge("EPSG:4326","neu"),new Ge("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ge("urn:ogc:def:crs:OGC:2:84"),new Ge("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Ge("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ge("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Ve={},je={};function ze(t,e,i){const n=t.getCode(),r=e.getCode();n in je||(je[n]={}),je[n][r]=i}function Be(t,e){let i;return t in je&&e in je[t]&&(i=je[t][e]),i}function Ue(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function Ze(t,e){let i=!0;for(let n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function Ye(t,e){const i=Math.cos(e),n=Math.sin(e),r=t[0]*i-t[1]*n,s=t[1]*i+t[0]*n;return t[0]=r,t[1]=s,t}function We(t,e){return t[0]*=e,t[1]*=e,t}function Xe(t,e){if(e.canWrapX()){const i=Nt(e.getExtent()),n=qe(t,e,i);n&&(t[0]-=n*i)}return t}function qe(t,e,i){const n=e.getExtent();let r=0;return e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])&&(i=i||Nt(n),r=Math.floor((t[0]-n[0])/i)),r}const Ke=6371008.8;function Je(t,e,i){i=i||Ke;const n=Wt(t[1]),r=Wt(e[1]),s=(r-n)/2,o=Wt(e[0]-t[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(r);return 2*i*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function Qe(t,e,i,n){n=n||Ke;const r=Wt(t[1]),s=Wt(t[0]),o=e/n,a=Math.asin(Math.sin(r)*Math.cos(o)+Math.cos(r)*Math.sin(o)*Math.cos(i));return[Yt(s+Math.atan2(Math.sin(i)*Math.sin(o)*Math.cos(r),Math.cos(o)-Math.sin(r)*Math.sin(a))),Yt(a)]}const $e=2;let ti=1;function ei(...t){ti>$e||console.warn(...t)}let ii=!0;function ni(t,e){if(void 0!==e)for(let i=0,n=t.length;i<n;++i)e[i]=t[i];else e=t.slice();return e}function ri(t,e){if(void 0!==e&&t!==e){for(let i=0,n=t.length;i<n;++i)e[i]=t[i];t=e}return t}function si(t){!function(t,e){Ve[t]=e}(t.getCode(),t),ze(t,t,ni)}function oi(t){return"string"==typeof t?Ve[e=t]||Ve[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function ai(t,e,i,n){let r;const s=(t=oi(t)).getPointResolutionFunc();if(s){if(r=s(e,i),n&&n!==t.getUnits()){const e=t.getMetersPerUnit();e&&(r=r*e/Le[n])}}else{const s=t.getUnits();if("degrees"==s&&!n||"degrees"==n)r=e;else{const o=di(t,oi("EPSG:4326"));if(o===ri&&"degrees"!==s)r=e*t.getMetersPerUnit();else{let t=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];t=o(t,t,2),r=(Je(t.slice(0,2),t.slice(2,4))+Je(t.slice(4,6),t.slice(6,8)))/2}const a=n?Le[n]:t.getMetersPerUnit();void 0!==a&&(r/=a)}}return r}function li(t){!function(t){t.forEach(si)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&ze(e,t,ni)}))}))}function hi(t,e){return t?"string"==typeof t?oi(t):t:oi(e)}function ui(t){return function(e,i,n){const r=e.length;n=void 0!==n?n:2,i=void 0!==i?i:new Array(r);for(let s=0;s<r;s+=n){const r=t(e.slice(s,s+n)),o=r.length;for(let t=0,a=n;t<a;++t)i[s+t]=t>=o?e[s+t]:r[t]}return i}}function ci(t,e,i,n){const r=oi(t),s=oi(e);ze(r,s,ui(i)),ze(s,r,ui(n))}function pi(t,e){if(t===e)return!0;const i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||di(t,e)===ni)&&i}function di(t,e){let i=Be(t.getCode(),e.getCode());return i||(i=ri),i}function gi(t,e){return di(oi(t),oi(e))}function fi(t,e,i){return gi(e,i)(t,void 0,t.length)}function yi(t,e,i,n){return function(t,e,i,n){if(Tt(t))return ut(i);let r=[];if(n>1){const e=t[2]-t[0],i=t[3]-t[1];for(let s=0;s<n;++s)r.push(t[0]+e*s/n,t[1],t[2],t[1]+i*s/n,t[2]-e*s/n,t[3],t[0],t[3]-i*s/n)}else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);const s=[],o=[];for(let t=0,e=r.length;t<e;t+=2)s.push(r[t]),o.push(r[t+1]);return function(t,e,i){return ht(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}(s,o,i)}(t,gi(e,i),void 0,n)}let mi=null;function _i(){return mi}function vi(t,e){return t}function Ci(t,e){return ii&&!Ze(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(ii=!1,ei("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function xi(t,e){return t}function wi(t,e){return t}function Mi(t,e){return t}function Ei(t,e,i){return function(n){let r,s;if(t.canWrapX()){const e=t.getExtent(),o=Nt(e);s=qe(n=n.slice(0),t,o),s&&(n[0]=n[0]-s*o),n[0]=Bt(n[0],e[0],e[2]),n[1]=Bt(n[1],e[1],e[3]),r=i(n)}else r=i(n);return s&&e.canWrapX()&&(r[0]+=s*Nt(e.getExtent())),r}}var Ii,Si,Li;function bi(t,e,i){return function(n,r,s,o,a){if(!n)return;if(!r&&!e)return n;const l=e?0:s[0]*r,h=e?0:s[1]*r,u=a?a[0]:0,c=a?a[1]:0;let p=t[0]+l/2+u,d=t[2]-l/2+u,g=t[1]+h/2+c,f=t[3]-h/2+c;p>d&&(p=(d+p)/2,d=p),g>f&&(g=(f+g)/2,f=g);let y=Bt(n[0],p,d),m=Bt(n[1],g,f);if(o&&i&&r){const t=30*r;y+=-t*Math.log(1+Math.max(0,p-n[0])/t)+t*Math.log(1+Math.max(0,n[0]-d)/t),m+=-t*Math.log(1+Math.max(0,g-n[1])/t)+t*Math.log(1+Math.max(0,n[1]-f)/t)}return[y,m]}}function Ri(t){return t}function Ni(t,e,i,n){const r=Nt(e)/i[0],s=St(e)/i[1];return n?Math.min(t,Math.max(r,s)):Math.min(t,Math.min(r,s))}function Ai(t,e,i){let n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),Bt(n,i/2,2*e)}function Ti(t,e,i,n,r){return i=void 0===i||i,function(s,o,a,l){if(void 0!==s){const o=n?Ni(t,n,a,r):t;return i&&l?Ai(s,o,e):Bt(s,e,o)}}}function Pi(t){if(void 0!==t)return 0}function Oi(t){if(void 0!==t)return t}function Di(t){return Math.pow(t,3)}function ki(t){return 1-Di(1-t)}function Fi(t){return 3*t*t-2*t*t*t}function Gi(t){return t}function Hi(t,e,i,n,r,s){s=s||[];let o=0;for(let a=e;a<i;a+=n){const e=t[a],i=t[a+1];s[o++]=r[0]*e+r[2]*i+r[4],s[o++]=r[1]*e+r[3]*i+r[5]}return s&&s.length!=o&&(s.length=o),s}function Vi(t,e,i,n,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),h=s[0],u=s[1];let c=0;for(let r=e;r<i;r+=n){const e=t[r]-h,i=t[r+1]-u;o[c++]=h+e*a-i*l,o[c++]=u+e*l+i*a;for(let e=r+2;e<r+n;++e)o[c++]=t[e]}return o&&o.length!=c&&(o.length=c),o}li(De),li(He),Ii=De,Si=function(t,e,i){const n=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(n));for(let r=0;r<n;r+=i){e[r]=Ne*t[r]/180;let i=Re*Math.log(Math.tan(Math.PI*(+t[r+1]+90)/360));i>Pe?i=Pe:i<-Pe&&(i=-Pe),e[r+1]=i}return e},Li=function(t,e,i){const n=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(n));for(let r=0;r<n;r+=i)e[r]=180*t[r]/Ne,e[r+1]=360*Math.atan(Math.exp(t[r+1]/Re))/Math.PI-90;return e},He.forEach((function(t){Ii.forEach((function(e){ze(t,e,Si),ze(e,t,Li)}))}));const ji=[1,0,0,1,0,0],zi=class extends O{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=d(((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return N()}closestPointXY(t,e,i,n){return N()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return N()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&ut(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){N()}scale(t,e,i){N()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return N()}getType(){return N()}applyTransform(t){N()}intersectsExtent(t){return N()}translate(t,e){N()}transform(t,e){const i=oi(t),n="tile-pixels"==i.getUnits()?function(t,n,r){const s=i.getExtent(),o=i.getWorldExtent(),a=St(o)/St(s);return J(ji,o[0],o[3],a,-a,0,0,0),Hi(t,0,t.length,r,ji,n),gi(i,e)(t,n,r)}:gi(i,e);return this.applyTransform(n),this}};function Bi(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const Ui=class extends zi{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return pt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return N()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Bi(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){N()}setLayout(t,e,i){let n;if(t)n=Bi(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}n=e.length,t=function(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();Vi(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){void 0===e&&(e=t),i||(i=wt(this.getExtent()));const n=this.getFlatCoordinates();if(n){const r=this.getStride();!function(t,e,i,n,r,s,o,a){a=a||[];const l=o[0],h=o[1];let u=0;for(let e=0;e<i;e+=n){const i=t[e]-l,o=t[e+1]-h;a[u++]=l+r*i,a[u++]=h+s*o;for(let i=e+2;i<e+n;++i)a[u++]=t[i]}a&&a.length!=u&&(a.length=u)}(n,0,n.length,r,t,e,i,n),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();!function(t,e,i,n,r,s,o){o=o||[];let a=0;for(let e=0;e<i;e+=n){o[a++]=t[e]+r,o[a++]=t[e+1]+s;for(let i=e+2;i<e+n;++i)o[a++]=t[i]}o&&o.length!=a&&(o.length=a)}(i,0,i.length,n,t,e,i),this.changed()}}};function Zi(t,e,i,n,r,s,o){const a=t[e],l=t[e+1],h=t[i]-a,u=t[i+1]-l;let c;if(0===h&&0===u)c=e;else{const p=((r-a)*h+(s-l)*u)/(h*h+u*u);if(p>1)c=i;else{if(p>0){for(let r=0;r<n;++r)o[r]=qt(t[e+r],t[i+r],p);return void(o.length=n)}c=e}}for(let e=0;e<n;++e)o[e]=t[c+e];o.length=n}function Yi(t,e,i,n,r){let s=t[e],o=t[e+1];for(e+=n;e<i;e+=n){const i=t[e],n=t[e+1],a=Zt(s,o,i,n);a>r&&(r=a),s=i,o=n}return r}function Wi(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];r=Yi(t,e,o,n,r),e=o}return r}function Xi(t,e,i,n,r,s,o,a,l,h,u){if(e==i)return h;let c,p;if(0===r){if(p=Zt(o,a,t[e],t[e+1]),p<h){for(c=0;c<n;++c)l[c]=t[e+c];return l.length=n,p}return h}u=u||[NaN,NaN];let d=e+n;for(;d<i;)if(Zi(t,d-n,d,n,o,a,u),p=Zt(o,a,u[0],u[1]),p<h){for(h=p,c=0;c<n;++c)l[c]=u[c];l.length=n,d+=n}else d+=n*Math.max((Math.sqrt(p)-Math.sqrt(h))/r|0,1);if(s&&(Zi(t,i-n,e,n,o,a,u),p=Zt(o,a,u[0],u[1]),p<h)){for(h=p,c=0;c<n;++c)l[c]=u[c];l.length=n}return h}function qi(t,e,i,n,r,s,o,a,l,h,u){u=u||[NaN,NaN];for(let c=0,p=i.length;c<p;++c){const p=i[c];h=Xi(t,e,p,n,r,s,o,a,l,h,u),e=p}return h}function Ki(t,e,i,n){for(let r=0,s=i.length;r<s;++r){const s=i[r];for(let i=0;i<n;++i)t[e++]=s[i]}return e}function Ji(t,e,i,n,r){r=r||[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=Ki(t,e,i[o],n);r[s++]=a,e=a}return r.length=s,r}function Qi(t,e,i,n,r,s,o){const a=(i-e)/n;if(a<3){for(;e<i;e+=n)s[o++]=t[e],s[o++]=t[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[e,i-n];let u=0;for(;h.length>0;){const i=h.pop(),s=h.pop();let o=0;const a=t[s],c=t[s+1],p=t[i],d=t[i+1];for(let e=s+n;e<i;e+=n){const i=Ut(t[e],t[e+1],a,c,p,d);i>o&&(u=e,o=i)}o>r&&(l[(u-e)/n]=1,s+n<u&&h.push(s,u),u+n<i&&h.push(u,i))}for(let i=0;i<a;++i)l[i]&&(s[o++]=t[e+i*n],s[o++]=t[e+i*n+1]);return o}function $i(t,e,i,n,r,s,o,a){for(let l=0,h=i.length;l<h;++l){const h=i[l];o=Qi(t,e,h,n,r,s,o),a.push(o),e=h}return o}function tn(t,e){return e*Math.round(t/e)}function en(t,e,i,n,r,s,o){if(e==i)return o;let a,l,h=tn(t[e],r),u=tn(t[e+1],r);e+=n,s[o++]=h,s[o++]=u;do{if(a=tn(t[e],r),l=tn(t[e+1],r),(e+=n)==i)return s[o++]=a,s[o++]=l,o}while(a==h&&l==u);for(;e<i;){const i=tn(t[e],r),c=tn(t[e+1],r);if(e+=n,i==a&&c==l)continue;const p=a-h,d=l-u,g=i-h,f=c-u;p*f==d*g&&(p<0&&g<p||p==g||p>0&&g>p)&&(d<0&&f<d||d==f||d>0&&f>d)?(a=i,l=c):(s[o++]=a,s[o++]=l,h=a,u=l,a=i,l=c)}return s[o++]=a,s[o++]=l,o}function nn(t,e,i,n,r,s,o,a){for(let l=0,h=i.length;l<h;++l){const h=i[l];o=en(t,e,h,n,r,s,o),a.push(o),e=h}return o}function rn(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let o=e;o<i;o+=n)r[s++]=t.slice(o,o+n);return r.length=s,r}function sn(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=i[o];r[s++]=rn(t,e,a,n,r[s]),e=a}return r.length=s,r}function on(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=i[o];r[s++]=1===a.length&&a[0]===e?[]:sn(t,e,a,n,r[s]),e=a[a.length-1]}return r.length=s,r}function an(t,e,i,n){let r=0,s=t[i-n],o=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];r+=o*i-s*n,s=i,o=n}return r/2}function ln(t,e,i,n){let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s];r+=an(t,e,o,n),e=o}return r}class hn extends Ui{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new hn(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<rt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Yi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Xi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return an(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return rn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Qi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new hn(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ki(this.flatCoordinates,0,t,this.stride),this.changed()}}const un=hn;class cn extends Ui{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new cn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const r=this.flatCoordinates,s=Zt(t,e,r[0],r[1]);if(s<n){const t=this.stride;for(let e=0;e<t;++e)i[e]=r[e];return i.length=t,s}return n}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return ct(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return at(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,i){for(let n=0,r=i.length;n<r;++n)t[e++]=i[n];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}const pn=cn;function dn(t,e,i,n,r){return!_t(r,(function(r){return!gn(t,e,i,n,r[0],r[1])}))}function gn(t,e,i,n,r,s){let o=0,a=t[i-n],l=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];l<=s?n>s&&(i-a)*(s-l)-(r-a)*(n-l)>0&&o++:n<=s&&(i-a)*(s-l)-(r-a)*(n-l)<0&&o--,a=i,l=n}return 0!==o}function fn(t,e,i,n,r,s){if(0===i.length)return!1;if(!gn(t,e,i[0],n,r,s))return!1;for(let e=1,o=i.length;e<o;++e)if(gn(t,i[e-1],i[e],n,r,s))return!1;return!0}function yn(t,e,i,n,r,o,a){let l,h,u,c,p,d,g;const f=r[o+1],y=[];for(let r=0,s=i.length;r<s;++r){const s=i[r];for(c=t[s-n],d=t[s-n+1],l=e;l<s;l+=n)p=t[l],g=t[l+1],(f<=d&&g<=f||d<=f&&f<=g)&&(u=(f-d)/(g-d)*(p-c)+c,y.push(u)),c=p,d=g}let m=NaN,_=-1/0;for(y.sort(s),c=y[0],l=1,h=y.length;l<h;++l){p=y[l];const r=Math.abs(p-c);r>_&&(u=(c+p)/2,fn(t,e,i,n,u,f)&&(m=u,_=r)),c=p}return isNaN(m)&&(m=r[o]),a?(a.push(m,f,_),a):[m,f,_]}function mn(t,e,i,n,r){let s=[];for(let o=0,a=i.length;o<a;++o){const a=i[o];s=yn(t,e,a,n,r,2*o,s),e=a[a.length-1]}return s}function _n(t,e,i,n,r){let s;for(e+=n;e<i;e+=n)if(s=r(t.slice(e-n,e),t.slice(e,e+n)),s)return s;return!1}function vn(t,e,i,n,r){const s=yt([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!At(r,s)&&(!!ot(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]||_n(t,e,i,n,(function(t,e){return function(t,e,i){let n=!1;const r=lt(t,e),s=lt(t,i);if(1===r||1===s)n=!0;else{const o=t[0],a=t[1],l=t[2],h=t[3],u=e[0],c=e[1],p=i[0],d=i[1],g=(d-c)/(p-u);let f,y;2&s&&!(2&r)&&(f=p-(d-h)/g,n=f>=o&&f<=l),n||!(4&s)||4&r||(y=d-(p-l)*g,n=y>=a&&y<=h),n||!(8&s)||8&r||(f=p-(d-a)/g,n=f>=o&&f<=l),n||!(16&s)||16&r||(y=d-(p-o)*g,n=y>=a&&y<=h)}return n}(r,t,e)})))}function Cn(t,e,i,n,r){return!!(vn(t,e,i,n,r)||gn(t,e,i,n,r[0],r[1])||gn(t,e,i,n,r[0],r[3])||gn(t,e,i,n,r[2],r[1])||gn(t,e,i,n,r[2],r[3]))}function xn(t,e,i,n,r){if(!Cn(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(let e=1,s=i.length;e<s;++e)if(dn(t,i[e-1],i[e],n,r)&&!vn(t,i[e-1],i[e],n,r))return!1;return!0}function wn(t,e,i,n){for(;e<i-n;){for(let r=0;r<n;++r){const s=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=s}e+=n,i-=n}}function Mn(t,e,i,n){let r=0,s=t[i-n],o=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];r+=(i-s)*(n+o),s=i,o=n}return 0===r?void 0:r>0}function En(t,e,i,n,r){r=void 0!==r&&r;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=Mn(t,e,o,n);if(0===s){if(r&&a||!r&&!a)return!1}else if(r&&!a||!r&&a)return!1;e=o}return!0}function In(t,e,i,n,r){r=void 0!==r&&r;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=Mn(t,e,o,n);(0===s?r&&a||!r&&!a:r&&!a||!r&&a)&&wn(t,e,o,n),e=o}return e}function Sn(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s)e=In(t,e,i[s],n,r);return e}class Ln extends Ui{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?l(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Ln(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<rt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Wi(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qi(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return fn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return ln(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),In(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,sn(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=wt(this.getExtent());this.flatInteriorPoint_=yn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new pn(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new un(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=new un(e.slice(r,o),t);n.push(a),r=o}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;En(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=In(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=nn(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Ln(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return xn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Ji(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const bn=Ln;function Rn(t){if(Tt(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],i=t[1],n=t[2],r=t[3],s=[e,i,e,r,n,r,n,i,e,i];return new Ln(s,"XY",[s.length])}function Nn(t,e){setTimeout((function(){t(e)}),0)}function An(t){return!(t.sourceCenter&&t.targetCenter&&!Ze(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function Tn(t,e,i,n,r){const s=Math.cos(-r);let o=Math.sin(-r),a=t[0]*s-t[1]*o,l=t[1]*s+t[0]*o;return a+=(e[0]/2-i[0])*n,l+=(i[1]-e[1]/2)*n,o=-o,[a*s-l*o,l*s+a*o]}const Pn=class extends O{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=hi(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&function(t){ii=!(void 0===t||t)}(),t.center&&(t.center=Ci(t.center,this.projection_)),t.extent&&(t.extent=wi(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const t in Ie)delete e[t];this.setProperties(e,!0);const i=function(t){let e,i,n;let r=void 0!==t.minZoom?t.minZoom:0,s=void 0!==t.maxZoom?t.maxZoom:28;const a=void 0!==t.zoomFactor?t.zoomFactor:2,l=void 0!==t.multiWorld&&t.multiWorld,h=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,u=void 0!==t.showFullExtent&&t.showFullExtent,c=hi(t.projection,"EPSG:3857"),p=c.getExtent();let d=t.constrainOnlyCenter,g=t.extent;if(l||g||!c.isGlobal()||(d=!1,g=p),void 0!==t.resolutions){const a=t.resolutions;i=a[r],n=void 0!==a[s]?a[s]:a[a.length-1],e=t.constrainResolution?function(t,e,i,n){return e=void 0===e||e,function(r,s,a,l){if(void 0!==r){const h=t[0],u=t[t.length-1],c=i?Ni(h,i,a,n):h;if(l)return e?Ai(r,c,u):Bt(r,u,c);const p=Math.min(c,r),d=Math.floor(o(t,p,s));return t[d]>c&&d<t.length-1?t[d+1]:t[d]}}}(a,h,!d&&g,u):Ti(i,n,h,!d&&g,u)}else{const o=(p?Math.max(Nt(p),St(p)):360*Le.degrees/c.getMetersPerUnit())/256/Math.pow(2,0),l=o/Math.pow(2,28);i=t.maxResolution,void 0!==i?r=0:i=o/Math.pow(a,r),n=t.minResolution,void 0===n&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(a,s):o/Math.pow(a,s):l),s=r+Math.floor(Math.log(i/n)/Math.log(a)),n=i/Math.pow(a,s-r),e=t.constrainResolution?function(t,e,i,n,r,s){return n=void 0===n||n,i=void 0!==i?i:0,function(o,a,l,h){if(void 0!==o){const u=r?Ni(e,r,l,s):e;if(h)return n?Ai(o,u,i):Bt(o,i,u);const c=1e-9,p=Math.ceil(Math.log(e/u)/Math.log(t)-c),d=-a*(.5-c)+.5,g=Math.min(u,o),f=Math.floor(Math.log(e/g)/Math.log(t)+d),y=Math.max(p,f);return Bt(e/Math.pow(t,y),i,u)}}}(a,i,n,h,!d&&g,u):Ti(i,n,h,!d&&g,u)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:r,zoomFactor:a}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const n=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return bi(t.extent,t.constrainOnlyCenter,e)}const e=hi(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,bi(t,!1,!1)}return Ri}(t),r=i.constraint,s=function(t){if(void 0===t.enableRotation||t.enableRotation){const e=t.constrainRotation;return void 0===e||!0===e?function(){const t=Wt(5);return function(e,i){return i||void 0===e?e:Math.abs(e)<=t?0:e}}():!1===e?Oi:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):Oi}return Pi}(t);this.constraints_={center:n,resolution:r,rotation:s},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const n=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),s=r/2*(n[3]-e[3]+e[1]-n[1]),o=r/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([i[0]+s,i[1]-o])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let i=arguments[t];i.center&&(i=Object.assign({},i),i.center=Ci(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Ci(i.anchor,this.getProjection())),e[t]=i}this.animateInternal.apply(this,e)}animateInternal(t){let e,i=arguments.length;i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i);let n=0;for(;n<i&&!this.isDef();++n){const t=arguments[n];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(n===i)return void(e&&Nn(e,!0));let r=Date.now(),s=this.targetCenter_.slice(),o=this.targetResolution_,a=this.targetRotation_;const l=[];for(;n<i;++n){const t=arguments[n],i={start:r,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||Fi,callback:e};if(t.center&&(i.sourceCenter=s,i.targetCenter=t.center.slice(),s=i.targetCenter),void 0!==t.zoom?(i.sourceResolution=o,i.targetResolution=this.getResolutionForZoom(t.zoom),o=i.targetResolution):t.resolution&&(i.sourceResolution=o,i.targetResolution=t.resolution,o=i.targetResolution),void 0!==t.rotation){i.sourceRotation=a;const e=Xt(t.rotation-a+Math.PI,2*Math.PI)-Math.PI;i.targetRotation=a+e,a=i.targetRotation}An(i)?i.complete=!0:r+=i.duration,l.push(i)}this.animations_.push(l),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,i=this.animations_.length;e<i;++e){const i=this.animations_[e];if(i[0].callback&&Nn(i[0].callback,!1),!t)for(let e=0,n=i.length;e<n;++e){const n=i[e];if(!n.complete){t=n.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let r=!0;for(let i=0,s=n.length;i<s;++i){const s=n[i];if(s.complete)continue;const o=t-s.start;let a=s.duration>0?o/s.duration:1;a>=1?(s.complete=!0,a=1):r=!1;const l=s.easing(a);if(s.sourceCenter){const t=s.sourceCenter[0],e=s.sourceCenter[1],i=s.targetCenter[0],n=s.targetCenter[1];this.nextCenter_=s.targetCenter;const r=t+l*(i-t),o=e+l*(n-e);this.targetCenter_=[r,o]}if(s.sourceResolution&&s.targetResolution){const t=1===l?s.targetResolution:s.sourceResolution+l*(s.targetResolution-s.sourceResolution);if(s.anchor){const e=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(i,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===l?Xt(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+l*(s.targetRotation-s.sourceRotation);if(s.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!s.complete)break}if(r){this.animations_[i]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=n[0].callback;t&&Nn(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();return void 0!==n&&(i=[n[0]-e[0],n[1]-e[1]],Ye(i,t-this.getRotation()),Ue(i,e)),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),r=this.getResolution();return void 0!==n&&void 0!==r&&(i=[e[0]-t*(e[0]-n[0])/r,e[1]-t*(e[1]-n[1])/r]),i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?vi(t,this.getProjection()):t}getCenterInternal(){return this.get(Ie.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return xi(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();q(e,"The view center is not defined");const i=this.getResolution();q(void 0!==i,"The view resolution is not defined");const n=this.getRotation();return q(void 0!==n,"The view rotation is not defined"),Et(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Ie.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(wi(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=Nt(t)/e[0],n=St(t)/e[1];return Math.max(i,n)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(t);return function(i){return e/Math.pow(t,i*n)}}getRotation(){return this.get(Ie.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(i/n)/e;return function(t){return Math.log(i/t)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const r=this.padding_;if(r){const t=this.getViewportSizeMinusPadding_();n=Tn(n,this.getViewportSize_(),[t[0]/2+r[3],t[1]/2+r[0]],e,i)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,i,n=this.minZoom_||0;if(this.resolutions_){const r=o(this.resolutions_,t,1);n=r,e=this.resolutions_[r],i=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=Bt(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,Bt(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(q(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))q(!Tt(t),"Cannot fit empty extent provided as `geometry`"),i=Rn(wi(t,this.getProjection()));else if("Circle"===t.getType()){const e=wi(t.getExtent(),this.getProjection());i=Rn(e),i.rotate(this.getRotation(),wt(e))}else{const e=_i();i=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),r=t.getFlatCoordinates(),s=t.getStride();let o=1/0,a=1/0,l=-1/0,h=-1/0;for(let t=0,e=r.length;t<e;t+=s){const e=r[t]*i-r[t+1]*n,s=r[t]*n+r[t+1]*i;o=Math.min(o,e),a=Math.min(a,s),l=Math.max(l,e),h=Math.max(h,s)}return[o,a,l,h]}fitInternal(t,e){let i=(e=e||{}).size;i||(i=this.getViewportSizeMinusPadding_());const n=void 0!==e.padding?e.padding:[0,0,0,0],r=void 0!==e.nearest&&e.nearest;let s;s=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const o=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(o,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);a=isNaN(a)?s:Math.max(a,s),a=this.getConstrainedResolution(a,r?0:1);const l=this.getRotation(),h=Math.sin(l),u=Math.cos(l),c=wt(o);c[0]+=(n[1]-n[3])/2*a,c[1]+=(n[0]-n[2])/2*a;const d=c[0]*u-c[1]*h,g=c[1]*u+c[0]*h,f=this.getConstrainedCenter([d,g],a),y=e.callback?e.callback:p;void 0!==e.duration?this.animateInternal({resolution:a,center:f,duration:e.duration,easing:e.easing},y):(this.targetResolution_=a,this.targetCenter_=f,this.applyTargetState_(!1,!0),Nn(y,!0))}centerOn(t,e,i){this.centerOnInternal(Ci(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(Tn(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let r;const s=this.padding_;if(s&&t){const o=this.getViewportSizeMinusPadding_(-i),a=Tn(t,n,[o[0]/2+s[3],o[1]/2+s[0]],e,i);r=[t[0]-a[0],t[1]-a[1]]}return r}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=vi(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Ci(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Ci(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?Ci(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(n),s=this.constraints_.resolution(this.targetResolution_,0,r,i),o=this.constraints_.center(this.targetCenter_,s,r,i,this.calculateCenterShift(this.targetCenter_,s,n,r));this.get(Ie.ROTATION)!==n&&this.set(Ie.ROTATION,n),this.get(Ie.RESOLUTION)!==s&&(this.set(Ie.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),o&&this.get(Ie.CENTER)&&Ze(this.get(Ie.CENTER),o)||this.set(Ie.CENTER,o),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=void 0!==t?t:200;const n=e||0,r=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,n,s),a=this.constraints_.center(this.targetCenter_,o,s,!1,this.calculateCenterShift(this.targetCenter_,o,r,s));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=o,this.targetRotation_=r,this.targetCenter_=a,void this.applyTargetState_();i=i||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===o&&this.getRotation()===r&&this.getCenterInternal()&&Ze(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:a,resolution:o,duration:t,easing:ki,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,i){i=i&&Ci(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}};function On(t,e){if(!t.visible)return!1;const i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;const n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}const Dn=class extends Ce{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(ve,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(ve)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(S(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=E(t,m,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const i=this.getMapInternal();let n;!t&&i&&(t=i.getView()),e=t instanceof Pn?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray()),n=e.layerStatesArray?e.layerStatesArray.find((t=>t.layer===this)):this.getLayerState();const r=this.getExtent();return On(n,e.viewState)&&(!r||At(r,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const i=this.getSource();if(i&&(e=i.getAttributions()),!e)return[];let n=e(t instanceof Pn?t.getViewStateAndExtent():t);return Array.isArray(n)||(n=[n]),n}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(S(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(S(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=E(t,Me,(function(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);q(!e.some((function(t){return t.layer===i.layer})),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}),this),this.mapRenderKey_=E(this,m,t.render,t),this.changed())}setSource(t){this.set(ve,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function kn(t,e){ue.expire()}const Fn=class extends r{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){N()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;J(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Q(n,i)}forEachFeatureAtCoordinate(t,e,i,n,r,s,o,a){let l;const h=e.viewState;function u(t,e,i,n){return r.call(s,e,t?i:null,n)}const c=h.projection,p=Xe(t.slice(),c),d=[[0,0]];if(c.canWrapX()&&n){const t=Nt(c.getExtent());d.push([-t,0],[t,0])}const g=e.layerStatesArray,f=g.length,y=[],m=[];for(let n=0;n<d.length;n++)for(let r=f-1;r>=0;--r){const s=g[r],c=s.layer;if(c.hasRenderer()&&On(s,h)&&o.call(a,c)){const r=c.getRenderer(),o=c.getSource();if(r&&o){const a=o.getWrapX()?p:t,h=u.bind(null,s.managed);m[0]=a[0]+d[n][0],m[1]=a[1]+d[n][1],l=r.forEachFeatureAtCoordinate(m,e,i,h,y)}if(l)return l}}if(0===y.length)return;const _=1/y.length;return y.forEach(((t,e)=>t.distanceSq+=e*_)),y.sort(((t,e)=>t.distanceSq-e.distanceSq)),y.some((t=>l=t.callback(t.feature,t.layer,t.geometry))),l}hasFeatureAtCoordinate(t,e,i,n,r,s){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,u,this,r,s)}getMap(){return this.map_}renderFrame(t){N()}flushDeclutterItems(t){}scheduleExpireIconCache(t){ue.canExpireCache()&&t.postRenderFunctions.push(kn)}},Gn=class extends t{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}},Hn="ol-hidden",Vn="ol-unselectable",jn="ol-control",zn="ol-collapsed",Bn=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),Un=["style","variant","weight","size","lineHeight","family"],Zn=function(t){const e=t.match(Bn);if(!e)return null;const i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let t=0,n=Un.length;t<n;++t){const n=e[t+1];void 0!==n&&(i[Un[t]]=n)}return i.families=i.family.split(/,\s?/),i};function Yn(t,e,i,n){let r;return r=i&&i.length?i.shift():Z?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(r.width=t),e&&(r.height=e),r.getContext("2d",n)}function Wn(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function Xn(t){let e=t.offsetWidth;const i=getComputedStyle(t);return e+=parseInt(i.marginLeft,10)+parseInt(i.marginRight,10),e}function qn(t){let e=t.offsetHeight;const i=getComputedStyle(t);return e+=parseInt(i.marginTop,10)+parseInt(i.marginBottom,10),e}function Kn(t,e){const i=e.parentNode;i&&i.replaceChild(t,e)}function Jn(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function Qn(t){for(;t.lastChild;)t.removeChild(t.lastChild)}const $n="10px sans-serif",tr="#000",er="round",ir=[],nr="round",rr="#000",sr="center",or="middle",ar=[0,0,0,0],lr=new O;let hr,ur=null;const cr={},pr=function(){const t="32px ",e=["monospace","serif"],i=e.length,n="wmytzilWMYTZIL@#/&?$%10";let r,s;function o(r,o,a){let l=!0;for(let h=0;h<i;++h){const i=e[h];if(s=fr(r+" "+o+" "+t+i,n),a!=i){const e=fr(r+" "+o+" "+t+a+","+i,n);l=l&&e!=s}}return!!l}function a(){let t=!0;const e=lr.getKeys();for(let i=0,n=e.length;i<n;++i){const n=e[i];lr.get(n)<100&&(o.apply(this,n.split("\n"))?(g(cr),ur=null,hr=void 0,lr.set(n,100)):(lr.set(n,lr.get(n)+1,!0),t=!1))}t&&(clearInterval(r),r=void 0)}return function(t){const e=Zn(t);if(!e)return;const i=e.families;for(let t=0,n=i.length;t<n;++t){const n=i[t],s=e.style+"\n"+e.weight+"\n"+n;void 0===lr.get(s)&&(lr.set(s,100,!0),o(e.style,e.weight,n)||(lr.set(s,0,!0),void 0===r&&(r=setInterval(a,32))))}}}(),dr=function(){let t;return function(e){let i=cr[e];if(null==i){if(Z){const t=Zn(e),n=gr(e,"Žg");i=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),i=t.offsetHeight,document.body.removeChild(t);cr[e]=i}return i}}();function gr(t,e){return ur||(ur=Yn(1,1)),t!=hr&&(ur.font=t,hr=ur.font),ur.measureText(e)}function fr(t,e){return gr(t,e).width}function yr(t,e,i){if(e in i)return i[e];const n=e.split("\n").reduce(((e,i)=>Math.max(e,fr(t,i))),0);return i[e]=n,n}const mr=class extends Fn{constructor(t){super(t),this.fontChangeListenerKey_=E(lr,e,t.redrawText.bind(t)),this.element_=document.createElement("div");const i=this.element_.style;i.position="absolute",i.width="100%",i.height="100%",i.zIndex="0",this.element_.className=Vn+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0,this.declutterLayers_=[]}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const n=new Gn(t,void 0,e);i.dispatchEvent(n)}}disposeInternal(){S(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(Me,t);const e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),i=t.viewState;this.children_.length=0;const n=this.declutterLayers_;n.length=0;let r=null;for(let s=0,o=e.length;s<o;++s){const o=e[s];t.layerIndex=s;const a=o.layer,l=a.getSourceState();if(!On(o,i)||"ready"!=l&&"undefined"!=l){a.unrender();continue}const h=a.render(t,r);h&&(h!==r&&(this.children_.push(h),r=h),"getDeclutter"in a&&n.push(a))}this.flushDeclutterItems(t),function(t,e){const i=t.childNodes;for(let n=0;;++n){const r=i[n],s=e[n];if(!r&&!s)break;r!==s&&(r?s?t.insertBefore(s,r):(t.removeChild(r),--n):t.appendChild(s))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}flushDeclutterItems(t){const e=this.declutterLayers_;for(let i=e.length-1;i>=0;--i)e[i].renderDeclutter(t);e.length=0}};class _r extends t{constructor(t,e){super(t),this.layer=e}}const vr="layers";class Cr extends Ce{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(vr,this.handleLayersChanged_),i?Array.isArray(i)?i=new H(i.slice(),{unique:!0}):q("function"==typeof i.getArray,"Expected `layers` to be an array or a `Collection`"):i=new H(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(S),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(E(t,D,this.handleLayersAdd_,this),E(t,k,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(S);g(this.listenerKeys_);const e=t.getArray();for(let t=0,i=e.length;t<i;t++){const i=e[t];this.registerLayerListeners_(i),this.dispatchEvent(new _r("addlayer",i))}this.changed()}registerLayerListeners_(t){const i=[E(t,e,this.handleLayerChange_,this),E(t,m,this.handleLayerChange_,this)];t instanceof Cr&&i.push(E(t,"addlayer",this.handleLayerGroupAdd_,this),E(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[T(t)]=i}handleLayerGroupAdd_(t){this.dispatchEvent(new _r("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new _r("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new _r("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=T(e);this.listenerKeys_[i].forEach(S),delete this.listenerKeys_[i],this.dispatchEvent(new _r("removelayer",e)),this.changed()}getLayers(){return this.get(vr)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,i=t.length;e<i;++e)this.dispatchEvent(new _r("removelayer",t[e]))}this.set(vr,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const n=this.getLayerState();let r=n.zIndex;t||void 0!==n.zIndex||(r=0);for(let t=i,s=e.length;t<s;t++){const i=e[t];i.opacity*=n.opacity,i.visible=i.visible&&n.visible,i.maxResolution=Math.min(i.maxResolution,n.maxResolution),i.minResolution=Math.max(i.minResolution,n.minResolution),i.minZoom=Math.max(i.minZoom,n.minZoom),i.maxZoom=Math.min(i.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==i.extent?i.extent=Lt(i.extent,n.extent):i.extent=n.extent),void 0===i.zIndex&&(i.zIndex=r)}return e}getSourceState(){return"ready"}}const xr=Cr,wr=class extends t{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}},Mr=class extends wr{constructor(t,e,i,n,r,s){super(t,e,r),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==n&&n,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},Er={SINGLECLICK:"singleclick",CLICK:v,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Ir="pointerdown",Sr=class extends y{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=E(i,Ir,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=E(i,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(w,this.boundHandleTouchMove_,!!X&&{passive:!1})}emulateClick_(t){let e=new Mr(Er.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Mr(Er.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new Mr(Er.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==Er.POINTERUP||e.type==Er.POINTERCANCEL){delete this.trackedTouches_[i];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=Er.POINTERDOWN&&e.type!=Er.POINTERMOVE||(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new Mr(Er.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(S),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new Mr(Er.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(E(t,Er.POINTERMOVE,this.handlePointerMove_,this),E(t,Er.POINTERUP,this.handlePointerUp_,this),E(this.element_,Er.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(E(this.element_.getRootNode(),Er.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new Mr(Er.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Mr(Er.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(S(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(w,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(S(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(S),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},Lr="postrender",br="loadstart",Rr="loadend",Nr="layergroup",Ar="size",Tr="target",Pr="view",Or=1/0,Dr=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,g(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(t){q(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=Or&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,r=e[t],s=i[t],o=t;for(;t<n>>1;){const r=this.getLeftChildIndex_(t),s=this.getRightChildIndex_(t),o=s<n&&i[s]<i[r]?s:r;e[t]=e[o],i[t]=i[o],t=o}e[t]=r,i[t]=s,this.siftDown_(o,t)}siftDown_(t,e){const i=this.elements_,n=this.priorities_,r=i[e],s=n[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(n[t]>s))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=r,n[e]=s}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;const r=e.length;let s,o,a;for(o=0;o<r;++o)s=e[o],a=t(s),a==Or?delete this.queuedElements_[this.keyFunction_(s)]:(i[n]=a,e[n++]=s);e.length=n,i.length=n,this.heapify_()}},kr=class extends Dr{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(m,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(2===i||3===i||4===i){3!==i&&e.removeEventListener(m,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i,n,r,s=0;for(;this.tilesLoading_<t&&s<e&&this.getCount()>0;)n=this.dequeue()[0],r=n.getKey(),i=n.getState(),0!==i||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++s,n.load())}},Fr=class extends O{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){Jn(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&Jn(this.element);for(let t=0,e=this.listenerKeys.length;t<e;++t)S(this.listenerKeys[t]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==p&&this.listenerKeys.push(E(t,Lr,this.render,this)),t.render())}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},Gr=class extends Fr{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",n=void 0!==t.expandClassName?t.expandClassName:e+"-expand",r=void 0!==t.collapseLabel?t.collapseLabel:"›",s=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof r?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=s):this.collapseLabel_=r;const o=void 0!==t.label?t.label:"i";"string"==typeof o?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=n):this.label_=o;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(v,this.handleClick_.bind(this),!1);const l=e+" "+Vn+" "+jn+(this.collapsed_&&this.collapsible_?" "+zn:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=l,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap((e=>e.getAttributions(t))))),i=!this.getMap().getAllLayers().some((t=>t.getSource()&&!1===t.getSource().getAttributionsCollapsible()));return this.overrideCollapsible_||this.setCollapsible(i),e}updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!h(e,this.renderedAttributions_)){Qn(this.ulElement_);for(let t=0,i=e.length;t<i;++t){const i=document.createElement("li");i.innerHTML=e[t],this.ulElement_.appendChild(i)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(zn),this.collapsed_?Kn(this.collapseLabel_,this.label_):Kn(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},Hr=class extends Fr{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",i=void 0!==t.label?t.label:"⇧",n=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const r=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=e+"-reset",s.setAttribute("type","button"),s.title=r,s.appendChild(this.label_),s.addEventListener(v,this.handleClick_.bind(this),!1);const o=e+" "+Vn+" "+jn,a=this.element;a.className=o,a.appendChild(s),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Hn)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:ki}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(Hn);t||0!==i?t&&0!==i&&this.element.classList.remove(Hn):this.element.classList.add(Hn)}this.label_.style.transform=t}this.rotation_=i}},Vr=class extends Fr{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,n=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",r=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",s=void 0!==t.zoomInLabel?t.zoomInLabel:"+",o=void 0!==t.zoomOutLabel?t.zoomOutLabel:"–",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",l=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=n,h.setAttribute("type","button"),h.title=a,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(v,this.handleClick_.bind(this,i),!1);const u=document.createElement("button");u.className=r,u.setAttribute("type","button"),u.title=l,u.appendChild("string"==typeof o?document.createTextNode(o):o),u.addEventListener(v,this.handleClick_.bind(this,-i),!1);const c=e+" "+Vn+" "+jn,p=this.element;p.className=c,p.appendChild(h),p.appendChild(u),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(void 0!==i){const n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:ki})):e.setZoom(n)}}};function jr(t){t=t||{};const e=new H;return(void 0===t.zoom||t.zoom)&&e.push(new Vr(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new Hr(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new Gr(t.attributionOptions)),e}const zr="active";function Br(t,e,i,n){const r=t.getZoom();if(void 0===r)return;const s=t.getConstrainedZoom(r+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:i,duration:void 0!==n?n:250,easing:ki})}const Ur=class extends O{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(zr)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(zr,t)}setMap(t){this.map_=t}},Zr=class extends Ur{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==Er.DBLCLICK){const i=t.originalEvent,n=t.map,r=t.coordinate,s=i.shiftKey?-this.delta_:this.delta_;Br(n.getView(),s,r,this.duration_),i.preventDefault(),e=!0}return!e}};function Yr(t){const e=t.length;let i=0,n=0;for(let r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return{clientX:i/e,clientY:n/e}}const Wr=class extends Ur{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Er.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Er.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==Er.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==Er.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function Xr(t){const e=arguments;return function(t){let i=!0;for(let n=0,r=e.length;n<r&&(i=i&&e[n](t),i);++n);return i}}const qr=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Kr=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),i=t.map.getOwnerDocument().activeElement;return e.contains(i)}(t)},Jr=u,Qr=function(t){const e=t.originalEvent;return 0==e.button&&!(z&&B&&e.ctrlKey)},$r=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},ts=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},es=function(t){const e=t.originalEvent,i=e.target.tagName;return"INPUT"!==i&&"SELECT"!==i&&"TEXTAREA"!==i&&!e.target.isContentEditable},is=function(t){const e=t.originalEvent;return q(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"mouse"==e.pointerType},ns=function(t){const e=t.originalEvent;return q(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"touch"===e.pointerType},rs=function(t){const e=t.originalEvent;return q(void 0!==e,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&0===e.button},ss=class extends Wr{constructor(t){super({stopDown:c}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Xr($r,rs);this.condition_=t.onFocusOnly?Xr(Kr,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,n=e.getEventPixel(Yr(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){const e=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],i=t.map.getView();We(e,i.getResolution()),Ye(e,i.getRotation()),i.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),r=i.getCenterInternal(),s=e.getPixelFromCoordinateInternal(r),o=e.getCoordinateFromPixelInternal([s[0]-t*Math.cos(n),s[1]-t*Math.sin(n)]);i.animateInternal({center:i.getConstrainedCenter(o),duration:500,easing:ki})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},os=class extends Wr{constructor(t){t=t||{},super({stopDown:c}),this.condition_=t.condition?t.condition:qr,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!is(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===Pi)return;const n=e.getSize(),r=t.pixel,s=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;i.adjustRotationInternal(-t)}this.lastAngle_=s}handleUpEvent(t){return!is(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!is(t)&&(!(!Qr(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}},as=class extends r{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new bn([i])}getGeometry(){return this.geometry_}};class ls extends t{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}const hs=class extends Wr{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new as(t.className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:Qr,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new ls("boxdrag",t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new ls(e?"boxend":"boxcancel",t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ls("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}},us=class extends hs{constructor(t){super({condition:(t=t||{}).condition?t.condition:ts,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(i),n=e.getResolutionForExtentInternal(t),r=e.getResolution()/n;i=i.clone(),i.scale(r*r)}e.fitInternal(i,{duration:this.duration_,easing:ki})}},cs="ArrowLeft",ps="ArrowRight",ds="ArrowDown",gs=class extends Ur{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return $r(t)&&es(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==C){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&(n==ds||n==cs||n==ps||"ArrowUp"==n)){const r=t.map.getView(),s=r.getResolution()*this.pixelDelta_;let o=0,a=0;n==ds?a=-s:n==cs?o=-s:n==ps?o=s:a=s;const l=[o,a];Ye(l,r.getRotation()),function(t,e,i){const n=t.getCenterInternal();if(n){const r=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:Gi,center:t.getConstrainedCenter(r)})}}(r,l,this.duration_),i.preventDefault(),e=!0}}return!e}},fs=class extends Ur{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(t){return!function(t){const e=t.originalEvent;return B?e.metaKey:e.ctrlKey}(t)&&es(t)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==C||t.type==x){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&("+"===n||"-"===n)){const r=t.map,s="+"===n?this.delta_:-this.delta_;Br(r.getView(),s,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}},ys=class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;const r=this.points_[e]-this.points_[i],s=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(s,r),this.initialVelocity_=Math.sqrt(r*r+s*s)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},ms=class extends Ur{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:Jr;this.condition_=t.onFocusOnly?Xr(Kr,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==M)return!0;const e=t.map,i=t.originalEvent;let n;if(i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==M&&(n=i.deltaY,j&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(n/=U),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(n*=40)),0===n)return!1;this.lastDelta_=n;const r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(n)<4?"trackpad":"wheel");const s=e.getView();if("trackpad"===this.mode_&&!s.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-n/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=n;const o=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),o),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-Bt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Br(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},_s=class extends Wr{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=c),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){const t=r-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=r;const s=t.map,o=s.getView();o.getConstraints().rotation!==Pi&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(Yr(this.targetPointers))),this.rotating_&&(s.render(),o.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},vs=class extends Wr{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=c),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,s=i.clientY-n.clientY,o=Math.sqrt(r*r+s*s);void 0!==this.lastDistance_&&(e=this.lastDistance_/o),this.lastDistance_=o;const a=t.map,l=a.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(Yr(this.targetPointers))),a.render(),l.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function Cs(t){t=t||{};const e=new H,i=new ys(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new os),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new Zr({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new ss({onFocusOnly:t.onFocusOnly,kinetic:i})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new _s),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new vs({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new gs),e.push(new fs({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new ms({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new us({duration:t.zoomDuration})),e}function xs(t){return t[0]>0&&t[1]>0}function ws(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function Ms(t){t instanceof Dn?t.setMapInternal(null):t instanceof xr&&t.getLayers().forEach(Ms)}function Es(t,e){if(t instanceof Dn)t.setMapInternal(e);else if(t instanceof xr){const i=t.getLayers().getArray();for(let t=0,n=i.length;t<n;++t)Es(i[t],e)}}const Is=class extends O{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const i={},n=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new xr({layers:t.layers});let r,s,o;return i[Nr]=n,i[Tr]=t.target,i[Pr]=t.view instanceof Pn?t.view:new Pn,void 0!==t.controls&&(Array.isArray(t.controls)?r=new H(t.controls.slice()):(q("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),r=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?s=new H(t.interactions.slice()):(q("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?o=new H(t.overlays.slice()):(q("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new H,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:i}}(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:U,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||jr(),this.interactions=e.interactions||Cs({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new kr(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Nr,this.handleLayerGroupChanged_),this.addChangeListener(Pr,this.handleViewChanged_),this.addChangeListener(Ar,this.handleSizeChanged_),this.addChangeListener(Tr,this.handleTargetChanged_),this.setProperties(e.values);const i=this;!t.view||t.view instanceof Pn||t.view.then((function(t){i.setView(new Pn(t))})),this.controls.addEventListener(D,(t=>{t.element.setMap(this)})),this.controls.addEventListener(k,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(D,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(k,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(D,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(k,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){Es(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const n=this.getCoordinateFromPixelInternal(t),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,s=void 0!==i.layerFilter?i.layerFilter:u,o=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,o,e,null,s,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),e),i}getAllLayers(){const t=[];return function e(i){i.forEach((function(i){i instanceof xr?e(i.getLayers()):t.push(i)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:u,r=void 0!==e.hitTolerance?e.hitTolerance:0,s=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,s,n,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i=this.getSize(),n=e.width/i[0],r=e.height/i[1],s="changedTouches"in t?t.changedTouches[0]:t;return[(s.clientX-e.left)/n,(s.clientY-e.top)/r]}getTarget(){return this.get(Tr)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return vi(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?K(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Nr)}setLayers(t){const e=this.getLayerGroup();if(t instanceof H)return void e.setLayers(t);const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e];if(!i.visible)continue;const n=i.layer.getRenderer();if(n&&!n.ready)return!0;const r=i.layer.getSource();if(r&&r.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Ci(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?K(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Ar)}getView(){return this.get(Pr)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,n){return function(t,e,i,n,r){if(!t||!(i in t.wantedTiles))return Or;if(!t.wantedTiles[i][e.getKey()])return Or;const s=t.viewState.center,o=n[0]-s[0],a=n[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}(this.frameState_,t,e,i,n)}handleBrowserEvent(t,e){e=e||t.type;const i=new Mr(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===Ir||i===M||i===C){const t=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():t,n=e.target;if(this.overlayContainerStopEvent_.contains(n)||!(i===t?t.documentElement:i).contains(n))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.getMap()===this&&n.getActive()&&this.getTargetElement()&&(!n.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let i=this.maxTilesLoading_,n=i;if(t){const e=t.viewHints;if(e[0]||e[1]){const e=Date.now()-t.time>8;i=e?0:8,n=e?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(Ee)&&this.renderer_.dispatchRenderEvent(Ee,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new wr(Rr,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new wr(br,this,t))));const i=this.postRenderFunctions_;for(let e=0,n=i.length;e<n;++e)i[e](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)S(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(_,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(M,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Jn(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new mr(this)),this.mapBrowserEventHandler_=new Sr(this,this.moveTolerance_);for(const t in Er)this.mapBrowserEventHandler_.addEventListener(Er[t],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(_,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(M,this.boundHandleBrowserEvent_,!!X&&{passive:!1});const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[E(t,C,this.handleBrowserEvent,this),E(t,x,this.handleBrowserEvent,this)];const i=e.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(S(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(S(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=E(t,e,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=E(t,m,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(S),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new _r("addlayer",t)),this.layerGroupPropertyListenerKeys_=[E(t,e,this.render,this),E(t,m,this.render,this),E(t,"addlayer",this.handleLayerAdd_,this),E(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}flushDeclutterItems(){const t=this.frameState_;t&&this.renderer_.flushDeclutterItems(t)}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){Ms(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),n=this.frameState_;let r=null;if(void 0!==e&&xs(e)&&i&&i.isDef()){const n=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=i.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:Et(s.center,s.resolution,s.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:s,viewHints:n,wantedTiles:{},mapId:T(this),renderTargets:{}},s.nextCenter&&s.nextResolution){const t=isNaN(s.nextRotation)?s.rotation:s.nextRotation;r.nextExtent=Et(s.nextCenter,s.nextResolution,t,e)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),n&&(!this.previousExtent_||!Tt(this.previousExtent_)&&!dt(r.extent,this.previousExtent_))&&(this.dispatchEvent(new wr("movestart",this,n)),this.previousExtent_=ut(this.previousExtent_)),this.previousExtent_&&!r.viewHints[0]&&!r.viewHints[1]&&!dt(r.extent,this.previousExtent_)&&(this.dispatchEvent(new wr("moveend",this,r)),nt(r.extent,this.previousExtent_))),this.dispatchEvent(new wr(Lr,this,r)),this.renderComplete_=this.hasListener(br)||this.hasListener(Rr)||this.hasListener(Ee)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new _r("removelayer",e)),this.set(Nr,t)}setSize(t){this.set(Ar,t)}setTarget(t){this.set(Tr,t)}setView(t){if(!t||t instanceof Pn)return void this.set(Pr,t);this.set(Pr,new Pn);const e=this;t.then((function(t){e.setView(new Pn(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const i=getComputedStyle(t),n=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),r=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);isNaN(n)||isNaN(r)||(e=[n,r],!xs(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&ei("No map visible because the map container's width or height are 0."))}const i=this.getSize();!e||i&&h(e,i)||(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}};let Ss=null;const Ls="units",bs=[1,2,5],Rs=25.4/.28,Ns=class extends Fr{constructor(t){t=t||{};const e=document.createElement("div");e.style.pointerEvents="none",super({element:e,render:t.render,target:t.target}),this.on,this.once,this.un;const i=void 0!==t.className?t.className:t.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+Vn,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=void 0!==t.minWidth?t.minWidth:64,this.maxWidth_=t.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(Ls,this.handleUnitsChanged_),this.setUnits(t.units||"metric"),this.scaleBar_=t.bar||!1,this.scaleBarSteps_=t.steps||4,this.scaleBarText_=t.text||!1,this.dpi_=t.dpi||void 0}getUnits(){return this.get(Ls)}handleUnitsChanged_(){this.updateElement_()}setUnits(t){this.set(Ls,t)}setDpi(t){this.dpi_=t}updateElement_(){const t=this.viewState_;if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=t.center,i=t.projection,n=this.getUnits(),r="degrees"==n?"degrees":"m";let s=ai(i,t.resolution,e,r);const o=this.minWidth_*(this.dpi_||Rs)/Rs,a=void 0!==this.maxWidth_?this.maxWidth_*(this.dpi_||Rs)/Rs:void 0;let l=o*s,h="";if("degrees"==n){const t=Le.degrees;l*=t,l<t/60?(h="″",s*=3600):l<t?(h="′",s*=60):h="°"}else if("imperial"==n)l<.9144?(h="in",s/=.0254):l<1609.344?(h="ft",s/=.3048):(h="mi",s/=1609.344);else if("nautical"==n)s/=1852,h="NM";else if("metric"==n)l<.001?(h="μm",s*=1e6):l<1?(h="mm",s*=1e3):l<1e3?h="m":(h="km",s/=1e3);else{if("us"!=n)throw new Error("Invalid units");l<.9144?(h="in",s*=39.37):l<1609.344?(h="ft",s/=.30480061):(h="mi",s/=1609.3472)}let u,c,p,d,g,f,y=3*Math.floor(Math.log(o*s)/Math.log(10));for(;;){p=Math.floor(y/3);const t=Math.pow(10,p);if(u=bs[(y%3+3)%3]*t,c=Math.round(u/s),isNaN(c))return this.element.style.display="none",void(this.renderedVisible_=!1);if(void 0!==a&&c>=a){u=d,c=g,p=f;break}if(c>=o)break;d=u,g=c,f=p,++y}const m=this.scaleBar_?this.createScaleBar(c,u,h):u.toFixed(p<0?-p:0)+" "+h;this.renderedHTML_!=m&&(this.innerElement_.innerHTML=m,this.renderedHTML_=m),this.renderedWidth_!=c&&(this.innerElement_.style.width=c+"px",this.renderedWidth_=c),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(t,e,i){const n=this.getScaleForResolution(),r=n<1?Math.round(1/n).toLocaleString()+" : 1":"1 : "+Math.round(n).toLocaleString(),s=this.scaleBarSteps_,o=t/s,a=[this.createMarker("absolute")];for(let n=0;n<s;++n){const r=n%2==0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";a.push(`<div><div class="ol-scale-singlebar ${r}" style="width: ${o}px;"></div>`+this.createMarker("relative")+(n%2==0||2===s?this.createStepText(n,t,!1,e,i):"")+"</div>")}return a.push(this.createStepText(s,t,!0,e,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${t}px;">`+r+"</div>":"")+a.join("")}createMarker(t){return`<div class="ol-scale-step-marker" style="position: ${t}; top: ${"absolute"===t?3:-10}px;"></div>`}createStepText(t,e,i,n,r){const s=(0===t?0:Math.round(n/this.scaleBarSteps_*t*100)/100)+(0===t?"":" "+r);return`<div class="ol-scale-step-text" style="margin-left: ${0===t?-3:e/this.scaleBarSteps_*-1}px;text-align: ${0===t?"left":"center"};min-width: ${0===t?0:e/this.scaleBarSteps_*2}px;left: ${i?e+"px":"unset"};">`+s+"</div>"}getScaleForResolution(){return ai(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m")*(1e3/25.4)*(this.dpi_||Rs)}render(t){const e=t.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()}},As="element",Ts="map",Ps="offset",Os="position",Ds="positioning",ks=class extends O{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=void 0===t.insertFirst||t.insertFirst,this.stopEvent=void 0===t.stopEvent||t.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==t.className?t.className:"ol-overlay-container ol-selectable",this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=!0===t.autoPan?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(As,this.handleElementChanged),this.addChangeListener(Ts,this.handleMapChanged),this.addChangeListener(Ps,this.handleOffsetChanged),this.addChangeListener(Os,this.handlePositionChanged),this.addChangeListener(Ds,this.handlePositioningChanged),void 0!==t.element&&this.setElement(t.element),this.setOffset(void 0!==t.offset?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),void 0!==t.position&&this.setPosition(t.position)}getElement(){return this.get(As)}getId(){return this.id}getMap(){return this.get(Ts)||null}getOffset(){return this.get(Ps)}getPosition(){return this.get(Os)}getPositioning(){return this.get(Ds)}handleElementChanged(){Qn(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(Jn(this.element),S(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=E(t,Lr,this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(As,t)}setMap(t){this.set(Ts,t)}setOffset(t){this.set(Ps,t)}setPosition(t){this.set(Os,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(Os))return;const i=this.getRect(e.getTargetElement(),e.getSize()),n=this.getElement(),r=this.getRect(n,[Xn(n),qn(n)]),s=void 0===(t=t||{}).margin?20:t.margin;if(!ot(i,r)){const n=r[0]-i[0],o=i[2]-r[2],a=r[1]-i[1],l=i[3]-r[3],h=[0,0];if(n<0?h[0]=n-s:o<0&&(h[0]=Math.abs(o)+s),a<0?h[1]=a-s:l<0&&(h[1]=Math.abs(l)+s),0!==h[0]||0!==h[1]){const i=e.getView().getCenterInternal(),n=e.getPixelFromCoordinateInternal(i);if(!n)return;const r=[n[0]+h[0],n[1]+h[1]],s=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(r),duration:s.duration,easing:s.easing})}}}getRect(t,e){const i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,r=i.top+window.pageYOffset;return[n,r,n+e[0],r+e[1]]}setPositioning(t){this.set(Ds,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e)return void this.setVisible(!1);const i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}updateRenderedPosition(t,e){const i=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);let s="0%",o="0%";"bottom-right"==r||"center-right"==r||"top-right"==r?s="-100%":"bottom-center"!=r&&"center-center"!=r&&"top-center"!=r||(s="-50%"),"bottom-left"==r||"bottom-center"==r||"bottom-right"==r?o="-100%":"center-left"!=r&&"center-center"!=r&&"center-right"!=r||(o="-50%");const a=`translate(${s}, ${o}) translate(${Math.round(t[0]+n[0])+"px"}, ${Math.round(t[1]+n[1])+"px"})`;this.rendered.transform_!=a&&(this.rendered.transform_=a,i.transform=a)}getOptions(){return this.options}},Fs=class extends Fr{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.boundHandleRotationChanged_=this.handleRotationChanged_.bind(this),this.collapsed_=void 0===t.collapsed||t.collapsed,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1),this.rotateWithView_=void 0!==t.rotateWithView&&t.rotateWithView,this.viewExtent_=void 0;const e=void 0!==t.className?t.className:"ol-overviewmap",i=void 0!==t.tipLabel?t.tipLabel:"Overview map",n=void 0!==t.collapseLabel?t.collapseLabel:"‹";"string"==typeof n?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=n):this.collapseLabel_=n;const r=void 0!==t.label?t.label:"›";"string"==typeof r?(this.label_=document.createElement("span"),this.label_.textContent=r):this.label_=r;const s=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,o=document.createElement("button");o.setAttribute("type","button"),o.title=i,o.appendChild(s),o.addEventListener(v,this.handleClick_.bind(this),!1),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.view_=t.view;const a=new Is({view:t.view,controls:new H,interactions:new H});this.ovmap_=a,t.layers&&t.layers.forEach((function(t){a.addLayer(t)}));const l=document.createElement("div");l.className="ol-overviewmap-box",l.style.boxSizing="border-box",this.boxOverlay_=new ks({position:[0,0],positioning:"center-center",element:l}),this.ovmap_.addOverlay(this.boxOverlay_);const h=e+" "+Vn+" "+jn+(this.collapsed_&&this.collapsible_?" "+zn:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=h,u.appendChild(this.ovmapDiv_),u.appendChild(o);const c=this,p=this.boxOverlay_,d=this.boxOverlay_.getElement(),g=function(t){const e={clientX:(i=t).clientX,clientY:i.clientY};var i;const n=a.getEventCoordinateInternal(e);p.setPosition(n)},f=function(t){const e=a.getEventCoordinateInternal(t);c.getMap().getView().setCenterInternal(e),window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",f)};d.addEventListener("mousedown",(function(){window.addEventListener("mousemove",g),window.addEventListener("mouseup",f)}))}setMap(t){const i=this.getMap();if(t!==i){if(i){const t=i.getView();t&&this.unbindView_(t),this.ovmap_.setTarget(null)}if(super.setMap(t),t){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(E(t,e,this.handleMapPropertyChange_,this));const i=t.getView();i&&(this.bindView_(i),i.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}}handleMapPropertyChange_(t){if(t.key===Pr){const e=t.oldValue;e&&this.unbindView_(e);const i=this.getMap().getView();this.bindView_(i)}else this.ovmap_.isRendered()||t.key!==Tr&&t.key!==Ar||this.ovmap_.updateSize()}bindView_(t){if(!this.view_){const e=new Pn({projection:t.getProjection()});this.ovmap_.setView(e)}t.addChangeListener(Ie.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()}unbindView_(t){t.removeChangeListener(Ie.ROTATION,this.boundHandleRotationChanged_)}handleRotationChanged_(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}validateExtent_(){const t=this.getMap(),e=this.ovmap_;if(!t.isRendered()||!e.isRendered())return;const i=t.getSize(),n=t.getView().calculateExtentInternal(i);if(this.viewExtent_&&dt(n,this.viewExtent_))return;this.viewExtent_=n;const r=e.getSize(),s=e.getView().calculateExtentInternal(r),o=e.getPixelFromCoordinateInternal(bt(n)),a=e.getPixelFromCoordinateInternal(xt(n)),l=Math.abs(o[0]-a[0]),h=Math.abs(o[1]-a[1]),u=r[0],c=r[1];l<.1*u||h<.1*c||l>.75*u||h>.75*c?this.resetExtent_():ot(s,n)||this.recenter_()}resetExtent_(){const t=this.getMap(),e=this.ovmap_,i=t.getSize(),n=t.getView().calculateExtentInternal(i),r=e.getView(),s=Math.log(7.5)/Math.LN2;!function(t,e){const i=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=i,t[2]+=i,t[1]-=n,t[3]+=n}(n,1/(.1*Math.pow(2,s/2))),r.fitInternal(Rn(n))}recenter_(){const t=this.getMap(),e=this.ovmap_,i=t.getView();e.getView().setCenterInternal(i.getCenterInternal())}updateBox_(){const t=this.getMap(),e=this.ovmap_;if(!t.isRendered()||!e.isRendered())return;const i=t.getSize(),n=t.getView(),r=e.getView(),s=this.rotateWithView_?0:-n.getRotation(),o=this.boxOverlay_,a=this.boxOverlay_.getElement(),l=n.getCenterInternal(),h=n.getResolution(),u=r.getResolution(),c=i[0]*h/u,p=i[1]*h/u;if(o.setPosition(l),a){a.style.width=c+"px",a.style.height=p+"px";const t="rotate("+s+"rad)";a.style.transform=t}}updateBoxAfterOvmapIsRendered_(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=I(this.ovmap_,Lr,(function(t){delete this.ovmapPostrenderKey_,this.updateBox_()}),this))}handleClick_(t){t.preventDefault(),this.handleToggle_()}handleToggle_(){this.element.classList.toggle(zn),this.collapsed_?Kn(this.collapseLabel_,this.label_):Kn(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;const t=this.ovmap_;if(!this.collapsed_){if(t.isRendered())return this.viewExtent_=void 0,void t.render();t.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())}setCollapsed(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}getRotateWithView(){return this.rotateWithView_}setRotateWithView(t){this.rotateWithView_!==t&&(this.rotateWithView_=t,0!==this.getMap().getView().getRotation()&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}getOverviewMap(){return this.ovmap_}render(t){this.validateExtent_(),this.updateBox_()}},Gs="preload",Hs="useInterimTilesOnError",Vs=class extends Dn{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get(Gs)}setPreload(t){this.set(Gs,t)}getUseInterimTilesOnError(){return this.get(Hs)}setUseInterimTilesOnError(t){this.set(Hs,t)}getData(t){return super.getData(t)}},js=class extends R{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return N()}getData(t){return null}prepareFrame(t){return N()}renderFrame(t,e){return N()}loadedTileCallback(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i}createLoadedTileFinder(t,e,i){return(n,r)=>{const s=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,r,s)}}forEachFeatureAtCoordinate(t,e,i,n,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;2!==e.getState()&&3!==e.getState()||this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return 2!=e&&3!=e&&t.addEventListener(m,this.boundHandleImageChange_),0==e&&(t.load(),e=t.getState()),2==e}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}},zs=[];let Bs=null;const Us=class extends js{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,i){let n;Bs||(Bs=Yn(1,1,void 0,{willReadFrequently:!0})),Bs.clearRect(0,0,1,1);try{Bs.drawImage(t,e,i,1,1,0,0,1,1),n=Bs.getImageData(0,0,1,1).data}catch(t){return Bs=null,null}return n}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const n=this.getLayer().getClassName();let r,s;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&h(oe(t.style.backgroundColor),oe(i)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(s=e.getContext("2d"))}if(s&&s.canvas.style.transform===e?(this.container=t,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=n;let t=r.style;t.position="absolute",t.width="100%",t.height="100%",s=Yn();const e=s.canvas;r.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=r,this.context=s}this.containerReused||!i||this.container.style.backgroundColor||(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const n=bt(i),r=Rt(i),s=xt(i),o=Ct(i);K(e.coordinateToPixelTransform,n),K(e.coordinateToPixelTransform,r),K(e.coordinateToPixelTransform,s),K(e.coordinateToPixelTransform,o);const a=this.inversePixelTransform;K(a,n),K(a,r),K(a,s),K(a,o),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.clip()}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){const r=new Gn(t,this.inversePixelTransform,i,e);n.dispatchEvent(r)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_(xe,t,e)}postRender(t,e){this.dispatchRenderEvent_(we,t,e)}getRenderTransform(t,e,i,n,r,s,o){const a=r/2,l=s/2,h=n/e,u=-h,c=-t[0]+o,p=-t[1];return J(this.tempTransform,a,l,h,u,-i,c,p)}disposeInternal(){delete this.frameState,super.disposeInternal()}},Zs=class extends y{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(m)}release(){3===this.state&&this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(2==t.getState())return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(2==t.getState()){t.interimTile=null;break}1==t.getState()?e=t:0==t.getState()?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){N()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const n=e-i+1e3/60;return n>=this.transition_?1:Di(n/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}};function Ys(t,e){return e&&(t.src=e),t.src&&Y?new Promise(((e,i)=>t.decode().then((()=>e(t))).catch((n=>t.complete&&t.width?e(t):i(n))))):function(t){return new Promise(((e,i)=>{function n(){s(),e(t)}function r(){s(),i(new Error("Image load error"))}function s(){t.removeEventListener("load",n),t.removeEventListener("error",r)}t.addEventListener("load",n),t.addEventListener("error",r)}))}(t)}function Ws(t,e){return e&&(t.src=e),t.src&&Y&&W?t.decode().then((()=>createImageBitmap(t))).catch((e=>{if(t.complete&&t.width)return t;throw e})):Ys(t)}const Xs=class extends y{constructor(t,e,i,n){super(),this.extent=t,this.pixelRatio_=i,this.resolution=e,this.state="function"==typeof n?0:n,this.image_=null,this.loader="function"==typeof n?n:null}changed(){this.dispatchEvent(m)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(0==this.state&&this.loader){this.state=1,this.changed();const e=this.getResolution(),i=Array.isArray(e)?e[0]:e;(t=()=>this.loader(this.getExtent(),i,this.getPixelRatio()),function(){let e;try{e=t()}catch(t){return Promise.reject(t)}return e instanceof Promise?e:Promise.resolve(e)}()).then((t=>{"image"in t&&(this.image_=t.image),"extent"in t&&(this.extent=t.extent),"resolution"in t&&(this.resolution=t.resolution),"pixelRatio"in t&&(this.pixelRatio_=t.pixelRatio),(t instanceof HTMLImageElement||t instanceof ImageBitmap||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement)&&(this.image_=t),this.state=2})).catch((t=>{this.state=3,console.error(t)})).finally((()=>this.changed()))}var t}setImage(t){this.image_=t}setResolution(t){this.resolution=t}},qs=class extends Zs{constructor(t,e,i,n,r,s){super(t,e,s),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=3,this.unlistenImage_(),this.image_=function(){const t=Yn(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=2:this.state=4,this.unlistenImage_(),this.changed()}load(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(t,e,i){const n=t;let r=!0,s=!1,o=!1;const a=[I(n,"load",(function(){o=!0,s||e()}))];return n.src&&Y?(s=!0,n.decode().then((function(){r&&e()})).catch((function(t){r&&(o?e():i())}))):a.push(I(n,"error",i)),function(){r=!1,a.forEach(S)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}},Ks=class{constructor(t,e,i,n,r,s){this.sourceProj_=t,this.targetProj_=e;let o={};const a=gi(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return o[e]||(o[e]=a(t)),o[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Nt(n)>=Nt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Nt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Nt(this.targetProj_.getExtent()):null;const l=bt(i),h=Rt(i),u=xt(i),c=Ct(i),p=this.transformInv_(l),d=this.transformInv_(h),g=this.transformInv_(u),f=this.transformInv_(c),y=10+(s?Math.max(0,Math.ceil(Math.log2(vt(i)/(s*s*256*256)))):0);if(this.addQuad_(l,h,u,c,p,d,g,f,y),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,n){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const n=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-n<this.sourceWorldWidth_/2&&(e.source=i)}}))}o={}}addTriangle_(t,e,i,n,r,s){this.triangles_.push({source:[n,r,s],target:[t,e,i]})}addQuad_(t,e,i,n,r,s,o,a,l){const h=et([r,s,o,a]),u=this.sourceWorldWidth_?Nt(h)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&u>.5&&u<1;let d=!1;if(l>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(d=Nt(et([t,e,i,n]))/this.targetWorldWidth_>.25||d),!p&&this.sourceProj_.isGlobal()&&u&&(d=u>.25||d)),!d&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!At(h,this.maxSourceExtent_))return;let g=0;if(!(d||isFinite(r[0])&&isFinite(r[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])))if(l>0)d=!0;else if(g=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(s[0])&&isFinite(s[1])?0:4)+(isFinite(o[0])&&isFinite(o[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1),1!=g&&2!=g&&4!=g&&8!=g)return;if(l>0){if(!d){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],n=this.transformInv_(e);let s;s=p?(Xt(r[0],c)+Xt(o[0],c))/2-Xt(n[0],c):(r[0]+o[0])/2-n[0];const a=(r[1]+o[1])/2-n[1];d=s*s+a*a>this.errorThresholdSquared_}if(d){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const h=[(e[0]+i[0])/2,(e[1]+i[1])/2],u=this.transformInv_(h),c=[(n[0]+t[0])/2,(n[1]+t[1])/2],p=this.transformInv_(c);this.addQuad_(t,e,h,c,r,s,u,p,l-1),this.addQuad_(c,h,i,n,p,u,o,a,l-1)}else{const h=[(t[0]+e[0])/2,(t[1]+e[1])/2],u=this.transformInv_(h),c=[(i[0]+n[0])/2,(i[1]+n[1])/2],p=this.transformInv_(c);this.addQuad_(t,h,c,n,r,u,p,a,l-1),this.addQuad_(h,e,i,c,u,s,o,p,l-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}11&g||this.addTriangle_(t,i,n,r,o,a),14&g||this.addTriangle_(t,i,e,r,o,s),g&&(13&g||this.addTriangle_(e,n,t,s,a,r),7&g||this.addTriangle_(e,n,i,s,a,o))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){const r=e.source;ft(t,r[0]),ft(t,r[1]),ft(t,r[2])})),t}getTriangles(){return this.triangles_}};let Js;const Qs=[];function $s(t,e,i,n,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(n,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(i,r)),t.restore()}function to(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function eo(t,e,i,n){const r=fi(i,e,t);let s=ai(e,n,i);const o=e.getMetersPerUnit();void 0!==o&&(s*=o);const a=t.getMetersPerUnit();void 0!==a&&(s/=a);const l=t.getExtent();if(!l||st(l,r)){const e=ai(t,s,r)/s;isFinite(e)&&e>0&&(s/=e)}return s}function io(t,e,i,n,r,s,o,a,l,h,u,c,p){const d=Yn(Math.round(i*t),Math.round(i*e),Qs);if(c||(d.imageSmoothingEnabled=!1),0===l.length)return d.canvas;function g(t){return Math.round(t*i)/i}d.scale(i,i),d.globalCompositeOperation="lighter";const f=[1/0,1/0,-1/0,-1/0];let y;if(l.forEach((function(t,e,i){gt(f,t.extent)})),!p||1!==l.length||0!==h){const t=Nt(f),e=St(f);y=Yn(Math.round(i*t/n),Math.round(i*e/n),Qs),c||(y.imageSmoothingEnabled=!1);const r=i/n;l.forEach((function(t,e,i){const n=t.extent[0]-f[0],s=-(t.extent[3]-f[3]),o=Nt(t.extent),a=St(t.extent);t.image.width>0&&t.image.height>0&&y.drawImage(t.image,h,h,t.image.width-2*h,t.image.height-2*h,n*r,s*r,o*r,a*r)}))}const m=bt(o);return a.getTriangles().forEach((function(t,e,r){const o=t.source,a=t.target;let h=o[0][0],u=o[0][1],p=o[1][0],_=o[1][1],v=o[2][0],C=o[2][1];const x=g((a[0][0]-m[0])/s),w=g(-(a[0][1]-m[1])/s),M=g((a[1][0]-m[0])/s),E=g(-(a[1][1]-m[1])/s),I=g((a[2][0]-m[0])/s),S=g(-(a[2][1]-m[1])/s),L=h,b=u;h=0,u=0,p-=L,_-=b,v-=L,C-=b;const R=function(t){const e=t.length;for(let i=0;i<e;i++){let n=i,r=Math.abs(t[i][i]);for(let s=i+1;s<e;s++){const e=Math.abs(t[s][i]);e>r&&(r=e,n=s)}if(0===r)return null;const s=t[n];t[n]=t[i],t[i]=s;for(let n=i+1;n<e;n++){const r=-t[n][i]/t[i][i];for(let s=i;s<e+1;s++)i==s?t[n][s]=0:t[n][s]+=r*t[i][s]}}const i=new Array(e);for(let n=e-1;n>=0;n--){i[n]=t[n][e]/t[n][n];for(let r=n-1;r>=0;r--)t[r][e]-=t[r][n]*i[n]}return i}([[p,_,0,0,M-x],[v,C,0,0,I-x],[0,0,p,_,E-w],[0,0,v,C,S-w]]);if(!R)return;if(d.save(),d.beginPath(),function(){if(void 0===Js){const t=Yn(6,6,Qs);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",$s(t,4,5,4,0),$s(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;Js=to(e,0)||to(e,4)||to(e,8),Wn(t),Qs.push(t.canvas)}return Js}()||!c){d.moveTo(M,E);const t=4,e=x-M,i=w-E;for(let n=0;n<t;n++)d.lineTo(M+g((n+1)*e/t),E+g(n*i/(t-1))),n!=t-1&&d.lineTo(M+g((n+1)*e/t),E+g((n+1)*i/(t-1)));d.lineTo(I,S)}else d.moveTo(M,E),d.lineTo(x,w),d.lineTo(I,S);let N;if(d.clip(),d.transform(R[0],R[2],R[1],R[3],x,w),d.translate(f[0]-L,f[3]-b),y)N=y.canvas,d.scale(n/i,-n/i);else{const t=l[0],e=t.extent;N=t.image,d.scale(Nt(e)/N.width,-St(e)/N.height)}d.drawImage(N,0,0),d.restore()})),y&&(Wn(y),Qs.push(y.canvas)),u&&(d.save(),d.globalCompositeOperation="source-over",d.strokeStyle="black",d.lineWidth=1,a.getTriangles().forEach((function(t,e,i){const n=t.target,r=(n[0][0]-m[0])/s,o=-(n[0][1]-m[1])/s,a=(n[1][0]-m[0])/s,l=-(n[1][1]-m[1])/s,h=(n[2][0]-m[0])/s,u=-(n[2][1]-m[1])/s;d.beginPath(),d.moveTo(a,l),d.lineTo(r,o),d.lineTo(h,u),d.closePath(),d.stroke()})),d.restore()),d.canvas}const no=class extends Zs{constructor(t,e,i,n,r,s,o,a,l,h,u,c){super(r,0,c),this.renderEdges_=void 0!==u&&u,this.pixelRatio_=o,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=s||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const p=n.getTileCoordExtent(this.wrappedTileCoord_),d=this.targetTileGrid_.getExtent();let g=this.sourceTileGrid_.getExtent();const f=d?Lt(p,d):p;if(0===vt(f))return void(this.state=4);const y=t.getExtent();y&&(g=g?Lt(g,y):y);const m=n.getResolution(this.wrappedTileCoord_[0]),_=function(t,e,i,n){const r=wt(i);let s=eo(t,e,r,n);return(!isFinite(s)||s<=0)&&_t(i,(function(i){return s=eo(t,e,i,n),isFinite(s)&&s>0})),s}(t,i,f,m);if(!isFinite(_)||_<=0)return void(this.state=4);const v=void 0!==h?h:.5;if(this.triangulation_=new Ks(t,i,f,g,_*v,m),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=e.getZForResolution(_);let C=this.triangulation_.calculateSourceExtent();if(g&&(t.canWrapX()?(C[1]=Bt(C[1],g[1],g[3]),C[3]=Bt(C[3],g[1],g[3])):C=Lt(C,g)),vt(C)){const t=e.getTileRangeForExtentAndZ(C,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=l(this.sourceZ_,e,i,o);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&2==e.getState()&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=3;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],s=this.targetTileGrid_.getResolution(e),o=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=io(n,r,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),s,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}load(){if(0==this.state){this.state=1,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const i=e.getState();if(0==i||1==i){t++;const i=E(e,m,(function(n){const r=e.getState();2!=r&&3!=r&&4!=r||(S(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(i)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,i){0==t.getState()&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(S),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Wn(this.canvas_.getContext("2d")),Qs.push(this.canvas_),this.canvas_=null),super.release()}};class ro{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function so(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new ro(t,e,i,n)}const oo=ro,ao=class extends Us{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new oo(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return 2==i||4==i||3==i&&!n}getTile(t,e,i,n){const r=n.pixelRatio,s=n.viewState.projection,o=this.getLayer();let a=o.getSource().getTile(t,e,i,r,s);return 3==a.getState()&&o.getUseInterimTilesOnError()&&o.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(a)||(a=a.getInterimTile()),a}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=K(e.pixelToCoordinateTransform,t.slice()),r=i.getExtent();if(r&&!st(r,n))return null;const s=e.pixelRatio,o=e.viewState.projection,a=e.viewState,l=i.getRenderSource(),h=l.getTileGridForProjection(a.projection),u=l.getTilePixelRatio(e.pixelRatio);for(let t=h.getZForResolution(a.resolution);t>=h.getMinZoom();--t){const e=h.getTileCoordForCoordAndZ(n,t),i=l.getTile(t,e[1],e[2],s,o);if(!(i instanceof qs||i instanceof no)||i instanceof no&&4===i.getState())return null;if(2!==i.getState())continue;const r=h.getOrigin(t),c=ws(h.getTileSize(t)),p=h.getResolution(t),d=Math.floor(u*((n[0]-r[0])/p-e[1]*c[0])),g=Math.floor(u*((r[1]-n[1])/p-e[2]*c[1])),f=Math.round(u*l.getGutterForProjection(a.projection));return this.getImageData(i.getImage(),d+f,g+f)}return null}loadedTileCallback(t,e,i){return!!this.isDrawableTile(i)&&super.loadedTileCallback(t,e,i)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex],n=t.viewState,r=n.projection,o=n.resolution,a=n.center,l=n.rotation,h=t.pixelRatio,u=this.getLayer(),c=u.getSource(),p=c.getRevision(),d=c.getTileGridForProjection(r),g=d.getZForResolution(o,c.zDirection),f=d.getResolution(g);let y=t.extent;const m=t.viewState.resolution,_=c.getTilePixelRatio(h),v=Math.round(Nt(y)/m*h),C=Math.round(St(y)/m*h),x=i.extent&&wi(i.extent);x&&(y=Lt(y,wi(i.extent)));const w=f*v/2/_,M=f*C/2/_,E=[a[0]-w,a[1]-M,a[0]+w,a[1]+M],I=d.getTileRangeForExtentAndZ(y,g),S={};S[g]={};const L=this.createLoadedTileFinder(c,r,S),b=this.tmpExtent,R=this.tmpTileRange_;this.newTiles_=!1;const N=l?It(n.center,m,l,t.size):void 0;for(let e=I.minX;e<=I.maxX;++e)for(let n=I.minY;n<=I.maxY;++n){if(l&&!d.tileCoordIntersectsViewport([g,e,n],N))continue;const r=this.getTile(g,e,n,t);if(this.isDrawableTile(r)){const e=T(this);if(2==r.getState()){S[g][r.tileCoord.toString()]=r;let t=r.inTransition(e);t&&1!==i.opacity&&(r.endTransition(e),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(r)||(this.newTiles_=!0)}if(1===r.getAlpha(e,t.time))continue}const s=d.getTileCoordChildTileRange(r.tileCoord,R,b);let o=!1;s&&(o=L(g+1,s)),o||d.forEachTileCoordParentTileRange(r.tileCoord,L,R,b)}const A=f/o*h/_;J(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,l,-v/2,-C/2);const P=tt(this.pixelTransform);this.useContainer(e,P,this.getBackground(t));const O=this.context,D=O.canvas;Q(this.inversePixelTransform,this.pixelTransform),J(this.tempTransform,v/2,C/2,A,A,0,-v/2,-C/2),D.width!=v||D.height!=C?(D.width=v,D.height=C):this.containerReused||O.clearRect(0,0,v,C),x&&this.clipUnrotated(O,t,x),c.getInterpolate()||(O.imageSmoothingEnabled=!1),this.preRender(O,t),this.renderedTiles.length=0;let k,F,G,H=Object.keys(S).map(Number);H.sort(s),1!==i.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(k=[],F=[]):H=H.reverse();for(let e=H.length-1;e>=0;--e){const i=H[e],n=c.getTilePixelSize(i,h,r),s=d.getResolution(i)/f,o=n[0]*s*A,a=n[1]*s*A,l=d.getTileCoordForCoordAndZ(bt(E),i),u=d.getTileCoordExtent(l),p=K(this.tempTransform,[_*(u[0]-E[0])/f,_*(E[3]-u[3])/f]),y=_*c.getGutterForProjection(r),m=S[i];for(const e in m){const n=m[e],r=n.tileCoord,s=l[1]-r[1],h=Math.round(p[0]-(s-1)*o),u=l[2]-r[2],d=Math.round(p[1]-(u-1)*a),f=Math.round(p[0]-s*o),_=Math.round(p[1]-u*a),v=h-f,C=d-_,x=g===i,w=x&&1!==n.getAlpha(T(this),t.time);let M=!1;if(!w)if(k){G=[f,_,f+v,_,f+v,_+C,f,_+C];for(let t=0,e=k.length;t<e;++t)if(g!==i&&i<F[t]){const e=k[t];At([f,_,f+v,_+C],[e[0],e[3],e[4],e[7]])&&(M||(O.save(),M=!0),O.beginPath(),O.moveTo(G[0],G[1]),O.lineTo(G[2],G[3]),O.lineTo(G[4],G[5]),O.lineTo(G[6],G[7]),O.moveTo(e[6],e[7]),O.lineTo(e[4],e[5]),O.lineTo(e[2],e[3]),O.lineTo(e[0],e[1]),O.clip())}k.push(G),F.push(i)}else O.clearRect(f,_,v,C);this.drawTileImage(n,t,f,_,v,C,y,x),k&&!w?(M&&O.restore(),this.renderedTiles.unshift(n)):this.renderedTiles.push(n),this.updateUsedTiles(t.usedTiles,c,n)}}return this.renderedRevision=p,this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!dt(this.renderedExtent_,E),this.renderedExtent_=E,this.renderedPixelRatio=h,this.renderedProjection=r,this.manageTilePyramid(t,c,d,h,r,y,g,u.getPreload()),this.scheduleExpireCache(t,c),this.postRender(O,t),i.extent&&O.restore(),O.imageSmoothingEnabled=!0,P!==D.style.transform&&(D.style.transform=P),this.container}drawTileImage(t,e,i,n,r,s,o,a){const l=this.getTileImage(t);if(!l)return;const h=T(this),u=e.layerStatesArray[e.layerIndex],c=u.opacity*(a?t.getAlpha(h,e.time):1),p=c!==this.context.globalAlpha;p&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(l,o,o,l.width-2*o,l.height-2*o,i,n,r,s),p&&this.context.restore(),c!==u.opacity?e.animate=!0:a&&t.endTransition(h)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const i=function(t,e,i){const n=T(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(i)}}updateUsedTiles(t,e,i){const n=T(e);n in t||(t[n]={}),t[n][i.getKey()]=!0}manageTilePyramid(t,e,i,n,r,s,o,a,l){const h=T(e);h in t.wantedTiles||(t.wantedTiles[h]={});const u=t.wantedTiles[h],c=t.tileQueue,p=i.getMinZoom(),d=t.viewState.rotation,g=d?It(t.viewState.center,t.viewState.resolution,d,t.size):void 0;let f,y,m,_,v,C,x=0;for(C=p;C<=o;++C)for(y=i.getTileRangeForExtentAndZ(s,C,y),m=i.getResolution(C),_=y.minX;_<=y.maxX;++_)for(v=y.minY;v<=y.maxY;++v)d&&!i.tileCoordIntersectsViewport([C,_,v],g)||(o-C<=a?(++x,f=e.getTile(C,_,v,n,r),0==f.getState()&&(u[f.getKey()]=!0,c.isKeyQueued(f.getKey())||c.enqueue([f,h,i.getTileCoordCenter(f.tileCoord),m])),void 0!==l&&l(f)):e.useTile(C,_,v,r));e.updateCacheSize(x,r)}},lo=class extends Vs{constructor(t){super(t)}createRenderer(){return new ao(this)}},ho=class extends Dn{constructor(t){super(t=t||{})}},uo=class extends Us{constructor(t){super(t),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(t){const e=t.layerStatesArray[t.layerIndex],i=t.pixelRatio,n=t.viewState,r=n.resolution,s=this.getLayer().getSource(),o=t.viewHints;let a=t.extent;if(void 0!==e.extent&&(a=Lt(a,wi(e.extent,n.projection))),!o[0]&&!o[1]&&!Tt(a))if(s){const t=n.projection,e=s.getImage(a,r,i,t);e&&(this.loadImage(e)?this.image_=e:4===e.getState()&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=K(e.pixelToCoordinateTransform,t.slice()),r=i.getExtent();if(r&&!st(r,n))return null;const s=this.image_.getExtent(),o=this.image_.getImage(),a=Nt(s),l=Math.floor(o.width*((n[0]-s[0])/a));if(l<0||l>=o.width)return null;const h=St(s),u=Math.floor(o.height*((s[3]-n[1])/h));return u<0||u>=o.height?null:this.getImageData(o,l,u)}renderFrame(t,e){const i=this.image_,n=i.getExtent(),r=i.getResolution(),[s,o]=Array.isArray(r)?r:[r,r],a=i.getPixelRatio(),l=t.layerStatesArray[t.layerIndex],h=t.pixelRatio,u=t.viewState,c=u.center,p=u.resolution,d=h*s/(p*a),g=h*o/(p*a),f=t.extent,y=u.resolution,m=u.rotation,_=Math.round(Nt(f)/y*h),v=Math.round(St(f)/y*h);J(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,m,-_/2,-v/2),Q(this.inversePixelTransform,this.pixelTransform);const C=tt(this.pixelTransform);this.useContainer(e,C,this.getBackground(t));const x=this.context,w=x.canvas;w.width!=_||w.height!=v?(w.width=_,w.height=v):this.containerReused||x.clearRect(0,0,_,v);let M=!1,E=!0;if(l.extent){const e=wi(l.extent,u.projection);E=At(e,t.extent),M=E&&!ot(e,t.extent),M&&this.clipUnrotated(x,t,e)}const I=i.getImage(),S=J(this.tempTransform,_/2,v/2,d,g,0,a*(n[0]-c[0])/s,a*(c[1]-n[3])/o);this.renderedResolution=o*h/a;const L=I.width*S[0],b=I.height*S[3];if(this.getLayer().getSource().getInterpolate()||(x.imageSmoothingEnabled=!1),this.preRender(x,t),E&&L>=.5&&b>=.5){const t=S[4],e=S[5],i=l.opacity;let n;1!==i&&(n=x.globalAlpha,x.globalAlpha=i),x.drawImage(I,0,0,+I.width,+I.height,t,e,L,b),1!==i&&(x.globalAlpha=n)}return this.postRender(x,t),M&&x.restore(),x.imageSmoothingEnabled=!0,C!==w.style.transform&&(w.style.transform=C),this.container}},co=class extends ho{constructor(t){super(t)}createRenderer(){return new uo(this)}getData(t){return super.getData(t)}};var po=i(341);class go{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=ws(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new go({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return N()}getImage(t){return N()}getHitDetectionImage(){return N()}getPixelRatio(t){return 1}getImageState(){return N()}getImageSize(){return N()}getOrigin(){return N()}getSize(){return N()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ws(t)}listenImageChange(t){N()}load(){N()}unlistenImageChange(t){N()}}const fo=go;function yo(t){return Array.isArray(t)?le(t):t}class mo extends fo{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=void 0!==t.radius?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.size_,this.renderOptions_,this.render()}clone(){const t=this.getScale(),e=new mo({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const i=this.renderOptions_,n=Yn(i.size*t,i.size*t);this.draw_(i,n,t),e=n.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return 2}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let n=this.radius_,r=void 0===this.radius2_?n:this.radius2_;if(n<r){const t=n;n=r,r=t}const s=void 0===this.radius2_?this.points_:2*this.points_,o=2*Math.PI/s,a=r*Math.sin(o),l=n-Math.sqrt(r*r-a*a),h=Math.sqrt(a*a+l*l),u=h/a;if("miter"===t&&u<=i)return u*e;const c=e/2/u,p=e/2*(l/h),d=Math.sqrt((n+c)*(n+c)+p*p)-n;if(void 0===this.radius2_||"bevel"===t)return 2*d;const g=n*Math.sin(o),f=r-Math.sqrt(n*n-g*g),y=Math.sqrt(g*g+f*f)/g;if(y<=i){const t=y*e/2-r-n;return 2*Math.max(d,t)}return 2*d}createRenderOptions(){let t,e=er,i=nr,n=0,r=null,s=0,o=0;this.stroke_&&(t=yo(this.stroke_.getColor()??rr),o=this.stroke_.getWidth()??1,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,i=this.stroke_.getLineJoin()??nr,e=this.stroke_.getLineCap()??er,n=this.stroke_.getMiterLimit()??10);const a=this.calculateLineJoinSize_(i,o,n),l=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:o,size:Math.ceil(2*l+a),lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:i,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let t=this.fill_.getColor();null===t&&(t=tr),e.fillStyle=yo(t),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),n=0;"string"==typeof i&&(i=oe(i)),null===i?n=1:Array.isArray(i)&&(n=4===i.length?i[3]:1),0===n&&(e=Yn(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius_;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(e*=2);const r=this.angle_-Math.PI/2,s=2*Math.PI/e;for(let o=0;o<e;o++){const e=r+o*s,a=o%2==0?i:n;t.lineTo(a*Math.cos(e),a*Math.sin(e))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=tr,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}const _o=mo;class vo extends _o{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new vo({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const Co=vo;class xo{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null}clone(){const t=this.getColor();return new xo({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){this.color_=t}}const wo=xo;class Mo{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Mo({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const Eo=Mo;class Io{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=bo,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Io({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=bo,this.geometry_=t}setZIndex(t){this.zIndex_=t}}let So=null;function Lo(t,e){if(!So){const t=new wo({color:"rgba(255,255,255,0.4)"}),e=new Eo({color:"#3399CC",width:1.25});So=[new Io({image:new Co({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return So}function bo(t){return t.getGeometry()}const Ro=Io;let No=null;class Ao extends y{constructor(t,e,i,n,r){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=r,this.imageState_=void 0===n?0:n,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&2===this.imageState_){No||(No=Yn(1,1,void 0,{willReadFrequently:!0})),No.drawImage(this.image_,0,0);try{No.getImageData(0,0,1,1),this.tainted_=!1}catch(t){No=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(m)}handleImageError_(){this.imageState_=3,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=2,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Yn(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(0===this.imageState_){this.image_||this.initializeImage_(),this.imageState_=1;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch(t){this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Ys(this.image_,this.src_).then((t=>{this.image_=t,this.handleImageLoad_()})).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||2!==this.imageState_)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const n=i.getContext("2d");n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle=te(this.color_),n.fillRect(0,0,i.width/t,i.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=i}}function To(t,e,i,n){return void 0!==i&&void 0!==n?[i/t,n/e]:void 0!==i?i/t:void 0!==n?n/e:1}class Po extends fo{constructor(t){const e=void 0!==(t=t||{}).opacity?t.opacity:1,i=void 0!==t.rotation?t.rotation:0,n=void 0!==t.scale?t.scale:1,r=void 0!==t.rotateWithView&&t.rotateWithView;super({opacity:e,rotation:i,scale:n,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:r,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const s=void 0!==t.img?t.img:null;let o,a=t.src;if(q(!(void 0!==a&&s),"`image` and `src` cannot be provided at the same time"),void 0!==a&&0!==a.length||!s||(a=s.src||T(s)),q(void 0!==a&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),q(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?o=0:void 0!==s&&(o=s instanceof HTMLImageElement?s.complete?s.src?2:0:1:2),this.color_=void 0!==t.color?oe(t.color):null,this.iconImage_=function(t,e,i,n,r){let s=void 0===e?void 0:ue.get(e,i,r);return s||(s=new Ao(t,t instanceof HTMLImageElement?t.src||void 0:e,i,n,r),ue.set(e,i,r,s)),s}(s,a,this.crossOrigin_,o,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,void 0!==t.width||void 0!==t.height){let e,i;if(t.size)[e,i]=t.size;else{const n=this.getImage(1);if(n.width&&n.height)e=n.width,i=n.height;else if(n instanceof HTMLImageElement){this.initialOptions_=t;const e=()=>{if(this.unlistenImageChange(e),!this.initialOptions_)return;const i=this.iconImage_.getSize();this.setScale(To(i[0],i[1],t.width,t.height))};return void this.listenImageChange(e)}}void 0!==e&&this.setScale(To(e,i,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Po({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=i[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(m,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(m,t)}}const Oo=Po;class Do{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=ws(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new wo({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding}clone(){const t=this.getScale();return new Do({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ws(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const ko=Do;let Fo=0;const Go=1<<Fo++,Ho=1<<Fo++,Vo=1<<Fo++,jo=1<<Fo++,zo=1<<Fo++,Bo=Math.pow(2,5)-1,Uo={[Go]:"boolean",[Ho]:"number",[Vo]:"string",[jo]:"color",[zo]:"number[]"},Zo=Object.keys(Uo).map(Number).sort(s);function Yo(t){const e=[];for(const n of Zo)(t&(i=n))===i&&e.push(Uo[n]);var i;return 0===e.length?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Wo(t,e){return!!(t&e)}function Xo(t,e){return t===e}class qo{constructor(t,e){this.type=t,this.value=e}}class Ko{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function Jo(){return{variables:new Set,properties:new Set,featureId:!1,style:{}}}function Qo(t,e,i){switch(typeof t){case"boolean":return new qo(Go,t);case"number":return new qo(Ho,t);case"string":{let e=Vo;return function(t){try{return se(t),!0}catch(t){return!1}}(t)&&(e|=jo),Xo(e&i,0)||(e&=i),new qo(e,t)}}if(!Array.isArray(t))throw new Error("Expression must be an array or a primitive value");if(0===t.length)throw new Error("Empty expression");if("string"==typeof t[0])return function(t,e,i){const n=t[0],r=za[n];if(!r)throw new Error(`Unknown operator: ${n}`);return r(t,e,i)}(t,e,i);for(const e of t)if("number"!=typeof e)throw new Error("Expected an array of numbers");let n=zo;return 3!==t.length&&4!==t.length||(n|=jo),i&&(n&=i),new qo(n,t)}const $o="get",ta="var",ea="concat",ia="geometry-type",na="any",ra="all",sa="!",oa="resolution",aa="zoom",la="time",ha="==",ua="!=",ca=">",pa=">=",da="<",ga="<=",fa="*",ya="/",ma="+",_a="-",va="clamp",Ca="%",xa="^",wa="abs",Ma="floor",Ea="ceil",Ia="round",Sa="sin",La="cos",ba="atan",Ra="sqrt",Na="match",Aa="between",Ta="interpolate",Pa="case",Oa="in",Da="number",ka="string",Fa="array",Ga="color",Ha="id",Va="band",ja="palette",za={[$o]:Xa((([t,e])=>void 0!==e?function(t){switch(t){case"string":return Vo;case"color":return jo;case"number":return Ho;case"boolean":return Go;case"number[]":return zo;default:throw new Error(`Unrecognized type hint: ${t}`)}}(e.value):Bo),Ua(1,2),(function(t,e){const i=Qo(t[1],e);if(!(i instanceof qo))throw new Error("Expected a literal argument for get operation");if("string"!=typeof i.value)throw new Error("Expected a string argument for get operation");return e.properties.add(i.value),3===t.length?[i,Qo(t[2],e)]:[i]})),[ta]:Xa((([t])=>t.type),Ua(1,1),(function(t,e,i,n){const r=t[1];if("string"!=typeof r)throw new Error("Expected a string argument for var operation");if(e.variables.add(r),!("variables"in e.style)||void 0===e.style.variables[r])return[new qo(Bo,r)];const s=Qo(e.style.variables[r],e);if(s.value=r,n&&!Wo(n,s.type))throw new Error(`The variable ${r} has type ${Yo(s.type)} but the following type was expected: ${Yo(n)}`);return[s]})),[Ha]:Xa(Ho|Vo,Ba,(function(t,e){e.featureId=!0})),[ea]:Xa(Vo,Ua(2,1/0),Za(Bo)),[ia]:Xa(Vo,Ba),[oa]:Xa(Ho,Ba),[aa]:Xa(Ho,Ba),[la]:Xa(Ho,Ba),[na]:Xa(Go,Ua(2,1/0),Za(Go)),[ra]:Xa(Go,Ua(2,1/0),Za(Go)),[sa]:Xa(Go,Ua(1,1),Za(Go)),[ha]:Xa(Go,Ua(2,2),Za(Bo),Ya),[ua]:Xa(Go,Ua(2,2),Za(Bo),Ya),[ca]:Xa(Go,Ua(2,2),Za(Bo),Ya),[pa]:Xa(Go,Ua(2,2),Za(Bo),Ya),[da]:Xa(Go,Ua(2,2),Za(Bo),Ya),[ga]:Xa(Go,Ua(2,2),Za(Bo),Ya),[fa]:Xa((t=>{let e=Ho|jo;for(let i=0;i<t.length;i++)e&=t[i].type;return e}),Ua(2,1/0),Za(Ho|jo),Ya),[ya]:Xa(Ho,Ua(2,2),Za(Ho)),[ma]:Xa(Ho,Ua(2,1/0),Za(Ho)),[_a]:Xa(Ho,Ua(2,2),Za(Ho)),[va]:Xa(Ho,Ua(3,3),Za(Ho)),[Ca]:Xa(Ho,Ua(2,2),Za(Ho)),[xa]:Xa(Ho,Ua(2,2),Za(Ho)),[wa]:Xa(Ho,Ua(1,1),Za(Ho)),[Ma]:Xa(Ho,Ua(1,1),Za(Ho)),[Ea]:Xa(Ho,Ua(1,1),Za(Ho)),[Ia]:Xa(Ho,Ua(1,1),Za(Ho)),[Sa]:Xa(Ho,Ua(1,1),Za(Ho)),[La]:Xa(Ho,Ua(1,1),Za(Ho)),[ba]:Xa(Ho,Ua(1,2),Za(Ho)),[Ra]:Xa(Ho,Ua(1,1),Za(Ho)),[Na]:Xa((t=>{let e=Bo;for(let i=2;i<t.length;i+=2)e&=t[i].type;return e&=t[t.length-1].type,e}),Ua(4,1/0),Wa,(function(t,e,i,n){const r=t.length-1;let s=Qo(t[1],e).type;const o=Qo(t[t.length-1],e);let a=void 0!==n?n&o.type:o.type;const l=new Array(r-2);for(let i=0;i<r-2;i+=2){const n=Qo(t[i+2],e),r=Qo(t[i+3],e);s&=n.type,a&=r.type,l[i]=n,l[i+1]=r}const h=Vo|Ho|Go;if(!Wo(h,s))throw new Error(`Expected an input of type ${Yo(h)} for the interpolate operation, got ${Yo(s)} instead`);if(Xo(a,0))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(t));for(let i=0;i<r-2;i+=2){const n=Qo(t[i+2],e,s),r=Qo(t[i+3],e,a);l[i]=n,l[i+1]=r}return[Qo(t[1],e,s),...l,Qo(t[t.length-1],e,a)]})),[Aa]:Xa(Go,Ua(3,3),Za(Ho)),[Ta]:Xa((t=>{let e=jo|Ho;for(let i=3;i<t.length;i+=2)e&=t[i].type;return e}),Ua(6,1/0),Wa,(function(t,e,i,n){const r=t[1];let s;switch(r[0]){case"linear":s=1;break;case"exponential":if(s=r[1],"number"!=typeof s)throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(s)} instead`);break;default:s=null}if(!s)throw new Error(`Invalid interpolation type: ${JSON.stringify(r)}`);s=Qo(s,e);let o=Qo(t[2],e);if(!Wo(Ho,o.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${Yo(o.type)} instead`);o=Qo(t[2],e,Ho);const a=new Array(t.length-3);for(let i=0;i<a.length;i+=2){let n=Qo(t[i+3],e);if(!Wo(Ho,n.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${Yo(n.type)} at position ${i+2} instead`);let r=Qo(t[i+4],e);if(!Wo(Ho|jo,r.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${Yo(r.type)} at position ${i+3} instead`);n=Qo(t[i+3],e,Ho),r=Qo(t[i+4],e,Ho|jo),a[i]=n,a[i+1]=r}return[s,o,...a]})),[Pa]:Xa((t=>{let e=Bo;for(let i=1;i<t.length;i+=2)e&=t[i].type;return e&=t[t.length-1].type,e}),Ua(3,1/0),(function(t,e){const i=t[0],n=t.length-1;if(n%2==0)throw new Error(`An odd amount of arguments was expected for operation ${i}, got ${JSON.stringify(n)} instead`)}),(function(t,e,i,n){const r=Qo(t[t.length-1],e);let s=void 0!==n?n&r.type:r.type;const o=new Array(t.length-1);for(let i=0;i<o.length-1;i+=2){const n=Qo(t[i+1],e),r=Qo(t[i+2],e);if(!Wo(Go,n.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${Yo(n.type)} at position ${i} instead`);s&=r.type,o[i]=n,o[i+1]=r}if(Xo(s,0))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(t));for(let i=0;i<o.length-1;i+=2)o[i+1]=Qo(t[i+2],e,s);return o[o.length-1]=Qo(t[t.length-1],e,s),o})),[Oa]:Xa(Go,Ua(2,2),(function(t,e){let i=t[2];if(!Array.isArray(i))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if("string"==typeof i[0]){if("literal"!==i[0])throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(i[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');i=i[1]}let n=Vo|Ho;const r=new Array(i.length);for(let t=0;t<r.length;t++){const s=Qo(i[t],e);n&=s.type,r[t]=s}if(Xo(n,0))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(t));return[Qo(t[1],e,n),...r]})),[Da]:Xa(Ho,Ua(1,1/0),Za(Bo)),[ka]:Xa(Vo,Ua(1,1/0),Za(Bo)),[Fa]:Xa((t=>3===t.length||4===t.length?zo|jo:zo),Ua(1,1/0),Za(Ho)),[Ga]:Xa(jo,Ua(3,4),Za(Ho)),[Va]:Xa(Ho,Ua(1,3),Za(Ho)),[ja]:Xa(jo,Ua(2,2),(function(t,e){const i=Qo(t[1],e,Ho);if(i.type!==Ho)throw new Error(`The first argument of palette must be an number, got ${Yo(i.type)} instead`);const n=t[2];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");const r=new Array(n.length);for(let t=0;t<r.length;t++){const i=Qo(n[t],e,jo);if(!(i instanceof qo))throw new Error(`The palette color at index ${t} must be a literal value`);if(!Wo(i.type,jo))throw new Error(`The palette color at index ${t} should be of type color, got ${Yo(i.type)} instead`);r[t]=i}return[i,...r]}))};function Ba(t,e){const i=t[0];if(1!==t.length)throw new Error(`Expected no arguments for ${i} operation`);return[]}function Ua(t,e){return function(i,n){const r=i[0],s=i.length-1;if(t===e){if(s!==t)throw new Error(`Expected ${t} argument${1===t?"":"s"} for ${r}, got ${s}`)}else if(s<t||s>e)throw new Error(`Expected ${e===1/0?`${t} or more`:`${t} to ${e}`} arguments for ${r}, got ${s}`)}}function Za(t){return function(e,i){const n=e[0],r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const r=Qo(e[o+1],i);if(!Wo(t,r.type)){const e=Yo(t),i=Yo(r.type);throw new Error(`Unexpected type for argument ${o} of ${n} operation, got ${e} but expected ${i}`)}r.type&=t,s[o]=r}return s}}function Ya(t,e,i){const n=t[0],r=t.length-1;let s=Bo;for(let t=0;t<i.length;++t)s&=i[t].type;if(0===s)throw new Error(`No common type could be found for arguments of ${n} operation`);const o=new Array(r);for(let i=0;i<r;++i)o[i]=Qo(t[i+1],e,s);return o}function Wa(t,e){const i=t[0],n=t.length-1;if(n%2==1)throw new Error(`An even amount of arguments was expected for operation ${i}, got ${JSON.stringify(n)} instead`)}function Xa(t,...e){return function(i,n,r){const s=i[0];let o=[];for(let t=0;t<e.length;t++)o=e[t](i,n,o,r)||o;let a="function"==typeof t?t(o):t;if(void 0!==r){if(!Wo(a,r))throw new Error(`The following expression was expected to return ${Yo(r)}, but returns ${Yo(a)} instead: ${JSON.stringify(i)}`);a&=r}if(0===a)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(i)}`);return new Ko(a,s,...o)}}function qa(t,e,i){const n=Qo(t,i);if(!Wo(e,n.type)){const t=Yo(e),i=Yo(n.type);throw new Error(`Expected expression to be of type ${t}, got ${i}`)}return Ka(n,i)}function Ka(t,e){if(t instanceof qo){if(t.type===jo&&"string"==typeof t.value){const e=se(t.value);return function(){return e}}return function(){return t.value}}const i=t.operator;switch(i){case Da:case ka:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Ka(t.args[i],e);switch(i){case Da:case ka:return t=>{for(let e=0;e<n;++e){const n=r[e](t);if(typeof n===i)return n}throw new Error(`Expected one of the values to be a ${i}`)};default:throw new Error(`Unsupported assertion operator ${i}`)}}(t,e);case $o:case ta:return function(t){const e=t.args[0].value;switch(t.operator){case $o:return t=>t.properties[e];case ta:return t=>t.variables[e];default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}(t);case"id":return t=>t.featureId;case ea:{const i=t.args.map((t=>Ka(t,e)));return t=>"".concat(...i.map((e=>e(t).toString())))}case oa:return t=>t.resolution;case na:case ra:case"!":return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Ka(t.args[i],e);switch(i){case na:return t=>{for(let e=0;e<n;++e)if(r[e](t))return!0;return!1};case ra:return t=>{for(let e=0;e<n;++e)if(!r[e](t))return!1;return!0};case"!":return t=>!r[0](t);default:throw new Error(`Unsupported logical operator ${i}`)}}(t,e);case ha:case ua:case"<":case ga:case">":case pa:return function(t,e){const i=t.operator,n=Ka(t.args[0],e),r=Ka(t.args[1],e);switch(i){case ha:return t=>n(t)===r(t);case ua:return t=>n(t)!==r(t);case"<":return t=>n(t)<r(t);case ga:return t=>n(t)<=r(t);case">":return t=>n(t)>r(t);case pa:return t=>n(t)>=r(t);default:throw new Error(`Unsupported comparison operator ${i}`)}}(t,e);case"*":case"/":case"+":case"-":case va:case"%":case"^":case wa:case Ma:case Ea:case Ia:case Sa:case La:case ba:case Ra:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Ka(t.args[i],e);switch(i){case"*":return t=>{let e=1;for(let i=0;i<n;++i)e*=r[i](t);return e};case"/":return t=>r[0](t)/r[1](t);case"+":return t=>{let e=0;for(let i=0;i<n;++i)e+=r[i](t);return e};case"-":return t=>r[0](t)-r[1](t);case va:return t=>{const e=r[0](t),i=r[1](t);if(e<i)return i;const n=r[2](t);return e>n?n:e};case"%":return t=>r[0](t)%r[1](t);case"^":return t=>Math.pow(r[0](t),r[1](t));case wa:return t=>Math.abs(r[0](t));case Ma:return t=>Math.floor(r[0](t));case Ea:return t=>Math.ceil(r[0](t));case Ia:return t=>Math.round(r[0](t));case Sa:return t=>Math.sin(r[0](t));case La:return t=>Math.cos(r[0](t));case ba:return 2===n?t=>Math.atan2(r[0](t),r[1](t)):t=>Math.atan(r[0](t));case Ra:return t=>Math.sqrt(r[0](t));default:throw new Error(`Unsupported numeric operator ${i}`)}}(t,e);case Na:return function(t,e){const i=t.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ka(t.args[r],e);return t=>{const e=n[0](t);for(let r=1;r<i;r+=2)if(e===n[r](t))return n[r+1](t);return n[i-1](t)}}(t,e);case Ta:return function(t,e){const i=t.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ka(t.args[r],e);return t=>{const e=n[0](t),r=n[1](t);let s,o;for(let a=2;a<i;a+=2){const i=n[a](t);let l=n[a+1](t);const h=Array.isArray(l);if(h&&(l=ne(l)),i>=r)return 2===a?l:h?Qa(e,r,s,o,i,l):Ja(e,r,s,o,i,l);s=i,o=l}return o}}(t,e);default:throw new Error(`Unsupported operator ${i}`)}}function Ja(t,e,i,n,r,s){const o=r-i;if(0===o)return n;const a=e-i;return n+(1===t?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1))*(s-n)}function Qa(t,e,i,n,r,s){if(0==r-i)return n;const o=re(n),a=re(s);let l=a[2]-o[2];return l>180?l-=360:l<-180&&(l+=360),ae(function(t){const e=kt.rgb(Ht.xyz(t));return e[3]=t[3],e}([Ja(t,e,i,o[0],r,a[0]),Ja(t,e,i,o[1],r,a[1]),o[2]+Ja(t,e,i,0,r,l),Ja(t,e,i,n[3],r,s[3])]))}function $a(t){return!0}function tl(t){const e=Jo(),i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=el(t[r],e);const r={variables:{},properties:{},resolution:NaN,featureId:null},s=new Array(i);return function(t,o){if(r.properties=t.getPropertiesInternal(),r.resolution=o,e.featureId){const e=t.getId();r.featureId=void 0!==e?e:null}let a=0;for(let t=0;t<i;++t){const e=n[t](r);e&&(s[a]=e,a+=1)}return s.length=a,s}}function el(t,e){const i=il(t,"",e),n=nl(t,"",e),r=function(t,e){const i="text-",n=sl(t,i+"value",e);if(!n)return null;const r=il(t,i,e),s=il(t,i+"background-",e),o=nl(t,i,e),a=nl(t,i+"background-",e),l=sl(t,i+"font",e),h=rl(t,i+"max-angle",e),u=rl(t,i+"offset-x",e),c=rl(t,i+"offset-y",e),p=ol(t,i+"overflow",e),d=sl(t,i+"placement",e),g=rl(t,i+"repeat",e),f=ul(t,i+"scale",e),y=ol(t,i+"rotate-with-view",e),m=rl(t,i+"rotation",e),_=sl(t,i+"align",e),v=sl(t,i+"justify",e),C=sl(t,i+"baseline",e),x=ll(t,i+"padding",e),w=new ko({});return function(t){if(w.setText(n(t)),r&&w.setFill(r(t)),s&&w.setBackgroundFill(s(t)),o&&w.setStroke(o(t)),a&&w.setBackgroundStroke(a(t)),l&&w.setFont(l(t)),h&&w.setMaxAngle(h(t)),u&&w.setOffsetX(u(t)),c&&w.setOffsetY(c(t)),p&&w.setOverflow(p(t)),d){const e=d(t);if("point"!==e&&"line"!==e)throw new Error("Expected point or line for text-placement");w.setPlacement(e)}if(g&&w.setRepeat(g(t)),f&&w.setScale(f(t)),y&&w.setRotateWithView(y(t)),m&&w.setRotation(m(t)),_){const e=_(t);if("left"!==e&&"center"!==e&&"right"!==e&&"end"!==e&&"start"!==e)throw new Error("Expected left, right, center, start, or end for text-align");w.setTextAlign(e)}if(v){const e=v(t);if("left"!==e&&"right"!==e&&"center"!==e)throw new Error("Expected left, right, or center for text-justify");w.setJustify(e)}if(C){const e=C(t);if("bottom"!==e&&"top"!==e&&"middle"!==e&&"alphabetic"!==e&&"hanging"!==e)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");w.setTextBaseline(e)}return x&&w.setPadding(x(t)),w}}(t,e),s=function(t,e){return"icon-src"in t?function(t,e){const i="icon-",n=i+"src",r=yl(t[n],n),s=hl(t,i+"anchor",e),o=ul(t,i+"scale",e),a=rl(t,i+"opacity",e),l=hl(t,i+"displacement",e),h=rl(t,i+"rotation",e),u=ol(t,i+"rotate-with-view",e),c=pl(t,i+"anchor-origin"),p=dl(t,i+"anchor-x-units"),d=dl(t,i+"anchor-y-units"),g=function(t,e){const i=t[e];if(void 0!==i)return _l(i,e)}(t,i+"color"),f=function(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);return i}}(t,i+"cross-origin"),y=function(t,e){const i=t[e];if(void 0!==i)return fl(i,e)}(t,i+"offset"),m=pl(t,i+"offset-origin"),_=cl(t,i+"width"),v=cl(t,i+"height"),C=function(t,e){const i=t[e];if(void 0!==i){if("number"==typeof i)return ws(i);if(!Array.isArray(i))throw new Error(`Expected a number or size array for ${e}`);if(2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])throw new Error(`Expected a number or size array for ${e}`);return i}}(t,i+"size"),x=gl(t,i+"declutter"),w=new Oo({src:r,anchorOrigin:c,anchorXUnits:p,anchorYUnits:d,color:g,crossOrigin:f,offset:y,offsetOrigin:m,height:v,width:_,size:C,declutterMode:x});return function(t){return a&&w.setOpacity(a(t)),l&&w.setDisplacement(l(t)),h&&w.setRotation(h(t)),u&&w.setRotateWithView(u(t)),o&&w.setScale(o(t)),s&&w.setAnchor(s(t)),w}}(t,e):"shape-points"in t?function(t,e){const i="shape-",n=i+"points",r=ml(t[n],n),s=il(t,i,e),o=nl(t,i,e),a=ul(t,i+"scale",e),l=hl(t,i+"displacement",e),h=rl(t,i+"rotation",e),u=ol(t,i+"rotate-with-view",e),c=cl(t,i+"radius"),p=cl(t,i+"radius1"),d=cl(t,i+"radius2"),g=cl(t,i+"angle"),f=gl(t,i+"declutter-mode"),y=new _o({points:r,radius:c,radius1:p,radius2:d,angle:g,declutterMode:f});return function(t){return s&&y.setFill(s(t)),o&&y.setStroke(o(t)),l&&y.setDisplacement(l(t)),h&&y.setRotation(h(t)),u&&y.setRotateWithView(u(t)),a&&y.setScale(a(t)),y}}(t,e):"circle-radius"in t?function(t,e){const i="circle-",n=il(t,i,e),r=nl(t,i,e),s=rl(t,i+"radius",e),o=ul(t,i+"scale",e),a=hl(t,i+"displacement",e),l=rl(t,i+"rotation",e),h=ol(t,i+"rotate-with-view",e),u=gl(t,i+"declutter-mode"),c=new Co({radius:5,declutterMode:u});return function(t){return s&&c.setRadius(s(t)),n&&c.setFill(n(t)),r&&c.setStroke(r(t)),a&&c.setDisplacement(a(t)),l&&c.setRotation(l(t)),h&&c.setRotateWithView(h(t)),o&&c.setScale(o(t)),c}}(t,e):null}(t,e),o=rl(t,"z-index",e);if(!(i||n||r||s||f(t)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new Ro;return function(t){let e=!0;if(i){const n=i(t);n&&(e=!1),a.setFill(n)}if(n){const i=n(t);i&&(e=!1),a.setStroke(i)}if(r){const i=r(t);i&&(e=!1),a.setText(i)}if(s){const i=s(t);i&&(e=!1),a.setImage(i)}return o&&a.setZIndex(o(t)),e?null:a}}function il(t,e,i){const n=al(t,e+"fill-color",i);if(!n)return null;const r=new wo;return function(t){const e=n(t);return"none"===e?null:(r.setColor(e),r)}}function nl(t,e,i){const n=rl(t,e+"stroke-width",i),r=al(t,e+"stroke-color",i);if(!n&&!r)return null;const s=sl(t,e+"stroke-line-cap",i),o=sl(t,e+"stroke-line-join",i),a=ll(t,e+"stroke-line-dash",i),l=rl(t,e+"stroke-line-dash-offset",i),h=rl(t,e+"stroke-miter-limit",i),u=new Eo;return function(t){if(r){const e=r(t);if("none"===e)return null;u.setColor(e)}if(n&&u.setWidth(n(t)),s){const e=s(t);if("butt"!==e&&"round"!==e&&"square"!==e)throw new Error("Expected butt, round, or square line cap");u.setLineCap(e)}if(o){const e=o(t);if("bevel"!==e&&"round"!==e&&"miter"!==e)throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(e)}return a&&u.setLineDash(a(t)),l&&u.setLineDashOffset(l(t)),h&&u.setMiterLimit(h(t)),u}}function rl(t,e,i){if(!(e in t))return;const n=qa(t[e],Ho,i);return function(t){return ml(n(t),e)}}function sl(t,e,i){if(!(e in t))return null;const n=qa(t[e],Vo,i);return function(t){return yl(n(t),e)}}function ol(t,e,i){if(!(e in t))return null;const n=qa(t[e],Go,i);return function(t){const i=n(t);if("boolean"!=typeof i)throw new Error(`Expected a boolean for ${e}`);return i}}function al(t,e,i){if(!(e in t))return null;const n=qa(t[e],jo|Vo,i);return function(t){return _l(n(t),e)}}function ll(t,e,i){if(!(e in t))return null;const n=qa(t[e],zo,i);return function(t){return fl(n(t),e)}}function hl(t,e,i){if(!(e in t))return null;const n=qa(t[e],zo,i);return function(t){const i=fl(n(t),e);if(2!==i.length)throw new Error(`Expected two numbers for ${e}`);return i}}function ul(t,e,i){if(!(e in t))return null;const n=qa(t[e],zo|Ho,i);return function(t){return function(t,e){if("number"==typeof t)return t;const i=fl(t,e);if(2!==i.length)throw new Error(`Expected an array of two numbers for ${e}`);return i}(n(t),e)}}function cl(t,e){const i=t[e];if(void 0!==i){if("number"!=typeof i)throw new Error(`Expected a number for ${e}`);return i}}function pl(t,e){const i=t[e];if(void 0!==i){if("bottom-left"!==i&&"bottom-right"!==i&&"top-left"!==i&&"top-right"!==i)throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return i}}function dl(t,e){const i=t[e];if(void 0!==i){if("pixels"!==i&&"fraction"!==i)throw new Error(`Expected pixels or fraction for ${e}`);return i}}function gl(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);if("declutter"!==i&&"obstacle"!==i&&"none"!==i)throw new Error(`Expected declutter, obstacle, or none for ${e}`);return i}}function fl(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const i=t.length;for(let n=0;n<i;++n)if("number"!=typeof t[n])throw new Error(`Expected an array of numbers for ${e}`);return t}function yl(t,e){if("string"!=typeof t)throw new Error(`Expected a string for ${e}`);return t}function ml(t,e){if("number"!=typeof t)throw new Error(`Expected a number for ${e}`);return t}function _l(t,e){if("string"==typeof t)return t;const i=fl(t,e),n=i.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return i}const vl="renderOrder",Cl=class extends Dn{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=void 0!==t.declutter&&t.declutter,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(vl)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new po(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set(vl,t)}setStyle(t){this.style_=function(t){if(void 0===t)return Lo;if(!t)return null;if("function"==typeof t)return t;if(t instanceof Ro)return t;if(!Array.isArray(t))return tl([t]);if(0===t.length)return[];const e=t.length,i=t[0];if(i instanceof Ro){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!(e instanceof Ro))throw new Error("Expected a list of style instances");i[n]=e}return i}if("style"in i){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!("style"in e))throw new Error("Expected a list of rules with a style property");i[n]=e}return function(t){const e=Jo(),i=function(t,e){const i=t.length,n=new Array(i);for(let r=0;r<i;++r){const i=t[r],s="filter"in i?qa(i.filter,Go,e):$a;let o;if(Array.isArray(i.style)){const t=i.style.length;o=new Array(t);for(let n=0;n<t;++n)o[n]=el(i.style[n],e)}else o=[el(i.style,e)];n[r]={filter:s,styles:o}}return function(e){const r=[];let s=!1;for(let o=0;o<i;++o)if((0,n[o].filter)(e)&&(!t[o].else||!s)){s=!0;for(const t of n[o].styles){const i=t(e);i&&r.push(i)}}return r}}(t,e),n={variables:{},properties:{},resolution:NaN,featureId:null};return function(t,r){if(n.properties=t.getPropertiesInternal(),n.resolution=r,e.featureId){const e=t.getId();n.featureId=void 0!==e?e:null}return i(n)}}(i)}return tl(t)}(t),this.styleFunction_=null===t?void 0:function(t){let e;if("function"==typeof t)e=t;else{let i;Array.isArray(t)?i=t:(q("function"==typeof t.getZIndex,"Expected an `Style` or an array of `Style`"),i=[t]),e=function(){return i}}return e}(this.style_),this.changed()}},xl={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},wl=[xl.FILL],Ml=[xl.STROKE],El=[xl.BEGIN_PATH],Il=[xl.CLOSE_PATH],Sl=xl,Ll=class{drawCustom(t,e,i,n){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}},bl=class extends Ll{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates;let s=r.length;for(let o=0,a=t.length;o<a;o+=e)n[0]=t[o],n[1]=t[o+1],st(i,n)&&(r[s++]=n[0],r[s++]=n[1]);return s}appendFlatLineCoordinates(t,e,i,n,r,s){const o=this.coordinates;let a=o.length;const l=this.getBufferedMaxExtent();s&&(e+=n);let h=t[e],u=t[e+1];const c=this.tmpCoordinate_;let p,d,g,f=!0;for(p=e+n;p<i;p+=n)c[0]=t[p],c[1]=t[p+1],g=lt(l,c),g!==d?(f&&(o[a++]=h,o[a++]=u,f=!1),o[a++]=c[0],o[a++]=c[1]):1===g?(o[a++]=c[0],o[a++]=c[1],f=!1):f=!0,h=c[0],u=c[1],d=g;return(r&&f||p===e+n)&&(o[a++]=h,o[a++]=u),a}drawCustomCoordinates_(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s],a=this.appendFlatLineCoordinates(t,e,o,n,!1,!1);r.push(a),e=o}return e}drawCustom(t,e,i,n){this.beginGeometry(t,e);const r=t.getType(),s=t.getStride(),o=this.coordinates.length;let a,l,h,u,c;switch(r){case"MultiPolygon":a=t.getOrientedFlatCoordinates(),u=[];const e=t.getEndss();c=0;for(let t=0,i=e.length;t<i;++t){const i=[];c=this.drawCustomCoordinates_(a,c,e[t],s,i),u.push(i)}this.instructions.push([Sl.CUSTOM,o,u,t,i,on]),this.hitDetectionInstructions.push([Sl.CUSTOM,o,u,t,n||i,on]);break;case"Polygon":case"MultiLineString":h=[],a="Polygon"==r?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),c=this.drawCustomCoordinates_(a,0,t.getEnds(),s,h),this.instructions.push([Sl.CUSTOM,o,h,t,i,sn]),this.hitDetectionInstructions.push([Sl.CUSTOM,o,h,t,n||i,sn]);break;case"LineString":case"Circle":a=t.getFlatCoordinates(),l=this.appendFlatLineCoordinates(a,0,a.length,s,!1,!1),this.instructions.push([Sl.CUSTOM,o,l,t,i,rn]),this.hitDetectionInstructions.push([Sl.CUSTOM,o,l,t,n||i,rn]);break;case"MultiPoint":a=t.getFlatCoordinates(),l=this.appendFlatPointCoordinates(a,s),l>o&&(this.instructions.push([Sl.CUSTOM,o,l,t,i,rn]),this.hitDetectionInstructions.push([Sl.CUSTOM,o,l,t,n||i,rn]));break;case"Point":a=t.getFlatCoordinates(),this.coordinates.push(a[0],a[1]),l=this.coordinates.length,this.instructions.push([Sl.CUSTOM,o,l,t,i]),this.hitDetectionInstructions.push([Sl.CUSTOM,o,l,t,n||i])}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[Sl.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Sl.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let n,r,s=-1;for(e=0;e<i;++e)n=t[e],r=n[0],r==Sl.END_GEOMETRY?s=e:r==Sl.BEGIN_GEOMETRY&&(n[2]=e,a(this.hitDetectionInstructions,s,e),s=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const e=t.getColor();i.fillStyle=yo(e||tr)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=yo(t||rr);const n=e.getLineCap();i.lineCap=void 0!==n?n:er;const r=e.getLineDash();i.lineDash=r?r.slice():ir;const s=e.getLineDashOffset();i.lineDashOffset=s||0;const o=e.getLineJoin();i.lineJoin=void 0!==o?o:nr;const a=e.getWidth();i.lineWidth=void 0!==a?a:1;const l=e.getMiterLimit();i.miterLimit=void 0!==l?l:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[Sl.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Sl.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,r=t.lineDash,s=t.lineDashOffset,o=t.lineJoin,a=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!h(t.currentLineDash,r)||t.currentLineDashOffset!=s||t.currentLineJoin!=o||t.currentLineWidth!=a||t.currentMiterLimit!=l)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=s,t.currentLineJoin=o,t.currentLineWidth=a,t.currentMiterLimit=l)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[Sl.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=nt(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;it(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}},Rl=class extends bl{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const r=this.state,s=void 0!==r.fillStyle,o=void 0!==r.strokeStyle,a=i.length;this.instructions.push(El),this.hitDetectionInstructions.push(El);for(let r=0;r<a;++r){const s=i[r],a=this.coordinates.length,l=this.appendFlatLineCoordinates(t,e,s,n,!0,!o),h=[Sl.MOVE_TO_LINE_TO,a,l];this.instructions.push(h),this.hitDetectionInstructions.push(h),o&&(this.instructions.push(Il),this.hitDetectionInstructions.push(Il)),e=s}return s&&(this.instructions.push(wl),this.hitDetectionInstructions.push(wl)),o&&(this.instructions.push(Ml),this.hitDetectionInstructions.push(Ml)),e}drawCircle(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Sl.SET_FILL_STYLE,tr]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Sl.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ir,0]);const s=t.getFlatCoordinates(),o=t.getStride(),a=this.coordinates.length;this.appendFlatLineCoordinates(s,0,s.length,o,!1,!1);const l=[Sl.CIRCLE,a];this.instructions.push(El,l),this.hitDetectionInstructions.push(El,l),void 0!==i.fillStyle&&(this.instructions.push(wl),this.hitDetectionInstructions.push(wl)),void 0!==i.strokeStyle&&(this.instructions.push(Ml),this.hitDetectionInstructions.push(Ml)),this.endGeometry(e)}drawPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Sl.SET_FILL_STYLE,tr]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Sl.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ir,0]);const s=t.getEnds(),o=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(o,0,s,a),this.endGeometry(e)}drawMultiPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Sl.SET_FILL_STYLE,tr]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Sl.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ir,0]);const s=t.getEndss(),o=t.getOrientedFlatCoordinates(),a=t.getStride();let l=0;for(let t=0,e=s.length;t<e;++t)l=this.drawFlatCoordinatess_(o,l,s[t],a);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=tn(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}};function Nl(t,e,i,n,r){const s=[];let o=i,a=0,l=e.slice(i,2);for(;a<t&&o+r<n;){const[i,n]=l.slice(-2),h=e[o+r],u=e[o+r+1],c=Math.sqrt((h-i)*(h-i)+(u-n)*(u-n));if(a+=c,a>=t){const e=(t-a+c)/c,p=qt(i,h,e),d=qt(n,u,e);l.push(p,d),s.push(l),l=[p,d],a==t&&(o+=r),a=0}else if(a<t)l.push(e[o+r],e[o+r+1]),o+=r;else{const t=c-a,e=qt(i,h,t/c),p=qt(n,u,t/c);l.push(e,p),s.push(l),l=[e,p],a=0,o+=r}}return a>0&&s.push(l),s}function Al(t,e,i,n,r){let s,o,a,l,h,u,c,p,d,g,f=i,y=i,m=0,_=0,v=i;for(o=i;o<n;o+=r){const i=e[o],n=e[o+1];void 0!==h&&(d=i-h,g=n-u,l=Math.sqrt(d*d+g*g),void 0!==c&&(_+=a,s=Math.acos((c*d+p*g)/(a*l)),s>t&&(_>m&&(m=_,f=v,y=o),_=0,v=o-r)),a=l,c=d,p=g),h=i,u=n}return _+=l,_>m?[v,o]:[f,y]}const Tl={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Pl={Circle:Rl,Default:bl,Image:class extends bl{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,s=this.appendFlatPointCoordinates(i,n);this.instructions.push([Sl.DRAW_IMAGE,r,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Sl.DRAW_IMAGE,r,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,s=this.appendFlatPointCoordinates(i,n);this.instructions.push([Sl.DRAW_IMAGE,r,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Sl.DRAW_IMAGE,r,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},LineString:class extends bl{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const r=this.coordinates.length,s=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),o=[Sl.MOVE_TO_LINE_TO,r,s];return this.instructions.push(o),this.hitDetectionInstructions.push(o),i}drawLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Sl.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ir,0],El);const s=t.getFlatCoordinates(),o=t.getStride();this.drawFlatCoordinates_(s,0,s.length,o),this.hitDetectionInstructions.push(Ml),this.endGeometry(e)}drawMultiLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Sl.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ir,0],El);const s=t.getEnds(),o=t.getFlatCoordinates(),a=t.getStride();let l=0;for(let t=0,e=s.length;t<e;++t)l=this.drawFlatCoordinates_(o,l,s[t],a);this.hitDetectionInstructions.push(Ml),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Ml),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Ml),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(El)}},Polygon:Rl,Text:class extends bl{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[tr]={fillStyle:tr},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const i=this.textFillState_,n=this.textStrokeState_,r=this.textState_;if(""===this.text_||!r||!i&&!n)return;const s=this.coordinates;let o=s.length;const a=t.getType();let l=null,h=t.getStride();if("line"!==r.placement||"LineString"!=a&&"MultiLineString"!=a&&"Polygon"!=a&&"MultiPolygon"!=a){let i=r.overflow?null:[];switch(a){case"Point":case"MultiPoint":l=t.getFlatCoordinates();break;case"LineString":l=t.getFlatMidpoint();break;case"Circle":l=t.getCenter();break;case"MultiLineString":l=t.getFlatMidpoints(),h=2;break;case"Polygon":l=t.getFlatInteriorPoint(),r.overflow||i.push(l[2]/this.resolution),h=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();l=[];for(let t=0,n=e.length;t<n;t+=3)r.overflow||i.push(e[t+2]/this.resolution),l.push(e[t],e[t+1]);if(0===l.length)return;h=2}const n=this.appendFlatPointCoordinates(l,h);if(n===o)return;if(i&&(n-o)/2!=l.length/h){let t=o/2;i=i.filter(((e,i)=>{const n=s[2*(t+i)]===l[i*h]&&s[2*(t+i)+1]===l[i*h+1];return n||--t,n}))}this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&this.updateFillStyle(this.state,this.createFill),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let u=r.padding;if(u!=ar&&(r.scale[0]<0||r.scale[1]<0)){let t=r.padding[0],e=r.padding[1],i=r.padding[2],n=r.padding[3];r.scale[0]<0&&(e=-e,n=-n),r.scale[1]<0&&(t=-t,i=-i),u=[t,e,i,n]}const c=this.pixelRatio;this.instructions.push([Sl.DRAW_IMAGE,o,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,u==ar?ar:u.map((function(t){return t*c})),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]);const p=1/c,d=this.state.fillStyle;r.backgroundFill&&(this.state.fillStyle=tr,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([Sl.DRAW_IMAGE,o,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[p,p],NaN,void 0,this.declutterImageWithText_,u,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?tr:this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]),r.backgroundFill&&(this.state.fillStyle=d,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!At(this.getBufferedMaxExtent(),t.getExtent()))return;let i;if(l=t.getFlatCoordinates(),"LineString"==a)i=[l.length];else if("MultiLineString"==a)i=t.getEnds();else if("Polygon"==a)i=t.getEnds().slice(0,1);else if("MultiPolygon"==a){const e=t.getEndss();i=[];for(let t=0,n=e.length;t<n;++t)i.push(e[t][0])}this.beginGeometry(t,e);const n=r.repeat,u=n?void 0:r.textAlign;let c=0;for(let t=0,e=i.length;t<e;++t){let e;e=n?Nl(n*this.resolution,l,c,i[t],h):[l.slice(c,i[t])];for(let n=0,a=e.length;n<a;++n){const a=e[n];let l=0,p=a.length;if(null==u){const t=Al(r.maxAngle,a,0,a.length,2);l=t[0],p=t[1]}for(let t=l;t<p;t+=h)s.push(a[t],a[t+1]);const d=s.length;c=i[t],this.drawChars_(o,d),o=d}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||sr,justify:e.justify,textBaseline:e.textBaseline||or,scale:e.scale});const s=this.fillKey_;i&&(s in this.fillStates||(this.fillStates[s]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,r=this.strokeKey_,s=this.textKey_,o=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,l=Tl[n.textBaseline],h=this.textOffsetY_*a,u=this.text_,c=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([Sl.DRAW_CHARS,t,e,l,n.overflow,o,n.maxAngle,a,h,r,c*a,u,s,1]),this.hitDetectionInstructions.push([Sl.DRAW_CHARS,t,e,l,n.overflow,o?tr:o,n.maxAngle,a,h,r,c*a,u,s,1/a])}setTextStyle(t,e){let i,n,r;if(t){const e=t.getFill();e?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=yo(e.getColor()||tr)):(n=null,this.textFillState_=n);const s=t.getStroke();if(s){r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const t=s.getLineDash(),e=s.getLineDashOffset(),i=s.getWidth(),n=s.getMiterLimit();r.lineCap=s.getLineCap()||er,r.lineDash=t?t.slice():ir,r.lineDashOffset=void 0===e?0:e,r.lineJoin=s.getLineJoin()||nr,r.lineWidth=void 0===i?1:i,r.miterLimit=void 0===n?10:n,r.strokeStyle=yo(s.getColor()||rr)}else r=null,this.textStrokeState_=r;i=this.textState_;const o=t.getFont()||$n;pr(o);const a=t.getScaleArray();i.overflow=t.getOverflow(),i.font=o,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||or,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||ar,i.scale=void 0===a?[1,1]:a;const l=t.getOffsetX(),h=t.getOffsetY(),u=t.getRotateWithView(),c=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===l?0:l,this.textOffsetY_=void 0===h?0:h,this.textRotateWithView_=void 0!==u&&u,this.textRotation_=void 0===c?0:c,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:T(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+T(n.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}},Ol=class{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const r=i[n].finish();t[e][n]=r}}return t}getBuilder(t,e){const i=void 0!==t?t.toString():"0";let n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);let r=n[e];return void 0===r&&(r=new(0,Pl[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r),r}};function Dl(t,e,i,n,r,s,o,a,l,h,u,c){let p=t[e],d=t[e+1],g=0,f=0,y=0,m=0;function _(){g=p,f=d,p=t[e+=n],d=t[e+1],m+=y,y=Math.sqrt((p-g)*(p-g)+(d-f)*(d-f))}do{_()}while(e<i-n&&m+y<s);let v=0===y?0:(s-m)/y;const C=qt(g,p,v),x=qt(f,d,v),w=e-n,M=m,E=s+a*l(h,r,u);for(;e<i-n&&m+y<E;)_();v=0===y?0:(E-m)/y;const I=qt(g,p,v),S=qt(f,d,v);let L;if(c){const t=[C,x,I,S];Vi(t,0,4,2,c,t,t),L=t[0]>t[2]}else L=C>I;const b=Math.PI,R=[],N=w+n===e;let A;if(y=0,m=M,p=t[e=w],d=t[e+1],N){_(),A=Math.atan2(d-f,p-g),L&&(A+=A>0?-b:b);const t=(I+C)/2,e=(S+x)/2;return R[0]=[t,e,(E-s)/2,A,r],R}for(let t=0,c=(r=r.replace(/\n/g," ")).length;t<c;){_();let C=Math.atan2(d-f,p-g);if(L&&(C+=C>0?-b:b),void 0!==A){let t=C-A;if(t+=t>b?-2*b:t<-b?2*b:0,Math.abs(t)>o)return null}A=C;const x=t;let w=0;for(;t<c;++t){const o=a*l(h,r[L?c-t-1:t],u);if(e+n<i&&m+y<s+w+o/2)break;w+=o}if(t===x)continue;const M=L?r.substring(c-x,c-t):r.substring(x,t);v=0===y?0:(s+w/2-m)/y;const E=qt(g,p,v),I=qt(f,d,v);R.push([E,I,w/2,C,M]),s+=w}return R}function kl(t,e,i,n){let r=t[e],s=t[e+1],o=0;for(let a=e+n;a<i;a+=n){const e=t[a],i=t[a+1];o+=Math.sqrt((e-r)*(e-r)+(i-s)*(i-s)),r=e,s=i}return o}const Fl=[1/0,1/0,-1/0,-1/0],Gl=[],Hl=[],Vl=[],jl=[];function zl(t){return t[3].declutterBox}const Bl=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function Ul(t,e){return"start"===e?e=Bl.test(t)?"right":"left":"end"===e&&(e=Bl.test(t)?"left":"right"),Tl[e]}function Zl(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}const Yl=class{constructor(t,e,i,n){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,i,n){const r=t+e+i+n;if(this.labels_[r])return this.labels_[r];const s=n?this.strokeStates[n]:null,o=i?this.fillStates[i]:null,a=this.textStates[e],l=this.pixelRatio,h=[a.scale[0]*l,a.scale[1]*l],u=Array.isArray(t),c=a.justify?Tl[a.justify]:Ul(Array.isArray(t)?t[0]:t,a.textAlign||sr),p=n&&s.lineWidth?s.lineWidth:0,d=u?t:t.split("\n").reduce(Zl,[]),{width:g,height:f,widths:y,heights:m,lineWidths:_}=function(t,e){const i=[],n=[],r=[];let s=0,o=0,a=0,l=0;for(let h=0,u=e.length;h<=u;h+=2){const c=e[h];if("\n"===c||h===u){s=Math.max(s,o),r.push(o),o=0,a+=l;continue}const p=e[h+1]||t.font,d=fr(p,c);i.push(d),o+=d;const g=dr(p);n.push(g),l=Math.max(l,g)}return{width:s,height:a,widths:i,heights:n,lineWidths:r}}(a,d),v=g+p,C=[],x=(v+2)*h[0],w=(f+p)*h[1],M={width:x<0?Math.floor(x):Math.ceil(x),height:w<0?Math.floor(w):Math.ceil(w),contextInstructions:C};1==h[0]&&1==h[1]||C.push("scale",h),n&&(C.push("strokeStyle",s.strokeStyle),C.push("lineWidth",p),C.push("lineCap",s.lineCap),C.push("lineJoin",s.lineJoin),C.push("miterLimit",s.miterLimit),C.push("setLineDash",[s.lineDash]),C.push("lineDashOffset",s.lineDashOffset)),i&&C.push("fillStyle",o.fillStyle),C.push("textBaseline","middle"),C.push("textAlign","center");const E=.5-c;let I=c*v+E*p;const S=[],L=[];let b,R=0,N=0,A=0,T=0;for(let t=0,e=d.length;t<e;t+=2){const e=d[t];if("\n"===e){N+=R,R=0,I=c*v+E*p,++T;continue}const r=d[t+1]||a.font;r!==b&&(n&&S.push("font",r),i&&L.push("font",r),b=r),R=Math.max(R,m[A]);const s=[e,I+E*y[A]+c*(y[A]-_[T]),.5*(p+R)+N];I+=y[A],n&&S.push("strokeText",s),i&&L.push("fillText",s),++A}return Array.prototype.push.apply(C,S),Array.prototype.push.apply(C,L),this.labels_[r]=M,M}replayTextBackground_(t,e,i,n,r,s,o){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),s&&(this.alignFill_=s[2],this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,r,s,o,a,l,h,u,c,p,d,g,f){let y=i-(o*=c[0]),m=n-(a*=c[1]);const _=r+l>t?t-l:r,v=s+h>e?e-h:s,C=d[3]+_*c[0]+d[1],x=d[0]+v*c[1]+d[2],w=y-d[3],M=m-d[0];let E;return(g||0!==u)&&(Gl[0]=w,jl[0]=w,Gl[1]=M,Hl[1]=M,Hl[0]=w+C,Vl[0]=Hl[0],Vl[1]=M+x,jl[1]=Vl[1]),0!==u?(E=J([1,0,0,1,0,0],i,n,1,1,u,-i,-n),K(E,Gl),K(E,Hl),K(E,Vl),K(E,jl),ht(Math.min(Gl[0],Hl[0],Vl[0],jl[0]),Math.min(Gl[1],Hl[1],Vl[1],jl[1]),Math.max(Gl[0],Hl[0],Vl[0],jl[0]),Math.max(Gl[1],Hl[1],Vl[1],jl[1]),Fl)):ht(Math.min(w,w+C),Math.min(M,M+x),Math.max(w,w+C),Math.max(M,M+x),Fl),p&&(y=Math.round(y),m=Math.round(m)),{drawImageX:y,drawImageY:m,drawImageW:_,drawImageH:v,originX:l,originY:h,declutterBox:{minX:Fl[0],minY:Fl[1],maxX:Fl[2],maxY:Fl[3],value:f},canvasTransform:E,scale:c}}replayImageOrLabel_(t,e,i,n,r,s,o){const a=!(!s&&!o),l=n.declutterBox,h=t.canvas,u=o?o[2]*n.scale[0]/2:0;return l.minX-u<=h.width/e&&l.maxX+u>=0&&l.minY-u<=h.height/e&&l.maxY+u>=0&&(a&&this.replayTextBackground_(t,Gl,Hl,Vl,jl,s,o),function(t,e,i,n,r,s,o,a,l,h,u){t.save(),1!==i&&(t.globalAlpha*=i),e&&t.transform.apply(t,e),n.contextInstructions?(t.translate(l,h),t.scale(u[0],u[1]),function(t,e){const i=t.contextInstructions;for(let t=0,n=i.length;t<n;t+=2)Array.isArray(i[t+1])?e[i[t]].apply(e,i[t+1]):e[i[t]]=i[t+1]}(n,t)):u[0]<0||u[1]<0?(t.translate(l,h),t.scale(u[0],u[1]),t.drawImage(n,r,s,o,a,0,0,o,a)):t.drawImage(n,r,s,o,a,l,h,o*u[0],a*u[1]),t.restore()}(t,n.canvasTransform,r,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){if(this.alignFill_){const e=K(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,n){const r=this.textStates[e],s=this.createLabel(t,e,n,i),o=this.strokeStates[i],a=this.pixelRatio,l=Ul(Array.isArray(t)?t[0]:t,r.textAlign||sr),h=Tl[r.textBaseline||or],u=o&&o.lineWidth?o.lineWidth:0;return{label:s,anchorX:l*(s.width/a-2*r.scale[0])+2*(.5-l)*u,anchorY:h*s.height/a+2*(.5-h)*u}}execute_(t,e,i,n,r,s,o,a){let l;var u,c;this.pixelCoordinates_&&h(i,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=Hi(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),c=i,(u=this.renderedTransform_)[0]=c[0],u[1]=c[1],u[2]=c[2],u[3]=c[3],u[4]=c[4],u[5]=c[5]);let p=0;const d=n.length;let g,f,y,m,_,v,C,x,w,M,E,I,S=0,L=0,b=0,R=null,N=null;const A=this.coordinateCache_,T=this.viewRotation_,P=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,O={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:T},D=this.instructions!=n||this.overlaps?0:200;let k,F,G,H;for(;p<d;){const i=n[p];switch(i[0]){case Sl.BEGIN_GEOMETRY:k=i[1],H=i[3],k.getGeometry()?void 0===o||At(o,H.getExtent())?++p:p=i[2]+1:p=i[2];break;case Sl.BEGIN_PATH:L>D&&(this.fill_(t),L=0),b>D&&(t.stroke(),b=0),L||b||(t.beginPath(),m=NaN,_=NaN),++p;break;case Sl.CIRCLE:S=i[1];const n=l[S],h=l[S+1],u=l[S+2]-n,c=l[S+3]-h,d=Math.sqrt(u*u+c*c);t.moveTo(n+d,h),t.arc(n,h,d,0,2*Math.PI,!0),++p;break;case Sl.CLOSE_PATH:t.closePath(),++p;break;case Sl.CUSTOM:S=i[1],g=i[2];const V=i[3],j=i[4],z=6==i.length?i[5]:void 0;O.geometry=V,O.feature=k,p in A||(A[p]=[]);const B=A[p];z?z(l,S,g,2,B):(B[0]=l[S],B[1]=l[S+1],B.length=2),j(B,O),++p;break;case Sl.DRAW_IMAGE:S=i[1],g=i[2],x=i[3],f=i[4],y=i[5];let U=i[6];const Z=i[7],Y=i[8],W=i[9],X=i[10];let q=i[11];const K=i[12];let J=i[13];const Q=i[14],$=i[15];if(!x&&i.length>=20){w=i[19],M=i[20],E=i[21],I=i[22];const t=this.drawLabelWithPointPlacement_(w,M,E,I);x=t.label,i[3]=x;const e=i[23];f=(t.anchorX-e)*this.pixelRatio,i[4]=f;const n=i[24];y=(t.anchorY-n)*this.pixelRatio,i[5]=y,U=x.height,i[6]=U,J=x.width,i[13]=J}let tt,et,it,nt;i.length>25&&(tt=i[25]),i.length>17?(et=i[16],it=i[17],nt=i[18]):(et=ar,it=!1,nt=!1),X&&P?q+=T:X||P||(q-=T);let rt=0;for(;S<g;S+=2){if(tt&&tt[rt++]<J/this.pixelRatio)continue;const i=this.calculateImageOrLabelDimensions_(x.width,x.height,l[S],l[S+1],J,U,f,y,Y,W,q,K,r,et,it||nt,k),n=[t,e,x,i,Z,it?R:null,nt?N:null];if(a){if("none"===Q)continue;if("obstacle"===Q){a.insert(i.declutterBox);continue}{let t,e;if($){const i=g-S;if(!$[i]){$[i]=n;continue}if(t=$[i],delete $[i],e=zl(t),a.collides(e))continue}if(a.collides(i.declutterBox))continue;t&&(a.insert(e),this.replayImageOrLabel_.apply(this,t)),a.insert(i.declutterBox)}}this.replayImageOrLabel_.apply(this,n)}++p;break;case Sl.DRAW_CHARS:const st=i[1],ot=i[2],at=i[3],lt=i[4];I=i[5];const ht=i[6],ut=i[7],ct=i[8];E=i[9];const pt=i[10];w=i[11],M=i[12];const dt=[i[13],i[13]],gt=this.textStates[M],ft=gt.font,yt=[gt.scale[0]*ut,gt.scale[1]*ut];let mt;ft in this.widths_?mt=this.widths_[ft]:(mt={},this.widths_[ft]=mt);const _t=kl(l,st,ot,2),vt=Math.abs(yt[0])*yr(ft,w,mt);if(lt||vt<=_t){const i=Dl(l,st,ot,2,w,(_t-vt)*Ul(w,this.textStates[M].textAlign),ht,Math.abs(yt[0]),yr,ft,mt,P?0:this.viewRotation_);t:if(i){const n=[];let r,s,o,l,h;if(E)for(r=0,s=i.length;r<s;++r){h=i[r],o=h[4],l=this.createLabel(o,M,"",E),f=h[2]+(yt[0]<0?-pt:pt),y=at*l.height+2*(.5-at)*pt*yt[1]/yt[0]-ct;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,h[0],h[1],l.width,l.height,f,y,0,0,h[3],dt,!1,ar,!1,k);if(a&&a.collides(s.declutterBox))break t;n.push([t,e,l,s,1,null,null])}if(I)for(r=0,s=i.length;r<s;++r){h=i[r],o=h[4],l=this.createLabel(o,M,I,""),f=h[2],y=at*l.height-ct;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,h[0],h[1],l.width,l.height,f,y,0,0,h[3],dt,!1,ar,!1,k);if(a&&a.collides(s.declutterBox))break t;n.push([t,e,l,s,1,null,null])}a&&a.load(n.map(zl));for(let t=0,e=n.length;t<e;++t)this.replayImageOrLabel_.apply(this,n[t])}}++p;break;case Sl.END_GEOMETRY:if(void 0!==s){k=i[1];const t=s(k,H);if(t)return t}++p;break;case Sl.FILL:D?L++:this.fill_(t),++p;break;case Sl.MOVE_TO_LINE_TO:for(S=i[1],g=i[2],F=l[S],G=l[S+1],v=F+.5|0,C=G+.5|0,v===m&&C===_||(t.moveTo(F,G),m=v,_=C),S+=2;S<g;S+=2)F=l[S],G=l[S+1],v=F+.5|0,C=G+.5|0,S!=g-2&&v===m&&C===_||(t.lineTo(F,G),m=v,_=C);++p;break;case Sl.SET_FILL_STYLE:R=i,this.alignFill_=i[2],L&&(this.fill_(t),L=0,b&&(t.stroke(),b=0)),t.fillStyle=i[1],++p;break;case Sl.SET_STROKE_STYLE:N=i,b&&(t.stroke(),b=0),this.setStrokeStyle_(t,i),++p;break;case Sl.STROKE:D?b++:t.stroke(),++p;break;default:++p}}L&&this.fill_(t),b&&t.stroke()}execute(t,e,i,n,r,s){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,r,void 0,void 0,s)}executeHitDetection(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,n,r)}},Wl=["Polygon","Circle","LineString","Image","Text","Default"],Xl={},ql=class{constructor(t,e,i,n,r,s){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(r)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t){for(const e in t){let i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);const n=t[e];for(const t in n){const e=n[t];i[t]=new Yl(this.resolution_,this.pixelRatio_,this.overlaps_,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let e=0,n=t.length;e<n;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,r,o){const a=2*(n=Math.round(n))+1,l=J(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Yn(a,a,void 0,{willReadFrequently:!0}));const u=this.hitDetectionContext_;let c;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):h||u.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(c=[1/0,1/0,-1/0,-1/0],ft(c,t),it(c,e*(this.renderBuffer_+n),c));const p=function(t){if(void 0!==Xl[t])return Xl[t];const e=2*t+1,i=t*t,n=new Array(i+1);for(let r=0;r<=t;++r)for(let s=0;s<=t;++s){const o=r*r+s*s;if(o>i)break;let a=n[o];a||(a=[],n[o]=a),a.push(4*((t+r)*e+(t+s))+3),r>0&&a.push(4*((t-r)*e+(t+s))+3),s>0&&(a.push(4*((t+r)*e+(t-s))+3),r>0&&a.push(4*((t-r)*e+(t-s))+3))}const r=[];for(let t=0,e=n.length;t<e;++t)n[t]&&r.push(...n[t]);return Xl[t]=r,r}(n);let d;function g(t,e){const i=u.getImageData(0,0,a,a).data;for(let s=0,l=p.length;s<l;s++)if(i[p[s]]>0){if(!o||"Image"!==d&&"Text"!==d||o.includes(t)){const i=(p[s]-3)/4,o=n-i%a,l=n-(i/a|0),h=r(t,e,o*o+l*l);if(h)return h}u.clearRect(0,0,a,a);break}}const f=Object.keys(this.executorsByZIndex_).map(Number);let y,m,_,v,C;for(f.sort(s),y=f.length-1;y>=0;--y){const t=f[y].toString();for(_=this.executorsByZIndex_[t],m=Wl.length-1;m>=0;--m)if(d=Wl[m],v=_[d],void 0!==v&&(C=v.executeHitDetection(u,l,i,g,c),C))return C}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],r=e[2],s=e[3],o=[i,n,i,s,r,s,r,n];return Hi(o,0,8,2,t,o),o}isEmpty(){return f(this.executorsByZIndex_)}execute(t,e,i,n,r,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);let h,u,c,p,d,g;for(l.sort(s),this.maxExtent_&&(t.save(),this.clip(t,i)),o=o||Wl,a&&l.reverse(),h=0,u=l.length;h<u;++h){const s=l[h].toString();for(d=this.executorsByZIndex_[s],c=0,p=o.length;c<p;++c)g=d[o[c]],void 0!==g&&g.execute(t,e,i,n,r,a)}this.maxExtent_&&t.restore()}},Kl=class extends Ll{constructor(t,e,i,n,r,s,o){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?Kt(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=s,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,i,n){if(!this.image_)return;const r=Hi(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_,o=this.tmpLocalTransform_,a=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=a*this.imageOpacity_);let l=this.imageRotation_;0===this.transformRotation_&&(l-=this.viewRotation_),this.imageRotateWithView_&&(l+=this.viewRotation_);for(let t=0,e=r.length;t<e;t+=2){const e=r[t]-this.imageAnchorX_,i=r[t+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const t=e+this.imageAnchorX_,n=i+this.imageAnchorY_;J(o,t,n,1,1,l,-t,-n),s.save(),s.transform.apply(s,o),s.translate(t,n),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.restore()}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,i,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(s.globalAlpha=a)}drawText_(t,e,i,n){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=Hi(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_;let o=this.textRotation_;for(0===this.transformRotation_&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);e<i;e+=n){const t=r[e]+this.textOffsetX_,i=r[e+1]+this.textOffsetY_;0!==o||1!=this.textScale_[0]||1!=this.textScale_[1]?(s.save(),s.translate(t-this.textOffsetX_,i-this.textOffsetY_),s.rotate(o),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.restore()):(this.textStrokeState_&&s.strokeText(this.text_,t,i),this.textFillState_&&s.fillText(this.text_,t,i))}}moveToLineTo_(t,e,i,n,r){const s=this.context_,o=Hi(t,e,i,n,this.transform_,this.pixelCoordinates_);s.moveTo(o[0],o[1]);let a=o.length;r&&(a-=2);for(let t=2;t<a;t+=2)s.lineTo(o[t],o[t+1]);return r&&s.closePath(),i}drawRings_(t,e,i,n){for(let r=0,s=i.length;r<s;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),At(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=function(t,e,i){const n=t.getFlatCoordinates();if(!n)return null;const r=t.getStride();return Hi(n,0,n.length,r,e,i)}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),s=this.context_;s.beginPath(),s.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let t=0,i=e.length;t<i;++t)this.drawGeometry(e[t])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),At(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(At(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let n=0;const r=t.getEnds(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t)n=this.moveToLineTo_(i,n,r[t],s,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),At(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),At(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const r=t.getEndss(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t){const e=r[t];n=this.drawRings_(i,n,e,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),h(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:sr;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:yo(e||tr)}}else this.fillState_=null;if(e){const t=e.getColor(),i=e.getLineCap(),n=e.getLineDash(),r=e.getLineDashOffset(),s=e.getLineJoin(),o=e.getWidth(),a=e.getMiterLimit(),l=n||ir;this.strokeState_={lineCap:void 0!==i?i:er,lineDash:1===this.pixelRatio_?l:l.map((t=>t*this.pixelRatio_)),lineDashOffset:(r||0)*this.pixelRatio_,lineJoin:void 0!==s?s:nr,lineWidth:(void 0!==o?o:1)*this.pixelRatio_,miterLimit:void 0!==a?a:10,strokeStyle:yo(t||rr)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const s=t.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/i,s[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:yo(t||tr)}}else this.textFillState_=null;const i=t.getStroke();if(i){const t=i.getColor(),e=i.getLineCap(),n=i.getLineDash(),r=i.getLineDashOffset(),s=i.getLineJoin(),o=i.getWidth(),a=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:er,lineDash:n||ir,lineDashOffset:r||0,lineJoin:void 0!==s?s:nr,lineWidth:void 0!==o?o:1,miterLimit:void 0!==a?a:10,strokeStyle:yo(t||rr)}}else this.textStrokeState_=null;const n=t.getFont(),r=t.getOffsetX(),s=t.getOffsetY(),o=t.getRotateWithView(),a=t.getRotation(),l=t.getScaleArray(),h=t.getText(),u=t.getTextAlign(),c=t.getTextBaseline();this.textState_={font:void 0!==n?n:$n,textAlign:void 0!==u?u:sr,textBaseline:void 0!==c?c:or},this.text_=void 0!==h?Array.isArray(h)?h.reduce(((t,e,i)=>t+(i%2?" ":e)),""):h:"",this.textOffsetX_=void 0!==r?this.pixelRatio_*r:0,this.textOffsetY_=void 0!==s?this.pixelRatio_*s:0,this.textRotateWithView_=void 0!==o&&o,this.textRotation_=void 0!==a?a:0,this.textScale_=[this.pixelRatio_*l[0],this.pixelRatio_*l[1]]}else this.text_=""}},Jl=.5,Ql={Point:function(t,e,i,n,r){const s=i.getImage(),o=i.getText();let a;if(s){if(2!=s.getImageState())return;let l=t;if(r){const h=s.getDeclutterMode();if("none"!==h)if(l=r,"obstacle"===h){const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(s,a),r.drawPoint(e,n)}else o&&o.getText()&&(a={})}const h=l.getBuilder(i.getZIndex(),"Image");h.setImageStyle(s,a),h.drawPoint(e,n)}if(o&&o.getText()){let s=t;r&&(s=r);const l=s.getBuilder(i.getZIndex(),"Text");l.setTextStyle(o,a),l.drawText(e,n)}},LineString:function(t,e,i,n,r){const s=i.getStroke();if(s){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,s),r.drawLineString(e,n)}const o=i.getText();if(o&&o.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n)}},Polygon:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(s||o){const r=t.getBuilder(i.getZIndex(),"Polygon");r.setFillStrokeStyle(s,o),r.drawPolygon(e,n)}const a=i.getText();if(a&&a.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}},MultiPoint:function(t,e,i,n,r){const s=i.getImage(),o=i.getText();let a;if(s){if(2!=s.getImageState())return;let l=t;if(r){const h=s.getDeclutterMode();if("none"!==h)if(l=r,"obstacle"===h){const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(s,a),r.drawMultiPoint(e,n)}else o&&o.getText()&&(a={})}const h=l.getBuilder(i.getZIndex(),"Image");h.setImageStyle(s,a),h.drawMultiPoint(e,n)}if(o&&o.getText()){let s=t;r&&(s=r);const l=s.getBuilder(i.getZIndex(),"Text");l.setTextStyle(o,a),l.drawText(e,n)}},MultiLineString:function(t,e,i,n,r){const s=i.getStroke();if(s){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,s),r.drawMultiLineString(e,n)}const o=i.getText();if(o&&o.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n)}},MultiPolygon:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(o||s){const r=t.getBuilder(i.getZIndex(),"Polygon");r.setFillStrokeStyle(s,o),r.drawMultiPolygon(e,n)}const a=i.getText();if(a&&a.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}},GeometryCollection:function(t,e,i,n,r){const s=e.getGeometriesArray();let o,a;for(o=0,a=s.length;o<a;++o)(0,Ql[s[o].getType()])(t,s[o],i,n,r)},Circle:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(s||o){const r=t.getBuilder(i.getZIndex(),"Circle");r.setFillStrokeStyle(s,o),r.drawCircle(e,n)}const a=i.getText();if(a&&a.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}}};function $l(t,e){return parseInt(T(t),10)-parseInt(T(e),10)}function th(t,e){return.5*t/e}function eh(t,e,i,n,r,s,o){let a=!1;const l=i.getImage();if(l){const t=l.getImageState();2==t||3==t?l.unlistenImageChange(r):(0==t&&l.load(),l.listenImageChange(r),a=!0)}return function(t,e,i,n,r,s){const o=i.getGeometryFunction()(e);if(!o)return;const a=o.simplifyTransformed(n,r);i.getRenderer()?ih(t,a,i,e):(0,Ql[a.getType()])(t,a,i,e,s)}(t,e,i,n,s,o),a}function ih(t,e,i,n){if("GeometryCollection"!=e.getType())t.getBuilder(i.getZIndex(),"Default").drawCustom(e,n,i.getRenderer(),i.getHitDetectionRenderer());else{const r=e.getGeometries();for(let e=0,s=r.length;e<s;++e)ih(t,r[e],i,n)}}const nh=class extends Us{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,r=e.viewState,s=r.center,o=r.resolution,a=r.projection,l=r.rotation,h=a.getExtent(),u=this.getLayer().getSource(),c=e.pixelRatio,p=e.viewHints,d=!(p[0]||p[1]),g=this.compositionContext_,f=Math.round(e.size[0]*c),y=Math.round(e.size[1]*c),m=u.getWrapX()&&a.canWrapX(),_=m?Nt(h):null,v=m?Math.ceil((n[2]-h[2])/_)+1:1;let C=m?Math.floor((n[0]-h[0])/_):0;do{const e=this.getRenderTransform(s,o,l,c,f,y,C*_);t.execute(g,1,e,l,d,void 0,i)}while(++C<v)}setupCompositionContext_(){if(1!==this.opacity_){const t=Yn(this.context.canvas.width,this.context.canvas.height,zs);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(1!==this.opacity_){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,Wn(this.compositionContext_),zs.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,e){const i=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];!function(t,e,i){!function(t,e,i,n,r,s,o){t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=s,t[5]=o}(t,e,0,0,i,0,0)}(this.pixelTransform,1/i,1/i),Q(this.inversePixelTransform,this.pixelTransform);const r=tt(this.pixelTransform);this.useContainer(e,r,this.getBackground(t));const s=this.context,o=s.canvas,a=this.replayGroup_,l=this.declutterExecutorGroup;let h=a&&!a.isEmpty()||l&&!l.isEmpty();if(!h&&!this.getLayer().hasListener(xe)&&!this.getLayer().hasListener(we))return null;const u=Math.round(t.size[0]*i),c=Math.round(t.size[1]*i);o.width!=u||o.height!=c?(o.width=u,o.height=c,o.style.transform!==r&&(o.style.transform=r)):this.containerReused||s.clearRect(0,0,u,c),this.preRender(s,t);const p=t.viewState;p.projection;this.opacity_=n.opacity,this.setupCompositionContext_();let d=!1;if(h&&n.extent&&this.clipping){const e=wi(n.extent);h=At(e,t.extent),d=h&&!ot(e,t.extent),d&&this.clipUnrotated(this.compositionContext_,t,e)}return h&&this.renderWorlds(a,t),d&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(s,t),this.renderedRotation_!==p.rotation&&(this.renderedRotation_=p.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise((e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const t=[this.context.canvas.width,this.context.canvas.height];K(this.pixelTransform,t);const e=this.renderedCenter_,i=this.renderedResolution_,n=this.renderedRotation_,r=this.renderedProjection_,o=this.wrappedRenderedExtent_,a=this.getLayer(),l=[],h=t[0]*Jl,u=t[1]*Jl;l.push(this.getRenderTransform(e,i,n,Jl,h,u,0).slice());const c=a.getSource(),p=r.getExtent();if(c.getWrapX()&&r.canWrapX()&&!ot(p,o)){let t=o[0];const r=Nt(p);let s,a=0;for(;t<p[0];)--a,s=r*a,l.push(this.getRenderTransform(e,i,n,Jl,h,u,s).slice()),t+=r;for(a=0,t=o[2];t>p[2];)++a,s=r*a,l.push(this.getRenderTransform(e,i,n,Jl,h,u,s).slice()),t-=r}this.hitDetectionImageData_=function(t,e,i,n,r,o,a){const l=Yn(t[0]*Jl,t[1]*Jl);l.imageSmoothingEnabled=!1;const h=l.canvas,u=new Kl(l,Jl,r,null,a),c=i.length,p=Math.floor(16777215/c),d={};for(let t=1;t<=c;++t){const e=i[t-1],s=e.getStyleFunction()||n;if(!s)continue;let a=s(e,o);if(!a)continue;Array.isArray(a)||(a=[a]);const l=(t*p).toString(16).padStart(7,"#00000");for(let t=0,i=a.length;t<i;++t){const i=a[t],n=i.getGeometryFunction()(e);if(!n||!At(r,n.getExtent()))continue;const s=i.clone(),o=s.getFill();o&&o.setColor(l);const h=s.getStroke();h&&(h.setColor(l),h.setLineDash(null)),s.setText(void 0);const u=i.getImage();if(u){const t=u.getImageSize();if(!t)continue;const e=Yn(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=l,e.fillRect(0,0,i.width,i.height),s.setImage(new Oo({img:i,anchor:u.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:u.getOrigin(),opacity:1,size:u.getSize(),scale:u.getScale(),rotation:u.getRotation(),rotateWithView:u.getRotateWithView()}))}const c=s.getZIndex()||0;let p=d[c];p||(p={},d[c]=p,p.Polygon=[],p.Circle=[],p.LineString=[],p.Point=[]);const g=n.getType();if("GeometryCollection"===g){const t=n.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){const i=t[e];p[i.getType().replace("Multi","")].push(i,s)}}else p[g.replace("Multi","")].push(n,s)}}const g=Object.keys(d).map(Number).sort(s);for(let t=0,i=g.length;t<i;++t){const i=d[g[t]];for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t+=2){u.setStyle(n[t+1]);for(let i=0,r=e.length;i<r;++i)u.setTransform(e[i]),u.drawGeometry(n[t])}}}return l.getImageData(0,0,h.width,h.height)}(t,l,this.renderedFeatures_,a.getStyleFunction(),o,i,n)}e(function(t,e,i){const n=[];if(i){const r=Math.floor(Math.round(t[0])*Jl),s=Math.floor(Math.round(t[1])*Jl),o=4*(Bt(r,0,i.width-1)+Bt(s,0,i.height-1)*i.width),a=i.data[o],l=i.data[o+1],h=i.data[o+2]+256*(l+256*a),u=Math.floor(16777215/e.length);h&&h%u==0&&n.push(e[h/u-1])}return n}(t,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(t,e,i,n,r){if(!this.replayGroup_)return;const s=e.viewState.resolution,o=e.viewState.rotation,a=this.getLayer(),l={},h=function(t,e,i){const s=T(t),o=l[s];if(o){if(!0!==o&&i<o.distanceSq){if(0===i)return l[s]=!0,r.splice(r.lastIndexOf(o),1),n(t,a,e);o.geometry=e,o.distanceSq=i}}else{if(0===i)return l[s]=!0,n(t,a,e);r.push(l[s]={feature:t,layer:a,geometry:e,distanceSq:i,callback:n})}};let u;const c=[this.replayGroup_];return this.declutterExecutorGroup&&c.push(this.declutterExecutorGroup),c.some((n=>u=n.forEachFeatureAtCoordinate(t,s,o,i,h,n===this.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map((t=>t.value)):null))),u}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[0],r=t.viewHints[1],s=e.getUpdateWhileAnimating(),o=e.getUpdateWhileInteracting();if(this.ready&&!s&&n||!o&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const a=t.extent,l=t.viewState,u=l.projection,c=l.resolution,p=t.pixelRatio,d=e.getRevision(),g=e.getRenderBuffer();let f=e.getRenderOrder();void 0===f&&(f=$l);const y=l.center.slice(),m=it(a,g*c),_=m.slice(),v=[m.slice()],C=u.getExtent();if(i.getWrapX()&&u.canWrapX()&&!ot(C,t.extent)){const t=Nt(C),e=Math.max(Nt(m)/2,t);m[0]=C[0]-e,m[2]=C[2]+e,Xe(y,u);const i=Pt(v[0],u);i[0]<C[0]&&i[2]<C[2]?v.push([i[0]+t,i[1],i[2]+t,i[3]]):i[0]>C[0]&&i[2]>C[2]&&v.push([i[0]-t,i[1],i[2]-t,i[3]])}if(this.ready&&this.renderedResolution_==c&&this.renderedRevision_==d&&this.renderedRenderOrder_==f&&ot(this.wrappedRenderedExtent_,m))return h(this.renderedExtent_,_)||(this.hitDetectionImageData_=null,this.renderedExtent_=_),this.renderedCenter_=y,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const x=new Ol(th(c,p),m,c,p);let w;this.getLayer().getDeclutter()&&(w=new Ol(th(c,p),m,c,p));const M=_i();let E;if(M){for(let t=0,e=v.length;t<e;++t){const e=xi(v[t]);i.loadFeatures(e,Mi(c),M)}E=di(M,u)}else for(let t=0,e=v.length;t<e;++t)i.loadFeatures(v[t],c,u);const I=function(t,e){const i=th(t,e);return i*i}(c,p);let S=!0;const L=t=>{let i;const n=t.getStyleFunction()||e.getStyleFunction();if(n&&(i=n(t,c)),i){const e=this.renderFeature(t,I,i,x,E,w);S=S&&!e}},b=xi(m),R=i.getFeaturesInExtent(b);f&&R.sort(f);for(let t=0,e=R.length;t<e;++t)L(R[t]);this.renderedFeatures_=R,this.ready=S;const N=x.finish(),A=new ql(m,c,p,i.getOverlaps(),N,e.getRenderBuffer());return w&&(this.declutterExecutorGroup=new ql(m,c,p,i.getOverlaps(),w.finish(),e.getRenderBuffer())),this.renderedResolution_=c,this.renderedRevision_=d,this.renderedRenderOrder_=f,this.renderedExtent_=_,this.wrappedRenderedExtent_=m,this.renderedCenter_=y,this.renderedProjection_=u,this.replayGroup_=A,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,r,s){if(!i)return!1;let o=!1;if(Array.isArray(i))for(let a=0,l=i.length;a<l;++a)o=eh(n,t,i[a],e,this.boundHandleStyleImageChange_,r,s)||o;else o=eh(n,t,i,e,this.boundHandleStyleImageChange_,r,s);return o}},rh=class extends Cl{constructor(t){super(t)}createRenderer(){return new nh(this)}},sh=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return q(void 0!==i,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return q(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){q(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}};function oh(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function ah(t,e,i){return t+"/"+e+"/"+i}function lh(t){return ah(t[0],t[1],t[2])}function hh(t){return(t[1]<<t[0])+t[2]}const uh=class extends sh{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(0===this.getCount())return;const t=this.peekFirstKey().split("/").map(Number)[0];this.forEach((e=>{e.tileCoord[0]!==t&&(this.remove(lh(e.tileCoord)),e.release())}))}};function ch(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const ph=class extends O{constructor(t){super(),this.projection=oi(t.projection),this.attributions_=ch(t.attributions),this.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise((function(t,i){e.viewResolver=t,e.viewRejector=i}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=ch(t),this.changed()}setState(t){this.state_=t,this.changed()}},dh=[0,0,0],gh=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,q(function(t){const e=((t,e)=>e-t)||s;return t.every((function(i,n){if(0===n)return!0;const r=e(t[n-1],i);return!(r>0||0===r)}))}(this.resolutions_),"`resolutions` must be sorted in descending order"),!t.origins)for(let t=0,i=this.resolutions_.length-1;t<i;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,q(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;void 0===i||this.origin_||this.origins_||(this.origin_=bt(i)),q(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,q(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:256,q(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(((t,e)=>{const n=new oo(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(i){const t=this.getTileRangeForExtentAndZ(i,e);n.minX=Math.max(t.minX,n.minX),n.maxX=Math.min(t.maxX,n.maxX),n.minY=Math.max(t.minY,n.minY),n.maxY=Math.min(t.maxY,n.maxY)}return n})):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const n=this.getTileRangeForExtentAndZ(t,e);for(let t=n.minX,r=n.maxX;t<=r;++t)for(let r=n.minY,s=n.maxY;r<=s;++r)i([e,t,r])}forEachTileCoordParentTileRange(t,e,i,n){let r,s,o,a=null,l=t[0]-1;for(2===this.zoomFactor_?(s=t[1],o=t[2]):a=this.getTileCoordExtent(t,n);l>=this.minZoom;){if(void 0!==s&&void 0!==o?(s=Math.floor(s/2),o=Math.floor(o/2),r=so(s,s,o,o,i)):r=this.getTileRangeForExtentAndZ(a,l,i),e(l,r))return!0;--l}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const i=2*t[1],n=2*t[2];return so(i,i+1,n,n+1,e)}const n=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const n=t[0],r=t[1],s=t[2];if(e===n)return so(r,s,r,s,i);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-n),o=Math.floor(r*t),a=Math.floor(s*t);return e<n?so(o,o,a,a,i):so(o,Math.floor(t*(r+1))-1,a,Math.floor(t*(s+1))-1,i)}const o=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,dh);const n=dh[1],r=dh[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,dh),so(n,dh[1],r,dh[2],i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=ws(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=ws(this.getTileSize(t[0]),this.tmpSize_),s=i[0]+t[1]*r[0]*n,o=i[1]-(t[2]+1)*r[1]*n;return ht(s,o,s+r[0]*n,o+r[1]*n,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,n,r){const s=this.getZForResolution(i),o=i/this.getResolution(s),a=this.getOrigin(s),l=ws(this.getTileSize(s),this.tmpSize_);let h=o*(t-a[0])/i/l[0],u=o*(a[1]-e)/i/l[1];return n?(h=$t(h,5)-1,u=$t(u,5)-1):(h=Qt(h,5),u=Qt(u,5)),oh(s,h,u,r)}getTileCoordForXYAndZ_(t,e,i,n,r){const s=this.getOrigin(i),o=this.getResolution(i),a=ws(this.getTileSize(i),this.tmpSize_);let l=(t-s[0])/o/a[0],h=(s[1]-e)/o/a[1];return n?(l=$t(l,5)-1,h=$t(h,5)-1):(l=Qt(l,5),h=Qt(h,5)),oh(i,l,h,r)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return Bt(o(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Cn(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i}};function fh(t){let e=t.getDefaultTileGrid();return e||(e=function(t){return function(t,e,i,n){n=void 0!==n?n:"top-left";const r=function(t,e,i,n){e=void 0!==e?e:42,i=ws(void 0!==i?i:Se);const r=St(t),s=Nt(t);n=n>0?n:Math.max(s/i[0],r/i[1]);const o=e+1,a=new Array(o);for(let t=0;t<o;++t)a[t]=n/Math.pow(2,t);return a}(t,e,i);return new gh({extent:t,origin:Mt(t,n),resolutions:r,tileSize:i})}(yh(t),void 0,void 0,void 0)}(t),t.setDefaultTileGrid(e)),e}function yh(t){let e=(t=oi(t)).getExtent();if(!e){const i=180*Le.degrees/t.getMetersPerUnit();e=ht(-i,-i,i,i)}return e}class mh extends t{constructor(t,e){super(t),this.tile=e}}const _h=class extends ph{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;this.tileGrid&&ws(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new uh(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)}forEachLoadedTile(t,e,i,n){const r=this.getTileCacheForProjection(t);if(!r)return!1;let s,o,a,l=!0;for(let t=i.minX;t<=i.maxX;++t)for(let h=i.minY;h<=i.maxY;++h)o=ah(e,t,h),a=!1,r.containsKey(o)&&(s=r.get(o),a=2===s.getState(),a&&(a=!1!==n(s))),a||(l=!1);return l}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,n,r){return N()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:fh(t)}getTileCacheForProjection(t){const e=this.getProjection();return q(null===e||pi(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),s=ws(n.getTileSize(t),this.tmpSize);return 1==r?s:(o=s,a=r,void 0===(l=this.tmpSize)&&(l=[0,0]),l[0]=o[0]*a+.5|0,l[1]=o[1]*a+.5|0,l);var o,a,l}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();const i=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,i){const n=e[0],r=t.getTileCoordCenter(e),s=yh(i);if(!st(s,r)){const e=Nt(s),i=Math.ceil((s[0]-r[0])/e);return r[0]+=e*i,t.getTileCoordForCoordAndZ(r,n)}return e}(i,t,e)),function(t,e){const i=t[0],n=t[1],r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;const s=e.getFullTileRange(i);return!s||s.containsXY(n,r)}(t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const i=this.getTileCacheForProjection(e);t>i.highWaterMark&&(i.highWaterMark=t)}useTile(t,e,i,n){}};function vh(t,e){const i=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,s=/\{-y\}/g;return function(o,a,l){if(o)return t.replace(i,o[0].toString()).replace(n,o[1].toString()).replace(r,o[2].toString()).replace(s,(function(){const t=o[0],i=e.getFullTileRange(t);if(!i)throw new Error("The {-y} placeholder requires a tile grid with extent");return(i.getHeight()-o[2]-1).toString()}))}}function Ch(t){return 1===t.length?t[0]:function(e,i,n){if(!e)return;const r=Xt(hh(e),t.length);return t[r](e,i,n)}}function xh(t){const e=[];let i=/\{([a-z])-([a-z])\}/.exec(t);if(i){const n=i[1].charCodeAt(0),r=i[2].charCodeAt(0);let s;for(s=n;s<=r;++s)e.push(t.replace(i[0],String.fromCharCode(s)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t),i){const n=parseInt(i[2],10);for(let r=parseInt(i[1],10);r<=n;r++)e.push(t.replace(i[0],r.toString()));return e}return e.push(t),e}class wh extends _h{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===wh.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=T(e),n=e.getState();let r;1==n?(this.tileLoadingKeys_[i]=!0,r="tileloadstart"):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=3==n?"tileloaderror":2==n?"tileloadend":void 0),null!=r&&this.dispatchEvent(new mh(r,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=xh(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=vh(t[r],e);return Ch(n)}(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){const n=ah(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)}}const Mh=wh;function Eh(t,e){t.getImage().src=e}const Ih=class extends Mh{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Eh,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:qs,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const t in this.tileCacheForProjection){const n=this.tileCacheForProjection[t];n.expireCache(n==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!pi(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!pi(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||pi(e,t)))return this.tileGrid;const i=T(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=fh(t)),this.tileGridForProjection[i]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||pi(e,t))return this.tileCache;const i=T(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new uh(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(t,e,i,n,r,s){const o=[t,e,i],a=this.getTileCoordForTileUrlFunction(o,r),l=a?this.tileUrlFunction(a,n,r):void 0,h=new this.tileClass(o,void 0!==l?0:4,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=s,h.addEventListener(m,this.handleTileChange.bind(this)),h}getTile(t,e,i,n,r){const s=this.getProjection();if(!s||!r||pi(s,r))return this.getTileInternal(t,e,i,n,s||r);const o=this.getTileCacheForProjection(r),a=[t,e,i];let l;const h=lh(a);o.containsKey(h)&&(l=o.get(h));const u=this.getKey();if(l&&l.key==u)return l;const c=this.getTileGridForProjection(s),p=this.getTileGridForProjection(r),d=this.getTileCoordForTileUrlFunction(a,r),g=new no(s,c,r,p,a,d,this.getTilePixelRatio(n),this.getGutter(),((t,e,i,n)=>this.getTileInternal(t,e,i,n,s)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=u,l?(g.interimTile=l,g.refreshInterimChain(),o.replace(h,g)):o.set(h,g),g}getTileInternal(t,e,i,n,r){let s=null;const o=ah(t,e,i),a=this.getKey();if(this.tileCache.containsKey(o)){if(s=this.tileCache.get(o),s.key!=a){const l=s;s=this.createTile_(t,e,i,n,r,a),0==l.getState()?s.interimTile=l.interimTile:s.interimTile=l,s.refreshInterimChain(),this.tileCache.replace(o,s)}}else s=this.createTile_(t,e,i,n,r,a),this.tileCache.set(o,s);return s}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(t,e){const i=oi(t);if(i){const t=T(i);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}};function Sh(t,e){const i=[];Object.keys(e).forEach((function(t){null!==e[t]&&void 0!==e[t]&&i.push(t+"="+encodeURIComponent(e[t]))}));const n=i.join("&");return t=t.replace(/[?&]$/,""),(t+=t.includes("?")?"&":"?")+n}function Lh(t,e){const i=(""+t).split("."),n=(""+e).split(".");for(let t=0;t<Math.max(i.length,n.length);t++){const e=parseInt(i[t]||"0",10),r=parseInt(n[t]||"0",10);if(e>r)return 1;if(r>e)return-1}return 0}function bh(t){return Array.isArray(t)?Math.min(...t):t}const Rh=class extends Xs{constructor(t,e,i,n,r,s,o){let a=t.getExtent();a&&t.canWrapX()&&(a=a.slice(),a[0]=-1/0,a[2]=1/0);let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);const h=l?Lt(i,l):i,u=eo(t,e,wt(h),n),c=new Ks(t,e,h,a,.5*u,n),p=c.calculateSourceExtent(),d=Tt(p)?null:s(p,u,r),g=d?0:4,f=d?d.getPixelRatio():1;super(i,n,f,g),this.targetProj_=e,this.maxSourceExtent_=a,this.triangulation_=c,this.targetResolution_=n,this.targetExtent_=i,this.sourceImage_=d,this.sourcePixelRatio_=f,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){1==this.state&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const t=this.sourceImage_.getState();if(2==t){const t=Nt(this.targetExtent_)/this.targetResolution_,e=St(this.targetExtent_)/this.targetResolution_;this.canvas_=io(t,e,this.sourcePixelRatio_,bh(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(0==this.state){this.state=1,this.changed();const t=this.sourceImage_.getState();2==t||3==t?this.reproject_():(this.sourceListenerKey_=E(this.sourceImage_,m,(function(t){const e=this.sourceImage_.getState();2!=e&&3!=e||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}}unlistenSource_(){S(this.sourceListenerKey_),this.sourceListenerKey_=null}};class Nh extends t{constructor(t,e){super(t),this.image=e}}function Ah(t,e){t.getImage().src=e}function Th(t,e,i,n){const r=e/i,s=wt(t),o=$t(Nt(t)/r,4),a=$t(St(t)/r,4);return Et(s,r,0,[o+2*$t((n-1)*o/2,4),a+2*$t((n-1)*a/2,4)])}const Ph=class extends ph{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:void 0===t.interpolate||t.interpolate}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=void 0!==t.resolutions?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=!!t.loader&&0===t.loader.length,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){const e=this.getResolutions();return e&&(t=e[o(e,t,0)]),t}getImage(t,e,i,n){const r=this.getProjection();if(!r||!n||pi(r,n))return r&&(n=r),this.getImageInternal(t,e,i,n);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&pi(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&dt(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new Rh(r,n,t,e,i,((t,e,i)=>this.getImageInternal(t,e,i,r)),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,i,n){if(this.loader){const r=Th(t,e,i,1),s=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===n&&(this.wantedExtent_&&ot(this.wantedExtent_,r)||ot(this.image.getExtent(),r))&&(this.wantedResolution_&&bh(this.wantedResolution_)===s||bh(this.image.getResolution())===s)))return this.image;this.wantedProjection_=n,this.wantedExtent_=r,this.wantedResolution_=s,this.image=new Xs(r,s,i,this.loader),this.image.addEventListener(m,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){const e=t.target;let i;switch(e.getState()){case 1:this.loading=!0,i="imageloadstart";break;case 2:this.loading=!1,i="imageloadend";break;case 3:this.loading=!1,i="imageloaderror";break;default:return}this.hasListener(i)&&this.dispatchEvent(new Nh(i,e))}},Oh="1.3.0",Dh=[101,101];function kh(t,e,i,n,r){r.WIDTH=i[0],r.HEIGHT=i[1];const s=n.getAxisOrientation();let o;const a=Lh(r.VERSION,"1.3")>=0;return r[a?"CRS":"SRS"]=n.getCode(),o=a&&"ne"==s.substr(0,2)?[e[1],e[0],e[3],e[2]]:e,r.BBOX=o.join(","),Sh(t,r)}function Fh(t,e,i,n,r,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/i,l=[Jt(Nt(t)/a,4),Jt(St(t)/a,4)];if(1!=i)switch(o){case"geoserver":const t=90*i+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+t:s.FORMAT_OPTIONS="dpi:"+t;break;case"mapserver":s.MAP_RESOLUTION=90*i;break;case"carmentaserver":case"qgis":s.DPI=90*i;break;default:throw new Error("Unknown `serverType` configured")}return kh(r,t,l,n,s)}function Gh(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:Oh,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},t)}const Hh=class extends Ih{constructor(t){t=t||{};const e=Object.assign({},t.params),i=!("TRANSPARENT"in e)||e.TRANSPARENT;super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:!i,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0,this.params_=e,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=void 0===t.hidpi||t.hidpi,this.tmpExtent_=[1/0,1/0,-1/0,-1/0],this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(t,e,i,n){const r=oi(i),s=this.getProjection()||r;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(s));const a=fi(t,r,s),l=eo(s,r,t,e),h=o.getZForResolution(l,this.zDirection),u=o.getResolution(h),c=o.getTileCoordForCoordAndZ(a,h);if(o.getResolutions().length<=c[0])return;let p=o.getTileCoordExtent(c,this.tmpExtent_);const d=this.gutter_;0!==d&&(p=it(p,u*d,p));const g={QUERY_LAYERS:this.params_.LAYERS};Object.assign(g,Gh(this.params_,"GetFeatureInfo"),n);const f=Math.floor((a[0]-p[0])/u),y=Math.floor((p[3]-a[1])/u);return g[this.v13_?"I":"X"]=f,g[this.v13_?"J":"Y"]=y,this.getRequestUrl_(c,p,1,s||r,g)}getLegendUrl(t,e){if(void 0===this.urls[0])return;const i={SERVICE:"WMS",VERSION:Oh,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e||void 0===e.LAYER){const t=this.params_.LAYERS;if(Array.isArray(t)&&1!==t.length)return;i.LAYER=t}if(void 0!==t){const e=this.getProjection()?this.getProjection().getMetersPerUnit():1,n=28e-5;i.SCALE=t*e/n}return Object.assign(i,e),Sh(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(t,e,i,n,r){const s=this.urls;if(!s)return;let o;return o=1==s.length?s[0]:s[Xt(hh(t),s.length)],Fh(e,(this.tileGrid||this.getTileGridForProjection(n)).getResolution(t[0]),i,n,o,r,this.serverType_)}getTilePixelRatio(t){return this.hidpi_&&void 0!==this.serverType_?t:1}getKeyForParams_(){let t=0;const e=[];for(const i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")}updateParams(t){Object.assign(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){const t=this.params_.VERSION||Oh;this.v13_=Lh(t,"1.3")>=0}tileUrlFunction(t,e,i){let n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(i)),n.getResolutions().length<=t[0])return;1==e||this.hidpi_&&void 0!==this.serverType_||(e=1);const r=n.getResolution(t[0]);let s=n.getTileCoordExtent(t,this.tmpExtent_);const o=this.gutter_;0!==o&&(s=it(s,r*o,s));const a=Object.assign({},Gh(this.params_,"GetMap"));return this.getRequestUrl_(t,s,e,i,a)}},Vh=class extends Ph{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:t.interpolate,projection:t.projection,resolutions:t.resolutions}),this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null,this.url_=t.url,this.imageLoadFunction_=void 0!==t.imageLoadFunction?t.imageLoadFunction:Ah,this.params_=t.params,this.serverType_=t.serverType,this.hidpi_=void 0===t.hidpi||t.hidpi,this.renderedRevision_=0,this.ratio_=void 0!==t.ratio?t.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(t,e,i,n){const r=oi(i),s=this.getProjection();return s&&s!==r&&(e=eo(s,r,t,e),t=fi(t,r,s)),function(t,e,i){if(void 0===t.url)return;const n=oi(t.projection||"EPSG:3857"),r=Et(e,i,0,Dh),s={QUERY_LAYERS:t.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(s,Gh(t.params,"GetFeatureInfo"),t.params);const o=Qt((e[0]-r[0])/i,4),a=Qt((r[3]-e[1])/i,4),l=Lh(s.VERSION,"1.3")>=0;return s[l?"I":"X"]=o,s[l?"J":"Y"]=a,kh(t.url,r,Dh,n,s)}({url:this.url_,params:{...this.params_,...n},projection:s||r},t,e)}getLegendUrl(t,e){return function(t,e){if(void 0===t.url)return;const i={SERVICE:"WMS",VERSION:Oh,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===t.params||void 0===t.params.LAYER){const e=t.params.LAYERS;if(Array.isArray(e)&&1!==e.length)return;i.LAYER=e}if(void 0!==e){const n=oi(t.projection||"EPSG:3857").getMetersPerUnit()||1,r=28e-5;i.SCALE=e*n/r}return Object.assign(i,t.params),Sh(t.url,i)}({url:this.url_,params:{...this.params_,...e}},t)}getParams(){return this.params_}getImageInternal(t,e,i,n){return void 0===this.url_?null:(this.loader&&this.loaderProjection_===n||(this.loaderProjection_=n,this.loader=function(t){const e=void 0===t.hidpi||t.hidpi,i=oi(t.projection||"EPSG:3857"),n=t.ratio||1.5,r=t.load||Ws;return(s,o,a)=>{s=Th(s,o,a,n),1==a||e&&void 0!==t.serverType||(a=1);const l=Fh(s,o,a,i,t.url,Gh(t.params,"GetMap"),t.serverType),h=new Image;return null!==t.crossOrigin&&(h.crossOrigin=t.crossOrigin),r(h,l).then((t=>({image:t,extent:s,pixelRatio:a})))}}({crossOrigin:this.crossOrigin_,params:this.params_,projection:n,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(t,e)=>(this.image.setImage(t),this.imageLoadFunction_(this.image,e),Ws(t))})),super.getImageInternal(t,e,i,n))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(t){this.imageLoadFunction_=t,this.changed()}setUrl(t){t!=this.url_&&(this.url_=t,this.loader=null,this.changed())}updateParams(t){Object.assign(this.params_,t),this.changed()}changed(){this.image=null,super.changed()}},jh=class extends Ih{constructor(t){const e=void 0!==t.requestEncoding?t.requestEncoding:"KVP",i=t.tileGrid;let n=t.urls;void 0===n&&void 0!==t.url&&(n=xh(t.url)),super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:n,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.version_=void 0!==t.version?t.version:"1.0.0",this.format_=void 0!==t.format?t.format:"image/jpeg",this.dimensions_=void 0!==t.dimensions?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=e,this.setKey(this.getKeyForDimensions_()),n&&n.length>0&&(this.tileUrlFunction=Ch(n.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const e=t.join("\n");this.setTileUrlFunction(Ch(t.map(this.createFromWMTSTemplate.bind(this))),e)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const t=this.urls?this.urls.slice(0):[];for(const e in this.dimensions_)t.push(e+"-"+this.dimensions_[e]);return t.join("/")}updateDimensions(t){Object.assign(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const e=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==e&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t="KVP"==e?Sh(t,i):t.replace(/\{(\w+?)\}/g,(function(t,e){return e.toLowerCase()in i?i[e.toLowerCase()]:t}));const n=this.tileGrid,r=this.dimensions_;return function(i,s,o){if(!i)return;const a={TileMatrix:n.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};Object.assign(a,r);let l=t;return l="KVP"==e?Sh(l,a):l.replace(/\{(\w+?)\}/g,(function(t,e){return a[e]})),l}}},zh=class{constructor(t){this.rbush_=new po(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[T(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,r=e.length;n<r;n++){const r=t[n],s=e[n],o={minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],value:s};i[n]=o,this.items_[T(s)]=o}this.rbush_.load(i)}remove(t){const e=T(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)}update(t,e){const i=this.items_[T(e)];dt([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map((function(t){return t.value}))}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,r=t.length;n<r;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return f(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return ht(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}};function Bh(t,e,i,n,r,o,a){let l,h;const u=(i-e)/n;if(1===u)l=e;else if(2===u)l=e,h=r;else if(0!==u){let o=t[e],a=t[e+1],u=0;const c=[0];for(let r=e+n;r<i;r+=n){const e=t[r],i=t[r+1];u+=Math.sqrt((e-o)*(e-o)+(i-a)*(i-a)),c.push(u),o=e,a=i}const p=r*u,d=function(t,e,i){let n,r;i=i||s;let o=0,a=t.length,l=!1;for(;o<a;)n=o+(a-o>>1),r=+i(t[n],e),r<0?o=n+1:(a=n,l=!r);return l?o:~o}(c,p);d<0?(h=(p-c[-d-2])/(c[-d-1]-c[-d-2]),l=e+(-d-2)*n):l=e+d*n}a=a>1?a:2,o=o||new Array(a);for(let e=0;e<a;++e)o[e]=void 0===l?NaN:void 0===h?t[l+e]:qt(t[l+e],t[l+n+e],h);return o}function Uh(t,e,i,n,r,s){if(i==e)return null;let o;if(r<t[e+n-1])return s?(o=t.slice(e,e+n),o[n-1]=r,o):null;if(t[i-1]<r)return s?(o=t.slice(i-n,i),o[n-1]=r,o):null;if(r==t[e+n-1])return t.slice(e,e+n);let a=e/n,l=i/n;for(;a<l;){const e=a+l>>1;r<t[(e+1)*n-1]?l=e:a=e+1}const h=t[a*n-1];if(r==h)return t.slice((a-1)*n,(a-1)*n+n);const u=(r-h)/(t[(a+1)*n-1]-h);o=[];for(let e=0;e<n-1;++e)o.push(qt(t[(a-1)*n+e],t[a*n+e],u));return o.push(r),o}function Zh(t,e,i,n){const r=[];let s=[1/0,1/0,-1/0,-1/0];for(let o=0,a=i.length;o<a;++o){const a=i[o];s=pt(t,e,a[0],n),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=a[a.length-1]}return r}const Yh=[1,0,0,1,0,0];class Wh{constructor(t,e,i,n,r,s){this.styleFunction,this.extent_,this.id_=s,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i,this.properties_=r,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_="Point"===this.type_?ct(this.flatCoordinates_):pt(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=wt(this.getExtent());this.flatInteriorPoints_=yn(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=function(t,e){const i=[];let n,r=0,s=0;for(let o=0,a=e.length;o<a;++o){const a=e[o],l=Mn(t,r,a,2);if(void 0===n&&(n=l),l===n)i.push(e.slice(s,o+1));else{if(0===i.length)continue;i[i.length-1].push(e[s])}s=o+1,r=a}return i}(this.flatCoordinates_,this.ends_),e=Zh(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=mn(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Bh(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let n=0,r=i.length;n<r;++n){const r=i[n],s=Bh(t,e,r,2,.5);l(this.flatMidpoints_,s),e=r}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){const e=(t=oi(t)).getExtent(),i=t.getWorldExtent();if(e&&i){const t=St(i)/St(e);J(Yh,i[0],i[3],t,-t,0,0,0),Hi(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Yh,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Wh(this.type_,this.flatCoordinates_.slice(),this.ends_.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=d(((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let n;switch(this.type_){case"LineString":i.length=Qi(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),n=[i.length];break;case"MultiLineString":n=[],i.length=$i(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,n);break;case"Polygon":n=[],i.length=nn(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,n)}return n&&(this.simplifiedGeometry_=new Wh(this.type_,i,n,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_})),this}}Wh.prototype.getFlatCoordinates=Wh.prototype.getOrientedFlatCoordinates;const Xh=Wh,qh="addfeature",Kh="removefeature";function Jh(t,e){return[[-1/0,-1/0,1/0,1/0]]}function Qh(t,e){return function(i,n,r,s,o){const a=this;!function(t,e,i,n,r,s,o){const a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(i,n,r):t,!0),"arraybuffer"==e.getType()&&(a.responseType="arraybuffer"),a.withCredentials=false,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){const t=e.getType();let n;"json"==t?n=JSON.parse(a.responseText):"text"==t?n=a.responseText:"xml"==t?(n=a.responseXML,n||(n=(new DOMParser).parseFromString(a.responseText,"application/xml"))):"arraybuffer"==t&&(n=a.response),n?s(e.readFeatures(n,{extent:i,featureProjection:r}),e.readProjection(n)):o()}else o()},a.onerror=o,a.send()}(t,e,i,n,r,(function(t,e){a.addFeatures(t),void 0!==s&&s(t)}),o||p)}}class $h extends t{constructor(t,e,i){super(t),this.feature=e,this.features=i}}const tu=class extends ph{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.on,this.once,this.un,this.loader_=p,this.format_=t.format,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&(q(this.format_,"`format` must be set when `url` is set"),this.loader_=Qh(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:Jh;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let i,n;this.featuresRtree_=e?new zh:null,this.loadedExtentsRtree_=new zh,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),e||void 0!==i||(i=new H(n)),void 0!==n&&this.addFeaturesInternal(n),void 0!==i&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=T(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const e=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new $h(qh,t))}setupChangeEvents_(t,i){i instanceof Xh||(this.featureChangeKeys_[t]=[E(i,m,this.handleFeatureChange_,this),E(i,e,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(void 0!==e.getId()){const t=String(e.getId());if(t in this.idIndex_)if(e instanceof Xh){const n=this.idIndex_[t];n instanceof Xh?Array.isArray(n)?n.push(e):this.idIndex_[t]=[n,e]:i=!1}else i=!1;else this.idIndex_[t]=e}return i&&(q(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let e=0,n=t.length;e<n;e++){const n=t[e],r=T(n);this.addToIndex_(r,n)&&i.push(n)}for(let t=0,r=i.length;t<r;t++){const r=i[t],s=T(r);this.setupChangeEvents_(s,r);const o=r.getGeometry();if(o){const t=o.getExtent();e.push(t),n.push(r)}else this.nullGeometryFeatures_[s]=r}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(qh))for(let t=0,e=i.length;t<e;t++)this.dispatchEvent(new $h(qh,i[t]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(qh,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),this.addEventListener(Kh,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),t.addEventListener(D,(t=>{e||(e=!0,this.addFeature(t.element),e=!1)})),t.addEventListener(k,(t=>{e||(e=!0,this.removeFeature(t.element),e=!1)})),this.featuresCollection_=t}clear(t){if(t){for(const t in this.featureChangeKeys_)this.featureChangeKeys_[t].forEach(S);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const t=t=>{this.removeFeatureInternal(t)};this.featuresRtree_.forEach(t);for(const t in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[t])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new $h("clear");this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){const n=i.getGeometry();if(n instanceof Xh||n.intersectsCoordinate(t))return e(i)}))}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,(function(i){const n=i.getGeometry();if(n instanceof Xh||n.intersectsExtent(t)){const t=e(i);if(t)return t}}))}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),f(this.nullGeometryFeatures_)||l(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=function(t,e){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[i[0],t[1],i[2],t[3]]];Pt(t,e);const n=Nt(i);if(Nt(t)>n)return[[i[0],t[1],i[2],t[3]]];if(t[0]<i[0])return[[t[0]+n,t[1],i[2],t[3]],[i[0],t[1],t[2],t[3]]];if(t[2]>i[2])return[[t[0],t[1],i[2],t[3]],[i[0],t[1],t[2]-n,t[3]]]}return[t]}(t,e);return[].concat(...i.map((t=>this.featuresRtree_.getInExtent(t))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let r=null;const s=[NaN,NaN];let o=1/0;const a=[-1/0,-1/0,1/0,1/0];return e=e||u,this.featuresRtree_.forEachInExtent(a,(function(t){if(e(t)){const e=t.getGeometry(),l=o;if(o=e instanceof Xh?0:e.closestPointXY(i,n,s,o),o<l){r=t;const e=Math.sqrt(o);a[0]=i-e,a[1]=n-e,a[2]=i+e,a[3]=n+e}}})),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=T(e),n=e.getGeometry();if(n){const t=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.featuresRtree_&&this.featuresRtree_.update(t,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);const r=e.getId();if(void 0!==r){const t=r.toString();this.idIndex_[t]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[t]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new $h("changefeature",e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:T(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&f(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,r=this.strategy_(t,e,i);for(let t=0,s=r.length;t<s;++t){const s=r[t];n.forEachInExtent(s,(function(t){return ot(t.extent,s)}))||(++this.loadingExtentsCount_,this.dispatchEvent(new $h("featuresloadstart")),this.loader_.call(this,s,e,i,(t=>{--this.loadingExtentsCount_,this.dispatchEvent(new $h("featuresloadend",void 0,t))}),(()=>{--this.loadingExtentsCount_,this.dispatchEvent(new $h("featuresloaderror"))})),n.insert(s,{extent:s.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,(function(e){if(dt(e.extent,t))return i=e,!0})),i&&e.remove(i)}removeFeature(t){if(!t)return;const e=T(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=T(t),i=this.featureChangeKeys_[e];if(!i)return;i.forEach(S),delete this.featureChangeKeys_[e];const n=t.getId();return void 0!==n&&delete this.idIndex_[n.toString()],delete this.uidIndex_[e],this.dispatchEvent(new $h(Kh,t)),t}removeFromIdIndex_(t){let e=!1;for(const i in this.idIndex_){const n=this.idIndex_[i];if(t instanceof Xh&&Array.isArray(n)&&n.includes(t))n.splice(n.indexOf(t),1);else if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}}return e}setLoader(t){this.loader_=t}setUrl(t){q(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Qh(t,this.format_))}};class eu extends O{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new eu(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(S(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=E(t,m,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;return Array.isArray(t)?e=t:(q("function"==typeof t.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const iu=eu,nu=class extends tu{constructor(t){super({attributions:t.attributions,wrapX:t.wrapX}),this.resolution=void 0,this.distance=void 0!==t.distance?t.distance:20,this.minDistance=t.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=t.geometryFunction||function(t){const e=t.getGeometry();return q(!e||"Point"===e.getType(),"The default `geometryFunction` can only handle `Point` or null geometries"),e},this.createCustomCluster_=t.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(t.source||null)}clear(t){this.features.length=0,super.clear(t)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(t,e,i){this.source.loadFeatures(t,e,i),e!==this.resolution&&(this.resolution=e,this.refresh())}setDistance(t){this.updateDistance(t,this.minDistance)}setMinDistance(t){this.updateDistance(this.distance,t)}getMinDistance(){return this.minDistance}setSource(t){this.source&&this.source.removeEventListener(m,this.boundRefresh_),this.source=t,t&&t.addEventListener(m,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(t,e){const i=0===t?0:Math.min(e,t)/t,n=t!==this.distance||this.interpolationRatio!==i;this.distance=t,this.minDistance=e,this.interpolationRatio=i,n&&this.refresh()}cluster(){if(void 0===this.resolution||!this.source)return;const t=[1/0,1/0,-1/0,-1/0],e=this.distance*this.resolution,i=this.source.getFeatures(),n={};for(let r=0,s=i.length;r<s;r++){const s=i[r];if(!(T(s)in n)){const i=this.geometryFunction(s);if(i){ct(i.getCoordinates(),t),it(t,e,t);const r=this.source.getFeaturesInExtent(t).filter((function(t){const e=T(t);return!(e in n)&&(n[e]=!0,!0)}));this.features.push(this.createCluster(r,t))}}}}createCluster(t,e){const i=[0,0];for(let e=t.length-1;e>=0;--e){const n=this.geometryFunction(t[e]);n?Ue(i,n.getCoordinates()):t.splice(e,1)}We(i,1/t.length);const n=wt(e),r=this.interpolationRatio,s=new pn([i[0]*(1-r)+n[0]*r,i[1]*(1-r)+n[1]*r]);return this.createCustomCluster_?this.createCustomCluster_(s,t):new iu({geometry:s,features:t})}};const ru=class extends gh{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}};class su extends Ui{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){l(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new su(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<rt(this.getExtent(),t,e))return n;const r=this.flatCoordinates,s=this.stride;for(let o=0,a=r.length;o<a;o+=s){const a=Zt(t,e,r[o],r[o+1]);if(a<n){n=a;for(let t=0;t<s;++t)i[t]=r[o+t];i.length=s}}return n}getCoordinates(){return rn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new pn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let r=0,s=t.length;r<s;r+=i){const s=new pn(t.slice(r,r+i),e);n.push(s)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,r=e.length;n<r;n+=i)if(at(t,e[n],e[n+1]))return!0;return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ki(this.flatCoordinates,0,t,this.stride),this.changed()}}const ou=su;class au extends Ui{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const n=t,r=[],s=[];for(let t=0,e=n.length;t<e;++t){const e=n[t],i=r.length,o=e.getEnds();for(let t=0,e=o.length;t<e;++t)o[t]+=i;l(r,e.getFlatCoordinates()),s.push(o)}e=0===n.length?this.getLayout():n[0].getLayout(),t=r,i=s}void 0!==e&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const i=this.flatCoordinates.length;l(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let t=0,n=e.length;t<n;++t)e[t]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let i=0;i<t;++i)e[i]=this.endss_[i].slice();const i=new au(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<rt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];r=Wi(t,e,o,n,r),e=o[o.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,r,s,o,a,l,h,u){u=u||[NaN,NaN];for(let s=0,c=i.length;s<c;++s){const c=i[s];h=qi(t,e,c,n,r,true,o,a,l,h,u),e=c[c.length-1]}return h}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,t,e,i,n))}containsXY(t,e){return function(t,e,i,n,r,s){if(0===i.length)return!1;for(let o=0,a=i.length;o<a;++o){const a=i[o];if(fn(t,e,a,n,r,s))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return function(t,e,i,n){let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s];r+=ln(t,e,o,n),e=o[o.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Sn(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,on(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=Zh(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=mn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ou(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;!function(t,e,i,n){for(let r=0,s=i.length;r<s;++r){const s=i[r];if(!En(t,e,s,n,undefined))return!1;s.length&&(e=s[s.length-1])}return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Sn(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=function(t,e,i,n,r,s,o,a){for(let l=0,h=i.length;l<h;++l){const h=i[l],u=[];o=nn(t,e,h,n,r,s,o,u),a.push(u),e=h[h.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new au(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const i=this.endss_[t-1];e=i[i.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(0!==e)for(let t=0,n=i.length;t<n;++t)i[t]-=e;return new bn(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s].slice(),a=o[o.length-1];if(0!==r)for(let t=0,e=o.length;t<e;++t)o[t]-=r;const l=new bn(e.slice(r,a),t,o);n.push(l),r=a}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return function(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];if(xn(t,e,o,n,r))return!0;e=o[o.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=function(t,e,i,n,r){r=r||[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=Ji(t,e,i[o],n,r[s]);0===a.length&&(a[0]=e),r[s++]=a,e=a[a.length-1]}return r.length=s,r}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{const t=i[i.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}}const lu=au,hu="accuracy",uu="accuracyGeometry",cu="altitude",pu="altitudeAccuracy",du="heading",gu="position",fu="projection",yu="speed",mu="tracking",_u="trackingOptions";class vu extends t{constructor(t){super("error"),this.code=t.code,this.message=t.message}}const Cu=class extends O{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.position_=null,this.transform_=ri,this.watchId_=void 0,this.addChangeListener(fu,this.handleProjectionChanged_),this.addChangeListener(mu,this.handleTrackingChanged_),void 0!==t.projection&&this.setProjection(t.projection),void 0!==t.trackingOptions&&this.setTrackingOptions(t.trackingOptions),this.setTracking(void 0!==t.tracking&&t.tracking)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const t=this.getProjection();t&&(this.transform_=di(oi("EPSG:4326"),t),this.position_&&this.set(gu,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const t=this.getTracking();t&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):t||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(t){const e=t.coords;this.set(hu,e.accuracy),this.set(cu,null===e.altitude?void 0:e.altitude),this.set(pu,null===e.altitudeAccuracy?void 0:e.altitudeAccuracy),this.set(du,null===e.heading?void 0:Wt(e.heading)),this.position_?(this.position_[0]=e.longitude,this.position_[1]=e.latitude):this.position_=[e.longitude,e.latitude];const i=this.transform_(this.position_);this.set(gu,i.slice()),this.set(yu,null===e.speed?void 0:e.speed);const n=function(t,e,i){i=i||32;const n=[];for(let r=0;r<i;++r)l(n,Qe(t,e,2*Math.PI*r/i,undefined));return n.push(n[0],n[1]),new Ln(n,"XY",[n.length])}(this.position_,e.accuracy);n.applyTransform(this.transform_),this.set(uu,n),this.changed()}positionError_(t){this.dispatchEvent(new vu(t))}getAccuracy(){return this.get(hu)}getAccuracyGeometry(){return this.get(uu)||null}getAltitude(){return this.get(cu)}getAltitudeAccuracy(){return this.get(pu)}getHeading(){return this.get(du)}getPosition(){return this.get(gu)}getProjection(){return this.get(fu)}getSpeed(){return this.get(yu)}getTracking(){return this.get(mu)}getTrackingOptions(){return this.get(_u)}setProjection(t){this.set(fu,oi(t))}setTracking(t){this.set(mu,t)}setTrackingOptions(t){this.set(_u,t)}};class xu extends Ui{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){l(this.flatCoordinates,t),this.changed()}clone(){const t=new xu(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<rt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Yi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Xi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return _n(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,Uh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return rn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Bh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return kl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Qi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new xu(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return vn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ki(this.flatCoordinates,0,t,this.stride),this.changed()}}const wu=xu;class Mu extends Ui{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const e=t,i=[],n=[];for(let t=0,r=e.length;t<r;++t)l(i,e[t].getFlatCoordinates()),n.push(i.length);const r=0===e.length?this.getLayout():e[0].getLayout();this.setFlatCoordinates(r,i),this.ends_=n}}appendLineString(t){l(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Mu(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<rt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Wi(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qi(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,i=void 0!==i&&i,function(t,e,i,n,r,s,o){if(o)return Uh(t,e,i[i.length-1],n,r,s);let a;if(r<t[n-1])return s?(a=t.slice(0,n),a[n-1]=r,a):null;if(t[t.length-1]<r)return s?(a=t.slice(t.length-n),a[n-1]=r,a):null;for(let s=0,o=i.length;s<o;++s){const o=i[s];if(e!=o){if(r<t[e+n-1])return null;if(r<=t[o-1])return Uh(t,e,o,n,r,!1);e=o}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return sn(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new wu(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let r=0;for(let s=0,o=e.length;s<o;++s){const o=e[s],a=new wu(t.slice(r,o),i);n.push(a),r=o}return n}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,r=this.stride;for(let s=0,o=n.length;s<o;++s){const o=n[s];l(t,Bh(e,i,o,r,.5)),i=o}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=$i(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new Mu(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return function(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){if(vn(t,e,i[s],n,r))return!0;e=i[s]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Ji(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const Eu=Mu,Iu=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=iu,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?oi(e.dataProjection):this.readProjection(t);e.extent&&i&&"tile-pixels"===i.getUnits()&&(i=oi(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return N()}readFeature(t,e){return N()}readFeatures(t,e){return N()}readGeometry(t,e){return N()}readProjection(t){return N()}writeFeature(t,e){return N()}writeFeatures(t,e){return N()}writeGeometry(t,e){return N()}};function Su(t,e,i){const n=i?oi(i.featureProjection):null,r=i?oi(i.dataProjection):null;let s=t;if(n&&r&&!pi(n,r)){e&&(s=t.clone());const i=e?n:r,o=e?r:n;"tile-pixels"===i.getUnits()?s.transform(i,o):s.applyTransform(gi(i,o))}if(e&&i&&void 0!==i.decimals){const e=Math.pow(10,i.decimals),n=function(t){for(let i=0,n=t.length;i<n;++i)t[i]=Math.round(t[i]*e)/e;return t};s===t&&(s=t.clone()),s.applyTransform(n)}return s}function Lu(t,e){const i=e?oi(e.featureProjection):null,n=e?oi(e.dataProjection):null;return i&&n&&!pi(i,n)?yi(t,n,i):t}function bu(t,e){return Uu().createElementNS(t,e)}function Ru(t,e){return Nu(t,e,[]).join("")}function Nu(t,e,i){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)e?i.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):i.push(t.nodeValue);else{let n;for(n=t.firstChild;n;n=n.nextSibling)Nu(n,e,i)}return i}function Au(t){return"documentElement"in t}function Tu(t){return(new DOMParser).parseFromString(t,"application/xml")}function Pu(t,e){return function(i,n){const r=t.call(void 0!==e?e:this,i,n);void 0!==r&&l(n[n.length-1],r)}}function Ou(t,e){return function(i,n){const r=t.call(void 0!==e?e:this,i,n);void 0!==r&&n[n.length-1].push(r)}}function Du(t,e){return function(i,n){const r=t.call(void 0!==e?e:this,i,n);void 0!==r&&(n[n.length-1]=r)}}function ku(t,e){return function(i,n,r){t.call(void 0!==e?e:this,i,n,r),r[r.length-1].node.appendChild(i)}}function Fu(t,e){return function(i,n,r){const s=n[n.length-1].node;let o=t;return void 0===o&&(o=r),bu(void 0!==e?e:s.namespaceURI,o)}}const Gu=Fu();function Hu(t,e,i,n){let r;for(r=e.firstElementChild;r;r=r.nextElementSibling){const e=t[r.namespaceURI];if(void 0!==e){const t=e[r.localName];void 0!==t&&t.call(n,r,i)}}}function Vu(t,e,i,n,r){return n.push(t),Hu(e,i,n,r),n.pop()}function ju(t,e,i,n,r,s,o){return r.push(t),function(t,e,i,n,r,s){const o=(void 0!==r?r:i).length;let a,l;for(let h=0;h<o;++h)a=i[h],void 0!==a&&(l=e.call(void 0!==s?s:this,a,n,void 0!==r?r[h]:void 0),void 0!==l&&t[l.namespaceURI][l.localName].call(s,l,a,n))}(e,i,n,r,s,o),r.pop()}let zu,Bu;function Uu(){return void 0===Bu&&"undefined"!=typeof document&&(Bu=document.implementation.createDocument("","",null)),Bu}const Zu=class extends Iu{constructor(){super(),this.xmlSerializer_=(void 0===zu&&"undefined"!=typeof XMLSerializer&&(zu=new XMLSerializer),zu)}getType(){return"xml"}readFeature(t,e){if(!t)return null;if("string"==typeof t){const i=Tu(t);return this.readFeatureFromDocument(i,e)}return Au(t)?this.readFeatureFromDocument(t,e):this.readFeatureFromNode(t,e)}readFeatureFromDocument(t,e){const i=this.readFeaturesFromDocument(t,e);return i.length>0?i[0]:null}readFeatureFromNode(t,e){return null}readFeatures(t,e){if(!t)return[];if("string"==typeof t){const i=Tu(t);return this.readFeaturesFromDocument(i,e)}return Au(t)?this.readFeaturesFromDocument(t,e):this.readFeaturesFromNode(t,e)}readFeaturesFromDocument(t,e){const i=[];for(let n=t.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&l(i,this.readFeaturesFromNode(n,e));return i}readFeaturesFromNode(t,e){return N()}readGeometry(t,e){if(!t)return null;if("string"==typeof t){const i=Tu(t);return this.readGeometryFromDocument(i,e)}return Au(t)?this.readGeometryFromDocument(t,e):this.readGeometryFromNode(t,e)}readGeometryFromDocument(t,e){return null}readGeometryFromNode(t,e){return null}readProjection(t){if(!t)return null;if("string"==typeof t){const e=Tu(t);return this.readProjectionFromDocument(e)}return Au(t)?this.readProjectionFromDocument(t):this.readProjectionFromNode(t)}readProjectionFromDocument(t){return this.dataProjection}readProjectionFromNode(t){return this.dataProjection}writeFeature(t,e){const i=this.writeFeatureNode(t,e);return this.xmlSerializer_.serializeToString(i)}writeFeatureNode(t,e){return null}writeFeatures(t,e){const i=this.writeFeaturesNode(t,e);return this.xmlSerializer_.serializeToString(i)}writeFeaturesNode(t,e){return null}writeGeometry(t,e){const i=this.writeGeometryNode(t,e);return this.xmlSerializer_.serializeToString(i)}writeGeometryNode(t,e){return null}},Yu="http://www.opengis.net/gml",Wu=/^\s*$/;class Xu extends Zu{constructor(t){super(),t=t||{},this.featureType=t.featureType,this.featureNS=t.featureNS,this.srsName=t.srsName,this.schemaLocation="",this.FEATURE_COLLECTION_PARSERS={},this.FEATURE_COLLECTION_PARSERS[this.namespace]={featureMember:Ou(this.readFeaturesInternal),featureMembers:Du(this.readFeaturesInternal)},this.supportedMediaTypes=["application/gml+xml"]}readFeaturesInternal(t,e){const i=t.localName;let n=null;if("FeatureCollection"==i)n=Vu([],this.FEATURE_COLLECTION_PARSERS,t,e,this);else if("featureMembers"==i||"featureMember"==i||"member"==i){const r=e[0];let s=r.featureType,o=r.featureNS;const a="p",l="p0";if(!s&&t.childNodes){s=[],o={};for(let e=0,i=t.childNodes.length;e<i;++e){const i=t.childNodes[e];if(1===i.nodeType){const t=i.nodeName.split(":").pop();if(!s.includes(t)){let e="",n=0;const r=i.namespaceURI;for(const t in o){if(o[t]===r){e=t;break}++n}e||(e=a+n,o[e]=r),s.push(e+":"+t)}}}"featureMember"!=i&&(r.featureType=s,r.featureNS=o)}if("string"==typeof o){const t=o;o={},o[l]=t}const h={},u=Array.isArray(s)?s:[s];for(const t in o){const e={};for(let n=0,r=u.length;n<r;++n)(u[n].includes(":")?u[n].split(":")[0]:l)===t&&(e[u[n].split(":").pop()]="featureMembers"==i?Ou(this.readFeatureElement,this):Du(this.readFeatureElement,this));h[o[t]]=e}n=Vu("featureMember"==i||"member"==i?void 0:[],h,t,e)}return null===n&&(n=[]),n}readGeometryOrExtent(t,e){const i=e[0];return i.srsName=t.firstElementChild.getAttribute("srsName"),i.srsDimension=t.firstElementChild.getAttribute("srsDimension"),Vu(null,this.GEOMETRY_PARSERS,t,e,this)}readExtentElement(t,e){const i=e[0],n=this.readGeometryOrExtent(t,e);return n?Lu(n,i):void 0}readGeometryElement(t,e){const i=e[0],n=this.readGeometryOrExtent(t,e);return n?Su(n,!1,i):void 0}readFeatureElementInternal(t,e,i){let n;const r={};for(let s=t.firstElementChild;s;s=s.nextElementSibling){let t;const o=s.localName;0===s.childNodes.length||1===s.childNodes.length&&(3===s.firstChild.nodeType||4===s.firstChild.nodeType)?(t=Ru(s,!1),Wu.test(t)&&(t=void 0)):(i&&(t="boundedBy"===o?this.readExtentElement(s,e):this.readGeometryElement(s,e)),t?"boundedBy"!==o&&(n=o):t=this.readFeatureElementInternal(s,e,!1));const a=s.attributes.length;if(a>0&&!(t instanceof zi)){t={_content_:t};for(let e=0;e<a;e++)t[s.attributes[e].name]=s.attributes[e].value}r[o]?(r[o]instanceof Array||(r[o]=[r[o]]),r[o].push(t)):r[o]=t}if(!i)return r;const s=new iu(r);n&&s.setGeometryName(n);const o=t.getAttribute("fid")||function(t,e){return t.getAttributeNS(e,"id")||""}(t,this.namespace);return o&&s.setId(o),s}readFeatureElement(t,e){return this.readFeatureElementInternal(t,e,!0)}readPoint(t,e){const i=this.readFlatCoordinatesFromNode(t,e);if(i)return new pn(i,"XYZ")}readMultiPoint(t,e){const i=Vu([],this.MULTIPOINT_PARSERS,t,e,this);if(i)return new ou(i)}readMultiLineString(t,e){const i=Vu([],this.MULTILINESTRING_PARSERS,t,e,this);if(i)return new Eu(i)}readMultiPolygon(t,e){const i=Vu([],this.MULTIPOLYGON_PARSERS,t,e,this);if(i)return new lu(i)}pointMemberParser(t,e){Hu(this.POINTMEMBER_PARSERS,t,e,this)}lineStringMemberParser(t,e){Hu(this.LINESTRINGMEMBER_PARSERS,t,e,this)}polygonMemberParser(t,e){Hu(this.POLYGONMEMBER_PARSERS,t,e,this)}readLineString(t,e){const i=this.readFlatCoordinatesFromNode(t,e);if(i)return new wu(i,"XYZ")}readFlatLinearRing(t,e){const i=Vu(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this);if(i)return i}readLinearRing(t,e){const i=this.readFlatCoordinatesFromNode(t,e);if(i)return new un(i,"XYZ")}readPolygon(t,e){const i=Vu([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this);if(i&&i[0]){const t=i[0],e=[t.length];let n,r;for(n=1,r=i.length;n<r;++n)l(t,i[n]),e.push(t.length);return new bn(t,"XYZ",e)}}readFlatCoordinatesFromNode(t,e){return Vu(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)}readGeometryFromNode(t,e){return this.readGeometryElement(t,[this.getReadOptions(t,e||{})])||null}readFeaturesFromNode(t,e){const i={featureType:this.featureType,featureNS:this.featureNS};return i&&Object.assign(i,this.getReadOptions(t,e)),this.readFeaturesInternal(t,[i])||[]}readProjectionFromNode(t){return oi(this.srsName?this.srsName:t.firstElementChild.getAttribute("srsName"))}}Xu.prototype.namespace=Yu,Xu.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}},Xu.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}},Xu.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}},Xu.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:Ou(Xu.prototype.pointMemberParser),pointMembers:Ou(Xu.prototype.pointMemberParser)}},Xu.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:Ou(Xu.prototype.lineStringMemberParser),lineStringMembers:Ou(Xu.prototype.lineStringMemberParser)}},Xu.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:Ou(Xu.prototype.polygonMemberParser),polygonMembers:Ou(Xu.prototype.polygonMemberParser)}},Xu.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:Ou(Xu.prototype.readFlatCoordinatesFromNode)}},Xu.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:Ou(Xu.prototype.readLineString)}},Xu.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:Ou(Xu.prototype.readPolygon)}},Xu.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:Du(Xu.prototype.readFlatLinearRing)}};const qu=Xu;function Ku(t){const e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}function Ju(t,e){t.appendChild(Uu().createTextNode(e))}const Qu=Yu+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",$u={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};class tc extends qu{constructor(t){super(t=t||{}),this.FEATURE_COLLECTION_PARSERS[Yu].featureMember=Ou(this.readFeaturesInternal),this.schemaLocation=t.schemaLocation?t.schemaLocation:Qu}readFlatCoordinates(t,e){const i=Ru(t,!1).replace(/^\s*|\s*$/g,""),n=e[0].srsName;let r="enu";if(n){const t=oi(n);t&&(r=t.getAxisOrientation())}const s=i.trim().split(/\s+/),o=[];for(let t=0,e=s.length;t<e;t++){const e=s[t].split(/,+/),i=parseFloat(e[0]),n=parseFloat(e[1]),a=3===e.length?parseFloat(e[2]):0;"en"===r.substr(0,2)?o.push(i,n,a):o.push(n,i,a)}return o}readBox(t,e){const i=Vu([null],this.BOX_PARSERS_,t,e,this);return ht(i[1][0],i[1][1],i[1][3],i[1][4])}innerBoundaryIsParser(t,e){const i=Vu(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)}outerBoundaryIsParser(t,e){const i=Vu(void 0,this.RING_PARSERS,t,e,this);i&&(e[e.length-1][0]=i)}GEOMETRY_NODE_FACTORY_(t,e,i){const n=e[e.length-1],r=n.multiSurface,s=n.surface,o=n.multiCurve;return Array.isArray(t)?i="Envelope":"MultiPolygon"===(i=t.getType())&&!0===r?i="MultiSurface":"Polygon"===i&&!0===s?i="Surface":"MultiLineString"===i&&!0===o&&(i="MultiCurve"),bu("http://www.opengis.net/gml",i)}writeFeatureElement(t,e,i){const n=e.getId();n&&t.setAttribute("fid",n);const r=i[i.length-1],s=r.featureNS,o=e.getGeometryName();r.serializers||(r.serializers={},r.serializers[s]={});const a=[],l=[];if(e.hasProperties()){const t=e.getProperties();for(const e in t){const i=t[e];null!==i&&(a.push(e),l.push(i),e==o||"function"==typeof i.getSimplifiedGeometry?e in r.serializers[s]||(r.serializers[s][e]=ku(this.writeGeometryElement,this)):e in r.serializers[s]||(r.serializers[s][e]=ku(Ju)))}}const h=Object.assign({},r);h.node=t,ju(h,r.serializers,Fu(void 0,s),l,i,a)}writeCurveOrLineString(t,e,i){const n=i[i.length-1].srsName;if("LineStringSegment"!==t.nodeName&&n&&t.setAttribute("srsName",n),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName){const n=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(n),this.writeCoordinates_(n,e,i)}else if("Curve"===t.nodeName){const n=bu(t.namespaceURI,"segments");t.appendChild(n),this.writeCurveSegments_(n,e,i)}}writeLineStringOrCurveMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,i))}writeMultiCurveOrLineString(t,e,i){const n=i[i.length-1],r=n.hasZ,s=n.srsName,o=n.curve;s&&t.setAttribute("srsName",s);const a=e.getLineStrings();ju({node:t,hasZ:r,srsName:s,curve:o},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)}writeGeometryElement(t,e,i){const n=i[i.length-1],r=Object.assign({},n);let s;r.node=t,s=Array.isArray(e)?Lu(e,n):Su(e,!0,n),ju(r,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[s],i,void 0,this)}createCoordinatesNode_(t){const e=bu(t,"coordinates");return e.setAttribute("decimal","."),e.setAttribute("cs",","),e.setAttribute("ts"," "),e}writeCoordinates_(t,e,i){const n=i[i.length-1],r=n.hasZ,s=n.srsName,o=e.getCoordinates(),a=o.length,l=new Array(a);for(let t=0;t<a;++t){const e=o[t];l[t]=this.getCoords_(e,s,r)}Ju(t,l.join(" "))}writeCurveSegments_(t,e,i){const n=bu(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,i)}writeSurfaceOrPolygon(t,e,i){const n=i[i.length-1],r=n.hasZ,s=n.srsName;if("PolygonPatch"!==t.nodeName&&s&&t.setAttribute("srsName",s),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName){const n=e.getLinearRings();ju({node:t,hasZ:r,srsName:s},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,n,i,void 0,this)}else if("Surface"===t.nodeName){const n=bu(t.namespaceURI,"patches");t.appendChild(n),this.writeSurfacePatches_(n,e,i)}}RING_NODE_FACTORY_(t,e,i){const n=e[e.length-1],r=n.node,s=n.exteriorWritten;return void 0===s&&(n.exteriorWritten=!0),bu(r.namespaceURI,void 0!==s?"innerBoundaryIs":"outerBoundaryIs")}writeSurfacePatches_(t,e,i){const n=bu(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i)}writeRing(t,e,i){const n=bu(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,i)}getCoords_(t,e,i){let n="enu";e&&(n=oi(e).getAxisOrientation());let r="en"===n.substr(0,2)?t[0]+","+t[1]:t[1]+","+t[0];return i&&(r+=","+(t[2]||0)),r}writePoint(t,e,i){const n=i[i.length-1],r=n.hasZ,s=n.srsName;s&&t.setAttribute("srsName",s);const o=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(o);const a=e.getCoordinates();Ju(o,this.getCoords_(a,s,r))}writeMultiPoint(t,e,i){const n=i[i.length-1],r=n.hasZ,s=n.srsName;s&&t.setAttribute("srsName",s);const o=e.getPoints();ju({node:t,hasZ:r,srsName:s},this.POINTMEMBER_SERIALIZERS,Fu("pointMember"),o,i,void 0,this)}writePointMember(t,e,i){const n=bu(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,i)}writeLinearRing(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const r=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(r),this.writeCoordinates_(r,e,i)}writeMultiSurfaceOrPolygon(t,e,i){const n=i[i.length-1],r=n.hasZ,s=n.srsName,o=n.surface;s&&t.setAttribute("srsName",s);const a=e.getPolygons();ju({node:t,hasZ:r,srsName:s,surface:o},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)}writeSurfaceOrPolygonMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i))}writeEnvelope(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const r=[e[0]+" "+e[1],e[2]+" "+e[3]];ju({node:t},this.ENVELOPE_SERIALIZERS,Gu,r,i,["lowerCorner","upperCorner"],this)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(t,e,i){const n=e[e.length-1].node;return bu("http://www.opengis.net/gml",$u[n.nodeName])}}tc.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:Du(tc.prototype.readFlatCoordinates)}},tc.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:tc.prototype.innerBoundaryIsParser,outerBoundaryIs:tc.prototype.outerBoundaryIsParser}},tc.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:Ou(tc.prototype.readFlatCoordinates)}},tc.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:Du(qu.prototype.readPoint),MultiPoint:Du(qu.prototype.readMultiPoint),LineString:Du(qu.prototype.readLineString),MultiLineString:Du(qu.prototype.readMultiLineString),LinearRing:Du(qu.prototype.readLinearRing),Polygon:Du(qu.prototype.readPolygon),MultiPolygon:Du(qu.prototype.readMultiPolygon),Box:Du(tc.prototype.readBox)}},tc.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:ku(tc.prototype.writeCurveOrLineString),MultiCurve:ku(tc.prototype.writeMultiCurveOrLineString),Point:ku(tc.prototype.writePoint),MultiPoint:ku(tc.prototype.writeMultiPoint),LineString:ku(tc.prototype.writeCurveOrLineString),MultiLineString:ku(tc.prototype.writeMultiCurveOrLineString),LinearRing:ku(tc.prototype.writeLinearRing),Polygon:ku(tc.prototype.writeSurfaceOrPolygon),MultiPolygon:ku(tc.prototype.writeMultiSurfaceOrPolygon),Surface:ku(tc.prototype.writeSurfaceOrPolygon),MultiSurface:ku(tc.prototype.writeMultiSurfaceOrPolygon),Envelope:ku(tc.prototype.writeEnvelope)}},tc.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:ku(tc.prototype.writeLineStringOrCurveMember),curveMember:ku(tc.prototype.writeLineStringOrCurveMember)}},tc.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:ku(tc.prototype.writeRing),innerBoundaryIs:ku(tc.prototype.writeRing)}},tc.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:ku(tc.prototype.writePointMember)}},tc.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:ku(tc.prototype.writeSurfaceOrPolygonMember),polygonMember:ku(tc.prototype.writeSurfaceOrPolygonMember)}},tc.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:ku(Ju),upperCorner:ku(Ju)}};const ec=tc,ic=Yu+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",nc={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};class rc extends qu{constructor(t){super(t=t||{}),this.surface_=void 0!==t.surface&&t.surface,this.curve_=void 0!==t.curve&&t.curve,this.multiCurve_=void 0===t.multiCurve||t.multiCurve,this.multiSurface_=void 0===t.multiSurface||t.multiSurface,this.schemaLocation=t.schemaLocation?t.schemaLocation:ic,this.hasZ=void 0!==t.hasZ&&t.hasZ}readMultiCurve(t,e){const i=Vu([],this.MULTICURVE_PARSERS,t,e,this);if(i)return new Eu(i)}readFlatCurveRing(t,e){const i=Vu([],this.MULTICURVE_PARSERS,t,e,this),n=[];for(let t=0,e=i.length;t<e;++t)l(n,i[t].getFlatCoordinates());return n}readMultiSurface(t,e){const i=Vu([],this.MULTISURFACE_PARSERS,t,e,this);if(i)return new lu(i)}curveMemberParser(t,e){Hu(this.CURVEMEMBER_PARSERS,t,e,this)}surfaceMemberParser(t,e){Hu(this.SURFACEMEMBER_PARSERS,t,e,this)}readPatch(t,e){return Vu([null],this.PATCHES_PARSERS,t,e,this)}readSegment(t,e){return Vu([],this.SEGMENTS_PARSERS,t,e,this)}readPolygonPatch(t,e){return Vu([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this)}readLineStringSegment(t,e){return Vu([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)}interiorParser(t,e){const i=Vu(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)}exteriorParser(t,e){const i=Vu(void 0,this.RING_PARSERS,t,e,this);i&&(e[e.length-1][0]=i)}readSurface(t,e){const i=Vu([null],this.SURFACE_PARSERS,t,e,this);if(i&&i[0]){const t=i[0],e=[t.length];let n,r;for(n=1,r=i.length;n<r;++n)l(t,i[n]),e.push(t.length);return new bn(t,"XYZ",e)}}readCurve(t,e){const i=Vu([null],this.CURVE_PARSERS,t,e,this);if(i)return new wu(i,"XYZ")}readEnvelope(t,e){const i=Vu([null],this.ENVELOPE_PARSERS,t,e,this);return ht(i[1][0],i[1][1],i[2][0],i[2][1])}readFlatPos(t,e){let i=Ru(t,!1);const n=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,r=[];let s;for(;s=n.exec(i);)r.push(parseFloat(s[1])),i=i.substr(s[0].length);if(""!==i)return;const o=e[0].srsName;let a="enu";if(o&&(a=oi(o).getAxisOrientation()),"neu"===a){let t,e;for(t=0,e=r.length;t<e;t+=3){const e=r[t],i=r[t+1];r[t]=i,r[t+1]=e}}const l=r.length;return 2==l&&r.push(0),0!==l?r:void 0}readFlatPosList(t,e){const i=Ru(t,!1).replace(/^\s*|\s*$/g,""),n=e[0],r=n.srsName,s=n.srsDimension;let o="enu";r&&(o=oi(r).getAxisOrientation());const a=i.split(/\s+/);let l,h,u,c=2;t.getAttribute("srsDimension")?c=Ku(t.getAttribute("srsDimension")):t.getAttribute("dimension")?c=Ku(t.getAttribute("dimension")):t.parentNode.getAttribute("srsDimension")?c=Ku(t.parentNode.getAttribute("srsDimension")):s&&(c=Ku(s));const p=[];for(let t=0,e=a.length;t<e;t+=c)l=parseFloat(a[t]),h=parseFloat(a[t+1]),u=3===c?parseFloat(a[t+2]):0,"en"===o.substr(0,2)?p.push(l,h,u):p.push(h,l,u);return p}writePos_(t,e,i){const n=i[i.length-1],r=n.hasZ,s=r?"3":"2";t.setAttribute("srsDimension",s);const o=n.srsName;let a="enu";o&&(a=oi(o).getAxisOrientation());const l=e.getCoordinates();let h;h="en"===a.substr(0,2)?l[0]+" "+l[1]:l[1]+" "+l[0],r&&(h+=" "+(l[2]||0)),Ju(t,h)}getCoords_(t,e,i){let n="enu";e&&(n=oi(e).getAxisOrientation());let r="en"===n.substr(0,2)?t[0]+" "+t[1]:t[1]+" "+t[0];return i&&(r+=" "+(t[2]||0)),r}writePosList_(t,e,i){const n=i[i.length-1],r=n.hasZ,s=r?"3":"2";t.setAttribute("srsDimension",s);const o=n.srsName,a=e.getCoordinates(),l=a.length,h=new Array(l);let u;for(let t=0;t<l;++t)u=a[t],h[t]=this.getCoords_(u,o,r);Ju(t,h.join(" "))}writePoint(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const r=bu(t.namespaceURI,"pos");t.appendChild(r),this.writePos_(r,e,i)}writeEnvelope(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const r=[e[0]+" "+e[1],e[2]+" "+e[3]];ju({node:t},this.ENVELOPE_SERIALIZERS,Gu,r,i,["lowerCorner","upperCorner"],this)}writeLinearRing(t,e,i){const n=i[i.length-1].srsName;n&&t.setAttribute("srsName",n);const r=bu(t.namespaceURI,"posList");t.appendChild(r),this.writePosList_(r,e,i)}RING_NODE_FACTORY_(t,e,i){const n=e[e.length-1],r=n.node,s=n.exteriorWritten;return void 0===s&&(n.exteriorWritten=!0),bu(r.namespaceURI,void 0!==s?"interior":"exterior")}writeSurfaceOrPolygon(t,e,i){const n=i[i.length-1],r=n.hasZ,s=n.srsName;if("PolygonPatch"!==t.nodeName&&s&&t.setAttribute("srsName",s),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName){const n=e.getLinearRings();ju({node:t,hasZ:r,srsName:s},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,n,i,void 0,this)}else if("Surface"===t.nodeName){const n=bu(t.namespaceURI,"patches");t.appendChild(n),this.writeSurfacePatches_(n,e,i)}}writeCurveOrLineString(t,e,i){const n=i[i.length-1].srsName;if("LineStringSegment"!==t.nodeName&&n&&t.setAttribute("srsName",n),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName){const n=bu(t.namespaceURI,"posList");t.appendChild(n),this.writePosList_(n,e,i)}else if("Curve"===t.nodeName){const n=bu(t.namespaceURI,"segments");t.appendChild(n),this.writeCurveSegments_(n,e,i)}}writeMultiSurfaceOrPolygon(t,e,i){const n=i[i.length-1],r=n.hasZ,s=n.srsName,o=n.surface;s&&t.setAttribute("srsName",s);const a=e.getPolygons();ju({node:t,hasZ:r,srsName:s,surface:o},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)}writeMultiPoint(t,e,i){const n=i[i.length-1],r=n.srsName,s=n.hasZ;r&&t.setAttribute("srsName",r);const o=e.getPoints();ju({node:t,hasZ:s,srsName:r},this.POINTMEMBER_SERIALIZERS,Fu("pointMember"),o,i,void 0,this)}writeMultiCurveOrLineString(t,e,i){const n=i[i.length-1],r=n.hasZ,s=n.srsName,o=n.curve;s&&t.setAttribute("srsName",s);const a=e.getLineStrings();ju({node:t,hasZ:r,srsName:s,curve:o},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)}writeRing(t,e,i){const n=bu(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,i)}writeSurfaceOrPolygonMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i))}writePointMember(t,e,i){const n=bu(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,i)}writeLineStringOrCurveMember(t,e,i){const n=this.GEOMETRY_NODE_FACTORY_(e,i);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,i))}writeSurfacePatches_(t,e,i){const n=bu(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,i)}writeCurveSegments_(t,e,i){const n=bu(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,i)}writeGeometryElement(t,e,i){const n=i[i.length-1],r=Object.assign({},n);let s;r.node=t,s=Array.isArray(e)?Lu(e,n):Su(e,!0,n),ju(r,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[s],i,void 0,this)}writeFeatureElement(t,e,i){const n=e.getId();n&&t.setAttribute("fid",n);const r=i[i.length-1],s=r.featureNS,o=e.getGeometryName();r.serializers||(r.serializers={},r.serializers[s]={});const a=[],l=[];if(e.hasProperties()){const t=e.getProperties();for(const e in t){const i=t[e];null!==i&&(a.push(e),l.push(i),e==o||"function"==typeof i.getSimplifiedGeometry?e in r.serializers[s]||(r.serializers[s][e]=ku(this.writeGeometryElement,this)):e in r.serializers[s]||(r.serializers[s][e]=ku(Ju)))}}const h=Object.assign({},r);h.node=t,ju(h,r.serializers,Fu(void 0,s),l,i,a)}writeFeatureMembers_(t,e,i){const n=i[i.length-1],r=n.featureType,s=n.featureNS,o={};o[s]={},o[s][r]=ku(this.writeFeatureElement,this);const a=Object.assign({},n);a.node=t,ju(a,o,Fu(r,s),e,i)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(t,e,i){const n=e[e.length-1].node;return bu(this.namespace,nc[n.nodeName])}GEOMETRY_NODE_FACTORY_(t,e,i){const n=e[e.length-1],r=n.multiSurface,s=n.surface,o=n.curve,a=n.multiCurve;return Array.isArray(t)?i="Envelope":"MultiPolygon"===(i=t.getType())&&!0===r?i="MultiSurface":"Polygon"===i&&!0===s?i="Surface":"LineString"===i&&!0===o?i="Curve":"MultiLineString"===i&&!0===a&&(i="MultiCurve"),bu(this.namespace,i)}writeGeometryNode(t,e){e=this.adaptOptions(e);const i=bu(this.namespace,"geom"),n={node:i,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return e&&Object.assign(n,e),this.writeGeometryElement(i,t,[n]),i}writeFeaturesNode(t,e){e=this.adaptOptions(e);const i=bu(this.namespace,"featureMembers");i.setAttributeNS("http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",this.schemaLocation);const n={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return e&&Object.assign(n,e),this.writeFeatureMembers_(i,t,[n]),i}}rc.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:Du(rc.prototype.readFlatPos),posList:Du(rc.prototype.readFlatPosList),coordinates:Du(ec.prototype.readFlatCoordinates)}},rc.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:rc.prototype.interiorParser,exterior:rc.prototype.exteriorParser}},rc.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:Du(qu.prototype.readPoint),MultiPoint:Du(qu.prototype.readMultiPoint),LineString:Du(qu.prototype.readLineString),MultiLineString:Du(qu.prototype.readMultiLineString),LinearRing:Du(qu.prototype.readLinearRing),Polygon:Du(qu.prototype.readPolygon),MultiPolygon:Du(qu.prototype.readMultiPolygon),Surface:Du(rc.prototype.readSurface),MultiSurface:Du(rc.prototype.readMultiSurface),Curve:Du(rc.prototype.readCurve),MultiCurve:Du(rc.prototype.readMultiCurve),Envelope:Du(rc.prototype.readEnvelope)}},rc.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:Ou(rc.prototype.curveMemberParser),curveMembers:Ou(rc.prototype.curveMemberParser)}},rc.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:Ou(rc.prototype.surfaceMemberParser),surfaceMembers:Ou(rc.prototype.surfaceMemberParser)}},rc.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:Ou(qu.prototype.readLineString),Curve:Ou(rc.prototype.readCurve)}},rc.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:Ou(qu.prototype.readPolygon),Surface:Ou(rc.prototype.readSurface)}},rc.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:Du(rc.prototype.readPatch)}},rc.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:Du(rc.prototype.readSegment)}},rc.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:Ou(rc.prototype.readFlatPosList),upperCorner:Ou(rc.prototype.readFlatPosList)}},rc.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:Du(rc.prototype.readPolygonPatch)}},rc.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:Pu(rc.prototype.readLineStringSegment)}},qu.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:Du(qu.prototype.readFlatLinearRing),Ring:Du(rc.prototype.readFlatCurveRing)}},rc.prototype.writeFeatures,rc.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:ku(rc.prototype.writeRing),interior:ku(rc.prototype.writeRing)}},rc.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:ku(Ju),upperCorner:ku(Ju)}},rc.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:ku(rc.prototype.writeSurfaceOrPolygonMember),polygonMember:ku(rc.prototype.writeSurfaceOrPolygonMember)}},rc.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:ku(rc.prototype.writePointMember)}},rc.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:ku(rc.prototype.writeLineStringOrCurveMember),curveMember:ku(rc.prototype.writeLineStringOrCurveMember)}},rc.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:ku(rc.prototype.writeCurveOrLineString),MultiCurve:ku(rc.prototype.writeMultiCurveOrLineString),Point:ku(rc.prototype.writePoint),MultiPoint:ku(rc.prototype.writeMultiPoint),LineString:ku(rc.prototype.writeCurveOrLineString),MultiLineString:ku(rc.prototype.writeMultiCurveOrLineString),LinearRing:ku(rc.prototype.writeLinearRing),Polygon:ku(rc.prototype.writeSurfaceOrPolygon),MultiPolygon:ku(rc.prototype.writeMultiSurfaceOrPolygon),Surface:ku(rc.prototype.writeSurfaceOrPolygon),MultiSurface:ku(rc.prototype.writeMultiSurfaceOrPolygon),Envelope:ku(rc.prototype.writeEnvelope)}};const sc=rc;class oc extends sc{constructor(t){super(t=t||{}),this.schemaLocation=t.schemaLocation?t.schemaLocation:this.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd"}writeGeometryElement(t,e,i){const n=i[i.length-1];i[i.length-1]=Object.assign({multiCurve:!0,multiSurface:!0},n),super.writeGeometryElement(t,e,i)}}oc.prototype.namespace="http://www.opengis.net/gml/3.2",oc.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:Du(sc.prototype.readFlatPos),posList:Du(sc.prototype.readFlatPosList),coordinates:Du(ec.prototype.readFlatCoordinates)}},oc.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:sc.prototype.interiorParser,exterior:sc.prototype.exteriorParser}},oc.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:Du(qu.prototype.readPoint),MultiPoint:Du(qu.prototype.readMultiPoint),LineString:Du(qu.prototype.readLineString),MultiLineString:Du(qu.prototype.readMultiLineString),LinearRing:Du(qu.prototype.readLinearRing),Polygon:Du(qu.prototype.readPolygon),MultiPolygon:Du(qu.prototype.readMultiPolygon),Surface:Du(oc.prototype.readSurface),MultiSurface:Du(sc.prototype.readMultiSurface),Curve:Du(oc.prototype.readCurve),MultiCurve:Du(sc.prototype.readMultiCurve),Envelope:Du(oc.prototype.readEnvelope)}},oc.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:Ou(sc.prototype.curveMemberParser),curveMembers:Ou(sc.prototype.curveMemberParser)}},oc.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:Ou(sc.prototype.surfaceMemberParser),surfaceMembers:Ou(sc.prototype.surfaceMemberParser)}},oc.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:Ou(qu.prototype.readLineString),Curve:Ou(sc.prototype.readCurve)}},oc.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:Ou(qu.prototype.readPolygon),Surface:Ou(sc.prototype.readSurface)}},oc.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:Du(sc.prototype.readPatch)}},oc.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:Du(sc.prototype.readSegment)}},oc.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:Ou(sc.prototype.readFlatPosList),upperCorner:Ou(sc.prototype.readFlatPosList)}},oc.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:Du(sc.prototype.readPolygonPatch)}},oc.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:Pu(sc.prototype.readLineStringSegment)}},oc.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:Ou(qu.prototype.pointMemberParser),pointMembers:Ou(qu.prototype.pointMemberParser)}},oc.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:Ou(qu.prototype.lineStringMemberParser),lineStringMembers:Ou(qu.prototype.lineStringMemberParser)}},oc.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:Ou(qu.prototype.polygonMemberParser),polygonMembers:Ou(qu.prototype.polygonMemberParser)}},oc.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:Ou(qu.prototype.readFlatCoordinatesFromNode)}},oc.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:Ou(qu.prototype.readLineString)}},oc.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:Ou(qu.prototype.readPolygon)}},oc.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:Du(qu.prototype.readFlatLinearRing),Ring:Du(oc.prototype.readFlatCurveRing)}},oc.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:ku(sc.prototype.writeRing),interior:ku(sc.prototype.writeRing)}},oc.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:ku(Ju),upperCorner:ku(Ju)}},oc.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:ku(sc.prototype.writeSurfaceOrPolygonMember),polygonMember:ku(sc.prototype.writeSurfaceOrPolygonMember)}},oc.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:ku(sc.prototype.writePointMember)}},oc.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:ku(sc.prototype.writeLineStringOrCurveMember),curveMember:ku(sc.prototype.writeLineStringOrCurveMember)}},oc.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:ku(sc.prototype.writeCurveOrLineString),MultiCurve:ku(sc.prototype.writeMultiCurveOrLineString),Point:ku(oc.prototype.writePoint),MultiPoint:ku(sc.prototype.writeMultiPoint),LineString:ku(sc.prototype.writeCurveOrLineString),MultiLineString:ku(sc.prototype.writeMultiCurveOrLineString),LinearRing:ku(sc.prototype.writeLinearRing),Polygon:ku(sc.prototype.writeSurfaceOrPolygon),MultiPolygon:ku(sc.prototype.writeMultiSurfaceOrPolygon),Surface:ku(sc.prototype.writeSurfaceOrPolygon),MultiSurface:ku(sc.prototype.writeMultiSurfaceOrPolygon),Envelope:ku(sc.prototype.writeEnvelope)}};const ac=oc,lc=new Map([["a","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M0 0 48 0 48 48 0 48 0 0' fill='white' fill-opacity='0.01' /><path d='M23.9407 7C23.8221 7 23.5849 7 23.4663 7.12021L2.59299 17.9387C2.3558 18.0589 2.1186 18.2993 2 18.5397C2 18.7802 2 19.1408 2.1186 19.3812L3.42318 21.6651V40.4172C3.42318 41.1384 4.01617 41.8597 4.84636 41.8597H9.4717C9.94609 41.8597 10.3019 41.499 10.3019 41.0182V38.6141C10.3019 38.1333 9.94609 37.7727 9.4717 37.7727H7.45553V20.9439L23.9407 12.4093L40.4259 20.9439V37.7727H38.5283C38.0539 37.7727 37.6981 38.1333 37.6981 38.6141V41.0182C37.6981 41.499 38.0539 41.8597 38.5283 41.8597H43.1536C43.8652 41.8597 44.5768 41.2586 44.5768 40.4172V21.6651L45.8814 19.3812C46 19.1408 46 18.9004 46 18.5397C45.8814 18.2993 45.7628 18.0589 45.5256 17.9387L24.6523 7.12021C24.2965 7 24.1779 7 23.9407 7Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M1.99999 18.5398C2.11859 18.2994 2.35579 18.0589 2.59298 17.9387L23.4663 7.12022C23.5849 7.00002 23.8221 7.00002 23.9407 7.00002C24.1779 7.00002 24.2965 7.00002 24.6523 7.12022L45.5256 17.9387C45.7628 18.0589 45.8814 18.2994 46 18.5398C46 18.9004 46 19.1408 45.8814 19.3812L44.5768 21.6651V40.4172C44.5768 41.2586 43.8652 41.8597 43.1536 41.8597H38.5283C38.0539 41.8597 37.6981 41.4991 37.6981 41.0182V38.6141C37.6981 38.1333 38.0539 37.7727 38.5283 37.7727H40.4259V20.9439L23.9407 12.4093L7.45552 20.9439V37.7727H9.47169C9.94608 37.7727 10.3019 38.1333 10.3019 38.6141V41.0182C10.3019 41.4991 9.94608 41.8597 9.47169 41.8597H4.84635C4.01616 41.8597 3.42317 41.1384 3.42317 40.4172V21.6651L2.11859 19.3812C1.99999 19.1408 1.99999 18.7802 1.99999 18.5398ZM2.22317 21.9837L1.05853 19.9448L1.04242 19.9121C0.88888 19.6009 0.840789 19.2828 0.820615 19.0783C0.799907 18.8684 0.79996 18.6682 0.79999 18.5523L0.799992 18.2599L0.923817 18.0089C1.15531 17.5396 1.57623 17.1105 2.04469 16.8713L22.8136 6.10691C23.0856 5.91565 23.3641 5.85538 23.5036 5.83181C23.6945 5.79955 23.8696 5.79989 23.9317 5.8C23.935 5.80001 23.938 5.80002 23.9407 5.80002C23.9466 5.80002 23.9528 5.80001 23.9591 5.80001C24.0677 5.7999 24.2328 5.79975 24.424 5.82743C24.6284 5.85702 24.8235 5.91144 25.0364 5.98335L25.1232 6.01267L46.0681 16.8683C46.0702 16.8694 46.0723 16.8705 46.0744 16.8716C46.6814 17.1822 46.9588 17.7634 47.0575 17.9702C47.0647 17.9851 47.0709 17.9981 47.0762 18.0089L47.2 18.2599V18.5398C47.2 18.5601 47.2001 18.5816 47.2002 18.6041C47.2017 18.9109 47.2041 19.4123 46.9576 19.9121L46.9415 19.9448L45.7768 21.9837V40.4172C45.7768 41.9703 44.478 43.0597 43.1536 43.0597H38.5283C37.376 43.0597 36.4981 42.1465 36.4981 41.0182V38.6141C36.4981 37.4858 37.376 36.5727 38.5283 36.5727H39.2259V21.6739L23.9407 13.7606L8.65552 21.6739V36.5727H9.47169C10.624 36.5727 11.5019 37.4858 11.5019 38.6141V41.0182C11.5019 42.1465 10.624 43.0597 9.47169 43.0597H4.84635C3.27502 43.0597 2.22317 41.72 2.22317 40.4172V21.9837Z' fill='white'/><path d='M34 29C34 34.5228 29.5228 39 24 39C18.4772 39 14 34.5228 14 29C14 23.4772 18.4772 19 24 19C29.5228 19 34 23.4772 34 29Z' fill='white'/><path d='M30.3641 22.6363C28.6644 20.9361 26.404 20 24 20C21.6076 20.0068 19.3158 20.9586 17.6282 22.6462C15.9406 24.3338 14.9953 26.6191 15 29C15 31.4042 15.9361 33.6639 17.6359 35.3639C19.3357 37.0639 21.596 38 24 38C26.404 38 28.6644 37.0637 30.3641 35.3637C32.0639 33.6637 33 31.4039 33 28.9997C33 26.5955 32.0652 24.3361 30.3641 22.6363ZM30.8904 31.9474C30.6524 31.8329 29.5629 31.1887 28.9864 31.19C28.9314 30.1124 28.4724 28.19 28.227 27.2232C28.5258 26.9255 29.3413 25.6161 29.6002 25.0653C30.3366 25.2558 31.3402 25.5547 31.7238 25.7661C31.7206 25.864 31.7414 25.9612 31.7847 26.0492C32.0052 26.525 32.5499 28.6545 32.578 29.3155L32.5396 29.3082C32.3696 30.1537 31.2947 31.4737 30.8904 31.9474ZM23.7168 37.3516C23.712 37.3494 23.7069 37.3477 23.7017 37.3466C23.5515 37.3089 22.6117 37.2342 21.8221 37.0097C21.2005 36.8329 20.6721 36.4474 20.3101 36.3397L20.3326 36.32C19.9801 35.9253 19.7865 34.5747 19.7178 33.8492C20.1821 33.7189 21.7142 32.9421 22.2635 32.5561C23.0277 32.8408 25.1561 33.6168 26.1639 33.8211C26.231 34.08 26.3469 34.5316 26.446 34.9526C26.5518 35.3968 26.6377 35.7497 26.7424 35.9224C25.8394 36.9111 24.0198 37.2937 23.7168 37.3516ZM18.7764 28.0263C18.4469 27.0095 18.2174 25.0384 18.1663 24.5721C18.4043 24.2595 18.8594 23.695 19.3788 23.2055C19.6992 22.9037 20.0517 22.6377 20.4302 22.4121C21.7457 22.2726 23.524 22.9134 24.1076 23.1421C24.0468 23.7376 24.3927 25.4921 24.5852 26.1008C23.7417 26.7084 22.1244 28.1713 21.554 28.6921C21.0272 28.4908 19.315 28.1363 18.7764 28.0263ZM26.2353 33.4947C25.3875 33.3255 23.5 32.6571 22.4573 32.27C22.4018 31.7542 21.9261 29.61 21.76 28.9592C22.3103 28.4568 23.9942 26.9329 24.806 26.3539C25.3185 26.5203 27.183 27.0566 27.8803 27.2282C28.1281 28.1992 28.6408 30.3263 28.6546 31.3334C28.2436 31.7561 26.6919 33.1003 26.2353 33.4947ZM31.8878 25.4176C31.8759 25.4292 31.8643 25.4421 31.8524 25.4558C31.3026 25.1705 30.0841 24.8429 29.6396 24.7289C29.3934 24.2532 28.0662 22.85 27.4313 22.4011C27.4548 22.2358 27.4879 21.9916 27.5178 21.7474C27.5484 21.4953 27.5707 21.2921 27.5796 21.1439C27.5796 21.1326 27.5815 21.1216 27.582 21.1105C29.491 21.9845 31.0197 23.5132 31.8878 25.4176ZM24 20.3347C25.1153 20.3337 26.2201 20.5493 27.2525 20.9692C27.2504 21.1692 27.1885 21.7087 27.1129 22.255C26.5801 22.2087 24.9237 22.7121 24.3721 22.8866C24.0206 22.7411 22.3645 22.0855 20.9183 22.0587L20.894 20.9097L20.9498 20.8882C21.9244 20.5212 22.958 20.3337 24 20.3347ZM16.5694 24.5613C16.9333 24.5492 17.5703 24.7026 17.8498 24.7755C17.9291 25.4618 18.1563 27.2655 18.4908 28.2263C18.2015 28.7789 17.4817 30.1708 17.2408 30.8105C16.4882 30.9629 15.7669 30.8161 15.5154 30.7537C15.0769 28.631 15.4529 26.4219 16.5694 24.5613ZM15.5987 31.1171C15.9069 31.1809 16.2208 31.2133 16.5356 31.2139C16.7496 31.2143 16.9632 31.1973 17.1745 31.1632C17.3291 31.6032 18.7658 33.1916 19.3674 33.7058C19.3994 34.1155 19.5432 35.6397 19.9439 36.3468C19.7744 36.3685 19.6031 36.3728 19.4327 36.3597C17.5233 35.1695 16.1497 33.2912 15.5987 31.1171ZM23.8755 37.6637C24.4043 37.5563 26.2157 37.1176 27.0978 36.025C27.5532 35.9824 28.6096 35.8211 29.5306 35.3271C29.658 35.2593 29.7804 35.1825 29.8969 35.0974L30.0209 35.2242C28.4607 36.7345 26.3373 37.6653 24.0003 37.6653C23.9582 37.6653 23.9172 37.6642 23.8755 37.6637ZM30.2576 34.9863L30.1518 34.8766C30.4302 34.5905 30.6257 34.2066 30.7703 33.6055C30.9165 32.9955 31.0056 32.5745 31.0215 32.3095C31.2106 32.0958 32.1123 31.0579 32.5933 30.1108C32.3571 31.9423 31.5387 33.6506 30.2576 34.9863Z' fill='%color%'/></svg>"],["b","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path fill-rule='evenodd' clip-rule='evenodd' d='M47.2186 44L24 3L0.781403 44H47.2186Z' fill='#FFD400'/><path d='M22.2139 39.6722V36.0278H25.786V39.6722H22.2139ZM22.9953 33.2945L22.1023 19.6278V13.9333H25.8976V19.6278L25.0046 33.2945H22.9953Z' fill='black'/></svg>"],["c","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M0 0 48 0 48 48 0 48 0 0' fill='white' fill-opacity='0.01' /><path d='M23.9407 7C23.8221 7 23.5849 7 23.4663 7.12021L2.59299 17.9387C2.3558 18.0589 2.1186 18.2993 2 18.5397C2 18.7802 2 19.1408 2.1186 19.3812L3.42318 21.6651V40.4172C3.42318 41.1384 4.01617 41.8597 4.84636 41.8597H9.4717C9.94609 41.8597 10.3019 41.499 10.3019 41.0182V38.6141C10.3019 38.1333 9.94609 37.7727 9.4717 37.7727H7.45553V20.9439L23.9407 12.4093L40.4259 20.9439V37.7727H38.5283C38.0539 37.7727 37.6981 38.1333 37.6981 38.6141V41.0182C37.6981 41.499 38.0539 41.8597 38.5283 41.8597H43.1536C43.8652 41.8597 44.5768 41.2586 44.5768 40.4172V21.6651L45.8814 19.3812C46 19.1408 46 18.9004 46 18.5397C45.8814 18.2993 45.7628 18.0589 45.5256 17.9387L24.6523 7.12021C24.2965 7 24.1779 7 23.9407 7Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M1.99999 18.5398C2.11859 18.2994 2.35579 18.0589 2.59298 17.9387L23.4663 7.12022C23.5849 7.00002 23.8221 7.00002 23.9407 7.00002C24.1779 7.00002 24.2965 7.00002 24.6523 7.12022L45.5256 17.9387C45.7628 18.0589 45.8814 18.2994 46 18.5398C46 18.9004 46 19.1408 45.8814 19.3812L44.5768 21.6651V40.4172C44.5768 41.2586 43.8652 41.8597 43.1536 41.8597H38.5283C38.0539 41.8597 37.6981 41.4991 37.6981 41.0182V38.6141C37.6981 38.1333 38.0539 37.7727 38.5283 37.7727H40.4259V20.9439L23.9407 12.4093L7.45552 20.9439V37.7727H9.47169C9.94608 37.7727 10.3019 38.1333 10.3019 38.6141V41.0182C10.3019 41.4991 9.94608 41.8597 9.47169 41.8597H4.84635C4.01617 41.8597 3.42317 41.1384 3.42317 40.4172V21.6651L2.11859 19.3812C1.99999 19.1408 1.99999 18.7802 1.99999 18.5398ZM2.22317 21.9837L1.05853 19.9448L1.04242 19.9121C0.88888 19.6009 0.840789 19.2828 0.820615 19.0783C0.799907 18.8684 0.79996 18.6682 0.79999 18.5523L0.799992 18.2599L0.923817 18.0089C1.15531 17.5396 1.57623 17.1105 2.04469 16.8713L22.8136 6.10691C23.0856 5.91565 23.3641 5.85538 23.5036 5.83181C23.6945 5.79955 23.8696 5.79989 23.9317 5.8C23.935 5.80001 23.938 5.80002 23.9407 5.80002C23.9466 5.80002 23.9528 5.80001 23.9591 5.80001C24.0677 5.7999 24.2328 5.79975 24.424 5.82743C24.6284 5.85702 24.8235 5.91144 25.0364 5.98335L25.1232 6.01267L46.0681 16.8683C46.0702 16.8694 46.0723 16.8705 46.0744 16.8716C46.6814 17.1822 46.9588 17.7634 47.0575 17.9702C47.0647 17.9851 47.0709 17.9981 47.0762 18.0089L47.2 18.2599V18.5398C47.2 18.5601 47.2001 18.5816 47.2002 18.6041C47.2017 18.9109 47.2041 19.4123 46.9576 19.9121L46.9415 19.9448L45.7768 21.9837V40.4172C45.7768 41.9703 44.478 43.0597 43.1536 43.0597H38.5283C37.376 43.0597 36.4981 42.1465 36.4981 41.0182V38.6141C36.4981 37.4858 37.376 36.5727 38.5283 36.5727H39.2259V21.6739L23.9407 13.7606L8.65552 21.6739V36.5727H9.47169C10.624 36.5727 11.5019 37.4858 11.5019 38.6141V41.0182C11.5019 42.1465 10.624 43.0597 9.47169 43.0597H4.84635C3.27502 43.0597 2.22317 41.72 2.22317 40.4172V21.9837Z' fill='white'/><path d='M22.1387 33.488C22.1387 33.2365 22.1387 33.1107 22.1387 33.1107C22.1387 32.9849 22.1387 32.8592 22.1387 32.7334C22.1387 32.1046 22.2627 31.4757 22.5109 30.8468C22.7591 30.3438 23.0073 29.8407 23.3795 29.4634C23.7518 29.086 24.1241 28.7087 24.4963 28.4572C25.1168 28.0799 25.6131 27.5768 25.6131 27.5768C25.9854 27.3253 26.2336 27.0737 26.4818 26.6964C26.73 26.3191 26.854 25.9418 26.854 25.5645C26.854 25.0614 26.6059 24.4325 26.1095 24.181C25.365 23.6779 23.8759 23.6779 23.8759 23.6779C23.3795 23.6779 22.8832 23.8037 22.5109 23.9294C22.1387 24.0552 21.7664 24.3067 21.27 24.4325C20.8978 24.6841 20.6496 24.8098 20.2773 25.0614C19.905 25.4387 19.5328 25.5645 19.5328 25.5645L17.9196 23.4263C18.2919 23.049 18.7882 22.546 19.2846 22.2944C19.781 21.9171 20.2773 21.6656 20.8978 21.414C21.3941 21.1625 22.0146 21.0367 22.635 20.9109C23.2555 20.7852 23.7518 20.7852 24.3723 20.7852C27.1022 20.7852 28.5913 21.9171 28.5913 21.9171C29.584 22.6717 30.0804 23.8037 30.0804 24.9356C30.0804 25.6902 29.9563 26.3191 29.7081 27.0737C29.4599 27.5768 29.2117 28.0799 28.7154 28.4572C28.3431 28.8345 27.8468 29.2118 27.4745 29.4634C26.9781 29.7149 26.6059 30.0922 26.2336 30.4695C25.8613 30.8468 25.4891 31.2242 25.2409 31.6015C24.9927 32.1045 24.8686 32.7334 24.8686 33.3623L22.1387 33.488Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M20.9387 34.7446V32.7341C20.9387 31.9435 21.0954 31.1648 21.3947 30.4063L21.4129 30.3603L21.4348 30.3159C21.4443 30.2966 21.454 30.2769 21.4639 30.2568C21.6916 29.7941 22.0144 29.1384 22.5253 28.6206C22.5384 28.6073 22.5516 28.5939 22.5649 28.5804C22.9077 28.2327 23.3518 27.7823 23.8245 27.4629L23.8483 27.4468L23.8728 27.4319C24.1085 27.2886 24.3335 27.1127 24.5062 26.9646C24.5905 26.8923 24.6578 26.8306 24.7023 26.7885C24.7245 26.7676 24.7408 26.7518 24.7506 26.7422L24.76 26.7329C24.7602 26.7328 24.76 26.733 24.76 26.7329C24.7603 26.7326 24.7608 26.7321 24.7609 26.7321C24.7609 26.7321 24.7609 26.7321 24.7609 26.7321L24.8426 26.6492L24.9413 26.5825C25.1816 26.4201 25.3176 26.2826 25.4792 26.0369C25.6243 25.8163 25.6541 25.6646 25.6541 25.5644C25.6541 25.5351 25.6502 25.4925 25.6386 25.4428C25.6271 25.3934 25.6106 25.3474 25.5917 25.3093C25.5728 25.2709 25.5574 25.251 25.5501 25.2428L25.5 25.2174L25.4377 25.1753C25.3108 25.0896 24.9927 24.9894 24.5528 24.93C24.3606 24.904 24.1851 24.8907 24.0579 24.8841C23.995 24.8809 23.9454 24.8793 23.9134 24.8785L23.8795 24.8779L23.8759 24.8779C23.5635 24.8779 23.207 24.9609 22.895 25.0663C22.8162 25.0929 22.7431 25.1275 22.599 25.1956C22.5551 25.2164 22.5047 25.2402 22.4455 25.2679C22.2707 25.3497 22.045 25.451 21.7782 25.535C21.6382 25.6257 21.5146 25.7008 21.4026 25.769L21.3972 25.7722C21.2704 25.8493 21.1585 25.9175 21.0346 25.9988C20.7883 26.2303 20.5465 26.3917 20.3542 26.5C20.2449 26.5616 20.1494 26.6072 20.0749 26.6395C20.0375 26.6558 20.0051 26.6688 19.9786 26.679C19.9653 26.684 19.9535 26.6884 19.9432 26.6921L19.9289 26.6972L19.9226 26.6994L19.9197 26.7004L19.9182 26.7009C19.9179 26.701 19.9169 26.7013 19.5328 25.5644C19.5328 25.5644 19.9051 25.4387 20.2773 25.0614C20.4635 24.9356 20.6186 24.8413 20.7737 24.7469C20.9288 24.6526 21.0839 24.5583 21.27 24.4325C21.5653 24.3577 21.8167 24.2384 22.0502 24.1275C22.2093 24.052 22.3601 23.9804 22.5109 23.9294C22.8832 23.8037 23.3796 23.6779 23.8759 23.6779C23.8759 23.6779 25.365 23.6779 26.1095 24.181C26.6059 24.4325 26.8541 25.0614 26.8541 25.5644C26.8541 25.9418 26.73 26.3191 26.4818 26.6964C26.2336 27.0737 25.9854 27.3252 25.6132 27.5768C25.6132 27.5768 25.1168 28.0799 24.4964 28.4572C24.1241 28.7087 23.7518 29.086 23.3796 29.4633C23.0073 29.8406 22.7591 30.3437 22.5109 30.8468C22.3216 31.3265 22.2045 31.8061 22.1596 32.2858C22.1457 32.435 22.1387 32.5842 22.1387 32.7334V33.488L24.8686 33.3623C24.8686 32.7334 24.9927 32.1045 25.2409 31.6015C25.4891 31.2241 25.8613 30.8468 26.2336 30.4695C26.6059 30.0922 26.9781 29.7149 27.4745 29.4633C27.8468 29.2118 28.3431 28.8345 28.7154 28.4572C29.2118 28.0799 29.4599 27.5768 29.7081 27.0737C29.9563 26.3191 30.0804 25.6902 30.0804 24.9356C30.0804 23.8037 29.584 22.6717 28.5913 21.9171C28.5913 21.9171 27.1022 20.7851 24.3723 20.7851C23.7518 20.7851 23.2555 20.7851 22.635 20.9109C22.0146 21.0367 21.3941 21.1625 20.8978 21.414C20.2773 21.6655 19.781 21.9171 19.2846 22.2944C18.7883 22.5459 18.2919 23.049 17.9196 23.4263L19.5328 25.5644L19.9169 26.7013L19.0964 26.9785L16.3373 23.3215L17.0654 22.5835C17.0799 22.5688 17.095 22.5535 17.1107 22.5376C17.4362 22.207 18.0051 21.629 18.6393 21.2785C19.2087 20.8586 19.7734 20.5773 20.4037 20.3195C21.0369 20.0097 21.7721 19.8611 22.3286 19.7486C22.3516 19.744 22.3743 19.7394 22.3966 19.7348C23.1356 19.585 23.735 19.5851 24.3384 19.5851L24.3723 19.5851C25.9065 19.5851 27.1111 19.9037 27.9479 20.2356C28.3655 20.4013 28.6908 20.5699 28.9198 20.7032C29.0344 20.7699 29.125 20.8279 29.1914 20.8725C29.2246 20.8948 29.2517 20.9138 29.2728 20.9289L29.2997 20.9485L29.3098 20.9559L29.3139 20.9591L29.3158 20.9605L29.3167 20.9611C29.3171 20.9614 29.3175 20.9618 28.6242 21.8738L29.3175 20.9618C30.6287 21.9585 31.2804 23.4544 31.2804 24.9356C31.2804 25.846 31.126 26.6033 30.848 27.4486L30.8217 27.5288L30.7843 27.6046C30.7754 27.6225 30.7664 27.6409 30.7572 27.6596C30.5303 28.1209 30.1894 28.8141 29.5124 29.3572C29.0734 29.7905 28.5367 30.1939 28.1464 30.4576L28.084 30.4997L28.017 30.5337C27.7221 30.6832 27.4796 30.9152 27.0878 31.3123C26.7232 31.6819 26.4585 31.9559 26.2862 32.1984C26.1538 32.4983 26.0686 32.9096 26.0686 33.3623V34.5082L20.9387 34.7446Z' fill='white'/><path d='M23.6277 40.1043C24.6557 40.1043 25.4891 39.2597 25.4891 38.2177C25.4891 37.1758 24.6557 36.3312 23.6277 36.3312C22.5997 36.3312 21.7664 37.1758 21.7664 38.2177C21.7664 39.2597 22.5997 40.1043 23.6277 40.1043Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M26.6891 38.2177C26.6891 39.9071 25.3336 41.3043 23.6277 41.3043C21.9218 41.3043 20.5664 39.9071 20.5664 38.2177C20.5664 36.5283 21.9218 35.1312 23.6277 35.1312C25.3336 35.1312 26.6891 36.5283 26.6891 38.2177ZM25.4891 38.2177C25.4891 39.2597 24.6557 40.1043 23.6277 40.1043C22.5997 40.1043 21.7664 39.2597 21.7664 38.2177C21.7664 37.1758 22.5997 36.3312 23.6277 36.3312C24.6557 36.3312 25.4891 37.1758 25.4891 38.2177Z' fill='white'/></svg>"],["d","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M0 0 48 0 48 48 0 48 0 0' fill='white' fill-opacity='0.01' /><path d='M23.9407 7C23.8221 7 23.5849 7 23.4663 7.12021L2.59299 17.9387C2.3558 18.0589 2.1186 18.2993 2 18.5397C2 18.7802 2 19.1408 2.1186 19.3812L3.42318 21.6651V40.4172C3.42318 41.1384 4.01617 41.8596 4.84636 41.8596H9.4717C9.94609 41.8596 10.3019 41.499 10.3019 41.0182V38.6141C10.3019 38.1333 9.94609 37.7727 9.4717 37.7727H7.45553V20.9439L23.9407 12.4093L40.4259 20.9439V37.7727H38.5283C38.0539 37.7727 37.6981 38.1333 37.6981 38.6141V41.0182C37.6981 41.499 38.0539 41.8596 38.5283 41.8596H43.1536C43.8652 41.8596 44.5768 41.2586 44.5768 40.4172V21.6651L45.8814 19.3812C46 19.1408 46 18.9004 46 18.5397C45.8814 18.2993 45.7628 18.0589 45.5256 17.9387L24.6523 7.12021C24.2965 7 24.1779 7 23.9407 7Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M1.99999 18.5398C2.11859 18.2994 2.35579 18.0589 2.59298 17.9387L23.4663 7.12022C23.5849 7.00002 23.8221 7.00002 23.9407 7.00002C24.1779 7.00002 24.2965 7.00002 24.6523 7.12022L45.5256 17.9387C45.7628 18.0589 45.8814 18.2994 46 18.5398C46 18.9004 46 19.1408 45.8814 19.3812L44.5768 21.6651V40.4172C44.5768 41.2586 43.8652 41.8597 43.1536 41.8597H38.5283C38.0539 41.8597 37.6981 41.499 37.6981 41.0182V38.6141C37.6981 38.1333 38.0539 37.7727 38.5283 37.7727H40.4259V20.9439L23.9407 12.4093L7.45552 20.9439V37.7727H9.47169C9.94608 37.7727 10.3019 38.1333 10.3019 38.6141V41.0182C10.3019 41.499 9.94608 41.8597 9.47169 41.8597H4.84635C4.01617 41.8597 3.42317 41.1384 3.42317 40.4172V21.6651L2.11859 19.3812C1.99999 19.1408 1.99999 18.7802 1.99999 18.5398ZM2.22317 21.9837L1.05853 19.9448L1.04242 19.9121C0.88888 19.6009 0.840789 19.2828 0.820615 19.0783C0.799907 18.8684 0.79996 18.6682 0.79999 18.5523L0.799992 18.2599L0.923817 18.0089C1.15531 17.5396 1.57623 17.1105 2.04469 16.8713L22.8136 6.10691C23.0856 5.91565 23.3641 5.85538 23.5036 5.83181C23.6945 5.79955 23.8696 5.79989 23.9317 5.8C23.935 5.80001 23.938 5.80002 23.9407 5.80002C23.9466 5.80002 23.9528 5.80001 23.9591 5.80001C24.0677 5.7999 24.2328 5.79975 24.424 5.82743C24.6284 5.85702 24.8235 5.91144 25.0364 5.98335L25.1232 6.01267L46.0681 16.8683C46.0701 16.8694 46.0721 16.8704 46.0741 16.8714C46.6813 17.1821 46.9588 17.7634 47.0575 17.9702C47.0647 17.9851 47.0709 17.9981 47.0762 18.0089L47.2 18.2599V18.5398C47.2 18.5601 47.2001 18.5816 47.2002 18.6041C47.2017 18.9109 47.2041 19.4123 46.9576 19.9121L46.9415 19.9448L45.7768 21.9837V40.4172C45.7768 41.9703 44.478 43.0597 43.1536 43.0597H38.5283C37.376 43.0597 36.4981 42.1465 36.4981 41.0182V38.6141C36.4981 37.4858 37.376 36.5727 38.5283 36.5727H39.2259V21.6739L23.9407 13.7606L8.65552 21.6739V36.5727H9.47169C10.624 36.5727 11.5019 37.4858 11.5019 38.6141V41.0182C11.5019 42.1465 10.624 43.0597 9.47169 43.0597H4.84635C3.27502 43.0597 2.22317 41.7199 2.22317 40.4172V21.9837Z' fill='white'/></svg>"],["e","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M0 0 48 0 48 48 0 48 0 0' fill='white' fill-opacity='0.01' /><path d='M46.2152 20.1647L25.1613 5.34728C24.471 4.88424 23.5506 4.88424 22.8603 5.34728L13.4264 11.9457V8.82011H8.36421V15.5343L7.55887 16.1131L1.80644 20.0489C1.0011 20.7435 0.771003 21.9011 1.34625 22.8272C1.92149 23.6375 2.95693 23.9848 3.87732 23.6375L24.0108 9.39892L44.2594 23.5218C45.2948 23.8691 46.4453 23.406 46.7905 22.3642C47.2507 21.5538 46.9055 20.6277 46.2152 20.1647Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M22.5261 4.84903C23.4186 4.25036 24.6031 4.25036 25.4956 4.84903L25.5067 4.85652L46.5554 19.6705C47.4381 20.2665 47.9392 21.491 47.3409 22.6084C46.8529 23.9763 45.348 24.5198 44.0686 24.0906L43.9869 24.0632L24.0132 10.1321L4.16103 24.1718L4.08913 24.1989C2.89719 24.6487 1.57975 24.1927 0.856992 23.1745L0.846308 23.1595L0.836569 23.1438C0.0934041 21.9474 0.403269 20.4668 1.41458 19.5946L1.43996 19.5727L7.21436 15.6218L7.76422 15.2266V8.22014H14.0264V10.7938L22.5261 4.84903ZM23.199 5.84262L12.8264 13.0975V9.42014H8.96422V15.8419L7.89778 16.6084L2.17496 20.5238C1.59975 21.0379 1.45624 21.8503 1.84633 22.495C2.26115 23.0662 2.97137 23.3026 3.59906 23.0995L24.0084 8.66575L44.5264 22.9765C45.2747 23.1885 46.0046 22.8284 46.2209 22.1755L46.2395 22.1193L46.2687 22.0679C46.5452 21.581 46.3614 20.9853 45.881 20.663L45.8698 20.6555L24.8219 5.84216C24.3359 5.51916 23.685 5.51931 23.199 5.84262Z' fill='white'/><path d='M15 18H33L24 11.8823L15 18Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M33 18L24 11.8823L15 18H33ZM18.25 17H29.75L24 13.0915L18.25 17Z' fill='white'/><path d='M43.448 39.56H42.2101V35.69H32.0505C31.7867 35.69 31.5336 35.5799 31.347 35.3839C31.1604 35.1879 31.0555 34.9221 31.0555 34.645C31.0555 34.3678 31.1604 34.102 31.347 33.906C31.5336 33.7101 31.7867 33.6 32.0505 33.6H42.2101V27.24H32.0505C31.7867 27.24 31.5336 27.1299 31.347 26.9339C31.1604 26.7379 31.0555 26.4721 31.0555 26.195C31.0555 25.9178 31.1604 25.652 31.347 25.456C31.5336 25.2601 31.7867 25.15 32.0505 25.15H42.2387L34.688 19.6H13.5405L5.69462 25.14H16.0637C16.3276 25.14 16.5807 25.2501 16.7673 25.446C16.9539 25.642 17.0587 25.9078 17.0587 26.185C17.0587 26.4621 16.9539 26.7279 16.7673 26.9239C16.5807 27.1199 16.3276 27.23 16.0637 27.23H5.69462V33.59H16.1684C16.4323 33.59 16.6854 33.7001 16.872 33.896C17.0586 34.092 17.1634 34.3578 17.1634 34.635C17.1634 34.9121 17.0586 35.1779 16.872 35.3739C16.6854 35.5699 16.4323 35.68 16.1684 35.68H5.69462V39.55H4.44728C4.22077 39.5684 4.00799 39.6712 3.84734 39.8399C3.6867 40.0086 3.58879 40.2321 3.57129 40.47V41.47C3.58661 41.7096 3.68355 41.9355 3.8444 42.1063C4.00525 42.277 4.21926 42.3813 4.44728 42.4H19.3868V26.1H28.5085V42.4H43.5527C43.7807 42.3813 43.9947 42.277 44.1556 42.1063C44.3164 41.9355 44.4134 41.7096 44.4287 41.47V40.47C44.4069 40.2154 44.2932 39.9792 44.1108 39.81C43.9284 39.6407 43.6912 39.5513 43.448 39.56Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M13.3663 19H34.8681L44.0514 25.75H32.0506C31.9382 25.75 31.8304 25.7969 31.7509 25.8803C31.6715 25.9638 31.6268 26.077 31.6268 26.195C31.6268 26.313 31.6715 26.4262 31.7509 26.5097C31.8304 26.5931 31.9382 26.64 32.0506 26.64H42.7815V34.2H32.0506C31.9382 34.2 31.8304 34.2469 31.7509 34.3303C31.6715 34.4138 31.6268 34.527 31.6268 34.645C31.6268 34.763 31.6715 34.8762 31.7509 34.9597C31.8304 35.0431 31.9382 35.09 32.0506 35.09H42.7815V38.96H43.4394C43.8248 38.9491 44.1999 39.0921 44.489 39.3604C44.7809 39.6311 44.9629 40.009 44.9977 40.4163L45 40.4431V41.4901L44.9987 41.5102C44.9742 41.8937 44.8191 42.255 44.5617 42.5283C44.3044 42.8015 43.962 42.9683 43.5971 42.9982L43.575 43H27.9372V26.7H19.9581V43H4.42505L4.40287 42.9982C4.03803 42.9683 3.69563 42.8015 3.43827 42.5283C3.18091 42.255 3.02579 41.8936 3.00128 41.5102L3 41.4901V40.4469L3.0017 40.4238C3.0297 40.0432 3.18635 39.6856 3.44338 39.4157C3.70041 39.1457 4.04087 38.9812 4.40328 38.9518L4.42525 38.95H5.12333V35.08H16.1684C16.2808 35.08 16.3886 35.0331 16.4681 34.9497C16.5475 34.8662 16.5922 34.753 16.5922 34.635C16.5922 34.517 16.5475 34.4038 16.4681 34.3203C16.3886 34.2369 16.2808 34.19 16.1684 34.19H5.12333V26.63H16.0637C16.1761 26.63 16.2839 26.5831 16.3633 26.4997C16.4428 26.4162 16.4874 26.303 16.4874 26.185C16.4874 26.067 16.4428 25.9538 16.3633 25.8703C16.2839 25.7869 16.1761 25.74 16.0637 25.74H3.82097L13.3663 19ZM13.7147 20.2L7.56828 24.54H16.0637C16.4791 24.54 16.8775 24.7133 17.1713 25.0218C17.465 25.3303 17.63 25.7487 17.63 26.185C17.63 26.6213 17.465 27.0397 17.1713 27.3482C16.8775 27.6567 16.4791 27.83 16.0637 27.83H6.26593V32.99H16.1684C16.5839 32.99 16.9823 33.1633 17.276 33.4718C17.5697 33.7803 17.7348 34.1987 17.7348 34.635C17.7348 35.0713 17.5697 35.4897 17.276 35.7982C16.9823 36.1067 16.5839 36.28 16.1684 36.28H6.26593V40.15H4.47429C4.39008 40.1608 4.31154 40.2009 4.25132 40.2642C4.1911 40.3274 4.15292 40.4099 4.1426 40.4984V41.4454C4.15172 41.5354 4.18971 41.6197 4.25056 41.6843C4.31085 41.7483 4.3898 41.789 4.47454 41.8H18.8155V25.5H29.0798V41.8H43.5255C43.6102 41.789 43.6892 41.7483 43.7494 41.6843C43.8103 41.6197 43.8483 41.5354 43.8574 41.4453V40.503C43.8447 40.4091 43.8005 40.3227 43.7325 40.2597C43.6596 40.192 43.5647 40.1562 43.4674 40.1597L43.4577 40.16H41.6389V36.29H32.0506C31.6351 36.29 31.2367 36.1167 30.943 35.8082C30.6493 35.4997 30.4842 35.0813 30.4842 34.645C30.4842 34.2087 30.6493 33.7903 30.943 33.4818C31.2367 33.1733 31.6351 33 32.0506 33H41.6389V27.84H32.0506C31.6351 27.84 31.2367 27.6667 30.943 27.3582C30.6493 27.0497 30.4842 26.6313 30.4842 26.195C30.4842 25.7587 30.6493 25.3403 30.943 25.0318C31.2367 24.7233 31.6351 24.55 32.0506 24.55H40.4261L34.508 20.2H13.7147Z' fill='white'/></svg>"],["f","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M0 0 48 0 48 48 0 48 0 0' fill='white' fill-opacity='0.01' /><path d='M38.591 28.6562H36.827L38.9218 30.8437C39.3628 31.2812 39.5833 31.8281 39.5833 32.4844V40.9062C39.6935 41.4531 39.2525 41.8906 38.7012 42H34.9527C34.5117 41.8906 34.0707 41.4531 34.0707 40.9062V39.1562H15.1076V40.9062C15.1076 41.4531 14.6666 41.8906 14.1154 42H10.3668C9.81558 41.8906 9.37457 41.4531 9.37457 40.9062V32.375C9.37457 31.8281 9.59507 31.1719 10.0361 30.7344L12.1308 28.5469H10.2566C9.81558 28.4375 9.59507 28.1094 9.59507 27.7812V27.0156C9.59507 26.3594 9.92583 25.8125 10.5873 25.5937L14.2256 24.8281L15.5486 21.6562C15.8794 20.6719 16.8716 19.9062 17.9741 19.9062H30.9837C32.0862 19.9062 32.9682 20.6719 33.4092 21.6562L34.7322 24.8281L38.2602 25.7031C38.9217 25.8125 39.2525 26.4687 39.2525 27.125V27.8906C39.2525 28.3281 38.9218 28.6562 38.591 28.6562Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M10.5873 25.5937C9.92581 25.8125 9.59506 26.3594 9.59506 27.0156V27.7812C9.59506 28.1094 9.81556 28.4375 10.2566 28.5469H12.1308L10.0361 30.7344C9.59506 31.1719 9.37456 31.8281 9.37456 32.375V40.9062C9.37456 41.4531 9.81556 41.8906 10.3668 42H14.1153C14.6666 41.8906 15.1076 41.4531 15.1076 40.9062V39.1562H34.0707V40.9062C34.0707 41.4531 34.5117 41.8906 34.9527 42H38.7012C39.2525 41.8906 39.6935 41.4531 39.5832 40.9062V32.4844C39.5832 31.8281 39.3627 31.2812 38.9217 30.8437L36.827 28.6562H38.591C38.9217 28.6562 39.2525 28.3281 39.2525 27.8906V27.125C39.2525 26.4687 38.9217 25.8125 38.2602 25.7031L34.7322 24.8281L33.4092 21.6562C32.9682 20.6719 32.0862 19.9062 30.9837 19.9062H17.9741C16.8716 19.9062 15.8793 20.6719 15.5486 21.6562L14.2256 24.8281L10.5873 25.5937ZM13.361 23.7838L10.2744 24.4333L10.2106 24.4544C8.9954 24.8562 8.39506 25.9105 8.39506 27.0156V27.7812C8.39506 28.5356 8.8257 29.2052 9.513 29.5455L9.17871 29.8946C8.4858 30.5898 8.17456 31.5632 8.17456 32.375V40.9062C8.17456 42.1548 9.15715 42.9834 10.1333 43.177L10.2489 43.2H14.2332L14.3489 43.177C15.325 42.9834 16.3076 42.1548 16.3076 40.9062V40.3562H32.8707V40.9062C32.8707 42.1004 33.7866 42.9471 34.6638 43.1647L34.8061 43.2H38.8191L38.9348 43.177C39.815 43.0024 40.9761 42.181 40.7832 40.8074V32.4844C40.7832 31.5339 40.4528 30.6785 39.7789 30.0038L39.4338 29.6435C40.0612 29.3023 40.4525 28.5989 40.4525 27.8906V27.125C40.4525 26.2015 39.9678 24.8016 38.51 24.5287L35.6072 23.8088L34.5107 21.1799L34.5043 21.1656C33.9321 19.8884 32.6944 18.7062 30.9837 18.7062H17.9741C16.3511 18.7062 14.9284 19.7994 14.4264 21.2295L13.361 23.7838Z' fill='white'/><path d='M45.3347 19.2187L25.1588 5.32812C24.4973 4.89063 23.6153 4.89063 22.9538 5.32812L7.62898 15.8281L2.77795 19.1094C1.89594 19.7656 1.78569 20.9687 2.33695 21.8437C2.99845 22.7187 4.21121 23.0469 5.20346 22.3906L5.75472 21.9531L24.0563 9.48437L42.5784 21.9531L43.0194 22.2812C43.7912 22.9375 45.004 22.9375 45.6655 22.1719C46.327 21.4062 46.327 20.2031 45.5552 19.5469C45.5552 19.4375 45.445 19.3281 45.3347 19.2187Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M46.1036 18.2912L46.1798 18.3668C46.1827 18.3696 46.1859 18.3729 46.1896 18.3765C46.2366 18.4228 46.348 18.5328 46.4435 18.6591C46.4774 18.7039 46.5278 18.7741 46.5784 18.867C47.6768 20.0425 47.5315 21.8476 46.5735 22.9564C45.4224 24.2887 43.4678 24.2078 42.2757 23.2236L41.8848 22.9327L24.0604 10.9336L6.46647 22.9202L5.90876 23.3629L5.86543 23.3915C4.27019 24.4466 2.36676 23.873 1.37971 22.5674L1.34888 22.5266L1.32164 22.4834C0.490312 21.1638 0.599441 19.2345 2.06162 18.1466L2.08327 18.1305L6.95665 14.8341L22.2837 4.33263L22.2919 4.32721C23.3547 3.62425 24.7579 3.62425 25.8208 4.32721L25.8301 4.33338L46.1036 18.2912ZM7.62898 15.8281L2.77795 19.1094C1.89594 19.7656 1.78569 20.9687 2.33695 21.8437C2.99845 22.7187 4.21121 23.0469 5.20346 22.3906L5.75472 21.9531L24.0563 9.48436L42.5784 21.9531L43.0194 22.2812C43.7912 22.9375 45.0039 22.9375 45.6655 22.1719C46.327 21.4062 46.327 20.2031 45.5552 19.5469C45.5552 19.4375 45.445 19.3281 45.3347 19.2187L25.1588 5.32811C24.4973 4.89061 23.6153 4.89061 22.9538 5.32811L7.62898 15.8281Z' fill='white'/><path d='M16.9819 22.7385L15.1077 26.8947V27.0041C15.1077 27.2228 15.2179 27.4416 15.4384 27.4416H33.5195H33.6298C33.74 27.3322 33.8503 27.1135 33.74 26.8947L31.8658 22.7385C31.6453 22.301 31.2043 21.9728 30.7633 21.9728H18.0844C17.6434 21.9728 17.2024 22.301 16.9819 22.7385Z' fill='white'/><path d='M12.2411 34.0041C12.2411 35.2072 13.2334 36.1916 14.4462 36.1916C15.6589 36.1916 16.6512 35.2072 16.6512 34.0041C16.6512 32.801 15.6589 31.8166 14.4462 31.8166C13.2334 31.8166 12.2411 32.801 12.2411 34.0041Z' fill='white'/><path d='M32.0863 34.0041C32.0863 35.2072 33.0785 36.1916 34.2913 36.1916C35.504 36.1916 36.4963 35.2072 36.4963 34.0041C36.4963 32.801 35.504 31.8166 34.2913 31.8166C33.0785 31.8166 32.0863 32.801 32.0863 34.0041Z' fill='white'/></svg>"],["g","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><rect width='48' height='48' rx='1' fill='%color%'/><path d='M33.8 29.4C34.1 29.4 34.4 29.2 34.4 28.8C34.4 28.5 34.2 28.3 33.8 28.3H33.2V20.2H33.8C34.1 20.2 34.4 20 34.4 19.6C34.4 19.2 34.2 19 33.8 19H33.2V12.1H33.8C34.1 12.1 34.3 11.9 34.3 11.5C34.3 11.2 34.1 11 33.8 11H14.6C14.3 11 14.1 11.2 14.1 11.6C14.1 11.9 14.3 12.1 14.6 12.1H15.2V19H14.6C14.3 19 14 19.2 14 19.6C14 20 14.2 20.2 14.6 20.2H15.2V28.3H14.6C14.3 28.3 14 28.5 14 28.8C14 29.1 14.2 29.4 14.6 29.4H15.2V36.9H14.6C14.3 36.9 14 37.1 14 37.4C14 37.7 14.2 38 14.5 38H33.8C34.1 38 34.4 37.8 34.4 37.4C34.4 37.1 34 36.9 33.8 36.9H33.2V29.4H33.8Z' fill='white'/><path d='M20.9 26.9C20.9 28.8 22.4 30.2 24.2 30.2C26 30.2 27.5 28.8 27.5 26.9C27.5 25.1 24.2 18.2 24.2 18.2C23.2 24.2 20.9 24.2 20.9 26.9Z' fill='%color%'/></svg>"],["h","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><rect width='48' height='48' rx='1' fill='%color%'/><path d='M33.4 38H31V31L33 29V13L26 8.99999V8.4C26 8.2 25.8 8 25.6 8L22.4 8C22.2 8 22 8.2 22 8.4V9L15 13V29L17 31V38H14.6C14.3 38 14 38.2 14 38.6V39.4C14 39.7 14.2 40 14.6 40H33.4C33.7 40 34 39.8 34 39.4V38.6C34 38.3 33.7 38 33.4 38ZM29 38H25V36L29 33V38ZM19 33L23 36V38H19V33Z' fill='white'/></svg>"],["i","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M0 0 48 0 48 48 0 48 0 0' fill='white' fill-opacity='0.01' /><rect width='48' height='48' rx='1' fill='%color%'/><path d='M32.1 21.1C32.7 23.1 31.9 27.2 29.4 28.2C33.1 20.3 25.2 9 18 9C22 11.6 23.2 17 20.5 21.1C20.3 21.4 20.1 21.7 19.8 22C20.3 21.3 20.4 16.9 18 15C19.6 20.9 13 22.2 13 28.8C13 34 17.7 38.2 23.5 38.2C31 38.2 37.5 28.9 32.1 21.1Z' fill='white'/><path d='M18.9 32.2C18.9 34.1 20.6 35.2 22.5 35.2C28.4 35.2 26 26 23.1 24.1C23.1 31.2 18.9 28.4 18.9 32.2Z' fill='%color%'/></svg>"],["j","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><rect width='48' height='48' rx='1' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M40.4352 18.8249C39.6369 18.2784 38.6445 17.983 37.6188 18.0008L37.6015 18.0009C36.1729 18.0009 35.5084 18.3915 34.7171 18.8565L34.7068 18.8626C33.802 19.3944 32.7653 20 30.7993 20C28.8332 20 27.7967 19.3943 26.8921 18.8625L26.8816 18.8563C26.0907 18.3913 25.4266 18.0009 23.9988 18.0009C22.571 18.0009 21.907 18.3913 21.1161 18.8564L21.1057 18.8625C20.2012 19.3943 19.1647 20 17.1988 20C15.233 20 14.1965 19.3943 13.292 18.8625L13.2816 18.8564C12.4907 18.3913 11.8267 18.0009 10.3988 18.0009L10.3817 18.0008C9.35582 17.9831 8.36338 18.2788 7.56519 18.8255C7.10955 19.1376 6.48717 19.0212 6.17507 18.5656C5.86298 18.1099 5.97935 17.4875 6.435 17.1754C7.58628 16.3869 8.98539 15.9782 10.4073 16.0009C12.3677 16.0027 13.4025 16.6074 14.3057 17.1384L14.3161 17.1446C15.107 17.6096 15.771 18 17.1988 18C18.6267 18 19.2907 17.6096 20.0816 17.1445L20.092 17.1384C20.9965 16.6066 22.033 16.0009 23.9988 16.0009C25.9647 16.0009 27.0012 16.6066 27.9057 17.1384L27.9161 17.1445C28.707 17.6095 29.3711 18 30.7993 18C32.2274 18 32.8917 17.6096 33.6829 17.1445L33.6935 17.1383C34.597 16.6073 35.6322 16.0027 37.5929 16.0009C39.0147 15.978 40.4137 16.3864 41.565 17.1746C42.0207 17.4865 42.1372 18.1089 41.8253 18.5646C41.5133 19.0203 40.8909 19.1369 40.4352 18.8249ZM40.4352 24.8249C39.6369 24.2784 38.6445 23.983 37.6188 24.0008L37.6015 24.0009C36.1729 24.0009 35.5084 24.3915 34.7171 24.8565L34.7068 24.8626C33.802 25.3944 32.7653 26 30.7993 26C28.8332 26 27.7967 25.3943 26.8921 24.8625L26.8816 24.8563C26.0907 24.3913 25.4266 24.0009 23.9988 24.0009C22.571 24.0009 21.907 24.3913 21.1161 24.8564L21.1057 24.8625C20.2012 25.3943 19.1647 26 17.1988 26C15.233 26 14.1965 25.3943 13.292 24.8625L13.2816 24.8564C12.4907 24.3913 11.8267 24.0009 10.3988 24.0009L10.3817 24.0008C9.35582 23.9831 8.36338 24.2788 7.56519 24.8255C7.10955 25.1376 6.48717 25.0212 6.17507 24.5656C5.86298 24.1099 5.97935 23.4875 6.435 23.1754C7.58627 22.3869 8.98538 21.9782 10.4073 22.0009C12.3677 22.0027 13.4025 22.6074 14.3057 23.1384L14.3161 23.1446C15.107 23.6096 15.771 24 17.1988 24C18.6267 24 19.2907 23.6096 20.0816 23.1445L20.092 23.1384C20.9965 22.6066 22.033 22.0009 23.9988 22.0009C25.9647 22.0009 27.0012 22.6066 27.9057 23.1384L27.9161 23.1445C28.707 23.6095 29.3711 24 30.7993 24C32.2274 24 32.8917 23.6096 33.683 23.1445L33.6935 23.1383C34.597 22.6073 35.6322 22.0027 37.5929 22.0009C39.0147 21.978 40.4137 22.3864 41.565 23.1746C42.0207 23.4866 42.1372 24.1089 41.8253 24.5646C41.5133 25.0203 40.8909 25.1369 40.4352 24.8249ZM40.4352 30.8249C39.6369 30.2784 38.6445 29.983 37.6188 30.0008L37.6015 30.0009C36.1729 30.0009 35.5084 30.3915 34.7171 30.8565L34.7068 30.8626C33.802 31.3944 32.7653 32 30.7993 32C28.8332 32 27.7967 31.3943 26.8921 30.8625L26.8816 30.8563C26.0907 30.3913 25.4266 30.0009 23.9988 30.0009C22.571 30.0009 21.907 30.3913 21.1161 30.8564L21.1057 30.8625C20.2012 31.3943 19.1647 32 17.1988 32C15.233 32 14.1965 31.3943 13.292 30.8625L13.2816 30.8564C12.4907 30.3913 11.8267 30.0009 10.3988 30.0009L10.3817 30.0008C9.35582 29.9831 8.36338 30.2788 7.56519 30.8255C7.10955 31.1376 6.48717 31.0212 6.17507 30.5656C5.86298 30.1099 5.97935 29.4875 6.435 29.1754C7.58627 28.3869 8.98538 27.9782 10.4073 28.0009C12.3677 28.0027 13.4025 28.6074 14.3057 29.1384L14.3161 29.1445C15.107 29.6096 15.771 30 17.1988 30C18.6267 30 19.2907 29.6096 20.0816 29.1445L20.092 29.1384C20.9965 28.6066 22.033 28.0009 23.9988 28.0009C25.9647 28.0009 27.0012 28.6066 27.9057 29.1384L27.9161 29.1445C28.707 29.6095 29.3711 30 30.7993 30C32.2274 30 32.8917 29.6096 33.683 29.1445L33.6935 29.1383C34.597 28.6073 35.6322 28.0027 37.5929 28.0009C39.0147 27.978 40.4137 28.3864 41.565 29.1746C42.0207 29.4865 42.1372 30.1089 41.8253 30.5646C41.5133 31.0203 40.8909 31.1369 40.4352 30.8249Z' fill='white'/></svg>"],["k","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><rect width='48' height='48' rx='1' fill='%color%'/><path d='M21.8411 27.6234C23.3412 27.6234 24.5572 26.4124 24.5572 24.9185C24.5572 23.4247 23.3412 22.2136 21.8411 22.2136C20.341 22.2136 19.125 23.4247 19.125 24.9185C19.125 26.4124 20.341 27.6234 21.8411 27.6234Z' fill='white'/><path d='M21.8411 27.6234C23.3412 27.6234 24.5572 26.4124 24.5572 24.9185C24.5572 23.4247 23.3412 22.2136 21.8411 22.2136C20.341 22.2136 19.125 23.4247 19.125 24.9185C19.125 26.4124 20.341 27.6234 21.8411 27.6234Z' fill='white'/><path d='M21.8411 27.6234C23.3412 27.6234 24.5572 26.4124 24.5572 24.9185C24.5572 23.4247 23.3412 22.2136 21.8411 22.2136C20.341 22.2136 19.125 23.4247 19.125 24.9185C19.125 26.4124 20.341 27.6234 21.8411 27.6234Z' fill='white'/><path d='M21.8412 21.0342C22.4393 21.0342 23.0012 21.1791 23.5104 21.4206C22.0675 16.8843 17.5366 9.47394 14.9862 8.00073C13.5595 10.9793 17.0961 17.8785 19.4363 21.8875C20.0991 21.3602 20.9277 21.0342 21.8412 21.0342Z' fill='white'/><path d='M17.9974 25.4819C14.8407 29.165 11.005 36.2653 11.001 39.0829C14.2263 38.8334 18.3288 32.6467 20.673 28.6095C19.2705 28.1627 18.2156 26.9632 17.9974 25.4819Z' fill='white'/><path d='M25.5798 23.8759C25.6727 24.21 25.7415 24.5562 25.7415 24.9184C25.7415 26.0173 25.2767 27.0075 24.533 27.7159C29.2902 28.6337 37.5395 28.3962 40.0171 26.9793C38.1256 24.2301 30.2198 23.8518 25.5798 23.8759Z' fill='white'/><path d='M23.8823 28.2151C23.3124 28.5693 20.3255 31.4835 19.6626 32.4858L18.6279 39.9887H25.0463L23.8823 28.2151Z' fill='white'/></svg>"],["l","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><rect width='48' height='48' rx='1' fill='%color%'/><path d='M31.3098 9.54878C30.4999 8.81707 29.3429 8.81707 28.533 9.54878L15.5745 22.7195C14.996 23.3293 14.8803 24.1829 15.1117 24.9146C15.4588 25.6463 16.153 26.1341 16.9629 26.1341H25.2934L15.9216 35.6463C15.2274 36.378 15.1117 37.5976 15.8059 38.3293L15.9216 38.4512C16.7315 39.1829 17.8885 39.1829 18.6984 38.4512L31.4255 25.6463C32.004 25.0366 32.1197 24.1829 31.8883 23.4512C31.5412 22.7195 30.847 22.2317 30.1528 22.2317H21.7066L31.4255 12.3537C32.1197 11.622 32.1197 10.4024 31.3098 9.54878C31.4255 9.54878 31.4255 9.54878 31.3098 9.54878Z' fill='white'/></svg>"],["m","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><rect width='48' height='48' rx='1' fill='%color%'/><path d='M10.2456 12.1404C10.2456 11.4561 9.79649 11 9.12281 11C8.44912 11 8 11.4561 8 12.1404V27.193V36.3158C8 36.6579 8.33684 37 8.67368 37H39.3263C39.6632 37 40 36.6579 40 36.3158V23.0877V22.7456V12.1404C40 11.4561 39.5509 11 38.8772 11C38.2035 11 37.7544 11.4561 37.7544 12.1404V34.6053C37.7544 34.6053 34.386 34.6053 30.1193 34.6053L21.1368 25.2544C20.8 24.9123 20.3509 24.7982 20.014 24.7982C19.5649 24.7982 19.1158 25.0263 18.8912 25.2544L10.2456 34.2632V12.1404Z' fill='white'/><path d='M17 34C17 34.5523 16.5523 35 16 35C15.4477 35 15 34.5523 15 34C15 33.4477 15.4477 33 16 33C16.5523 33 17 33.4477 17 34Z' fill='%color%'/><path d='M26 33C26 33.5523 25.5523 34 25 34C24.4477 34 24 33.5523 24 33C24 32.4477 24.4477 32 25 32C25.5523 32 26 32.4477 26 33Z' fill='%color%'/><path d='M20 31.5C20 31.7761 19.7761 32 19.5 32C19.2239 32 19 31.7761 19 31.5C19 31.2239 19.2239 31 19.5 31C19.7761 31 20 31.2239 20 31.5Z' fill='%color%'/><path d='M21 28.5C21 28.7761 20.7761 29 20.5 29C20.2239 29 20 28.7761 20 28.5C20 28.2239 20.2239 28 20.5 28C20.7761 28 21 28.2239 21 28.5Z' fill='%color%'/><path d='M36.3953 32.8641L28.9884 25.3419C28.7604 25.114 28.4186 25 28.0767 25C27.7349 25 27.393 25.114 27.1651 25.3419C26.9372 25.5699 25 27.6214 25 27.6214L30.4697 33.32H36.1674C36.3953 33.32 36.5092 33.0921 36.3953 32.8641Z' fill='white'/><path d='M29 27.5C29 27.7761 28.7761 28 28.5 28C28.2239 28 28 27.7761 28 27.5C28 27.2239 28.2239 27 28.5 27C28.7761 27 29 27.2239 29 27.5Z' fill='%color%'/><path d='M32 31C32 31.5523 31.5523 32 31 32C30.4477 32 30 31.5523 30 31C30 30.4477 30.4477 30 31 30C31.5523 30 32 30.4477 32 31Z' fill='%color%'/></svg>"],["n","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><rect width='48' height='48' rx='1' fill='%color%'/><path d='M24.0604 14C23.4566 14 8 14 8 16.9586V24.0592C10.5358 25.0059 16.8151 25.716 24.0604 25.716C24.4226 25.716 24.6642 25.716 25.0264 25.716C27.8038 25.716 30.5811 25.5976 33.4792 25.3609C36.4981 25.1243 38.7925 24.5867 40.1208 24.1133C40.1208 24.1133 40.1208 24.0592 40.1208 23.8225V16.9586C40 14 24.5434 14 24.0604 14Z' fill='white'/><path d='M38.4302 16.9586C38.4302 15.8935 30.7019 14.9468 24.0604 14.9468C17.4189 14.9468 9.56982 15.8935 9.56982 16.9586C9.56982 18.0237 17.4189 18.9704 24.0604 18.9704C30.7019 18.9704 38.4302 18.0237 38.4302 16.9586Z' fill='%color%'/><path d='M40.1208 31.0414V25.4793C35.8943 26.6627 29.0113 27.2545 24.5434 27.2545C19.834 27.2545 12.5887 26.6627 8 25.4793V30.9231C8 33.8817 23.4566 34 24.0604 34C24.6642 34 40.1208 34 40.1208 31.0414Z' fill='white'/></svg>"],["o","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><rect width='48' height='48' rx='1' fill='%color%'/><path d='M40.1608 14.3518C40.1608 14.1106 40.1608 13.8693 40.1608 13.6281L41.7287 12.6633L41.2463 10.9749L39.4372 11.0955C39.3166 10.8543 39.196 10.6131 39.0754 10.3719L40.0402 8.80402L38.8342 7.59799L37.2664 8.56281C37.0252 8.44221 36.7839 8.32161 36.5427 8.201V6.27135L34.7337 5.90955L33.8895 7.59799C33.6483 7.59799 33.2865 7.59799 33.0453 7.59799L32.201 5.90955L30.5126 6.39196V8.32161C30.2714 8.44221 30.0302 8.56281 29.9096 8.68342L28.3417 7.71859L27.1357 8.92462L28.1005 10.4925C27.9799 10.7337 27.8593 10.9749 27.7387 11.2161H25.9297L25.5679 12.9045L27.2563 13.7487C27.2563 13.9899 27.2563 14.2312 27.2563 14.4724L25.4473 15.5578L25.9297 17.2462L27.8593 17.1256C27.9799 17.3668 28.1005 17.4874 28.2211 17.7286L27.2563 19.4171L28.4623 20.6231L30.1508 19.5377C30.392 19.6583 30.5126 19.7789 30.7538 19.8995V21.8291L32.4422 22.3116L33.4071 20.6231C33.6483 20.6231 33.8895 20.6231 34.1307 20.6231L35.0955 22.3116L36.7839 21.8291L36.6633 19.8995L37.2664 19.5377L38.9548 20.5025L40.1608 19.2965L39.196 17.608C39.3166 17.3668 39.4372 17.1256 39.5578 17.005H41.4875L41.8493 15.3166L40.1608 14.3518Z' fill='white'/><path d='M32.6834 17.8493C34.7337 18.4523 36.9045 17.1257 37.3869 15.0754C37.8693 12.9046 36.5427 10.8543 34.6131 10.3719C32.5628 9.76888 30.392 11.0955 29.9096 13.1458C29.3065 15.196 30.6332 17.2463 32.6834 17.8493Z' fill='%color%'/><path d='M28.2211 27.6181C28.1005 27.2563 28.1005 26.8945 27.9799 26.5327L30.0302 24.603L28.8241 22.4321L26.1709 23.1558C25.9297 22.9146 25.6885 22.5528 25.3266 22.3115L26.0503 19.6583L23.8794 18.4522L21.8292 20.3819C21.4673 20.2613 20.9849 20.1407 20.6231 20.0201L20.0201 17.3668H17.4874L16.7638 20.0201C16.402 20.1407 15.9196 20.2613 15.5578 20.3819L13.6282 18.4522L11.4573 19.6583L12.1809 22.3115C11.9397 22.5528 11.6985 22.794 11.4573 23.0352L8.80403 22.3115L7.598 24.4824L9.52765 26.5327C9.40705 26.8945 9.28644 27.2563 9.28644 27.6181L6.51257 28.2211V30.7538L9.28644 31.4774C9.40705 31.8392 9.52765 32.201 9.52765 32.5628L7.4774 34.4925L8.68343 36.6633L11.4573 35.8191C11.6985 36.0603 11.9397 36.3015 12.1809 36.5427L11.3367 39.3166L13.5075 40.5226L15.5578 38.4723C15.9196 38.593 16.2814 38.7136 16.5226 38.7136L17.2462 41.4874H19.7789L20.5025 38.7136C20.8643 38.5929 21.2261 38.593 21.5879 38.4723L23.6382 40.5226L25.8091 39.3166L24.9648 36.5427C25.206 36.3015 25.4472 36.0603 25.6885 35.8191L28.4623 36.6633L29.6684 34.4925L27.6181 32.5628C27.7387 32.201 27.8593 31.8392 27.8593 31.4774L30.6332 30.7538V28.2211L28.2211 27.6181Z' fill='white'/><path d='M13.0251 29.6683C13.0251 32.804 15.5578 35.3367 18.6935 35.3367C21.8292 35.3367 24.3618 32.6834 24.3618 29.6683C24.3618 26.5327 21.8292 24 18.6935 24C15.5578 24 13.0251 26.5327 13.0251 29.6683Z' fill='%color%'/></svg>"],["p","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M48 24C48 37.2548 37.2548 48 24 48C10.7452 48 0 37.2548 0 24C0 10.7452 10.7452 0 24 0C37.2548 0 48 10.7452 48 24Z' fill='#CFC9C9'/><path d='M21.4824 28.5684V27.3398C21.4824 26.2773 21.7093 25.3532 22.1631 24.5674C22.6169 23.7816 23.4469 22.946 24.6533 22.0605C25.8154 21.2305 26.5791 20.5553 26.9443 20.0352C27.3206 19.515 27.5088 18.9339 27.5088 18.292C27.5088 17.5726 27.2432 17.0247 26.7119 16.6484C26.1807 16.2721 25.4391 16.084 24.4873 16.084C22.8271 16.084 20.9346 16.6263 18.8096 17.7109L17 14.0752C19.4681 12.6917 22.0856 12 24.8525 12C27.1325 12 28.9421 12.5479 30.2812 13.6436C31.6315 14.7393 32.3066 16.2002 32.3066 18.0264C32.3066 19.2438 32.0299 20.2952 31.4766 21.1807C30.9232 22.0661 29.8717 23.0622 28.3223 24.1689C27.2598 24.9548 26.5846 25.5524 26.2969 25.9619C26.0202 26.3714 25.8818 26.9082 25.8818 27.5723V28.5684H21.4824ZM20.9512 34.2461C20.9512 33.3164 21.2002 32.6136 21.6982 32.1377C22.1963 31.6618 22.9212 31.4238 23.873 31.4238C24.7917 31.4238 25.5 31.6673 25.998 32.1543C26.5072 32.6413 26.7617 33.3385 26.7617 34.2461C26.7617 35.1204 26.5072 35.8122 25.998 36.3213C25.4889 36.8193 24.7806 37.0684 23.873 37.0684C22.9434 37.0684 22.224 36.8249 21.7148 36.3379C21.2057 35.8398 20.9512 35.1426 20.9512 34.2461Z' fill='black'/></svg>"],["q","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><g clip-path='url(#clip0_1513:954)'><path d='M45.12 42.25H44.1667V16.73C44.1667 16.51 43.9467 16.29 43.6167 16.29C43.6167 16.29 43.4935 16.29 43.3967 16.4L35.9167 23V16.73C35.9167 16.51 35.6967 16.29 35.3667 16.29C35.3667 16.29 35.2399 16.29 35.1467 16.4L26.75 23V16.73C26.75 16.51 26.53 16.29 26.2 16.29C26.2 16.29 26.1162 16.29 25.98 16.4L17.5833 23H16.08L14.21 2.1C14.1 1.44 13.77 1 13.33 1H7.94C7.5 1 7.17 1.44 7.06 2.1L3.98 34C3.76 36.75 3.54 39.4964 3.54 42.2464H2.88C2.44 42.2464 2 42.6864 2 43.1264V44.12C2 44.56 2.44 45 2.88 45H4.31H16.85H45.12C45.56 45 46 44.56 46 44.12V43.13C46 42.58 45.56 42.25 45.12 42.25ZM17.5833 27.5833H23.0833V31.25H17.5833V27.5833ZM17.5833 38.5833V34.9167H23.0833V38.5833H17.5833ZM26.75 27.5833H32.25V31.25H26.75V27.5833ZM26.75 38.5833V34.9167H32.25V38.5833H26.75ZM35.9167 27.5833H41.4167V31.25H35.9167V27.5833ZM35.9167 38.5833V34.9167H41.4167V38.5833H35.9167Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M44.1667 42.25H45.12C45.56 42.25 46 42.58 46 43.13V44.12C46 44.56 45.56 45 45.12 45H2.87999C2.43999 45 1.99999 44.56 1.99999 44.12V43.1264C1.99999 42.6864 2.43999 42.2464 2.87999 42.2464H3.53999C3.53999 39.5 3.75942 36.7571 3.97913 34.0107L3.97999 34L7.05999 2.09999C7.16999 1.43999 7.49999 0.999988 7.93999 0.999988H13.33C13.77 0.999988 14.1 1.43999 14.21 2.09999L16.08 23H17.5833L25.55 16.738L25.98 16.4C26.1162 16.29 26.2 16.29 26.2 16.29C26.53 16.29 26.75 16.51 26.75 16.73V23L34.7167 16.738L35.1467 16.4C35.2399 16.29 35.3667 16.29 35.3667 16.29C35.6967 16.29 35.9167 16.51 35.9167 16.73V23L43.3967 16.4C43.4935 16.29 43.6167 16.29 43.6167 16.29C43.9467 16.29 44.1667 16.51 44.1667 16.73V42.25ZM42.566 15.5326C42.7701 15.3294 42.9955 15.2191 43.1767 15.161C43.2768 15.1289 43.3667 15.1115 43.4393 15.102C43.476 15.0971 43.5094 15.0942 43.5388 15.0924C43.5536 15.0915 43.5675 15.0909 43.5805 15.0905L43.5992 15.0901L43.6081 15.09L43.6124 15.09L43.6145 15.09L43.6156 15.09C43.6161 15.09 43.6167 15.09 43.6167 16.29V15.09C44.4292 15.09 45.3667 15.6804 45.3667 16.73V41.0653C46.2913 41.1796 47.2 41.9281 47.2 43.13V44.12C47.2 44.7303 46.9069 45.2401 46.5735 45.5735C46.2401 45.9069 45.7303 46.2 45.12 46.2H2.87999C2.26971 46.2 1.75987 45.9069 1.42646 45.5735C1.09304 45.2401 0.799988 44.7303 0.799988 44.12V43.1264C0.799988 42.5161 1.09304 42.0063 1.42646 41.6729C1.65812 41.4412 1.97496 41.229 2.35149 41.1211C2.39972 38.7053 2.59197 36.3023 2.7811 33.9381L2.7846 33.8945L5.86952 1.9435L5.87632 1.90271C5.95357 1.43918 6.12174 0.956808 6.43266 0.561101C6.75735 0.14785 7.27232 -0.200012 7.93999 -0.200012H13.33C13.9977 -0.200012 14.5126 0.147851 14.8373 0.561102C15.1482 0.956809 15.3164 1.43918 15.3937 1.90271L15.4012 1.94766L17.1768 21.7932L25.2335 15.4604C25.3942 15.3319 25.562 15.2372 25.7325 15.1754C25.8183 15.1444 25.9016 15.1228 25.9812 15.1091C26.0208 15.1023 26.059 15.0975 26.0957 15.0944C26.114 15.0929 26.1318 15.0918 26.1492 15.091L26.175 15.0902L26.1876 15.0901L26.1938 15.09L26.1969 15.09L26.1984 15.09C26.1992 15.09 26.2 15.09 26.2 16.29V15.09C27.0125 15.09 27.95 15.6804 27.95 16.73V20.5304L34.3448 15.5039C34.5434 15.3156 34.7592 15.2137 34.9288 15.1599C35.0298 15.1279 35.1201 15.1108 35.192 15.1015C35.2285 15.0969 35.2615 15.094 35.2905 15.0923C35.305 15.0914 35.3187 15.0909 35.3313 15.0905L35.3497 15.0901L35.3583 15.09L35.3625 15.09L35.3646 15.09L35.3656 15.09C35.3661 15.09 35.3666 15.09 35.3667 16.29V15.09C36.1792 15.09 37.1167 15.6804 37.1167 16.73V20.3408L42.566 15.5326ZM21.8833 28.7833H18.7833V30.05H21.8833V28.7833ZM18.7833 36.1167V37.3833H21.8833V36.1167H18.7833ZM31.05 28.7833H27.95V30.05H31.05V28.7833ZM27.95 36.1167V37.3833H31.05V36.1167H27.95ZM40.2167 28.7833H37.1167V30.05H40.2167V28.7833ZM37.1167 36.1167V37.3833H40.2167V36.1167H37.1167ZM17.5833 27.5833V31.25H23.0833V27.5833H17.5833ZM17.5833 38.5833H23.0833V34.9167H17.5833V38.5833ZM26.75 27.5833V31.25H32.25V27.5833H26.75ZM26.75 38.5833H32.25V34.9167H26.75V38.5833ZM35.9167 27.5833V31.25H41.4167V27.5833H35.9167ZM35.9167 38.5833H41.4167V34.9167H35.9167V38.5833Z' fill='white'/><path d='M17.5833 27.5833H23.0833V31.25H17.5833V27.5833Z' fill='white'/><path d='M26.75 27.5833H32.25V31.25H26.75V27.5833Z' fill='white'/><path d='M35.9167 27.5833H41.4167V31.25H35.9167V27.5833Z' fill='white'/><path d='M17.5833 34.9167H23.0833V38.5834H17.5833V34.9167Z' fill='white'/><path d='M26.75 34.9167H32.25V38.5834H26.75V34.9167Z' fill='white'/><path d='M35.9167 34.9167H41.4167V38.5834H35.9167V34.9167Z' fill='white'/></g><defs><clipPath id='clip0_1513:954'><rect width='48' height='48' fill='white'/></clipPath></defs></svg>"],["r","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M0 0 48 0 48 48 0 48 0 0' fill='white' fill-opacity='0.01' /><path d='M45.4497 23.6006L25.2043 9.33437C24.5369 8.88854 23.647 8.88854 22.9795 9.33437L13.858 15.4615V12.678H9.23668V18.6923L8.45801 19.2496L2.6229 23.4892C1.84423 24.1579 1.83083 25.3839 2.38702 26.2755C3.05445 27.0557 4.069 27.3901 5.07014 26.7214L5.55283 26.2755V42.2308H4.62519H3.71091C3.26595 42.2308 2.821 42.6766 2.821 43.1224V43.9969C2.821 44.4427 3.26595 45 3.71091 45H7.07243H18.8637V41.9907V29.1734H29.6539V45H30.0988H41.5564H44.2333C44.6782 45 45.1232 44.5542 45.1232 44.1084V43.2339C45.1232 42.788 44.6782 42.2308 44.2333 42.2308H43.2249H42.3913V26.387L42.8363 26.7214C43.7262 27.2786 44.6937 27 45.4497 26.387C46.2469 25.7406 46.1171 24.1579 45.4497 23.6006Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M46.1811 22.648L46.2188 22.6795C46.9098 23.2565 47.1763 24.1802 47.1984 24.9248C47.2209 25.6836 47.0007 26.6743 46.2055 27.3191C45.534 27.8635 44.5966 28.2993 43.5913 28.2143V41.0308H44.2332C44.9419 41.0308 45.468 41.4473 45.7569 41.785C46.0547 42.1331 46.3232 42.6503 46.3232 43.2339V44.1083C46.3232 44.7207 46.0296 45.2332 45.6944 45.5691C45.3594 45.9047 44.8468 46.2 44.2332 46.2H28.4538V30.3734H20.0637V46.2H3.71091C3.00224 46.2 2.47613 45.7834 2.18724 45.4457C1.88945 45.0976 1.621 44.5804 1.621 43.9969V43.1224C1.621 42.51 1.91456 41.9975 2.24974 41.6617C2.58478 41.326 3.09733 41.0308 3.71091 41.0308H4.35283V28.2546C4.02007 28.2985 3.68506 28.2854 3.3557 28.2159C2.58345 28.053 1.94327 27.6028 1.47516 27.0556L1.41657 26.9871L1.36886 26.9106C0.60421 25.6848 0.476989 23.7503 1.84107 22.5788L1.87807 22.547L7.7596 18.2737L8.03667 18.0755V11.478H15.058V13.2099L22.313 8.33649C23.3839 7.62115 24.7999 7.62115 25.8708 8.33649L25.8833 8.34481L46.1811 22.648ZM13.858 15.4615V12.678H9.23668V18.6923L8.458 19.2496L2.62289 23.4892C1.84422 24.1579 1.83082 25.3839 2.38702 26.2755C2.89445 26.8687 3.60254 27.2042 4.35283 27.037C4.58939 26.9843 4.83015 26.8817 5.07014 26.7214L5.55283 26.2755V42.2308H3.71091C3.26595 42.2308 2.821 42.6766 2.821 43.1224V43.9969C2.821 44.4427 3.26595 45 3.71091 45H18.8637V29.1734H29.6539V45H44.2332C44.6782 45 45.1232 44.5542 45.1232 44.1083V43.2339C45.1232 42.788 44.6782 42.2308 44.2332 42.2308H42.3913V26.387L42.8363 26.7214C43.084 26.8765 43.3378 26.9669 43.5913 27.0032C44.2485 27.0976 44.9042 26.8293 45.4497 26.387C46.2469 25.7406 46.1171 24.1579 45.4497 23.6006L25.2043 9.33435C24.5369 8.88853 23.647 8.88853 22.9795 9.33435L13.858 15.4615Z' fill='white'/></svg>"],["s","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M0 0 48 0 48 48 0 48 0 0' fill='white' fill-opacity='0.01' /><g clip-path='url(#clip0_1521:27)'><path d='M45.4 43.0625V43.6625H46H46.9091H46.9098H46.9105H46.9112H46.9119H46.9126H46.9133H46.914H46.9147H46.9154H46.9161H46.9167H46.9174H46.9181H46.9188H46.9194H46.9201H46.9208H46.9214H46.9221H46.9228H46.9234H46.9241H46.9247H46.9254H46.926H46.9267H46.9273H46.9279H46.9286H46.9292H46.9298H46.9305H46.9311H46.9317H46.9323H46.9329H46.9336H46.9342H46.9348H46.9354H46.936H46.9366H46.9372H46.9378H46.9384H46.939H46.9396H46.9402H46.9408H46.9414H46.9419H46.9425H46.9431H46.9437H46.9443H46.9448H46.9454H46.946H46.9465H46.9471H46.9477H46.9482H46.9488H46.9493H46.9499H46.9504H46.951H46.9515H46.9521H46.9526H46.9532H46.9537H46.9543H46.9548H46.9553H46.9558H46.9564H46.9569H46.9574H46.958H46.9585H46.959H46.9595H46.96H46.9605H46.9611H46.9616H46.9621H46.9626H46.9631H46.9636H46.9641H46.9646H46.9651H46.9656H46.9661H46.9666H46.9671H46.9676H46.968H46.9685H46.969H46.9695H46.97H46.9705H46.9709H46.9714H46.9719H46.9724H46.9728H46.9733H46.9738H46.9742H46.9747H46.9752H46.9756H46.9761H46.9766H46.977H46.9775H46.9779H46.9784H46.9788H46.9793H46.9797H46.9802H46.9806H46.9811H46.9815H46.9819H46.9824H46.9828H46.9833H46.9837H46.9841H46.9846H46.985H46.9854H46.9859H46.9863H46.9867H46.9871H46.9876H46.988H46.9884H46.9888H46.9893H46.9897H46.9901H46.9905H46.9909H46.9913H46.9918H46.9922H46.9926H46.993H46.9934H46.9938H46.9942H46.9946H46.995H46.9954H46.9958H46.9962H46.9966H46.997H46.9974H46.9978H46.9982H46.9986H46.999H46.9994H46.9998H47.0002H47.0006H47.001H47.0014H47.0018H47.0021H47.0025H47.0029H47.0033H47.0037H47.0041H47.0044H47.0048H47.0052H47.0056H47.006H47.0063H47.0067H47.0071H47.0075H47.0079H47.0082H47.0086H47.009H47.0094H47.0097H47.0101H47.0105H47.0108H47.0112H47.0116H47.012H47.0123H47.0127H47.0131H47.0134H47.0138H47.0142H47.0145H47.0149H47.0153H47.0156H47.016H47.0163H47.0167H47.0171H47.0174H47.0178H47.0182H47.0185H47.0189H47.0192H47.0196H47.02H47.0203H47.0207H47.021H47.0214H47.0218H47.0221H47.0225H47.0228H47.0232H47.0235H47.0239H47.0243H47.0246H47.025H47.0253H47.0257H47.026H47.0264H47.0268H47.0271H47.0275H47.0278H47.0282H47.0285H47.0289H47.0292H47.0296H47.0299H47.0303H47.0307H47.031H47.0314H47.0317H47.0321H47.0324H47.0328H47.0331H47.0335H47.0339H47.0342H47.0346H47.0349H47.0353H47.0356H47.036H47.0364H47.0367H47.0371H47.0374H47.0378H47.0381H47.0385H47.0389H47.0392H47.0396H47.0399H47.0403H47.0406H47.041H47.0414H47.0417H47.0421H47.0424H47.0428H47.0432H47.0435H47.0439H47.0443H47.0446H47.045H47.0454H47.0457H47.0461H47.0465H47.0468H47.0472H47.0476H47.0479H47.0483H47.0487H47.049H47.0494H47.0498H47.0501H47.0505H47.0509H47.0513H47.0516H47.052H47.0524H47.0528H47.0531H47.0535H47.0539H47.0543H47.0546H47.055H47.0554H47.0558H47.0562H47.0565H47.0569H47.0573H47.0577H47.0581H47.0585H47.0589H47.0592H47.0596H47.06H47.0604H47.0608H47.0612H47.0616H47.062H47.0624H47.0628H47.0632H47.0636H47.064H47.0644H47.0648H47.0652H47.0656H47.066H47.0664H47.0668H47.0672H47.0676H47.068H47.0684H47.0689H47.0693H47.0697H47.0701H47.0705H47.0709H47.0714H47.0718H47.0722H47.0726H47.073H47.0735H47.0739H47.0743H47.0747H47.0752H47.0756H47.076H47.0765H47.0769H47.0773H47.0778H47.0782H47.0787H47.0791H47.0795H47.08H47.0804H47.0809H47.0813H47.0818H47.0822H47.0827H47.0831H47.0836H47.0841H47.0845H47.085H47.0854H47.0859H47.0864H47.0868H47.0873H47.0878H47.0882H47.0887H47.0892H47.0897H47.0901H47.0906H47.0911H47.0916H47.0921H47.0926H47.093H47.0935H47.094H47.0945H47.095H47.0955H47.096H47.0965H47.097H47.0975H47.098H47.0985H47.099H47.0996H47.1001H47.1006H47.1011H47.1016H47.1021H47.1027H47.1032H47.1037H47.1042H47.1048H47.1053H47.1058H47.1064H47.1069H47.1074H47.108H47.1085H47.1091H47.1096H47.1102H47.1107H47.1113H47.1118H47.1124H47.1129H47.1135H47.1141H47.1146H47.1152H47.1158H47.1164H47.1169H47.1175H47.1181H47.1187H47.1193H47.1198H47.1204H47.121H47.1216H47.1222H47.1228H47.1234H47.124H47.1246H47.1252H47.1258H47.1264H47.127H47.1277H47.1283H47.1289H47.1295H47.1302H47.1308H47.1314H47.132H47.1327H47.1333H47.134H47.1346H47.1353H47.1359H47.1365H47.1372H47.1379H47.1385H47.1392H47.1398H47.1405H47.1412H47.1418H47.1425H47.1432H47.1439H47.1446H47.1452H47.1459H47.1466H47.1473H47.148H47.1487H47.1494H47.1501H47.1508H47.1515C47.1977 43.6625 47.2788 43.6903 47.3447 43.7684C47.4028 43.8371 47.4337 43.9271 47.4116 44.0375L47.4 44.0957V44.155V45.0289C47.4 45.1612 47.3516 45.2446 47.2912 45.3001C47.2231 45.3626 47.1266 45.4 47.0303 45.4H24.6V36V35.4H24H13H12.4V36V45.4H2C1.86876 45.4 1.78583 45.3519 1.73046 45.2914C1.66795 45.2231 1.6303 45.1261 1.6303 45.0289V44.0336C1.6303 43.9013 1.67871 43.8179 1.73909 43.7624C1.8072 43.6999 1.9037 43.6625 2 43.6625H2.60606H4H4.6V43.0625V30.8266V30.2266H4H0.937991L5.47372 20.4053L18.5 11.7211L31.5038 20.3903L35.142 30.348H32H31.4V30.948V43.0625V43.6625H32H34H34.6V43.0625V33.6H39H39.8693L39.561 32.7872L34.061 18.2872L33.9928 18.1074L33.8328 18.0008L29.6 15.1789V8.24853L33.2485 4.6H41.7512L45.4 8.25406V43.0625ZM22 27.6H22.6V27V20V19.4H22H15H14.4V20V27V27.6H15H22Z' fill='%color%' stroke='white' stroke-width='1.2'/><path d='M15 20H22V27H15V20Z' fill='white'/></g><defs><clipPath id='clip0_1521:27'><rect width='48' height='48' fill='white'/></clipPath></defs></svg>"],["t","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M0 0 48 0 48 48 0 48 0 0' fill='white' fill-opacity='0.01' /><path d='M2.66666 16.7424H13.9167C14.25 16.7424 14.5833 16.6307 14.8055 16.2955L24 6.66667L33.1944 16.2955C33.4167 16.5189 33.75 16.7424 34.0833 16.7424H45.1944C45.4167 16.7424 45.6389 16.6307 45.75 16.4072C45.8611 16.1838 45.8611 15.9603 45.75 15.7368L40.5833 9.05863C40.3611 8.72345 39.9167 8.5 39.5833 8.5H30.4167L25.1111 3.44691C24.7778 3.11173 24.4444 3 24 3H23.8889C23.4444 3 23 3.11173 22.6667 3.44691L17.5833 8.5H8.41666C7.97221 8.5 7.63888 8.72345 7.41666 9.05863L2.22222 15.7368C2.11111 15.9603 2.11111 16.1838 2.22222 16.4072C2.22222 16.5189 2.44444 16.7424 2.66666 16.7424Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M33.1944 16.2955L24 6.66666L14.8055 16.2955C14.5833 16.6306 14.25 16.7424 13.9166 16.7424H2.66665C2.44443 16.7424 2.22221 16.5189 2.22221 16.4072C2.1111 16.1837 2.1111 15.9603 2.22221 15.7368L7.41665 9.05862C7.63887 8.72344 7.9722 8.49999 8.41665 8.49999H17.5833L22.6667 3.44689C23 3.11171 23.4444 2.99999 23.8889 2.99999H24C24.4444 2.99999 24.7778 3.11171 25.1111 3.44689L30.4167 8.49999H39.5833C39.9167 8.49999 40.3611 8.72344 40.5833 9.05862L45.75 15.7368C45.8611 15.9603 45.8611 16.1837 45.75 16.4072C45.6389 16.6306 45.4167 16.7424 45.1944 16.7424H34.0833C33.75 16.7424 33.4166 16.5189 33.1944 16.2955ZM41.554 8.35227L46.7717 15.0963L46.8245 15.2025C47.1029 15.7625 47.1029 16.3815 46.8245 16.9415C46.4835 17.6271 45.8081 17.9424 45.1944 17.9424H34.0833C33.2686 17.9424 32.6428 17.4426 32.3436 17.1416L32.335 17.133L24 8.40426L15.734 17.0607C15.2299 17.7401 14.501 17.9424 13.9166 17.9424H2.66665C2.17692 17.9424 1.80168 17.7135 1.59037 17.5365C1.47354 17.4386 1.35719 17.316 1.26025 17.1698C1.21408 17.1002 1.13392 16.9686 1.0795 16.7894C0.871501 16.2709 0.894238 15.7123 1.14771 15.2025L1.20122 15.0949L6.44569 8.35241C6.85411 7.76165 7.52524 7.29999 8.41665 7.29999H17.0884L21.8158 2.60071C21.8167 2.59981 21.8176 2.5989 21.8185 2.59799C22.4556 1.95922 23.2587 1.79999 23.8889 1.79999H24C24.323 1.79999 24.6733 1.84058 25.0301 1.97853C25.3862 2.11626 25.6868 2.32702 25.9492 2.58793L30.8967 7.29999H39.5833C39.9948 7.29999 40.385 7.42981 40.6963 7.59836C41.0006 7.76312 41.3165 8.01174 41.554 8.35227Z' fill='white'/><path fill-rule='evenodd' clip-rule='evenodd' d='M44.1667 42.4167H45.1111C45.5556 42.4167 46 42.8636 46 43.3105V44.2729C46 44.7198 45.5556 45.1667 45.1111 45.1667H2.88889C2.44444 45.1667 2 44.7198 2 44.2729V43.3105C2 42.8636 2.44444 42.4167 2.88889 42.4167H3.83333V20.4167H14.2222C15.1111 20.4167 15.8889 20.0815 16.4444 19.5229L24 11.6487L31.5556 19.4111C32.1111 20.0815 32.8889 20.4167 33.7778 20.4167H44.1667V42.4167ZM37.75 39.6667H40.5V36.9167H37.75V39.6667ZM37.75 33.25H40.5V30.5H37.75V33.25ZM37.75 26.8334H40.5V24.0834H37.75V26.8334ZM33.1667 24.0834H30.4167V26.8334H33.1667V24.0834ZM30.4167 30.5H33.1667V33.25H30.4167V30.5ZM33.1667 36.9167H30.4167V39.6667H33.1667V36.9167ZM7.5 24.0834H10.25V26.8334H7.5V24.0834ZM10.25 30.5H7.5V33.25H10.25V30.5ZM7.5 36.9167H10.25V39.6667H7.5V36.9167ZM17.5833 24.0834H14.8333V26.8334H17.5833V24.0834ZM14.8333 30.5H17.5833V33.25H14.8333V30.5ZM17.5833 36.9167H14.8333V39.6667H17.5833V36.9167Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M31.5555 19.4111C32.1111 20.0815 32.8889 20.4167 33.7778 20.4167H44.1667V42.4167H45.1111C45.5555 42.4167 46 42.8636 46 43.3105V44.2729C46 44.7198 45.5555 45.1667 45.1111 45.1667H2.88888C2.44443 45.1667 1.99999 44.7198 1.99999 44.2729V43.3105C1.99999 42.8636 2.44443 42.4167 2.88888 42.4167H3.83332V20.4167H14.2222C15.1111 20.4167 15.8889 20.0815 16.4444 19.5229L24 11.6487L31.5555 19.4111ZM15.587 18.6833L23.9938 9.92188L32.4489 18.6085L32.4795 18.6454C32.786 19.0152 33.2117 19.2167 33.7778 19.2167H45.3667V41.2339C45.868 41.3018 46.2862 41.5613 46.5731 41.8498C46.9079 42.1865 47.2 42.6991 47.2 43.3105V44.2729C47.2 44.8843 46.9079 45.3969 46.5731 45.7335C46.2387 46.0698 45.726 46.3667 45.1111 46.3667H2.88888C2.27403 46.3667 1.7613 46.0698 1.4269 45.7335C1.09208 45.3969 0.799988 44.8843 0.799988 44.2729V43.3105C0.799988 42.6991 1.09208 42.1865 1.4269 41.8498C1.71381 41.5613 2.132 41.3018 2.63332 41.2339V19.2167H14.2222C14.797 19.2167 15.2633 19.0053 15.587 18.6833ZM38.95 38.4667H39.3V38.1167H38.95V38.4667ZM38.95 32.05H39.3V31.7H38.95V32.05ZM38.95 25.6333H39.3V25.2833H38.95V25.6333ZM31.9667 25.2833H31.6167V25.6333H31.9667V25.2833ZM30.4167 30.5H33.1667V33.25H30.4167V30.5ZM31.6167 32.05H31.9667V31.7H31.6167V32.05ZM31.9667 38.1167H31.6167V38.4667H31.9667V38.1167ZM7.49999 24.0833H10.25V26.8333H7.49999V24.0833ZM8.69999 25.6333H9.04999V25.2833H8.69999V25.6333ZM9.04999 31.7H8.69999V32.05H9.04999V31.7ZM7.49999 36.9167H10.25V39.6667H7.49999V36.9167ZM8.69999 38.4667H9.04999V38.1167H8.69999V38.4667ZM16.3833 25.2833H16.0333V25.6333H16.3833V25.2833ZM14.8333 30.5H17.5833V33.25H14.8333V30.5ZM16.0333 32.05H16.3833V31.7H16.0333V32.05ZM16.3833 38.1167H16.0333V38.4667H16.3833V38.1167ZM37.75 39.6667V36.9167H40.5V39.6667H37.75ZM37.75 33.25V30.5H40.5V33.25H37.75ZM37.75 26.8333V24.0833H40.5V26.8333H37.75ZM33.1667 24.0833V26.8333H30.4167V24.0833H33.1667ZM33.1667 36.9167V39.6667H30.4167V36.9167H33.1667ZM10.25 30.5V33.25H7.49999V30.5H10.25ZM17.5833 24.0833V26.8333H14.8333V24.0833H17.5833ZM17.5833 36.9167V39.6667H14.8333V36.9167H17.5833Z' fill='white'/><path d='M21.4444 18.5757C21.4444 20.0281 22.5555 21.1454 24 21.1454C25.4444 21.1454 26.5555 20.0281 26.5555 18.5757C26.5555 17.1232 25.4444 16.006 24 16.006C22.5555 16.006 21.4444 17.1232 21.4444 18.5757Z' fill='white'/><path d='M7.5 24.0833H10.25V26.8333H7.5V24.0833Z' fill='white'/><path d='M14.8333 24.0833H17.5833V26.8333H14.8333V24.0833Z' fill='white'/><path d='M7.5 30.5H10.25V33.25H7.5V30.5Z' fill='white'/><path d='M14.8333 30.5H17.5833V33.25H14.8333V30.5Z' fill='white'/><path d='M7.5 36.9166H10.25V39.6666H7.5V36.9166Z' fill='white'/><path d='M14.8333 36.9166H17.5833V39.6666H14.8333V36.9166Z' fill='white'/><path d='M30.4167 24.0833H33.1667V26.8333H30.4167V24.0833Z' fill='white'/><path d='M37.75 24.0833H40.5V26.8333H37.75V24.0833Z' fill='white'/><path d='M30.4167 30.5H33.1667V33.25H30.4167V30.5Z' fill='white'/><path d='M37.75 30.5H40.5V33.25H37.75V30.5Z' fill='white'/><path d='M30.4167 36.9166H33.1667V39.6666H30.4167V36.9166Z' fill='white'/><path d='M37.75 36.9166H40.5V39.6666H37.75V36.9166Z' fill='white'/></svg>"],["u","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M10.25 4.75H37.75C38.2083 4.75 38.6667 4.29167 38.6667 3.83333V2.91667C38.6667 2.45833 38.2083 2 37.75 2H10.25C9.79168 2 9.33334 2.45833 9.33334 2.91667V3.83333C9.33334 4.29167 9.79168 4.75 10.25 4.75Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M37.75 5.94999H10.25C9.63055 5.94999 9.11155 5.65235 8.77126 5.31206C8.43097 4.97177 8.13333 4.45277 8.13333 3.83332V2.91665C8.13333 2.29721 8.43097 1.77821 8.77126 1.43792C9.11155 1.09763 9.63055 0.799988 10.25 0.799988H37.75C38.3694 0.799988 38.8884 1.09763 39.2287 1.43792C39.569 1.77821 39.8667 2.29721 39.8667 2.91665V3.83332C39.8667 4.45277 39.569 4.97177 39.2287 5.31206C38.8884 5.65235 38.3694 5.94999 37.75 5.94999ZM37.75 4.74999H10.25C9.79166 4.74999 9.33333 4.29165 9.33333 3.83332V2.91665C9.33333 2.45832 9.79166 1.99999 10.25 1.99999H37.75C38.2083 1.99999 38.6667 2.45832 38.6667 2.91665V3.83332C38.6667 4.29165 38.2083 4.74999 37.75 4.74999Z' fill='white'/><path d='M46 43.3333C46 42.875 45.5417 42.4166 45.0833 42.4166H43.25V8.49998C43.25 8.04165 42.7917 7.58331 42.3333 7.58331H5.66666C5.20832 7.58331 4.74999 8.04165 4.74999 8.49998V42.4166H2.91666C2.45832 42.4166 2 42.875 2 43.3333V44.25C2 44.7083 2.45832 45.1666 2.86938 45.1666H45.0833C45.5417 45.1666 46 44.7083 46 44.25L46 43.3333Z' fill='%color%'/><path fill-rule='evenodd' clip-rule='evenodd' d='M46.5621 41.8546C46.9023 42.1949 47.2 42.7138 47.2 43.3333L47.2 44.25C47.2 44.8694 46.9023 45.3884 46.5621 45.7287C46.2218 46.069 45.7028 46.3666 45.0833 46.3666H2.86937C2.2412 46.3666 1.73164 46.0393 1.41729 45.7137C1.09491 45.3799 0.799988 44.8665 0.799988 44.25V43.3333C0.799988 42.7139 1.09762 42.1949 1.4379 41.8546C1.77819 41.5143 2.29719 41.2166 2.91664 41.2166H3.54998V8.49997C3.54998 7.88052 3.84762 7.36152 4.18791 7.02123C4.5282 6.68094 5.0472 6.3833 5.66664 6.3833H42.3333C42.9528 6.3833 43.4718 6.68094 43.812 7.02123C44.1523 7.36151 44.45 7.88052 44.45 8.49997V41.2166H45.0833C45.7028 41.2166 46.2218 41.5143 46.5621 41.8546ZM45.0833 42.4166C45.5416 42.4166 46 42.875 46 43.3333L46 44.25C46 44.7083 45.5416 45.1666 45.0833 45.1666H2.86937C2.45831 45.1666 1.99999 44.7083 1.99999 44.25V43.3333C1.99999 42.875 2.45831 42.4166 2.91664 42.4166H4.74998V8.49997C4.74998 8.04163 5.20831 7.5833 5.66664 7.5833H42.3333C42.7916 7.5833 43.25 8.04163 43.25 8.49997V42.4166H45.0833Z' fill='white'/><path d='M16.6667 19.9583C16.6667 19.7052 16.8719 19.5 17.125 19.5H21.7083C21.9615 19.5 22.1667 19.7052 22.1667 19.9583V24.5417C22.1667 24.7948 21.9615 25 21.7083 25H17.125C16.8719 25 16.6667 24.7948 16.6667 24.5417V19.9583Z' fill='white'/><path d='M16.6667 10.7916C16.6667 10.5385 16.8719 10.3333 17.125 10.3333H21.7083C21.9615 10.3333 22.1667 10.5385 22.1667 10.7916V15.375C22.1667 15.6281 21.9615 15.8333 21.7083 15.8333H17.125C16.8719 15.8333 16.6667 15.6281 16.6667 15.375V10.7916Z' fill='white'/><path d='M25.8333 19.9583C25.8333 19.7052 26.0385 19.5 26.2916 19.5H30.875C31.1281 19.5 31.3333 19.7052 31.3333 19.9583V24.5417C31.3333 24.7948 31.1281 25 30.875 25H26.2916C26.0385 25 25.8333 24.7948 25.8333 24.5417V19.9583Z' fill='white'/><path d='M35 19.9583C35 19.7052 35.2052 19.5 35.4583 19.5H40.0417C40.2948 19.5 40.5 19.7052 40.5 19.9583V24.5417C40.5 24.7948 40.2948 25 40.0417 25H35.4583C35.2052 25 35 24.7948 35 24.5417V19.9583Z' fill='white'/><path d='M25.8333 10.7916C25.8333 10.5385 26.0385 10.3333 26.2916 10.3333H30.875C31.1281 10.3333 31.3333 10.5385 31.3333 10.7916V15.375C31.3333 15.6281 31.1281 15.8333 30.875 15.8333H26.2916C26.0385 15.8333 25.8333 15.6281 25.8333 15.375V10.7916Z' fill='white'/><path d='M35 10.7916C35 10.5385 35.2052 10.3333 35.4583 10.3333H40.0417C40.2948 10.3333 40.5 10.5385 40.5 10.7916V15.375C40.5 15.6281 40.2948 15.8333 40.0417 15.8333H35.4583C35.2052 15.8333 35 15.6281 35 15.375V10.7916Z' fill='white'/><path d='M7.5 38.2916C7.5 38.0385 7.7052 37.8333 7.95833 37.8333H40.0417C40.2948 37.8333 40.5 38.0385 40.5 38.2916V41.9583C40.5 42.2114 40.2948 42.4166 40.0417 42.4166H7.95833C7.7052 42.4166 7.5 42.2114 7.5 41.9583V38.2916Z' fill='white'/><path d='M7.5 19.9583C7.5 19.7052 7.7052 19.5 7.95833 19.5H12.5417C12.7948 19.5 13 19.7052 13 19.9583V24.5417C13 24.7948 12.7948 25 12.5417 25H7.95833C7.7052 25 7.5 24.7948 7.5 24.5417V19.9583Z' fill='white'/><path d='M16.6667 29.125C16.6667 28.8718 16.8719 28.6666 17.125 28.6666H21.7083C21.9615 28.6666 22.1667 28.8718 22.1667 29.125V33.7083C22.1667 33.9614 21.9615 34.1666 21.7083 34.1666H17.125C16.8719 34.1666 16.6667 33.9614 16.6667 33.7083V29.125Z' fill='white'/><path d='M25.8333 29.125C25.8333 28.8718 26.0385 28.6666 26.2916 28.6666H30.875C31.1281 28.6666 31.3333 28.8718 31.3333 29.125V33.7083C31.3333 33.9614 31.1281 34.1666 30.875 34.1666H26.2916C26.0385 34.1666 25.8333 33.9614 25.8333 33.7083V29.125Z' fill='white'/><path d='M35 29.125C35 28.8718 35.2052 28.6666 35.4583 28.6666H40.0417C40.2948 28.6666 40.5 28.8718 40.5 29.125V33.7083C40.5 33.9614 40.2948 34.1666 40.0417 34.1666H35.4583C35.2052 34.1666 35 33.9614 35 33.7083V29.125Z' fill='white'/><path d='M7.5 29.125C7.5 28.8718 7.7052 28.6666 7.95833 28.6666H12.5417C12.7948 28.6666 13 28.8718 13 29.125V33.7083C13 33.9614 12.7948 34.1666 12.5417 34.1666H7.95833C7.7052 34.1666 7.5 33.9614 7.5 33.7083V29.125Z' fill='white'/><path d='M7.5 10.7916C7.5 10.5385 7.7052 10.3333 7.95833 10.3333H12.5417C12.7948 10.3333 13 10.5385 13 10.7916V15.375C13 15.6281 12.7948 15.8333 12.5417 15.8333H7.95833C7.7052 15.8333 7.5 15.6281 7.5 15.375V10.7916Z' fill='white'/></svg>"],["x","<svg width='48' height='48' viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'><rect width='48' height='48' rx='1' fill='%color%'/><path d='M20.8217 29.9381C20.8217 29.6082 20.8217 29.2783 20.8217 29.2783C20.8217 29.1134 20.8217 28.7835 20.8217 28.6186C20.8217 27.4639 20.9767 26.3093 21.4419 25.3196C21.5969 24.4948 22.062 23.6701 22.6822 22.8454C23.3023 22.1856 23.9225 21.6907 24.6977 21.1959C25.6279 20.3711 26.5581 19.5464 26.5581 19.5464C27.1783 19.0515 27.6434 18.5567 27.9535 18.0619C28.4186 17.567 28.5736 16.9072 28.5736 16.0825C28.5736 15.0928 28.1085 14.268 27.3333 13.6082C26.2481 12.7835 23.7674 12.7835 23.7674 12.7835C22.9922 12.7835 22.2171 12.9485 21.4419 13.1134C20.6667 13.4433 20.0465 13.7732 19.4264 14.1031C18.8062 14.433 18.3411 14.7629 17.876 15.2577C17.1008 15.7526 16.6357 16.2474 16.6357 16.2474L14 12.6186C14.6202 11.7938 15.3953 11.134 16.1705 10.6392C17.1008 9.97938 17.876 9.48454 18.8062 9.15464C19.7364 8.82474 20.6667 8.49485 21.7519 8.3299C22.6822 8.16495 23.6124 8 24.5426 8C29.0388 8 31.5194 9.97938 31.5194 9.97938C33.0698 11.134 34 13.2784 34 15.2577C34 16.5773 33.845 17.732 33.3798 18.8866C33.0698 19.8763 32.4496 20.701 31.8295 21.3608C31.2093 22.0206 30.4341 22.6804 29.6589 23.1753C28.8837 23.6701 28.2636 24.1649 27.6434 24.8247C27.0233 25.4845 26.4031 26.1443 26.093 26.8041C25.6279 27.7938 25.4729 28.7835 25.4729 29.7732L20.8217 29.9381Z' fill='white'/><path d='M23.3023 39.835C25.0148 39.835 26.4031 38.358 26.4031 36.536C26.4031 34.7141 25.0148 33.2371 23.3023 33.2371C21.5898 33.2371 20.2015 34.7141 20.2015 36.536C20.2015 38.358 21.5898 39.835 23.3023 39.835Z' fill='white'/></svg>"]]);class hc{constructor(){this.iconMap={erhverv:"u",spoergsmaal:"p",ukendt:"p",advarsel:"b","ukendt-bygning":"c",smaabygning:"d",udehus:"d",drivhus:"d",fritidsformaal:"e","carport-garage":"f",carport:"f",olietank:"g",silo:"h",affaldsbeholder:"h","halmfyr-biogas-mv":"i","halmfyr-biogas":"i",vandanlaeg:"j",vindmoelle:"k",energi:"l",energi_anlaeg:"l",biogas:"i","ensilage-planlager":"m",ensilage_planlager:"m",tank:"n",overdaekket_areal:"d",fritliggende_udestue:"d","andet-anlaeg":"o",andet_anlaeg:"o","ukendt-TEK":"x",industri:"q",helaarsbeboelse:"r",landbrug:"s",institution:"t",idraetsformaal:"a",u:"u",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",x:"x"},this.colorMap={sikker:"#008100",usikker:"#db0101",standard:"#3098d8",flyttet:"#133f88",signatur:"#7e7e7e"},this.imageStyleCache=new Map}getIcon(t){return this.iconMap[t.icon]||"a"}getIconColor(t){return this.colorMap[t.color]||t.color||"#000"}getFontFamily(){return"bbr"}createBackgroundStyle(t,e,i,n){return null}createIcon(t,e,i,n){let r=this.createIconStyleImage(t,e);return[new Ro({image:r,zIndex:n}),new Ro({image:e?new Co({radius:32,stroke:new Eo({color:i?"rgb(212, 235, 58)":"rgba(212, 235, 58, 0.45)",width:4})}):null,zIndex:n+1})]}getIconSvg(t,e=!0,i=null){let n=i?this.colorMap[i]:this.getIconColor(t),r=this.getIcon(t),s=lc.get(r);return void 0!==s&&null!=s&&0!=s.length||(console.log("No marker data for "+t.icon),s=lc.get("p")),s=s.replace(/%color%/gi,n),e?window.btoa(s):s}getImage(t,e=null,i=null){const n=this.getIconSvg(t,!0,i),r=e||t.title;let s=document.createElement("img");return s.title=r,s.alt=r,s.src="data:image/svg+xml;base64,"+n,s}createIconStyleImage(t,e){let i=this.getIconColor(t),n=this.getIcon(t)+"-"+i,r=this.imageStyleCache.get(n);if(null==r){let i=this.getIconSvg(t);r=new Oo({src:"data:image/svg+xml;base64,"+i,scale:e?.58:.54}),this.imageStyleCache.set(n,r)}return r}}class uc extends hc{static get Instance(){return this._instance||(this._instance=new uc)}}class cc extends hc{constructor(){super(...arguments),this.retbbrIconMap={erhverv:"u",spoergsmaal:"p",advarsel:"b","ukendt-bygning":"c",smaabygning:"d",fritidsformaal:"e","carport-garage":"f",olietank:"g",silo:"h","halmfyr-biogas-mv":"i",vandanlaeg:"j",vindmoelle:"k",energi:"l","ensilage-planlager":"m",tank:"n","andet-anlaeg":"o",industri:"q",helaarsbeboelse:"r",landbrug:"s",institution:"t",idraetsformaal:"a",ukendt:"p"},this.isTekniskeAnlaeg=["tank","vindmoelle","olietank","olietank","energi","halmfyr-biogas-mv","vandanlaeg","andet-anlaeg","ensilage-planlager"]}static get Instance(){return this._instance||(this._instance=new cc)}getIcon(t){return this.retbbrIconMap[t.icon]||"p"}getFontFamily(){return"retbbr"}createBackgroundStyle(t,e,i,n){return this.isTekniskeAnlaeg.indexOf(t.icon)>-1?new Ro({image:new _o({points:4,radius:e?22:18,fill:new wo({color:this.getIconColor(t)}),angle:Math.PI/4})}):super.createBackgroundStyle(t,e,i,n)}}class pc{static setProvider(t){pc.currentProvider=t||"bbr"}static getIconProvider(t=null){switch(t||pc.currentProvider){case"bbr":default:return uc.Instance;case"retbbr":return cc.Instance}}}pc.currentProvider="bbr";class dc{}dc.POINT="Point",dc.LINE_STRING="LineString",dc.LINEAR_RING="LinearRing",dc.POLYGON="Polygon",dc.MULTI_POINT="MultiPoint",dc.MULTI_LINE_STRING="MultiLineString",dc.MULTI_POLYGON="MultiPolygon",dc.GEOMETRY_COLLECTION="GeometryCollection",dc.CIRCLE="Circle";class gc{static isOkResponse(t){return!t.status||t.status>=200&&t.status<300||t.request instanceof XDomainRequest}static appendParamsToUrl(t,e){if(Array.isArray(t)){for(var i=[],n=0;n<t.length;n++)i.push(t[n]+e);return i}return t+e}static isObjectDefined(t){return!(null==t)}static isNumber(t){return gc.isObjectDefined(t)&&""!==t.toString()&&!isNaN(parseInt(t.toString()))}static generateGUID(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return(t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()).toUpperCase()}static convertToOLGeometry(t,e,i){if(i=gc.isObjectDefined(i)?i:"XY",e===dc.POINT)return new pn([t.x,t.y],i);throw"Type "+e+" is not supported. Supported type values: SKAT.BaseMap.Utils.GeometryType.POINT"}static encodeAEOEAA(t){return t.replace(/æ/g,"ae").replace(/ø/g,"oe").replace(/å/g,"aa")}static filterNulls(t){for(let e=0;e<t.length;e++)null==t[e]&&(t.splice(e,1),e--);return t}static extentToArray(t){return[t[0],t[1],t[2],t[3]]}}class fc{static set(t,e,i,n){var r=encodeURIComponent(t)+"="+encodeURIComponent(e)+"; ";i=i>-1?i:7;var s=new Date;s.setTime(s.getTime()+24*i*60*60*1e3),n=n||"/",document.cookie=r+"expires="+s.toUTCString()+"; path="+n}static get(t){var e=fc.splitString(document.cookie);return fc.getByName(e,t)}static splitString(t){var e=[];if(t)for(var i=t.split(";"),n=0;n<i.length;n++){var r=i[n].trim();-1!==r.indexOf("expires=")&&-1!==r.indexOf("path=")&&""===r||e.push(r)}return e}static getByName(t,e){for(var i=0;i<t.length;i++)if(t[i].indexOf(e+"=")>-1)return decodeURIComponent(t[i].replace(e+"=",""));return null}static updateByName(t,e,i){for(var n=0;n<t.length;n++)if(t[n].indexOf(e+"=")>-1){t[n]=t[n].substring(0,t[n].indexOf("=")+1)+encodeURIComponent(i);break}}}class yc{constructor(t){this.id=null,this.target=null,this.element=null,this.olControl=null,Object.assign(this,t)}}class mc{constructor(t=null){this.options=null,this.map=null,this.olControl=null,this.options=t||new yc}setMap(t){if(!gc.isObjectDefined(t))throw new Error("map cannot be null");this.map=t,this.olControl=null!=this.options.olControl?this.options.olControl:this.renderElem()}getId(){return this.options.id}getOLControl(){return this.olControl}renderElem(){throw"RenderElem must be overwriten in inherited method"}getTargetElem(){return this.options.target?this.options.target:null}activateShortcut(){this.olControl instanceof Vr&&mc.activateZoomShortcut(this.olControl)}show(){this.options.element.classList.remove("ol-hidden")}hide(){this.options.element.classList.add("ol-hidden")}static activateZoomShortcut(t){let e=t.getMap();if(e){let t=e.getTargetElement().querySelectorAll(".ol-zoom");if(t&&t.length>0){let e=t[0],i=e.querySelector(".ol-zoom-in");i&&(i.title+=" (+)",i.ariaLabel+=" (+)",document.addEventListener("keyup",function(t){"+"===t.key&&i.click()}.bind(this),!1));let n=e.querySelector(".ol-zoom-out");n&&(n.title+=" (-)",n.ariaLabel+=" (-)",document.addEventListener("keyup",function(t){"-"===t.key&&n.click()}.bind(this),!1))}}}}class _c extends yc{constructor(t){super(t),this.collapsible=!0,this.collapsed=!1,Object.assign(this,t)}}class vc extends mc{constructor(t){(t=t||new _c).target=vc.renderMainElement(t.target),t.olControl=new Gr(t),super(t)}static renderMainElement(t){var e=document.createElement("div");return e.className="SKAT-BaseMap-Copyright ufst-attribution",t&&t.appendChild(e),e}}const Cc={errorLabel:"Fejl",changeLayer:"Skift korttype",zoomInTipLabel:"Zoom ind",zoomOutTipLabel:"Zoom ud",geoLocationTitle:"Zoom til din lokation",geoLocationAccessDenied:"Der er ikke tilladelse til at hente din lokation. Tjek opsætning i din browser.",geoLocationUnavailable:"Din lokation er p.t. utilgængelig. Prøv igen senere.",close:"Luk"};class xc{}function wc(t){return Cc[t]||t}xc.errorLabel="errorLabel",xc.changeLayer="changeLayer",xc.zoomInTipLabel="zoomInTipLabel",xc.zoomOutTipLabel="zoomOutTipLabel",xc.geoLocationTitle="geoLocationTitle",xc.geoLocationAccessDenied="geoLocationAccessDenied",xc.geoLocationUnavailable="geoLocationUnavailable";const Mc="geo-location-control";class Ec extends yc{constructor(t){super(t),this.showButton=!1,Object.assign(this,t),this.id=Mc}}class Ic extends mc{constructor(t){(t=t||new Ec).olControl=new Sc(t),super(t),this._options=t}zoomToGeoLocation(){this.getOLControl().zoomToGeoLocation()}renderElem(){return new Sc(this._options)}}class Sc extends Fr{constructor(t){super({target:t.target,element:document.createElement("div")}),this._locationLayer=null,this.element.className="ol-geolocation ol-unselectable ol-control"+(t.showButton?"":" ol-hidden");const e=wc(xc.geoLocationTitle);let i=this.createButton(e);i.addEventListener("click",(()=>{this.handleClick()})),this.element.appendChild(i)}setMap(t){super.setMap(t),this._map=t,this._geolocation=new Cu({trackingOptions:{enableHighAccuracy:!0,maximumAge:60},projection:t.getView().getProjection()}),this._geolocation.on("error",(t=>{this.handleError(t)})),this._geolocation.on("change",(t=>{this._geolocation.setTracking(!1);const e=this._geolocation.getPosition();e&&this.zoomToCoordinates(e)}))}zoomToGeoLocation(){this.handleClick()}clearMarker(){this._locationLayer&&this._locationLayer.getSource().clear()}handleClick(){const t=this._geolocation.getPosition();t?this.zoomToCoordinates(t):this._geolocation.setTracking(!0)}zoomToCoordinates(t){const e=this._map.getView();e.animate({center:t,zoom:e.getMaxZoom()-3},(e=>{e?this.showLocation(t):this.clearMarker()}))}handleError(t){let e=t.message;switch(t.code){case 1:e=wc(xc.geoLocationAccessDenied);break;case 2:case 3:e=wc(xc.geoLocationUnavailable)}alert(wc(xc.errorLabel)+": "+e)}addFeatureLayer(){this._locationLayer||(this._locationLayer=new rh({source:new tu({features:[]}),style:[new Ro({image:new Co({fill:new wo({color:"rgba(66, 133, 244, 0.25)"}),radius:11})}),new Ro({image:new Co({fill:new wo({color:"rgb(66, 133, 244)"}),stroke:new Eo({color:"white"}),radius:5})})]}),this._map.addLayer(this._locationLayer))}showLocation(t){this._locationLayer||this.addFeatureLayer();const e=this._locationLayer.getSource();e.clear();const i=new iu(new pn(t));e.addFeature(i)}createButton(t){let e=document.createElement("button");return e.type="button",e.title=t,e.setAttribute("aria-label",t),e.innerHTML="<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-cursor-fill' viewBox='0 0 16 16' style='color:black'><path d='M14.082 2.182a.5.5 0 0 1 .103.557L8.528 15.467a.5.5 0 0 1-.917-.007L5.57 10.694.803 8.652a.5.5 0 0 1-.006-.916l12.728-5.657a.5.5 0 0 1 .556.103z'/></svg>",e}}class Lc{static renderDefaultElem(t,e){const i=t;let n=null,r=null,s=null;0!=(e=e||{}).enableZoomControl&&(r=document.createElement("img"),r.alt=wc(xc.zoomInTipLabel),r.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAItJREFUWAljZCADZGZmev79+3cbslZmZmav6dOnb0cWI4bNRIwiWqoZdcBoCIyGwGgIjIbAgIcAI6hiIbWsB1ZEJkA9TWj66oAV0hk0MYJcFvRajaAO3AqagGbhlsUhM+BRMOoAFlBLBkf04BSmZiJkxGkLHonRJhmewCFZajQXjIbAaAiMhsBoCAAA32ojPx68CJoAAAAASUVORK5CYII=",s=document.createElement("img"),s.alt=wc(xc.zoomOutTipLabel),s.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAGCAYAAACij5zfAAAAAXNSR0IArs4c6QAAACNJREFUKBVjTEtL+88wgIBpAO0GWz3qABZGRsbJAx0NA2o/AEU1AtOKjoZwAAAAAElFTkSuQmCC",n={zoomInTipLabel:wc(xc.zoomInTipLabel),zoomOutTipLabel:wc(xc.zoomOutTipLabel),zoomInLabel:r,zoomOutLabel:s,target:i});const o=jr({attribution:!1,rotate:!1,zoomOptions:n,zoom:!!n});if(r){let t=r.parentElement;t&&t.setAttribute("aria-label",wc(xc.zoomInTipLabel))}if(s){let t=s.parentElement;t&&t.setAttribute("aria-label",wc(xc.zoomOutTipLabel))}0!=e.enableScaleLine&&o.push(new Ns);var a=[];if(0!=e.enableAttribution){const t=new vc(new _c({collapsible:!1,target:i}));a.push(t)}if(0!=e.enableGeolocationControl){const t=new Ic(new Ec({showButton:e.showGeoLocationButton}));a.push(t)}for(let t=0;t<o.getLength();t++)a.push(new mc({id:o.item(t).get("id"),olControl:o.item(t)}));return a}}var bc=6378137,Rc=.0066943799901413165,Nc=484813681109536e-20,Ac=Math.PI/2,Tc=1e-10,Pc=.017453292519943295,Oc=57.29577951308232,Dc=Math.PI/4,kc=2*Math.PI,Fc=3.14159265359,Gc={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const Hc={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var Vc=/[\s_\-\/\(\)]/g;function jc(t,e){if(t[e])return t[e];for(var i,n=Object.keys(t),r=e.toLowerCase().replace(Vc,""),s=-1;++s<n.length;)if((i=n[s]).toLowerCase().replace(Vc,"")===r)return t[i]}function zc(t){var e,i,n,r={},s=t.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var i=e.split("=");return i.push(!0),t[i[0].toLowerCase()]=i[1],t}),{}),o={proj:"projName",datum:"datumCode",rf:function(t){r.rf=parseFloat(t)},lat_0:function(t){r.lat0=t*Pc},lat_1:function(t){r.lat1=t*Pc},lat_2:function(t){r.lat2=t*Pc},lat_ts:function(t){r.lat_ts=t*Pc},lon_0:function(t){r.long0=t*Pc},lon_1:function(t){r.long1=t*Pc},lon_2:function(t){r.long2=t*Pc},alpha:function(t){r.alpha=parseFloat(t)*Pc},gamma:function(t){r.rectified_grid_angle=parseFloat(t)},lonc:function(t){r.longc=t*Pc},x_0:function(t){r.x0=parseFloat(t)},y_0:function(t){r.y0=parseFloat(t)},k_0:function(t){r.k0=parseFloat(t)},k:function(t){r.k0=parseFloat(t)},a:function(t){r.a=parseFloat(t)},b:function(t){r.b=parseFloat(t)},r_a:function(){r.R_A=!0},zone:function(t){r.zone=parseInt(t,10)},south:function(){r.utmSouth=!0},towgs84:function(t){r.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){r.to_meter=parseFloat(t)},units:function(t){r.units=t;var e=jc(Hc,t);e&&(r.to_meter=e.to_meter)},from_greenwich:function(t){r.from_greenwich=t*Pc},pm:function(t){var e=jc(Gc,t);r.from_greenwich=(e||parseFloat(t))*Pc},nadgrids:function(t){"@null"===t?r.datumCode="none":r.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(r.axis=t)},approx:function(){r.approx=!0}};for(e in s)i=s[e],e in o?"function"==typeof(n=o[e])?n(i):r[n]=i:r[e]=i;return"string"==typeof r.datumCode&&"WGS84"!==r.datumCode&&(r.datumCode=r.datumCode.toLowerCase()),r}var Bc=1,Uc=/\s/,Zc=/[A-Za-z]/,Yc=/[A-Za-z84_]/,Wc=/[,\]]/,Xc=/[\d\.E\-\+]/;function qc(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Bc}function Kc(t,e,i){Array.isArray(e)&&(i.unshift(e),e=null);var n=e?{}:t,r=i.reduce((function(t,e){return Jc(e,t),t}),n);e&&(t[e]=r)}function Jc(t,e){if(Array.isArray(t)){var i=t.shift();if("PARAMETER"===i&&(i=t.shift()),1===t.length)return Array.isArray(t[0])?(e[i]={},void Jc(t[0],e[i])):void(e[i]=t[0]);if(t.length)if("TOWGS84"!==i){if("AXIS"===i)return i in e||(e[i]=[]),void e[i].push(t);var n;switch(Array.isArray(i)||(e[i]={}),i){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[i]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&Jc(t[2],e[i]));case"SPHEROID":case"ELLIPSOID":return e[i]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&Jc(t[3],e[i]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void Kc(e,i,t);default:for(n=-1;++n<t.length;)if(!Array.isArray(t[n]))return Jc(t,e[i]);return Kc(e,i,t)}}else e[i]=t;else e[i]=!0}else e[t]=!0}function Qc(t){return.017453292519943295*t}function $c(t){var e=new qc(t).output(),i=e.shift(),n=e.shift();e.unshift(["name",n]),e.unshift(["type",i]);var r={};return Jc(e,r),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var e="",i=0,n=t.AXIS.length;i<n;++i){var r=[t.AXIS[i][0].toLowerCase(),t.AXIS[i][1].toLowerCase()];-1!==r[0].indexOf("north")||("y"===r[0]||"lat"===r[0])&&"north"===r[1]?e+="n":-1!==r[0].indexOf("south")||("y"===r[0]||"lat"===r[0])&&"south"===r[1]?e+="s":-1!==r[0].indexOf("east")||("x"===r[0]||"lon"===r[0])&&"east"===r[1]?e+="e":-1===r[0].indexOf("west")&&("x"!==r[0]&&"lon"!==r[0]||"west"!==r[1])||(e+="w")}2===e.length&&(e+="u"),3===e.length&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var s=t.GEOGCS;function o(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(s=t),s&&(s.DATUM?t.datumCode=s.DATUM.name.toLowerCase():t.datumCode=s.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),s.DATUM&&s.DATUM.SPHEROID&&(t.ellps=s.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=s.DATUM.SPHEROID.a,t.rf=parseFloat(s.DATUM.SPHEROID.rf,10)),s.DATUM&&s.DATUM.TOWGS84&&(t.datum_params=s.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Qc],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Qc],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Qc],["lat0","latitude_of_origin",Qc],["lat0","standard_parallel_1",Qc],["lat1","standard_parallel_1",Qc],["lat2","standard_parallel_2",Qc],["azimuth","Azimuth"],["alpha","azimuth",Qc],["srsCode","name"]].forEach((function(e){return function(t,e){var i=e[0],n=e[1];!(i in t)&&n in t&&(t[i]=t[n],3===e.length&&(t[i]=e[2](t[i])))}(t,e)})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName?!t.lat_ts&&t.lat0&&"Polar_Stereographic"===t.projName&&(t.lat_ts=t.lat0,t.lat0=Qc(t.lat0>0?90:-90)):(t.lat0=Qc(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(r),r}function tp(t){var e=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?tp[t]=zc(arguments[1]):tp[t]=$c(arguments[1]):tp[t]=i}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?tp.apply(e,t):tp(t)}));if("string"==typeof t){if(t in tp)return tp[t]}else"EPSG"in t?tp["EPSG:"+t.EPSG]=t:"ESRI"in t?tp["ESRI:"+t.ESRI]=t:"IAU2000"in t?tp["IAU2000:"+t.IAU2000]=t:console.log(t);return}}qc.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;Uc.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case Bc:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},qc.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(Wc.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},qc.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=Bc)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=Bc,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},qc.prototype.number=function(t){if(!Xc.test(t)){if(Wc.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},qc.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},qc.prototype.keyword=function(t){if(Yc.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=Bc)}if(!Wc.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},qc.prototype.neutral=function(t){if(Zc.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(Xc.test(t))return this.word=t,void(this.state=3);if(!Wc.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},qc.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)},function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(tp);const ep=tp;var ip=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],np=["3857","900913","3785","102113"];function rp(t,e){var i,n;if(t=t||{},!e)return t;for(n in e)void 0!==(i=e[n])&&(t[n]=i);return t}function sp(t,e,i){var n=t*e;return i/Math.sqrt(1-n*n)}function op(t){return t<0?-1:1}function ap(t){return Math.abs(t)<=Fc?t:t-op(t)*kc}function lp(t,e,i){var n=t*i,r=.5*t;return n=Math.pow((1-n)/(1+n),r),Math.tan(.5*(Ac-e))/n}function hp(t,e){for(var i,n,r=.5*t,s=Ac-2*Math.atan(e),o=0;o<=15;o++)if(i=t*Math.sin(s),s+=n=Ac-2*Math.atan(e*Math.pow((1-i)/(1+i),r))-s,Math.abs(n)<=1e-10)return s;return-9999}function up(t){return t}var cp=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=sp(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,i,n=t.x,r=t.y;if(r*Oc>90&&r*Oc<-90&&n*Oc>180&&n*Oc<-180)return null;if(Math.abs(Math.abs(r)-Ac)<=Tc)return null;if(this.sphere)e=this.x0+this.a*this.k0*ap(n-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(Dc+.5*r));else{var s=Math.sin(r),o=lp(this.e,r,s);e=this.x0+this.a*this.k0*ap(n-this.long0),i=this.y0-this.a*this.k0*Math.log(o)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n=t.x-this.x0,r=t.y-this.y0;if(this.sphere)i=Ac-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var s=Math.exp(-r/(this.a*this.k0));if(-9999===(i=hp(this.e,s)))return null}return e=ap(this.long0+n/(this.a*this.k0)),t.x=e,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:up,inverse:up,names:["longlat","identity"]}],pp={},dp=[];function gp(t,e){var i=dp.length;return t.names?(dp[i]=t,t.names.forEach((function(t){pp[t.toLowerCase()]=i})),this):(console.log(e),!0)}const fp={start:function(){cp.forEach(gp)},add:gp,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==pp[e]&&dp[pp[e]]?dp[pp[e]]:void 0}};var yp={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},mp=yp.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};yp.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var _p={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};var vp={};function Cp(t){if(0===t.length)return null;var e="@"===t[0];return e&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:vp[t]||null,isNull:!1}}function xp(t){return t/3600*Math.PI/180}function wp(t,e,i){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,i)))}function Mp(t){return t.map((function(t){return[xp(t.longitudeShift),xp(t.latitudeShift)]}))}function Ep(t,e,i){return{name:wp(t,e+8,e+16).trim(),parent:wp(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,i),upperLatitude:t.getFloat64(e+88,i),lowerLongitude:t.getFloat64(e+104,i),upperLongitude:t.getFloat64(e+120,i),latitudeInterval:t.getFloat64(e+136,i),longitudeInterval:t.getFloat64(e+152,i),gridNodeCount:t.getInt32(e+168,i)}}function Ip(t,e,i,n){for(var r=e+176,s=[],o=0;o<i.gridNodeCount;o++){var a={latitudeShift:t.getFloat32(r+16*o,n),longitudeShift:t.getFloat32(r+16*o+4,n),latitudeAccuracy:t.getFloat32(r+16*o+8,n),longitudeAccuracy:t.getFloat32(r+16*o+12,n)};s.push(a)}return s}function Sp(t,e){if(!(this instanceof Sp))return new Sp(t);e=e||function(t){if(t)throw t};var i=function(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in ep}(t))return ep[t];if(function(t){return ip.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=$c(t);if(function(t){var e=jc(t,"authority");if(e){var i=jc(e,"epsg");return i&&np.indexOf(i)>-1}}(e))return ep["EPSG:3857"];var i=function(t){var e=jc(t,"extension");if(e)return jc(e,"proj4")}(e);return i?zc(i):e}return function(t){return"+"===t[0]}(t)?zc(t):void 0}(t);if("object"==typeof i){var n=Sp.projections.get(i.projName);if(n){if(i.datumCode&&"none"!==i.datumCode){var r=jc(_p,i.datumCode);r&&(i.datum_params=i.datum_params||(r.towgs84?r.towgs84.split(","):null),i.ellps=r.ellipse,i.datumName=r.datumName?r.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84",i.lat1=i.lat1||i.lat0;var s=function(t,e,i,n,r){if(!t){var s=jc(yp,n);s||(s=mp),t=s.a,e=s.b,i=s.rf}return i&&!e&&(e=(1-1/i)*t),(0===i||Math.abs(t-e)<Tc)&&(r=!0,e=t),{a:t,b:e,rf:i,sphere:r}}(i.a,i.b,i.rf,i.ellps,i.sphere),o=function(t,e,i,n){var r=t*t,s=e*e,o=(r-s)/r,a=0;return n?(r=(t*=1-o*(.16666666666666666+o*(.04722222222222222+.022156084656084655*o)))*t,o=0):a=Math.sqrt(o),{es:o,e:a,ep2:(r-s)/s}}(s.a,s.b,s.rf,i.R_A),a=function(t){return void 0===t?null:t.split(",").map(Cp)}(i.nadgrids),l=i.datum||function(t,e,i,n,r,s,o){var a={};return a.datum_type=void 0===t||"none"===t?5:4,e&&(a.datum_params=e.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=1),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=2,a.datum_params[3]*=Nc,a.datum_params[4]*=Nc,a.datum_params[5]*=Nc,a.datum_params[6]=a.datum_params[6]/1e6+1))),o&&(a.datum_type=3,a.grids=o),a.a=i,a.b=n,a.es=r,a.ep2=s,a}(i.datumCode,i.datum_params,s.a,s.b,o.es,o.ep2,a);rp(this,i),rp(this,n),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=l,this.init(),e(null,this)}else e(t)}else e(t)}Sp.projections=fp,Sp.projections.start();const Lp=Sp;function bp(t,e,i){var n,r,s,o,a=t.x,l=t.y,h=t.z?t.z:0;if(l<-Ac&&l>-1.001*Ac)l=-Ac;else if(l>Ac&&l<1.001*Ac)l=Ac;else{if(l<-Ac)return{x:-1/0,y:-1/0,z:t.z};if(l>Ac)return{x:1/0,y:1/0,z:t.z}}return a>Math.PI&&(a-=2*Math.PI),r=Math.sin(l),o=Math.cos(l),s=r*r,{x:((n=i/Math.sqrt(1-e*s))+h)*o*Math.cos(a),y:(n+h)*o*Math.sin(a),z:(n*(1-e)+h)*r}}function Rp(t,e,i,n){var r,s,o,a,l,h,u,c,p,d,g,f,y,m,_,v=t.x,C=t.y,x=t.z?t.z:0;if(r=Math.sqrt(v*v+C*C),s=Math.sqrt(v*v+C*C+x*x),r/i<1e-12){if(m=0,s/i<1e-12)return _=-n,{x:t.x,y:t.y,z:t.z}}else m=Math.atan2(C,v);o=x/s,c=(a=r/s)*(1-e)*(l=1/Math.sqrt(1-e*(2-e)*a*a)),p=o*l,y=0;do{y++,h=e*(u=i/Math.sqrt(1-e*p*p))/(u+(_=r*c+x*p-u*(1-e*p*p))),f=(g=o*(l=1/Math.sqrt(1-h*(2-h)*a*a)))*c-(d=a*(1-h)*l)*p,c=d,p=g}while(f*f>1e-24&&y<30);return{x:m,y:Math.atan(g/Math.abs(d)),z:_}}function Np(t){return 1===t||2===t}function Ap(t,e,i){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;for(var n={x:-i.x,y:i.y},r={x:Number.NaN,y:Number.NaN},s=[],o=0;o<t.grids.length;o++){var a=t.grids[o];if(s.push(a.name),a.isNull){r=n;break}if(a.mandatory,null!==a.grid){var l=a.grid.subgrids[0],h=(Math.abs(l.del[1])+Math.abs(l.del[0]))/1e4,u=l.ll[0]-h,c=l.ll[1]-h,p=l.ll[0]+(l.lim[0]-1)*l.del[0]+h,d=l.ll[1]+(l.lim[1]-1)*l.del[1]+h;if(!(c>n.y||u>n.x||d<n.y||p<n.x||(r=Tp(n,e,l),isNaN(r.x))))break}else if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*Oc+" "+n.y*Oc+" tried: '"+s+"'"),-1):(i.x=-r.x,i.y=r.y,0)}function Tp(t,e,i){var n={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return n;var r={x:t.x,y:t.y};r.x-=i.ll[0],r.y-=i.ll[1],r.x=ap(r.x-Math.PI)+Math.PI;var s=Pp(r,i);if(e){if(isNaN(s.x))return n;s.x=r.x-s.x,s.y=r.y-s.y;var o,a,l=9;do{if(a=Pp(s,i),isNaN(a.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}o={x:r.x-(a.x+s.x),y:r.y-(a.y+s.y)},s.x+=o.x,s.y+=o.y}while(l--&&Math.abs(o.x)>1e-12&&Math.abs(o.y)>1e-12);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=ap(s.x+i.ll[0]),n.y=s.y+i.ll[1]}else isNaN(s.x)||(n.x=t.x+s.x,n.y=t.y+s.y);return n}function Pp(t,e){var i,n={x:t.x/e.del[0],y:t.y/e.del[1]},r=Math.floor(n.x),s=Math.floor(n.y),o=n.x-1*r,a=n.y-1*s,l={x:Number.NaN,y:Number.NaN};if(r<0||r>=e.lim[0])return l;if(s<0||s>=e.lim[1])return l;i=s*e.lim[0]+r;var h=e.cvs[i][0],u=e.cvs[i][1];i++;var c=e.cvs[i][0],p=e.cvs[i][1];i+=e.lim[0];var d=e.cvs[i][0],g=e.cvs[i][1];i--;var f=e.cvs[i][0],y=e.cvs[i][1],m=o*a,_=o*(1-a),v=(1-o)*(1-a),C=(1-o)*a;return l.x=v*h+_*c+C*f+m*d,l.y=v*u+_*p+C*y+m*g,l}function Op(t,e,i){var n,r,s,o=i.x,a=i.y,l=i.z||0,h={};for(s=0;s<3;s++)if(!e||2!==s||void 0!==i.z)switch(0===s?(n=o,r=-1!=="ew".indexOf(t.axis[s])?"x":"y"):1===s?(n=a,r=-1!=="ns".indexOf(t.axis[s])?"y":"x"):(n=l,r="z"),t.axis[s]){case"e":case"n":h[r]=n;break;case"w":case"s":h[r]=-n;break;case"u":void 0!==i[r]&&(h.z=n);break;case"d":void 0!==i[r]&&(h.z=-n);break;default:return null}return h}function Dp(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function kp(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function Fp(t,e,i,n){var r;if(Array.isArray(i)&&(i=Dp(i)),function(t){kp(t.x),kp(t.y)}(i),t.datum&&e.datum&&function(t,e){return(1===t.datum.datum_type||2===t.datum.datum_type)&&"WGS84"!==e.datumCode||(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==t.datumCode}(t,e)&&(i=Fp(t,r=new Lp("WGS84"),i,n),t=r),n&&"enu"!==t.axis&&(i=Op(t,!1,i)),"longlat"===t.projName)i={x:i.x*Pc,y:i.y*Pc,z:i.z||0};else if(t.to_meter&&(i={x:i.x*t.to_meter,y:i.y*t.to_meter,z:i.z||0}),!(i=t.inverse(i)))return;if(t.from_greenwich&&(i.x+=t.from_greenwich),i=function(t,e,i){if(function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(1===t.datum_type?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:2!==t.datum_type||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}(t,e))return i;if(5===t.datum_type||5===e.datum_type)return i;var n=t.a,r=t.es;if(3===t.datum_type){if(0!==Ap(t,!1,i))return;n=bc,r=Rc}var s=e.a,o=e.b,a=e.es;return 3===e.datum_type&&(s=bc,o=6356752.314,a=Rc),r!==a||n!==s||Np(t.datum_type)||Np(e.datum_type)?(i=bp(i,r,n),Np(t.datum_type)&&(i=function(t,e,i){if(1===e)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(2===e){var n=i[0],r=i[1],s=i[2],o=i[3],a=i[4],l=i[5],h=i[6];return{x:h*(t.x-l*t.y+a*t.z)+n,y:h*(l*t.x+t.y-o*t.z)+r,z:h*(-a*t.x+o*t.y+t.z)+s}}}(i,t.datum_type,t.datum_params)),Np(e.datum_type)&&(i=function(t,e,i){if(1===e)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(2===e){var n=i[0],r=i[1],s=i[2],o=i[3],a=i[4],l=i[5],h=i[6],u=(t.x-n)/h,c=(t.y-r)/h,p=(t.z-s)/h;return{x:u+l*c-a*p,y:-l*u+c+o*p,z:a*u-o*c+p}}}(i,e.datum_type,e.datum_params)),i=Rp(i,a,s,o),3!==e.datum_type||0===Ap(e,!0,i)?i:void 0):i}(t.datum,e.datum,i))return e.from_greenwich&&(i={x:i.x-e.from_greenwich,y:i.y,z:i.z||0}),"longlat"===e.projName?i={x:i.x*Oc,y:i.y*Oc,z:i.z||0}:(i=e.forward(i),e.to_meter&&(i={x:i.x/e.to_meter,y:i.y/e.to_meter,z:i.z||0})),n&&"enu"!==e.axis?Op(e,!0,i):i}var Gp=Lp("WGS84");function Hp(t,e,i,n){var r,s,o;return Array.isArray(i)?(r=Fp(t,e,i,n)||{x:NaN,y:NaN},i.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name?"number"==typeof r.z?[r.x,r.y,r.z].concat(i.splice(3)):[r.x,r.y,i[2]].concat(i.splice(3)):[r.x,r.y].concat(i.splice(2)):[r.x,r.y]):(s=Fp(t,e,i,n),2===(o=Object.keys(i)).length||o.forEach((function(n){if(void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name){if("x"===n||"y"===n||"z"===n)return}else if("x"===n||"y"===n)return;s[n]=i[n]})),s)}function Vp(t){return t instanceof Lp?t:t.oProj?t.oProj:Lp(t)}const jp=function(t,e,i){t=Vp(t);var n,r=!1;return void 0===e?(e=t,t=Gp,r=!0):(void 0!==e.x||Array.isArray(e))&&(i=e,e=t,t=Gp,r=!0),e=Vp(e),i?Hp(t,e,i):(n={forward:function(i,n){return Hp(t,e,i,n)},inverse:function(i,n){return Hp(e,t,i,n)}},r&&(n.oProj=e),n)};var zp="AJSAJS",Bp="AFAFAF",Up=65,Zp=73,Yp=79;const Wp={forward:Xp,inverse:function(t){var e=Qp(td(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:qp};function Xp(t,e){return e=e||5,function(t,e){var i,n,r,s,o,a,l,h,u,c,p,d="00000"+t.easting,g="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(u=t.easting,c=t.northing,p=$p(t.zoneNumber),i=Math.floor(u/1e5),n=Math.floor(c/1e5)%20,s=zp.charCodeAt(r=p-1),o=Bp.charCodeAt(r),h=!1,(a=s+i-1)>90&&(a=a-90+Up-1,h=!0),(a===Zp||s<Zp&&a>Zp||(a>Zp||s<Zp)&&h)&&a++,(a===Yp||s<Yp&&a>Yp||(a>Yp||s<Yp)&&h)&&++a===Zp&&a++,a>90&&(a=a-90+Up-1),(l=o+n)>86?(l=l-86+Up-1,h=!0):h=!1,(l===Zp||o<Zp&&l>Zp||(l>Zp||o<Zp)&&h)&&l++,(l===Yp||o<Yp&&l>Yp||(l>Yp||o<Yp)&&h)&&++l===Zp&&l++,l>86&&(l=l-86+Up-1),String.fromCharCode(a)+String.fromCharCode(l))+d.substr(d.length-5,e)+g.substr(g.length-5,e)}(function(t){var e,i,n,r,s,o,a,l=t.lat,h=t.lon,u=6378137,c=.00669438,p=.9996,d=Kp(l),g=Kp(h);a=Math.floor((h+180)/6)+1,180===h&&(a=60),l>=56&&l<64&&h>=3&&h<12&&(a=32),l>=72&&l<84&&(h>=0&&h<9?a=31:h>=9&&h<21?a=33:h>=21&&h<33?a=35:h>=33&&h<42&&(a=37)),o=Kp(6*(a-1)-180+3),e=.006739496752268451,i=u/Math.sqrt(1-c*Math.sin(d)*Math.sin(d)),n=Math.tan(d)*Math.tan(d),r=e*Math.cos(d)*Math.cos(d);var f,y,m=p*i*((s=Math.cos(d)*(g-o))+(1-n+r)*s*s*s/6+(5-18*n+n*n+72*r-58*e)*s*s*s*s*s/120)+5e5,_=p*(u*(.9983242984503243*d-.002514607064228144*Math.sin(2*d)+2639046602129982e-21*Math.sin(4*d)-3.418046101696858e-9*Math.sin(6*d))+i*Math.tan(d)*(s*s/2+(5-n+9*r+4*r*r)*s*s*s*s/24+(61-58*n+n*n+600*r-2.2240339282485886)*s*s*s*s*s*s/720));return l<0&&(_+=1e7),{northing:Math.round(_),easting:Math.round(m),zoneNumber:a,zoneLetter:(f=l,y="Z",84>=f&&f>=72?y="X":72>f&&f>=64?y="W":64>f&&f>=56?y="V":56>f&&f>=48?y="U":48>f&&f>=40?y="T":40>f&&f>=32?y="S":32>f&&f>=24?y="R":24>f&&f>=16?y="Q":16>f&&f>=8?y="P":8>f&&f>=0?y="N":0>f&&f>=-8?y="M":-8>f&&f>=-16?y="L":-16>f&&f>=-24?y="K":-24>f&&f>=-32?y="J":-32>f&&f>=-40?y="H":-40>f&&f>=-48?y="G":-48>f&&f>=-56?y="F":-56>f&&f>=-64?y="E":-64>f&&f>=-72?y="D":-72>f&&f>=-80&&(y="C"),y)}}({lat:t[1],lon:t[0]}),e)}function qp(t){var e=Qp(td(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Kp(t){return t*(Math.PI/180)}function Jp(t){return t/Math.PI*180}function Qp(t){var e=t.northing,i=t.easting,n=t.zoneLetter,r=t.zoneNumber;if(r<0||r>60)return null;var s,o,a,l,h,u,c,p,d,g=.9996,f=6378137,y=.00669438,m=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),_=i-5e5,v=e;n<"N"&&(v-=1e7),c=6*(r-1)-180+3,s=.006739496752268451,d=(p=v/g/6367449.145945056)+(3*m/2-27*m*m*m/32)*Math.sin(2*p)+(21*m*m/16-55*m*m*m*m/32)*Math.sin(4*p)+151*m*m*m/96*Math.sin(6*p),o=f/Math.sqrt(1-y*Math.sin(d)*Math.sin(d)),a=Math.tan(d)*Math.tan(d),l=s*Math.cos(d)*Math.cos(d),h=.99330562*f/Math.pow(1-y*Math.sin(d)*Math.sin(d),1.5),u=_/(o*g);var C=d-o*Math.tan(d)/h*(u*u/2-(5+3*a+10*l-4*l*l-9*s)*u*u*u*u/24+(61+90*a+298*l+45*a*a-1.6983531815716497-3*l*l)*u*u*u*u*u*u/720);C=Jp(C);var x,w=(u-(1+2*a+l)*u*u*u/6+(5-2*l+28*a-3*l*l+8*s+24*a*a)*u*u*u*u*u/120)/Math.cos(d);if(w=c+Jp(w),t.accuracy){var M=Qp({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});x={top:M.lat,right:M.lon,bottom:C,left:w}}else x={lat:C,lon:w};return x}function $p(t){var e=t%6;return 0===e&&(e=6),e}function td(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,i=t.length,n=null,r="",s=0;!/[A-Z]/.test(e=t.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+t;r+=e,s++}var o=parseInt(r,10);if(0===s||s+3>i)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(s++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;n=t.substring(s,s+=2);for(var l=$p(o),h=function(t,e){for(var i=zp.charCodeAt(e-1),n=1e5,r=!1;i!==t.charCodeAt(0);){if(++i===Zp&&i++,i===Yp&&i++,i>90){if(r)throw"Bad character: "+t;i=Up,r=!0}n+=1e5}return n}(n.charAt(0),l),u=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var i=Bp.charCodeAt(e-1),n=0,r=!1;i!==t.charCodeAt(0);){if(++i===Zp&&i++,i===Yp&&i++,i>86){if(r)throw"Bad character: "+t;i=Up,r=!0}n+=1e5}return n}(n.charAt(1),l);u<ed(a);)u+=2e6;var c=i-s;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var p,d,g,f=c/2,y=0,m=0;return f>0&&(p=1e5/Math.pow(10,f),d=t.substring(s,s+f),y=parseFloat(d)*p,g=t.substring(s+f),m=parseFloat(g)*p),{easting:y+h,northing:m+u,zoneLetter:a,zoneNumber:o,accuracy:p}}function ed(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function id(t,e,i){if(!(this instanceof id))return new id(t,e,i);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var n=t.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=t,this.y=e,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}id.fromMGRS=function(t){return new id(qp(t))},id.prototype.toMGRS=function(t){return Xp([this.x,this.y],t)};const nd=id;var rd=.046875,sd=.01953125,od=.01068115234375;function ad(t){var e=[];e[0]=1-t*(.25+t*(rd+t*(sd+t*od))),e[1]=t*(.75-t*(rd+t*(sd+t*od)));var i=t*t;return e[2]=i*(.46875-t*(.013020833333333334+.007120768229166667*t)),i*=t,e[3]=i*(.3645833333333333-.005696614583333333*t),e[4]=i*t*.3076171875,e}function ld(t,e,i,n){return i*=e,e*=e,n[0]*t-i*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))}function hd(t,e,i){for(var n=1/(1-e),r=t,s=20;s;--s){var o=Math.sin(r),a=1-e*o*o;if(r-=a=(ld(r,o,Math.cos(r),i)-t)*(a*Math.sqrt(a))*n,Math.abs(a)<Tc)return r}return r}const ud={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=ad(this.es),this.ml0=ld(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,i,n,r=t.x,s=t.y,o=ap(r-this.long0),a=Math.sin(s),l=Math.cos(s);if(this.es){var h=l*o,u=Math.pow(h,2),c=this.ep2*Math.pow(l,2),p=Math.pow(c,2),d=Math.abs(l)>Tc?Math.tan(s):0,g=Math.pow(d,2),f=Math.pow(g,2);e=1-this.es*Math.pow(a,2),h/=Math.sqrt(e);var y=ld(s,a,l,this.en);i=this.a*(this.k0*h*(1+u/6*(1-g+c+u/20*(5-18*g+f+14*c-58*g*c+u/42*(61+179*f-f*g-479*g)))))+this.x0,n=this.a*(this.k0*(y-this.ml0+a*o*h/2*(1+u/12*(5-g+9*c+4*p+u/30*(61+f-58*g+270*c-330*g*c+u/56*(1385+543*f-f*g-3111*g))))))+this.y0}else{var m=l*Math.sin(o);if(Math.abs(Math.abs(m)-1)<Tc)return 93;if(i=.5*this.a*this.k0*Math.log((1+m)/(1-m))+this.x0,n=l*Math.cos(o)/Math.sqrt(1-Math.pow(m,2)),(m=Math.abs(n))>=1){if(m-1>Tc)return 93;n=0}else n=Math.acos(n);s<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return t.x=i,t.y=n,t},inverse:function(t){var e,i,n,r,s=(t.x-this.x0)*(1/this.a),o=(t.y-this.y0)*(1/this.a);if(this.es)if(i=hd(e=this.ml0+o/this.k0,this.es,this.en),Math.abs(i)<Ac){var a=Math.sin(i),l=Math.cos(i),h=Math.abs(l)>Tc?Math.tan(i):0,u=this.ep2*Math.pow(l,2),c=Math.pow(u,2),p=Math.pow(h,2),d=Math.pow(p,2);e=1-this.es*Math.pow(a,2);var g=s*Math.sqrt(e)/this.k0,f=Math.pow(g,2);n=i-(e*=h)*f/(1-this.es)*.5*(1-f/12*(5+3*p-9*u*p+u-4*c-f/30*(61+90*p-252*u*p+45*d+46*u-f/56*(1385+3633*p+4095*d+1574*d*p)))),r=ap(this.long0+g*(1-f/6*(1+2*p+u-f/20*(5+28*p+24*d+8*u*p+6*u-f/42*(61+662*p+1320*d+720*d*p))))/l)}else n=Ac*op(o),r=0;else{var y=Math.exp(s/this.k0),m=.5*(y-1/y),_=this.lat0+o/this.k0,v=Math.cos(_);e=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(m,2))),n=Math.asin(e),o<0&&(n=-n),r=0===m&&0===v?0:ap(Math.atan2(m,v)+this.long0)}return t.x=r,t.y=n,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function cd(t){var e=Math.exp(t);return(e-1/e)/2}function pd(t,e){t=Math.abs(t),e=Math.abs(e);var i=Math.max(t,e),n=Math.min(t,e)/(i||1);return i*Math.sqrt(1+Math.pow(n,2))}function dd(t,e){for(var i,n=2*Math.cos(2*e),r=t.length-1,s=t[r],o=0;--r>=0;)i=n*s-o+t[r],o=s,s=i;return e+i*Math.sin(2*e)}function gd(t,e,i){for(var n,r,s=Math.sin(e),o=Math.cos(e),a=cd(i),l=function(t){var e=Math.exp(t);return(e+1/e)/2}(i),h=2*o*l,u=-2*s*a,c=t.length-1,p=t[c],d=0,g=0,f=0;--c>=0;)n=g,r=d,p=h*(g=p)-n-u*(d=f)+t[c],f=u*g-r+h*d;return[(h=s*l)*p-(u=o*a)*f,h*f+u*p]}const fd={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(ud.init.apply(this),this.forward=ud.forward,this.inverse=ud.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),i=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),i*=e,this.cgb[1]=i*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),i*=e,this.cgb[2]=i*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=i*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),i*=e,this.cgb[3]=i*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=i*(1237/630+e*(e*(-24832/14175)-2.4)),i*=e,this.cgb[4]=i*(4174/315+e*(-144838/6237)),this.cbg[4]=i*(-734/315+e*(109598/31185)),i*=e,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=i*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=i*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),i*=e,this.utg[2]=i*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=i*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),i*=e,this.utg[3]=i*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=i*(49561/161280+e*(-179/168+e*(6601661/7257600))),i*=e,this.utg[4]=i*(-4583/161280+e*(108847/3991680)),this.gtu[4]=i*(34729/80640+e*(-3418889/1995840)),i*=e,this.utg[5]=i*(-20648693/638668800),this.gtu[5]=.6650675310896665*i;var n=dd(this.cbg,this.lat0);this.Zb=-this.Qn*(n+function(t,e){for(var i,n=2*Math.cos(e),r=t.length-1,s=t[r],o=0;--r>=0;)i=n*s-o+t[r],o=s,s=i;return Math.sin(e)*i}(this.gtu,2*n))},forward:function(t){var e=ap(t.x-this.long0),i=t.y;i=dd(this.cbg,i);var n=Math.sin(i),r=Math.cos(i),s=Math.sin(e),o=Math.cos(e);i=Math.atan2(n,o*r),e=Math.atan2(s*r,pd(n,r*o)),e=function(t){var e=Math.abs(t);return e=function(t){var e=1+t,i=e-1;return 0===i?t:t*Math.log(e)/i}(e*(1+e/(pd(1,e)+1))),t<0?-e:e}(Math.tan(e));var a,l,h=gd(this.gtu,2*i,2*e);return i+=h[0],e+=h[1],Math.abs(e)<=2.623395162778?(a=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*i+this.Zb)+this.y0):(a=1/0,l=1/0),t.x=a,t.y=l,t},inverse:function(t){var e,i,n=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);if(r=(r-this.Zb)/this.Qn,n/=this.Qn,Math.abs(n)<=2.623395162778){var s=gd(this.utg,2*r,2*n);r+=s[0],n+=s[1],n=Math.atan(cd(n));var o=Math.sin(r),a=Math.cos(r),l=Math.sin(n),h=Math.cos(n);r=Math.atan2(o*h,pd(l,h*a)),e=ap((n=Math.atan2(l,h*a))+this.long0),i=dd(this.cgb,r)}else e=1/0,i=1/0;return t.x=e,t.y=i,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]},yd={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(ap(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Pc,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,fd.init.apply(this),this.forward=fd.forward,this.inverse=fd.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function md(t,e){return Math.pow((1-t)/(1+t),e)}const _d={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Dc)/(Math.pow(Math.tan(.5*this.lat0+Dc),this.C)*md(this.e*t,this.ratexp))},forward:function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+Dc),this.C)*md(this.e*Math.sin(i),this.ratexp))-Ac,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,i=t.y,n=Math.pow(Math.tan(.5*i+Dc)/this.K,1/this.C),r=20;r>0&&(i=2*Math.atan(n*md(this.e*Math.sin(t.y),-.5*this.e))-Ac,!(Math.abs(i-t.y)<1e-14));--r)t.y=i;return r?(t.x=e,t.y=i,t):null},names:["gauss"]},vd={init:function(){_d.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,i,n,r;return t.x=ap(t.x-this.long0),_d.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),n=Math.cos(t.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*n),t.x=r*i*Math.sin(t.x),t.y=r*(this.cosc0*e-this.sinc0*i*n),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,i,n,r,s;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=Math.sqrt(t.x*t.x+t.y*t.y)){var o=2*Math.atan2(s,this.R2);e=Math.sin(o),i=Math.cos(o),r=Math.asin(i*this.sinc0+t.y*e*this.cosc0/s),n=Math.atan2(t.x*e,s*this.cosc0*i-t.y*this.sinc0*e)}else r=this.phic0,n=0;return t.x=n,t.y=r,_d.inverse.apply(this,[t]),t.x=ap(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},Cd={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Tc&&(this.k0=.5*(1+op(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Tc&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Tc&&(this.k0=.5*this.cons*sp(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/lp(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=sp(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Ac,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,i,n,r,s,o,a=t.x,l=t.y,h=Math.sin(l),u=Math.cos(l),c=ap(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=Tc&&Math.abs(l+this.lat0)<=Tc?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*h+this.coslat0*u*Math.cos(c)),t.x=this.a*e*u*Math.sin(c)+this.x0,t.y=this.a*e*(this.coslat0*h-this.sinlat0*u*Math.cos(c))+this.y0,t):(i=2*Math.atan(this.ssfn_(l,h,this.e))-Ac,r=Math.cos(i),n=Math.sin(i),Math.abs(this.coslat0)<=Tc?(s=lp(this.e,l*this.con,this.con*h),o=2*this.a*this.k0*s/this.cons,t.x=this.x0+o*Math.sin(a-this.long0),t.y=this.y0-this.con*o*Math.cos(a-this.long0),t):(Math.abs(this.sinlat0)<Tc?(e=2*this.a*this.k0/(1+r*Math.cos(c)),t.y=e*n):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*r*Math.cos(c))),t.y=e*(this.cosX0*n-this.sinX0*r*Math.cos(c))+this.y0),t.x=e*r*Math.sin(c)+this.x0,t))},inverse:function(t){var e,i,n,r,s;t.x-=this.x0,t.y-=this.y0;var o=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,i=this.lat0,o<=Tc?(t.x=e,t.y=i,t):(i=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/o),e=Math.abs(this.coslat0)<Tc?this.lat0>0?ap(this.long0+Math.atan2(t.x,-1*t.y)):ap(this.long0+Math.atan2(t.x,t.y)):ap(this.long0+Math.atan2(t.x*Math.sin(a),o*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=i,t)}if(Math.abs(this.coslat0)<=Tc){if(o<=Tc)return i=this.lat0,e=this.long0,t.x=e,t.y=i,t;t.x*=this.con,t.y*=this.con,n=o*this.cons/(2*this.a*this.k0),i=this.con*hp(this.e,n),e=this.con*ap(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else r=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=Tc?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+t.y*Math.sin(r)*this.cosX0/o),e=ap(this.long0+Math.atan2(t.x*Math.sin(r),o*this.cosX0*Math.cos(r)-t.y*this.sinX0*Math.sin(r)))),i=-1*hp(this.e,Math.tan(.5*(Ac+s)));return t.x=e,t.y=i,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,i){return e*=i,Math.tan(.5*(Ac+t))*Math.pow((1-e)/(1+e),.5*i)}},xd={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,n=1/this.rf,r=2*n-Math.pow(n,2),s=this.e=Math.sqrt(r);this.R=this.k0*i*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+s*e)/(1-s*e));this.K=o-this.alpha*a+this.alpha*s/2*l},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(e+i)+this.K,r=2*(Math.atan(Math.exp(n))-Math.PI/4),s=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*o+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,i=t.y-this.y0,n=e/this.R,r=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(n)),o=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+o/this.alpha,l=0,h=s,u=-1e3,c=0;Math.abs(h-u)>1e-7;){if(++c>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),u=h,h=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=a,t.y=h,t},names:["somerc"]};var wd=1e-7;const Md={init:function(){var t,e,i,n,r,s,o,a,l,h,u,c,p,d=0,g=0,f=0,y=0,m=0,_=0,v=0;this.no_off=(p="object"==typeof(c=this).PROJECTION?Object.keys(c.PROJECTION)[0]:c.PROJECTION,"no_uoff"in c||"no_off"in c||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(p)),this.no_rot="no_rot"in this;var C=!1;"alpha"in this&&(C=!0);var x=!1;if("rectified_grid_angle"in this&&(x=!0),C&&(v=this.alpha),x&&(d=this.rectified_grid_angle*Pc),C||x)g=this.longc;else if(f=this.long1,m=this.lat1,y=this.long2,_=this.lat2,Math.abs(m-_)<=wd||(t=Math.abs(m))<=wd||Math.abs(t-Ac)<=wd||Math.abs(Math.abs(this.lat0)-Ac)<=wd||Math.abs(Math.abs(_)-Ac)<=wd)throw new Error;var w=1-this.es;e=Math.sqrt(w),Math.abs(this.lat0)>Tc?(a=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*a*a,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/w),this.A=this.B*this.k0*e/t,(r=(n=this.B*e/(i*Math.sqrt(t)))*n-1)<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=n,this.E*=Math.pow(lp(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=n=r=1),C||x?(C?(u=Math.asin(Math.sin(v)/n),x||(d=v)):(u=d,v=Math.asin(n*Math.sin(u))),this.lam0=g-Math.asin(.5*(r-1/r)*Math.tan(u))/this.B):(s=Math.pow(lp(this.e,m,Math.sin(m)),this.B),o=Math.pow(lp(this.e,_,Math.sin(_)),this.B),r=this.E/s,l=(o-s)/(o+s),h=((h=this.E*this.E)-o*s)/(h+o*s),(t=f-y)<-Math.pi?y-=kc:t>Math.pi&&(y+=kc),this.lam0=ap(.5*(f+y)-Math.atan(h*Math.tan(.5*this.B*(f-y))/l)/this.B),u=Math.atan(2*Math.sin(this.B*ap(f-this.lam0))/(r-1/r)),d=v=Math.asin(n*Math.sin(u))),this.singam=Math.sin(u),this.cosgam=Math.cos(u),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A,this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(v))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*u,this.v_pole_n=this.ArB*Math.log(Math.tan(Dc-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(Dc+r))},forward:function(t){var e,i,n,r,s,o,a,l,h={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-Ac)>Tc){if(e=.5*((s=this.E/Math.pow(lp(this.e,t.y,Math.sin(t.y)),this.B))-(o=1/s)),i=.5*(s+o),r=Math.sin(this.B*t.x),n=(e*this.singam-r*this.cosgam)/i,Math.abs(Math.abs(n)-1)<Tc)throw new Error;l=.5*this.ArB*Math.log((1-n)/(1+n)),o=Math.cos(this.B*t.x),a=Math.abs(o)<wd?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+r*this.singam,o)}else l=t.y>0?this.v_pole_n:this.v_pole_s,a=this.ArB*t.y;return this.no_rot?(h.x=a,h.y=l):(a-=this.u_0,h.x=l*this.cosrot+a*this.sinrot,h.y=a*this.cosrot-l*this.sinrot),h.x=this.a*h.x+this.x0,h.y=this.a*h.y+this.y0,h},inverse:function(t){var e,i,n,r,s,o,a,l={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(i=t.y,e=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=.5*((n=Math.exp(-this.BrA*i))-1/n),s=.5*(n+1/n),a=((o=Math.sin(this.BrA*e))*this.cosgam+r*this.singam)/s,Math.abs(Math.abs(a)-1)<Tc)l.x=0,l.y=a<0?-Ac:Ac;else{if(l.y=this.E/Math.sqrt((1+a)/(1-a)),l.y=hp(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(r*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},Ed={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Tc)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),i=Math.cos(this.lat1),n=sp(this.e,e,i),r=lp(this.e,this.lat1,e),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=sp(this.e,s,o),l=lp(this.e,this.lat2,s),h=lp(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Tc?this.ns=Math.log(n/a)/Math.log(r/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=n/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=Tc&&(i=op(i)*(Ac-2e-10));var n,r,s=Math.abs(Math.abs(i)-Ac);if(s>Tc)n=lp(this.e,i,Math.sin(i)),r=this.a*this.f0*Math.pow(n,this.ns);else{if((s=i*this.ns)<=0)return null;r=0}var o=this.ns*ap(e-this.long0);return t.x=this.k0*(r*Math.sin(o))+this.x0,t.y=this.k0*(this.rh-r*Math.cos(o))+this.y0,t},inverse:function(t){var e,i,n,r,s,o=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),i=1):(e=-Math.sqrt(o*o+a*a),i=-1);var l=0;if(0!==e&&(l=Math.atan2(i*o,i*a)),0!==e||this.ns>0){if(i=1/this.ns,n=Math.pow(e/(this.a*this.f0),i),-9999===(r=hp(this.e,n)))return null}else r=-Ac;return s=ap(l/this.ns+this.long0),t.x=s,t.y=r,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc"]},Id={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,i,n,r,s,o,a,l=t.x,h=t.y,u=ap(l-this.long0);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),n=-u*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),s=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(r)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),t.y=a*Math.cos(o)/1,t.x=a*Math.sin(o)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,i,n,r,s,o,a,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),s=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.atan2(t.y,t.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),i=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(e)),t.x=this.long0-i/this.alfa,o=e,a=0;var h=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-t.y)<1e-10&&(a=1),o=t.y,h+=1}while(0===a&&h<15);return h>=15?null:t},names:["Krovak","krovak"]};function Sd(t,e,i,n,r){return t*r-e*Math.sin(2*r)+i*Math.sin(4*r)-n*Math.sin(6*r)}function Ld(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function bd(t){return.375*t*(1+.25*t*(1+.46875*t))}function Rd(t){return.05859375*t*t*(1+.75*t)}function Nd(t){return t*t*t*(35/3072)}function Ad(t,e,i){var n=e*i;return t/Math.sqrt(1-n*n)}function Td(t){return Math.abs(t)<Ac?t:t-op(t)*Math.PI}function Pd(t,e,i,n,r){var s,o;s=t/e;for(var a=0;a<15;a++)if(s+=o=(t-(e*s-i*Math.sin(2*s)+n*Math.sin(4*s)-r*Math.sin(6*s)))/(e-2*i*Math.cos(2*s)+4*n*Math.cos(4*s)-6*r*Math.cos(6*s)),Math.abs(o)<=1e-10)return s;return NaN}const Od={init:function(){this.sphere||(this.e0=Ld(this.es),this.e1=bd(this.es),this.e2=Rd(this.es),this.e3=Nd(this.es),this.ml0=this.a*Sd(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,i,n=t.x,r=t.y;if(n=ap(n-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(n)),i=this.a*(Math.atan2(Math.tan(r),Math.cos(n))-this.lat0);else{var s=Math.sin(r),o=Math.cos(r),a=Ad(this.a,this.e,s),l=Math.tan(r)*Math.tan(r),h=n*Math.cos(r),u=h*h,c=this.es*o*o/(1-this.es);e=a*h*(1-u*l*(1/6-(8-l+8*c)*u/120)),i=this.a*Sd(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+a*s/o*u*(.5+(5-l+6*c)*u/24)}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n=t.x/this.a,r=t.y/this.a;if(this.sphere){var s=r+this.lat0;e=Math.asin(Math.sin(s)*Math.cos(n)),i=Math.atan2(Math.tan(n),Math.cos(s))}else{var o=Pd(this.ml0/this.a+r,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-Ac)<=Tc)return t.x=this.long0,t.y=Ac,r<0&&(t.y*=-1),t;var a=Ad(this.a,this.e,Math.sin(o)),l=a*a*a/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),u=n*this.a/a,c=u*u;e=o-a*Math.tan(o)/l*u*u*(.5-(1+3*h)*u*u/24),i=u*(1-c*(h/3+(1+3*h)*h*c/15))/Math.cos(o)}return t.x=ap(i+this.long0),t.y=Td(e),t},names:["Cassini","Cassini_Soldner","cass"]};function Dd(t,e){var i;return t>1e-7?(1-t*t)*(e/(1-(i=t*e)*i)-.5/t*Math.log((1-i)/(1+i))):2*e}const kd={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-Ac)<Tc?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<Tc?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=Dd(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,i=[];return i[0]=.3333333333333333*t,e=t*t,i[0]+=.17222222222222222*e,i[1]=.06388888888888888*e,e*=t,i[0]+=.10257936507936508*e,i[1]+=.0664021164021164*e,i[2]=.016415012942191543*e,i}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Dd(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,i,n,r,s,o,a,l,h,u,c=t.x,p=t.y;if(c=ap(c-this.long0),this.sphere){if(s=Math.sin(p),u=Math.cos(p),n=Math.cos(c),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+u*n:1+this.sinph0*s+this.cosph0*u*n)<=Tc)return null;e=(i=Math.sqrt(2/i))*u*Math.sin(c),i*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*u*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(p+this.lat0)<Tc)return null;i=Dc-.5*p,e=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(c),i*=n}}else{switch(a=0,l=0,h=0,n=Math.cos(c),r=Math.sin(c),s=Math.sin(p),o=Dd(this.e,s),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=o/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:h=1+this.sinb1*a+this.cosb1*l*n;break;case this.EQUIT:h=1+l*n;break;case this.N_POLE:h=Ac+p,o=this.qp-o;break;case this.S_POLE:h=p-Ac,o=this.qp+o}if(Math.abs(h)<Tc)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),i=this.mode===this.OBLIQ?this.ymf*h*(this.cosb1*a-this.sinb1*l*n):(h=Math.sqrt(2/(1+l*n)))*a*this.ymf,e=this.xmf*h*l*r;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(h=Math.sqrt(o))*r,i=n*(this.mode===this.S_POLE?h:-h)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n,r,s,o,a,l,h,u,c=t.x/this.a,p=t.y/this.a;if(this.sphere){var d,g=0,f=0;if((i=.5*(d=Math.sqrt(c*c+p*p)))>1)return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(f=Math.sin(i),g=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(d)<=Tc?0:Math.asin(p*f/d),c*=f,p=g*d;break;case this.OBLIQ:i=Math.abs(d)<=Tc?this.lat0:Math.asin(g*this.sinph0+p*f*this.cosph0/d),c*=f*this.cosph0,p=(g-Math.sin(i)*this.sinph0)*d;break;case this.N_POLE:p=-p,i=Ac-i;break;case this.S_POLE:i-=Ac}e=0!==p||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(c,p):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c/=this.dd,p*=this.dd,(o=Math.sqrt(c*c+p*p))<Tc)return t.x=this.long0,t.y=this.lat0,t;r=2*Math.asin(.5*o/this.rq),n=Math.cos(r),c*=r=Math.sin(r),this.mode===this.OBLIQ?(a=n*this.sinb1+p*r*this.cosb1/o,s=this.qp*a,p=o*this.cosb1*n-p*this.sinb1*r):(a=p*r/o,s=this.qp*a,p=o*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(p=-p),!(s=c*c+p*p))return t.x=this.long0,t.y=this.lat0,t;a=1-s/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(c,p),u=(l=Math.asin(a))+l,i=l+(h=this.apa)[0]*Math.sin(u)+h[1]*Math.sin(u+u)+h[2]*Math.sin(u+u+u)}return t.x=ap(this.long0+e),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function Fd(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}const Gd={init:function(){Math.abs(this.lat1+this.lat2)<Tc||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=sp(this.e3,this.sin_po,this.cos_po),this.qs1=Dd(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=sp(this.e3,this.sin_po,this.cos_po),this.qs2=Dd(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Dd(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>Tc?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var n=Dd(this.e3,this.sin_phi,this.cos_phi),r=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,s=this.ns0*ap(e-this.long0),o=r*Math.sin(s)+this.x0,a=this.rh-r*Math.cos(s)+this.y0;return t.x=o,t.y=a,t},inverse:function(t){var e,i,n,r,s,o;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),n=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),n=-1),r=0,0!==e&&(r=Math.atan2(n*t.x,n*t.y)),n=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-n*n)/(2*this.ns0)):(i=(this.c-n*n)/this.ns0,o=this.phi1z(this.e3,i)),s=ap(r/this.ns0+this.long0),t.x=s,t.y=o,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var i,n,r,s,o=Fd(.5*e);if(t<Tc)return o;for(var a=t*t,l=1;l<=25;l++)if(o+=s=.5*(r=1-(n=t*(i=Math.sin(o)))*n)*r/Math.cos(o)*(e/(1-a)-i/r+.5/t*Math.log((1-n)/(1+n))),Math.abs(s)<=1e-7)return o;return null}},Hd={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,i,n,r,s,o,a,l=t.x,h=t.y;return n=ap(l-this.long0),e=Math.sin(h),i=Math.cos(h),r=Math.cos(n),(s=this.sin_p14*e+this.cos_p14*i*r)>0||Math.abs(s)<=Tc?(o=this.x0+1*this.a*i*Math.sin(n)/s,a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*r)/s):(o=this.x0+this.infinity_dist*i*Math.sin(n),a=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*i*r)),t.x=o,t.y=a,t},inverse:function(t){var e,i,n,r,s,o;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(r=Math.atan2(e,this.rc),i=Math.sin(r),o=Fd((n=Math.cos(r))*this.sin_p14+t.y*i*this.cos_p14/e),s=Math.atan2(t.x*i,e*this.cos_p14*n-t.y*this.sin_p14*i),s=ap(this.long0+s)):(o=this.phic0,s=0),t.x=s,t.y=o,t},names:["gnom"]},Vd={init:function(){this.sphere||(this.k0=sp(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,i,n=t.x,r=t.y,s=ap(n-this.long0);if(this.sphere)e=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts);else{var o=Dd(this.e,Math.sin(r));e=this.x0+this.a*this.k0*s,i=this.y0+this.a*o*.5/this.k0}return t.x=e,t.y=i,t},inverse:function(t){var e,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=ap(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=function(t,e){var i=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-i)<1e-6)return e<0?-1*Ac:Ac;for(var n,r,s,o,a=Math.asin(.5*e),l=0;l<30;l++)if(r=Math.sin(a),s=Math.cos(a),o=t*r,a+=n=Math.pow(1-o*o,2)/(2*s)*(e/(1-t*t)-r/(1-o*o)+.5/t*Math.log((1-o)/(1+o))),Math.abs(n)<=1e-10)return a;return NaN}(this.e,2*t.y*this.k0/this.a),e=ap(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=i,t},names:["cea"]},jd={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,i=t.y,n=ap(e-this.long0),r=Td(i-this.lat0);return t.x=this.x0+this.a*n*this.rc,t.y=this.y0+this.a*r,t},inverse:function(t){var e=t.x,i=t.y;return t.x=ap(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=Td(this.lat0+(i-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},zd={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ld(this.es),this.e1=bd(this.es),this.e2=Rd(this.es),this.e3=Nd(this.es),this.ml0=this.a*Sd(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,i,n,r=t.x,s=t.y,o=ap(r-this.long0);if(n=o*Math.sin(s),this.sphere)Math.abs(s)<=Tc?(e=this.a*o,i=-1*this.a*this.lat0):(e=this.a*Math.sin(n)/Math.tan(s),i=this.a*(Td(s-this.lat0)+(1-Math.cos(n))/Math.tan(s)));else if(Math.abs(s)<=Tc)e=this.a*o,i=-1*this.ml0;else{var a=Ad(this.a,this.e,Math.sin(s))/Math.tan(s);e=a*Math.sin(n),i=this.a*Sd(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+a*(1-Math.cos(n))}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){var e,i,n,r,s,o,a,l,h;if(n=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=Tc)e=ap(n/this.a+this.long0),i=0;else{var u;for(o=this.lat0+r/this.a,a=n*n/this.a/this.a+o*o,l=o,s=20;s;--s)if(l+=h=-1*(o*(l*(u=Math.tan(l))+1)-l-.5*(l*l+a)*u)/((l-o)/u-1),Math.abs(h)<=Tc){i=l;break}e=ap(this.long0+Math.asin(n*Math.tan(l)/this.a)/Math.sin(i))}else if(Math.abs(r+this.ml0)<=Tc)i=0,e=ap(this.long0+n/this.a);else{var c,p,d,g,f;for(o=(this.ml0+r)/this.a,a=n*n/this.a/this.a+o*o,l=o,s=20;s;--s)if(f=this.e*Math.sin(l),c=Math.sqrt(1-f*f)*Math.tan(l),p=this.a*Sd(this.e0,this.e1,this.e2,this.e3,l),d=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=h=(o*(c*(g=p/this.a)+1)-g-.5*c*(g*g+a))/(this.es*Math.sin(2*l)*(g*g+a-2*o*g)/(4*c)+(o-g)*(c*d-2/Math.sin(2*l))-d),Math.abs(h)<=Tc){i=l;break}c=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=ap(this.long0+Math.asin(n*c/this.a)/Math.sin(i))}return t.x=e,t.y=i,t},names:["Polyconic","poly"]},Bd={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,i=t.x,n=t.y-this.lat0,r=i-this.long0,s=n/Nc*1e-5,o=r,a=1,l=0;for(e=1;e<=10;e++)a*=s,l+=this.A[e]*a;var h,u=l,c=o,p=1,d=0,g=0,f=0;for(e=1;e<=6;e++)h=d*u+p*c,p=p*u-d*c,d=h,g=g+this.B_re[e]*p-this.B_im[e]*d,f=f+this.B_im[e]*p+this.B_re[e]*d;return t.x=f*this.a+this.x0,t.y=g*this.a+this.y0,t},inverse:function(t){var e,i,n=t.x,r=t.y,s=n-this.x0,o=(r-this.y0)/this.a,a=s/this.a,l=1,h=0,u=0,c=0;for(e=1;e<=6;e++)i=h*o+l*a,l=l*o-h*a,h=i,u=u+this.C_re[e]*l-this.C_im[e]*h,c=c+this.C_im[e]*l+this.C_re[e]*h;for(var p=0;p<this.iterations;p++){var d,g=u,f=c,y=o,m=a;for(e=2;e<=6;e++)d=f*u+g*c,g=g*u-f*c,f=d,y+=(e-1)*(this.B_re[e]*g-this.B_im[e]*f),m+=(e-1)*(this.B_im[e]*g+this.B_re[e]*f);g=1,f=0;var _=this.B_re[1],v=this.B_im[1];for(e=2;e<=6;e++)d=f*u+g*c,g=g*u-f*c,f=d,_+=e*(this.B_re[e]*g-this.B_im[e]*f),v+=e*(this.B_im[e]*g+this.B_re[e]*f);var C=_*_+v*v;u=(y*_+m*v)/C,c=(m*_-y*v)/C}var x=u,w=c,M=1,E=0;for(e=1;e<=9;e++)M*=x,E+=this.D[e]*M;var I=this.lat0+E*Nc*1e5,S=this.long0+w;return t.x=S,t.y=I,t},names:["New_Zealand_Map_Grid","nzmg"]},Ud={init:function(){},forward:function(t){var e=t.x,i=t.y,n=ap(e-this.long0),r=this.x0+this.a*n,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=r,t.y=s,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=ap(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},names:["Miller_Cylindrical","mill"]},Zd={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ad(this.es)},forward:function(t){var e,i,n=t.x,r=t.y;if(n=ap(n-this.long0),this.sphere){if(this.m)for(var s=this.n*Math.sin(r),o=20;o;--o){var a=(this.m*r+Math.sin(r)-s)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<Tc)break}else r=1!==this.n?Math.asin(this.n*Math.sin(r)):r;e=this.a*this.C_x*n*(this.m+Math.cos(r)),i=this.a*this.C_y*r}else{var l=Math.sin(r),h=Math.cos(r);i=this.a*ld(r,l,h,this.en),e=this.a*n*h/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=Fd((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Fd(Math.sin(e)/this.n)),i=ap(i+this.long0),e=Td(e)):(e=hd(t.y/this.a,this.es,this.en),(n=Math.abs(e))<Ac?(n=Math.sin(e),i=ap(this.long0+t.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(e)))):n-Tc<Ac&&(i=this.long0)),t.x=i,t.y=e,t},names:["Sinusoidal","sinu"]},Yd={init:function(){},forward:function(t){for(var e=t.x,i=t.y,n=ap(e-this.long0),r=i,s=Math.PI*Math.sin(i);;){var o=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=o,Math.abs(o)<Tc)break}r/=2,Math.PI/2-Math.abs(i)<Tc&&(n=0);var a=.900316316158*this.a*n*Math.cos(r)+this.x0,l=1.4142135623731*this.a*Math.sin(r)+this.y0;return t.x=a,t.y=l,t},inverse:function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),e=Math.asin(i);var n=ap(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,Math.abs(i)>1&&(i=1);var r=Math.asin(i);return t.x=n,t.y=r,t},names:["Mollweide","moll"]},Wd={init:function(){Math.abs(this.lat1+this.lat2)<Tc||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ld(this.es),this.e1=bd(this.es),this.e2=Rd(this.es),this.e3=Nd(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=sp(this.e,this.sinphi,this.cosphi),this.ml1=Sd(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Tc?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=sp(this.e,this.sinphi,this.cosphi),this.ml2=Sd(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Sd(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,i=t.x,n=t.y;if(this.sphere)e=this.a*(this.g-n);else{var r=Sd(this.e0,this.e1,this.e2,this.e3,n);e=this.a*(this.g-r)}var s=this.ns*ap(i-this.long0),o=this.x0+e*Math.sin(s),a=this.y0+this.rh-e*Math.cos(s);return t.x=o,t.y=a,t},inverse:function(t){var e,i,n,r;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var s=0;return 0!==i&&(s=Math.atan2(e*t.x,e*t.y)),this.sphere?(r=ap(this.long0+s/this.ns),n=Td(this.g-i/this.a),t.x=r,t.y=n,t):(n=Pd(this.g-i/this.a,this.e0,this.e1,this.e2,this.e3),r=ap(this.long0+s/this.ns),t.x=r,t.y=n,t)},names:["Equidistant_Conic","eqdc"]},Xd={init:function(){this.R=this.a},forward:function(t){var e,i,n=t.x,r=t.y,s=ap(n-this.long0);Math.abs(r)<=Tc&&(e=this.x0+this.R*s,i=this.y0);var o=Fd(2*Math.abs(r/Math.PI));(Math.abs(s)<=Tc||Math.abs(Math.abs(r)-Ac)<=Tc)&&(e=this.x0,i=r>=0?this.y0+Math.PI*this.R*Math.tan(.5*o):this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/s-s/Math.PI),l=a*a,h=Math.sin(o),u=Math.cos(o),c=u/(h+u-1),p=c*c,d=c*(2/h-1),g=d*d,f=Math.PI*this.R*(a*(c-g)+Math.sqrt(l*(c-g)*(c-g)-(g+l)*(p-g)))/(g+l);s<0&&(f=-f),e=this.x0+f;var y=l+c;return f=Math.PI*this.R*(d*y-a*Math.sqrt((g+l)*(l+1)-y*y))/(g+l),i=r>=0?this.y0+f:this.y0-f,t.x=e,t.y=i,t},inverse:function(t){var e,i,n,r,s,o,a,l,h,u,c,p;return t.x-=this.x0,t.y-=this.y0,c=Math.PI*this.R,s=(n=t.x/c)*n+(r=t.y/c)*r,c=3*(r*r/(l=-2*(o=-Math.abs(r)*(1+s))+1+2*r*r+s*s)+(2*(a=o-2*r*r+n*n)*a*a/l/l/l-9*o*a/l/l)/27)/(h=(o-a*a/3/l)/l)/(u=2*Math.sqrt(-h/3)),Math.abs(c)>1&&(c=c>=0?1:-1),p=Math.acos(c)/3,i=t.y>=0?(-u*Math.cos(p+Math.PI/3)-a/3/l)*Math.PI:-(-u*Math.cos(p+Math.PI/3)-a/3/l)*Math.PI,e=Math.abs(n)<Tc?this.long0:ap(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(n*n-r*r)+s*s))/2/n),t.x=e,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},qd={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,i,n,r,s,o,a,l,h,u,c,p,d,g,f,y,m,_,v,C,x,w,M=t.x,E=t.y,I=Math.sin(t.y),S=Math.cos(t.y),L=ap(M-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=Tc?(t.x=this.x0+this.a*(Ac-E)*Math.sin(L),t.y=this.y0-this.a*(Ac-E)*Math.cos(L),t):Math.abs(this.sin_p12+1)<=Tc?(t.x=this.x0+this.a*(Ac+E)*Math.sin(L),t.y=this.y0+this.a*(Ac+E)*Math.cos(L),t):(_=this.sin_p12*I+this.cos_p12*S*Math.cos(L),m=(y=Math.acos(_))?y/Math.sin(y):1,t.x=this.x0+this.a*m*S*Math.sin(L),t.y=this.y0+this.a*m*(this.cos_p12*I-this.sin_p12*S*Math.cos(L)),t):(e=Ld(this.es),i=bd(this.es),n=Rd(this.es),r=Nd(this.es),Math.abs(this.sin_p12-1)<=Tc?(s=this.a*Sd(e,i,n,r,Ac),o=this.a*Sd(e,i,n,r,E),t.x=this.x0+(s-o)*Math.sin(L),t.y=this.y0-(s-o)*Math.cos(L),t):Math.abs(this.sin_p12+1)<=Tc?(s=this.a*Sd(e,i,n,r,Ac),o=this.a*Sd(e,i,n,r,E),t.x=this.x0+(s+o)*Math.sin(L),t.y=this.y0+(s+o)*Math.cos(L),t):(a=I/S,l=Ad(this.a,this.e,this.sin_p12),h=Ad(this.a,this.e,I),u=Math.atan((1-this.es)*a+this.es*l*this.sin_p12/(h*S)),v=0===(c=Math.atan2(Math.sin(L),this.cos_p12*Math.tan(u)-this.sin_p12*Math.cos(L)))?Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):Math.abs(Math.abs(c)-Math.PI)<=Tc?-Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):Math.asin(Math.sin(L)*Math.cos(u)/Math.sin(c)),p=this.e*this.sin_p12/Math.sqrt(1-this.es),y=l*v*(1-(C=v*v)*(f=(d=this.e*this.cos_p12*Math.cos(c)/Math.sqrt(1-this.es))*d)*(1-f)/6+(x=C*v)/8*(g=p*d)*(1-2*f)+(w=x*v)/120*(f*(4-7*f)-3*p*p*(1-7*f))-w*v/48*g),t.x=this.x0+y*Math.sin(c),t.y=this.y0+y*Math.cos(c),t))},inverse:function(t){var e,i,n,r,s,o,a,l,h,u,c,p,d,g,f,y,m,_,v,C,x,w,M;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*Ac*this.a)return;return i=e/this.a,n=Math.sin(i),r=Math.cos(i),s=this.long0,Math.abs(e)<=Tc?o=this.lat0:(o=Fd(r*this.sin_p12+t.y*n*this.cos_p12/e),a=Math.abs(this.lat0)-Ac,s=Math.abs(a)<=Tc?this.lat0>=0?ap(this.long0+Math.atan2(t.x,-t.y)):ap(this.long0-Math.atan2(-t.x,t.y)):ap(this.long0+Math.atan2(t.x*n,e*this.cos_p12*r-t.y*this.sin_p12*n))),t.x=s,t.y=o,t}return l=Ld(this.es),h=bd(this.es),u=Rd(this.es),c=Nd(this.es),Math.abs(this.sin_p12-1)<=Tc?(o=Pd(((p=this.a*Sd(l,h,u,c,Ac))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,l,h,u,c),s=ap(this.long0+Math.atan2(t.x,-1*t.y)),t.x=s,t.y=o,t):Math.abs(this.sin_p12+1)<=Tc?(p=this.a*Sd(l,h,u,c,Ac),o=Pd(((e=Math.sqrt(t.x*t.x+t.y*t.y))-p)/this.a,l,h,u,c),s=ap(this.long0+Math.atan2(t.x,t.y)),t.x=s,t.y=o,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),f=Math.atan2(t.x,t.y),d=Ad(this.a,this.e,this.sin_p12),y=Math.cos(f),_=-(m=this.e*this.cos_p12*y)*m/(1-this.es),v=3*this.es*(1-_)*this.sin_p12*this.cos_p12*y/(1-this.es),w=1-_*(x=(C=e/d)-_*(1+_)*Math.pow(C,3)/6-v*(1+3*_)*Math.pow(C,4)/24)*x/2-C*x*x*x/6,g=Math.asin(this.sin_p12*Math.cos(x)+this.cos_p12*Math.sin(x)*y),s=ap(this.long0+Math.asin(Math.sin(f)*Math.sin(x)/Math.cos(g))),M=Math.sin(g),o=Math.atan2((M-this.es*w*this.sin_p12)*Math.tan(g),M*(1-this.es)),t.x=s,t.y=o,t)},names:["Azimuthal_Equidistant","aeqd"]},Kd={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,i,n,r,s,o,a,l=t.x,h=t.y;return n=ap(l-this.long0),e=Math.sin(h),i=Math.cos(h),r=Math.cos(n),((s=this.sin_p14*e+this.cos_p14*i*r)>0||Math.abs(s)<=Tc)&&(o=1*this.a*i*Math.sin(n),a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*r)),t.x=o,t.y=a,t},inverse:function(t){var e,i,n,r,s,o,a;return t.x-=this.x0,t.y-=this.y0,i=Fd((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),n=Math.sin(i),r=Math.cos(i),o=this.long0,Math.abs(e)<=Tc?(a=this.lat0,t.x=o,t.y=a,t):(a=Fd(r*this.sin_p14+t.y*n*this.cos_p14/e),s=Math.abs(this.lat0)-Ac,Math.abs(s)<=Tc?(o=this.lat0>=0?ap(this.long0+Math.atan2(t.x,-t.y)):ap(this.long0-Math.atan2(-t.x,t.y)),t.x=o,t.y=a,t):(o=ap(this.long0+Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n)),t.x=o,t.y=a,t))},names:["ortho"]};function Jd(t,e,i,n){var r;return t<Tc?(n.value=1,r=0):(r=Math.atan2(e,i),Math.abs(r)<=Dc?n.value=1:r>Dc&&r<=Ac+Dc?(n.value=2,r-=Ac):r>Ac+Dc||r<=-(Ac+Dc)?(n.value=3,r=r>=0?r-Fc:r+Fc):(n.value=4,r+=Ac)),r}function Qd(t,e){var i=t+e;return i<-Fc?i+=kc:i>+Fc&&(i-=kc),i}const $d={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Ac-Dc/2?this.face=5:this.lat0<=-(Ac-Dc/2)?this.face=6:Math.abs(this.long0)<=Dc?this.face=1:Math.abs(this.long0)<=Ac+Dc?this.face=this.long0>0?2:4:this.face=3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,i,n,r,s,o,a={x:0,y:0},l={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,5===this.face)r=Ac-e,i>=Dc&&i<=Ac+Dc?(l.value=1,n=i-Ac):i>Ac+Dc||i<=-(Ac+Dc)?(l.value=2,n=i>0?i-Fc:i+Fc):i>-(Ac+Dc)&&i<=-Dc?(l.value=3,n=i+Ac):(l.value=4,n=i);else if(6===this.face)r=Ac+e,i>=Dc&&i<=Ac+Dc?(l.value=1,n=-i+Ac):i<Dc&&i>=-Dc?(l.value=2,n=-i):i<-Dc&&i>=-(Ac+Dc)?(l.value=3,n=-i-Ac):(l.value=4,n=i>0?-i+Fc:-i-Fc);else{var h,u,c,p,d,g;2===this.face?i=Qd(i,+Ac):3===this.face?i=Qd(i,+Fc):4===this.face&&(i=Qd(i,-Ac)),p=Math.sin(e),d=Math.cos(e),g=Math.sin(i),h=d*Math.cos(i),u=d*g,c=p,1===this.face?n=Jd(r=Math.acos(h),c,u,l):2===this.face?n=Jd(r=Math.acos(u),c,-h,l):3===this.face?n=Jd(r=Math.acos(-h),c,-u,l):4===this.face?n=Jd(r=Math.acos(-u),c,h,l):(r=n=0,l.value=1)}return o=Math.atan(12/Fc*(n+Math.acos(Math.sin(n)*Math.cos(Dc))-Ac)),s=Math.sqrt((1-Math.cos(r))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(n))))),2===l.value?o+=Ac:3===l.value?o+=Fc:4===l.value&&(o+=1.5*Fc),a.x=s*Math.cos(o),a.y=s*Math.sin(o),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,t.x=a.x,t.y=a.y,t},inverse:function(t){var e,i,n,r,s,o,a,l,h,u,c,p,d={lam:0,phi:0},g={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?g.value=1:t.y>=0&&t.y>=Math.abs(t.x)?(g.value=2,e-=Ac):t.x<0&&-t.x>=Math.abs(t.y)?(g.value=3,e=e<0?e+Fc:e-Fc):(g.value=4,e+=Ac),h=Fc/12*Math.tan(e),s=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(s),(a=1-(n=Math.cos(e))*n*(r=Math.tan(i))*r*(1-Math.cos(Math.atan(1/Math.cos(o)))))<-1?a=-1:a>1&&(a=1),5===this.face)l=Math.acos(a),d.phi=Ac-l,1===g.value?d.lam=o+Ac:2===g.value?d.lam=o<0?o+Fc:o-Fc:3===g.value?d.lam=o-Ac:d.lam=o;else if(6===this.face)l=Math.acos(a),d.phi=l-Ac,1===g.value?d.lam=-o+Ac:2===g.value?d.lam=-o:3===g.value?d.lam=-o-Ac:d.lam=o<0?-o-Fc:-o+Fc;else{var f,y,m;h=(f=a)*f,y=(h+=(m=h>=1?0:Math.sqrt(1-h)*Math.sin(o))*m)>=1?0:Math.sqrt(1-h),2===g.value?(h=y,y=-m,m=h):3===g.value?(y=-y,m=-m):4===g.value&&(h=y,y=m,m=-h),2===this.face?(h=f,f=-y,y=h):3===this.face?(f=-f,y=-y):4===this.face&&(h=f,f=y,y=-h),d.phi=Math.acos(-m)-Ac,d.lam=Math.atan2(y,f),2===this.face?d.lam=Qd(d.lam,-Ac):3===this.face?d.lam=Qd(d.lam,-Fc):4===this.face&&(d.lam=Qd(d.lam,+Ac))}return 0!==this.es&&(u=d.phi<0?1:0,c=Math.tan(d.phi),p=this.b/Math.sqrt(c*c+this.one_minus_f_squared),d.phi=Math.atan(Math.sqrt(this.a*this.a-p*p)/(this.one_minus_f*p)),u&&(d.phi=-d.phi)),d.lam+=this.long0,t.x=d.lam,t.y=d.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var tg=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],eg=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],ig=.8487,ng=1.3523,rg=Oc/5,sg=1/rg,og=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};const ag={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=ap(t.x-this.long0),i=Math.abs(t.y),n=Math.floor(i*rg);n<0?n=0:n>=18&&(n=17);var r={x:og(tg[n],i=Oc*(i-sg*n))*e,y:og(eg[n],i)};return t.y<0&&(r.y=-r.y),r.x=r.x*this.a*ig+this.x0,r.y=r.y*this.a*ng+this.y0,r},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*ig),y:Math.abs(t.y-this.y0)/(this.a*ng)};if(e.y>=1)e.x/=tg[18][0],e.y=t.y<0?-Ac:Ac;else{var i=Math.floor(18*e.y);for(i<0?i=0:i>=18&&(i=17);;)if(eg[i][0]>e.y)--i;else{if(!(eg[i+1][0]<=e.y))break;++i}var n=eg[i],r=5*(e.y-n[0])/(eg[i+1][0]-n[0]);r=function(t,e,i,n){for(var r=e;n;--n){var s=t(r);if(r-=s,Math.abs(s)<1e-10)break}return r}((function(t){return(og(n,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(n,t)}),r,0,100),e.x/=og(tg[i],r),e.y=(5*i+r)*Pc,t.y<0&&(e.y=-e.y)}return e.x=ap(e.x+this.long0),e},names:["Robinson","robin"]},lg={init:function(){this.name="geocent"},forward:function(t){return bp(t,this.es,this.a)},inverse:function(t){return Rp(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var hg={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const ug={init:function(){if(Object.keys(hg).forEach(function(t){if(void 0===this[t])this[t]=hg[t].def;else{if(hg[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);hg[t].num&&(this[t]=parseFloat(this[t]))}hg[t].degrees&&(this[t]=this[t]*Pc)}.bind(this)),Math.abs(Math.abs(this.lat0)-Ac)<Tc?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<Tc?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,i,n,r,s=Math.sin(t.y),o=Math.cos(t.y),a=Math.cos(t.x);switch(this.mode){case 3:i=this.sinph0*s+this.cosph0*o*a;break;case 2:i=o*a;break;case 1:i=-s;break;case 0:i=s}switch(e=(i=this.pn1/(this.p-i))*o*Math.sin(t.x),this.mode){case 3:i*=this.cosph0*s-this.sinph0*o*a;break;case 2:i*=s;break;case 0:i*=-o*a;break;case 1:i*=o*a}return r=1/((n=i*this.cg+e*this.sg)*this.sw*this.h1+this.cw),e=(e*this.cg-i*this.sg)*this.cw*r,i=n*r,t.x=e*this.a,t.y=i*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,i,n,r={x:t.x,y:t.y};n=1/(this.pn1-t.y*this.sw),e=this.pn1*t.x*n,i=this.pn1*t.y*this.cw*n,t.x=e*this.cg+i*this.sg,t.y=i*this.cg-e*this.sg;var s=pd(t.x,t.y);if(Math.abs(s)<Tc)r.x=0,r.y=t.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case 3:r.y=Math.asin(o*this.sinph0+t.y*a*this.cosph0/s),t.y=(o-this.sinph0*Math.sin(r.y))*s,t.x*=a*this.cosph0;break;case 2:r.y=Math.asin(t.y*a/s),t.y=o*s,t.x*=a;break;case 0:r.y=Math.asin(o),t.y=-t.y;break;case 1:r.y=-Math.asin(o)}r.x=Math.atan2(t.x,t.y)}return t.x=r.x+this.long0,t.y=r.y,t},names:["Tilted_Perspective","tpers"]};var cg;jp.defaultDatum="WGS84",jp.Proj=Lp,jp.WGS84=new jp.Proj("WGS84"),jp.Point=nd,jp.toPoint=Dp,jp.defs=ep,jp.nadgrid=function(t,e){var i=new DataView(e),n=function(t){var e=t.getInt32(8,!1);return 11!==e&&(11!==(e=t.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(i),r=function(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:wp(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}(i,n);r.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var s=function(t,e,i){for(var n=[],r=0;r<e.nSubgrids;r++){var s=Ep(t,176,i),o=Ip(t,176,s,i),a=Math.round(1+(s.upperLongitude-s.lowerLongitude)/s.longitudeInterval),l=Math.round(1+(s.upperLatitude-s.lowerLatitude)/s.latitudeInterval);n.push({ll:[xp(s.lowerLongitude),xp(s.lowerLatitude)],del:[xp(s.longitudeInterval),xp(s.latitudeInterval)],lim:[a,l],count:s.gridNodeCount,cvs:Mp(o)})}return n}(i,r,n),o={header:r,subgrids:s};return vp[t]=o,o},jp.transform=Fp,jp.mgrs=Wp,jp.version="__VERSION__",(cg=jp).Proj.projections.add(ud),cg.Proj.projections.add(fd),cg.Proj.projections.add(yd),cg.Proj.projections.add(vd),cg.Proj.projections.add(Cd),cg.Proj.projections.add(xd),cg.Proj.projections.add(Md),cg.Proj.projections.add(Ed),cg.Proj.projections.add(Id),cg.Proj.projections.add(Od),cg.Proj.projections.add(kd),cg.Proj.projections.add(Gd),cg.Proj.projections.add(Hd),cg.Proj.projections.add(Vd),cg.Proj.projections.add(jd),cg.Proj.projections.add(zd),cg.Proj.projections.add(Bd),cg.Proj.projections.add(Ud),cg.Proj.projections.add(Zd),cg.Proj.projections.add(Yd),cg.Proj.projections.add(Wd),cg.Proj.projections.add(Xd),cg.Proj.projections.add(qd),cg.Proj.projections.add(Kd),cg.Proj.projections.add($d),cg.Proj.projections.add(ag),cg.Proj.projections.add(lg),cg.Proj.projections.add(ug);const pg=jp;window.skatGlobalvariables,pg.defs([["EPSG:25832","+proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs"],["EPSG:900913","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"],["EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"]]),function(t){Ss=t;const e=Object.keys(t.defs),i=e.length;let n,r;for(n=0;n<i;++n){const i=e[n];if(!oi(i)){const e=t.defs(i);let n=e.units;n||"longlat"!==e.projName||(n="degrees"),si(new be({code:i,axisOrientation:e.axis,metersPerUnit:e.to_meter,units:n}))}}for(n=0;n<i;++n){const s=e[n],o=oi(s);for(r=0;r<i;++r){const i=e[r],n=oi(i);if(!Be(s,i))if(t.defs[s]===t.defs[i])li([o,n]);else{const e=t(s,i);ci(o,n,Ei(o,n,e.forward),Ei(n,o,e.inverse))}}}}(pg);class dg{}dg.prepend="",dg.append="";class gg{static getToken(){let t=Math.random()*gg.length;return gg.token[t]}}gg.token=["8da8dfc3cf4c0e6fee78028a7e5907e7"],gg.url="https://api.dataforsyningen.dk/",gg.dawaUrl="https://dawa.aws.dk";class fg{static getDAFUrl(){return"https://services.datafordeler.dk/"}static getDAFLogin(){return"username=USWEWZEWFN&password=1RFP!d4cZd.AG!b5v68f"}}class yg{}var mg;yg.error="Der skete en fejl",yg.mapDivError="Kort elementet blev ikke fundet",yg.ajaxConnectionError="Der skete en fejl under kaldet til en webservice.",yg.serviceParserError="Svaret fra webservicen kunne ikke fortolkes.",yg.reload="Prøv igen",yg.zoomUseCtrlToZoom="Brug [ctrl] og musehjul til at zoome i kortet",yg.touchUseToFingersToPan="Brug 2 fingre til at panorere i kortet",yg.timeout="Forbindelse til servicen kunne ikke gennemføres, grundet for lang svartid fra servicen.",function(t){t[t.uknError=1]="uknError",t[t.mapElemMissing=2]="mapElemMissing",t[t.paramError=100]="paramError"}(mg||(mg={}));class _g{}_g.timeoutLength=5e3;class vg{static setEndpointUrl(t){vg.endPointUrl=t}static setWWWVersion(t){vg.wwwVersion=t}static getImagePath(t=!0){return vg.endPointUrl.indexOf("http://localhost")>-1||vg.endPointUrl.indexOf("https://localhost")>-1?"/images/SKAT/"+(t?"BaseMap/":""):vg.endPointUrl+"images/SKAT/"+(t?"BaseMap/":"")}}vg.endPointUrl="",vg.wwwVersion="";const Cg="<a href='https://www.sdfe.dk' target='_blank'>&copy; Styrelsen for Dataforsyning og Effektivisering</a>",xg=[12e4,59e5,1e6,65e5];class wg{constructor(t){Object.assign(this,t)}}class Mg{constructor(t){this.id=gc.generateGUID(),this.visible=!0,this.opacity=1,this.minResolution=null,this.maxResolution=null,this.type=null,this.serviceStatusInformations=null,this.isBackgroundLayer=!1,this.events=null,this.isWMTS=!1,this.name=null,this.extent=void 0,Object.assign(this,t)}}class Eg{constructor(t,e){if(this.options=null,this.map=null,this.layer=null,null===t)throw"Layer must be defined";this.options=e instanceof Mg?e:e?new Mg(e):new Mg,this.layer=t,this.layer.setOpacity(this.options.opacity),this.layer.setVisible(this.options.visible),this.options.minResolution&&this.layer.setMinResolution(this.options.minResolution),this.options.maxResolution&&this.layer.setMaxResolution(this.options.maxResolution),this.layer.set("id",this.options.id),this.layer.set("type",this.options.type),this.layer.set("isBackgroundLayer",this.options.isBackgroundLayer),this.layer.set("name",this.options.name),this.addLoadEvent()}setMap(t){if(null===t)throw new Error("map cannot be null");this.map=t,this.addEventsToLayer()}setZIndex(t){this.layer.setZIndex(t)}getId(){return this.layer.get("id")}getZIndex(){return this.layer.getZIndex()}setVisible(t){this.layer&&this.layer.setVisible(t)}getVisible(){return this.layer.getVisible()}setOpacity(t){this.layer.setOpacity(t)}getLayerName(){return this.layer.get("name")}getOLLayer(){return this.layer}registerServiceStatusInformations(t){this.options.serviceStatusInformations&&t.registerLayer(this.options.serviceStatusInformations)}supportMask(){return!1}updateMaskGeometry(t){}supportMarkers(){return!1}isBackgroundLayer(){return this.options.isBackgroundLayer}updateMarkers(t){}addEventsToLayer(){let t=this;this.options.events&&this.options.events.baseLayerChange&&this.map.getLayers().forEach((function(e){let i=e.getOLLayer();i&&i.get("isBackgroundLayer")&&i.on("change:visible",(function(e){e.oldValue||t.options.events.baseLayerChange.apply(t.layer,[i])}))}))}addLoadEvent(){this.layer instanceof xr?(this.layer,this.layer.getLayers().forEach((function(t){t.getSource().on("tileloaderror",(function(t){var e=t.tile.retries?t.tile.retries:0;e<5&&(e++,t.tile.retries=e,t.tile.load())}))}))):this.layer.getSource().on("tileloaderror",(function(t){var e=t.tile.retries?t.tile.retries:0;e<5&&(e++,t.tile.retries=e,t.tile.load())}))}}class Ig{constructor(t){this.testFunction=null,this.status=null,Object.assign(this,t)}}var Sg;!function(t){t.OK="OK",t.PARTIAL="Virker delvist",t.ERROR="Fejlede",t.UKN="Ukendt"}(Sg||(Sg={}));class Lg{constructor(t){this.layerInfo=[],this.attempts=0}registerLayer(t){if(null==t)throw"Missing layer entry";t.id=gc.generateGUID(),t.status=null,this.layerInfo.push(t)}renderStatus(){var t,e=document.getElementById("SKAT.BaseMap.ServiceStatus");e?e.innerHTML="":((e=document.createElement("div")).id="SKAT.BaseMap.ServiceStatus",e.innerHTML="<strong>Drift status</strong><ul></ul>",t=e.children[1]);for(var i=0;i<this.layerInfo.length;i++){var n=document.createElement("li");n.id=this.layerInfo[i].id;var r=document.createElement("span");r.innerHTML=this.layerInfo[i].label,n.title="service: "+this.layerInfo[i].name,n.appendChild(r);var s=document.createElement("span");s.id=n.id+"_status";var o=this.layerInfo[i].status?this.layerInfo[i].status:Sg.UKN;s.innerHTML+=" Service "+o,t&&t.appendChild(n)}return e}testServiceStatus(){var t=this.layerInfo.length;this.attempts=0;for(var e=0;e<this.layerInfo.length;e++)this.testRessource(this.layerInfo[e],(function(e){0==--t&&this.updateResult()}))}updateResult(){for(var t=0;t<this.layerInfo.length;t++){var e=document.getElementById(this.layerInfo[t].id);if(!e)return this.attempts++,void(this.attempts<10&&setTimeout(this.updateResult,200));var i=this.layerInfo[t].status?this.layerInfo[t].status:"ukendt";e.title+=", Status "+i,e.className=i.toLowerCase()}}testRessource(t,e){t.status=null;let i=t.testUrls;var n=i.slice(0),r=0,s=0;!function e(n,o){var a=n.pop();a?fetch(a).then((function(t){return t.ok?t.text():null})).then(function(a){a?(t.testFunction?t.testFunction(a)?r++:s++:a.indexOf("<ServiceException>")>-1?s++:r++,r+s<i.length?e(n,o):o()):s++}.bind(this)).catch(function(t){s++,r+s<i.length?e(n,o):o()}.bind(this)):o()}(n,(function(){r===i.length?t.status=Sg.OK:t.status=r>0&&s>0?Sg.PARTIAL:s>0?Sg.ERROR:Sg.UKN,e(t)}))}}class bg{constructor(t){this.layer=null,this.label=null,this.service=null,Object.assign(this,t)}}class Rg extends Mg{constructor(t){super(t),this.wmsServiceStatusOptions=null,Object.assign(this,t)}}class Ng extends Eg{constructor(t,e){super(t,e)}registerServiceStatusInformations(t){let e=this.layer.getSource();if(null===e)return!1;let i=null;e instanceof Vh?i=[e.getUrl()]:e instanceof Hh?i=e.getUrls():console.error("source not supported");let n=this.options&&this.options.wmsServiceStatusOptions?this.options.wmsServiceStatusOptions:null;if(null===i)return!1;var r=n&&n.layer?n.layer:null,s=n&&n.label?n.label:"WMS lag",o=n&&n.service?n.service:"WMS service";if(null===r)return;i=gc.appendParamsToUrl(i,"&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&FORMAT=image%2Fpng&TRANSPARENT=TRUE&layers="+r+"&style=default&WIDTH=25&HEIGHT=25&CRS=EPSG%3A25832&STYLES=&BBOX=724672%2C6176467.2%2C724697.6%2C6176492.8");let a=new Ig({name:o,label:s,testUrls:i});t.registerLayer(a)}}Ng.Type="SKAT.BaseMap.Layer.WMS";class Ag extends Ng{constructor(t){(t=t||new Rg({visible:!1})).type="SKAT.BaseMap.Layer.WMS.Ortofoto",t.isBackgroundLayer=!0,t.name=t.name?t.name:"Ortofoto";let e={attributions:Cg,url:fg.getDAFUrl()+"GeoDanmarkOrto/orto_foraar/1.0.0/WMS?"+fg.getDAFLogin(),params:{LAYERS:"orto_foraar",STYLES:"default",TRANSPARENT:"FALSE",FORMAT:"image/jpeg"},ratio:1};t.wmsServiceStatusOptions=new bg({label:"Datafordeleren Ortoforår (WMS)",service:"orto_foraar",layer:e.params.LAYERS}),super(new lo({source:new Hh(e)}),t)}}class Tg extends Rg{constructor(t){super(t),this.useDimLayer=!0,this.useGrayLayer=!1,Object.assign(this,t)}}class Pg extends Ng{constructor(t){(t=t?t instanceof Tg?t:new Tg(t):new Tg).type="SKAT.BaseMap.Layer.WMS.Skaermkort",t.isBackgroundLayer=!0,t.name=t.name?t.name:"Skærmkort";let e=t.useDimLayer?"dtk_skaermkort_daempet":t.useGrayLayer?"dtk_skaermkort_graa":"dtk_skaermkort",i="topo_skaermkort",n={attributions:Cg,urls:[fg.getDAFUrl()+"Dkskaermkort/"+i+"/1.0.0/wms?"+fg.getDAFLogin()],params:{LAYERS:e,STYLES:"default",TRANSPARENT:"FALSE",FORMAT:"image/jpeg"},ratio:1};t.wmsServiceStatusOptions=new bg({label:"Datafordeleren Skærmkort (WMS)",service:i,layer:n.params.LAYERS}),super(new lo({source:new Hh(n)}),t)}}class Og extends yc{constructor(t){super(t),this.toogleLayers=null,Object.assign(this,t),this.toogleLayers=this.toogleLayers?this.toogleLayers:[new Ag,new Pg]}}class Dg extends mc{constructor(t){super(t=t||new Og)}renderElem(){return new kg(this.options)}activateShortcut(){this.olControl.addShortcut()}}class kg extends Fs{constructor(t){let e=[],i=null;for(let i=0;i<t.toogleLayers.length;i++)e.push(t.toogleLayers[i].getOLLayer());super({collapsible:!1,collapsed:!1,layers:e,rotateWithView:!1,tipLabel:"",render:function(t){i.updateCenter.call(i,t)},target:t.target?t.target:void 0}),this._options=t,i=this,this.renderChangeLayerFunctionality(),this._toogleIndex=0}setMap(t){super.setMap(t),this._mapView=t.getView(),this._maxZoomLevel=this._mapView.getMaxZoom(),this._owMapView=this.getOverviewMap().getView()}addShortcut(){this.element.title="Skift korttype (ctrl + y)",this.element.setAttribute("aria-label","Skift korttype (ctrl + y)"),document.addEventListener("keyup",function(t){t.ctrlKey&&"y"===t.key&&this.toogleLayer()}.bind(this),!1)}updateCenter(t){let e=this._mapView.getZoom();this._owMapView.setZoom(e-2>0?e-3:1),this._owMapView.setCenter(this._mapView.getCenter())}renderChangeLayerFunctionality(){let t=this._options.toogleLayers[1].getLayerName(),e=this.element.querySelector("button");e.parentElement.removeChild(e),this._layerNameParentElem=document.createElement("button"),this._layerNameParentElem.type="button",this._layerNameParentElem.className="layername",this._layerNameParentElem.setAttribute("aria-label","Skift korttype til "+t),this._layerNameElem=document.createElement("span"),this._layerNameElem.innerHTML=t,this._layerNameParentElem.appendChild(this._layerNameElem),this.element.appendChild(this._layerNameParentElem),this.element.addEventListener("click",this.toogleLayer.bind(this)),this.element.title="Skift korttype",this._layerNameParentElem.title=this.element.title}toogleLayer(){let t,e=this.getMap().getLayers(),i=null,n=null;this._toogleIndex+1<this._options.toogleLayers.length?(t=this._toogleIndex,this._toogleIndex++):(this._toogleIndex=0,t=this._options.toogleLayers.length-1);let r=this._options.toogleLayers[t].getLayerName(),s=this._options.toogleLayers[this._toogleIndex].getLayerName();for(let t=0;t<e.getLength();t++){let o=e.item(t);o.get("name")==r?i=o:o.get("name")==s&&(n=o)}i&&n?(i.setVisible(!1),n.setVisible(!0),this._layerNameElem.innerHTML=i.get("name"),this._layerNameParentElem.setAttribute("aria-label","Skift korttype til "+i.get("name")),this._options.toogleLayers[t].setVisible(!0),this._options.toogleLayers[this._toogleIndex].setVisible(!1)):console.log("missing layer: currentlayer="+i+", newlayer="+n)}}class Fg extends yc{constructor(t){super(t),this.buttonText=wc(xc.changeLayer),this.target=null,Object.assign(this,t)}}class Gg extends mc{constructor(t){super(t=t||new Fg)}renderElem(){return new Hg(this.options)}}class Hg extends Fr{constructor(t){let e=document.createElement("div");e.className="SKAT-BaseMap-SimpleLayerSwitcherControl ufst-simple-layer-switcher-control ol-unselectable",e.title=t.buttonText,e.ariaLabel=t.buttonText;var i=document.createElement("img");i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABUCAYAAAAVgLC7AAAACXBIWXMAABcRAAAXEQHKJvM/AAAEI0lEQVR42u3cv32bQBQH8J9ZwN7A3sCkpbE2iDJByARROrqQji7yBpcJokxgpaG1vIG8gTWBUvjIBxvQ3b379xC8MilAP+4L3L3DF8fjEVwry4sFANSi2nI9xwuOAWZ5cQVgA+BO/tMTgGUtqj23c02Yjrp9KzwAuAWwy/JiOQd4OrwSwAOAy57/vgTwO8uL9UxYTVZVbEgnTMmqig3phDFZVbEgHYUwgawO6UUtqpezH4FEsjqk981749kGaElWh/SDPMZ5EfZAVlV/5VP6ZfQj0BNZVd2FIp2MmCwL0l4IRyAbjXRyJmSjkU7OiKwu6RU7wgzJquoPgNwFaesAJYsN01F3qp7lfXEXjTBzsqq6BvBoS5o0AkdI1htp4wCzvEgBbEc66pyTTgzDWwF4PMPwyKS1RqAkKwB8xDRKm7QyQEl2I6/QlEqLdKJJdmrhNaS3WV7kxiNwgmRV9QvAqo90J8AJk1XVk7wv7gYJT5ysqm77SF8cj8eZrAXpJsDtGc0qQpJeNoTTOQ8S6bIJcAXgMGdiXPv/T+H56WtcP2pRlW9eY+aHiVYd5Axle+pFegXg55xVpzrNqcG58Ey6n6zRYsJMukvWKMCZtLqfrL0iPUHSvWTJAU6I9EmyVgFOgLTxFhByX3jE/WArss4CbJEee3vTiKzTAFtBlgC+T4GslwBHSppE1luAIyJtRdZrgCMg7Xyjpc5UDpQDMiTthKx2gK0AQB3y8gJs8bp6Ozqy8vzXANZDDfah5aw+guQrKD/H+hohPPJHiT1T12+1qNYnA9R4CJDvIfLDQBGQ9H0tqhXxgg/NtDp7ZtpL+rr3LBsSN/IYt57J5rWoNkSyqrn+mz0zTVuTMrflSNolWVV9qUUlmgCp7zKcSPsgqxxESSsISjXfXxj3lSWxVI4aW7KfKOFleXGV5cUG9JWltAlwidftCpS6BHGzdi2qfS2qFMC9BdmUeL9LAexAX9t8BtBpa+byvYfKirxZm3DsGGQ7v3Noe5uweFKSv7/QPLbvp6yq3rwPJj2sdgAWFqSvLUirjh2b7If3L9OquTAn0izIGq/GRCZ9AyAHsONClrScFeJEPCyp2bZhtS68aVvTlsLgZm3H4XkjaxWgoyvbu1nbUXDBpdh8bGhzogc5EgUjsge8/vEeowtr29ZkQdrBeZDn9C4+uI5G2hFZq6V+l5/8ByXt4PXKSXfOdVszCGkHL/jOunPO25oOPsgeJN1q8nyORdZ7gK0fatNg75DmQjZIgK0fXcKuwX4PoJTTuZID2aAByhAXiNtg99JQDxagI9JsyEYJ0CHp6GSjBhiItFey0QP0SDoIWRYBtoJ01WAPRpZVgDJE2wZ7ULLsApQh3sB8z0wUsiwDJJCORpZ1gJqko5JlH+AJ0izIjiLAHtJsyL6vf7J3V0OyPhWBAAAAAElFTkSuQmCC",i.alt=t.buttonText;var n=document.createElement("div");n.innerHTML=t.buttonText,e.appendChild(i),e.appendChild(n),super({element:e,target:t.target}),this.ortoLayer=null,this.skaermLayer=null,this.options=t;var r=this;e.onclick=function(t){r.ortoLayer.getVisible()?(r.ortoLayer.setVisible(!1),r.skaermLayer.setVisible(!0)):(r.ortoLayer.setVisible(!0),r.skaermLayer.setVisible(!1))}}setMap(t){super.setMap.apply(this,[t]);for(var e=t.getLayers().getArray(),i=0;i<e.length;i++){var n=e[i].get("type");"SKAT.BaseMap.Layer.Group.Ortofoto"===n||"SKAT.BaseMap.Layer.WMTS.Ortofoto"===n||"SKAT.BaseMap.Layer.WMS.Ortofoto"===n?this.ortoLayer=e[i]:"SKAT.BaseMap.Layer.Group.Skaermkort"!==n&&"SKAT.BaseMap.Layer.WMTS.Skaermkort"!==n&&"SKAT.BaseMap.Layer.WMS.Skaermkort"!==n||(this.skaermLayer=e[i])}}}class Vg{constructor(t){this.layer=null,this.label=null,this.service=null,Object.assign(this,t)}}class jg{constructor(t){this.matrixIds=["L00","L01","L02","L03","L04","L05","L06","L07","L08","L09","L10","L11","L12","L13"],this.resolutions=[1638.4,819.2,409.6,204.8,102.4,51.2,25.6,12.8,6.4,3.2,1.6,.8,.4,.2],this.orgin=[12e4,65e5],this.attributions=null,this.urls=null,this.format="image/jpeg",this.matrixSet="View1",this.layer=null,this.style="default",this.wmtsSource=null,this.wmtsServiceStatusOptions=null,Object.assign(this,t)}}class zg extends jg{constructor(t){super(t),this.matrixIds=["0","1","2","3","4","5","6","7","8","9","10","11","12","13"],this.resolutions=[1638.4,819.2,409.6,204.8,102.4,51.2,25.6,12.8,6.4,3.2,1.6,.8,.4,.2],Object.assign(this,t)}}class Bg extends Eg{constructor(t,e){(e=e||new Mg).isWMTS=!0;let i=null;i=null!==t.wmtsSource?t.wmtsSource:new jh({tileGrid:new ru({origin:t.orgin,resolutions:t.resolutions,matrixIds:t.matrixIds}),attributions:t.attributions,urls:t.urls,format:t.format,matrixSet:t.matrixSet,layer:t.layer,style:t.style}),super(new lo({opacity:1,source:i,visible:e.visible,extent:e.extent}),e),this.source=i,this.wmtsOptions=t}registerServiceStatusInformations(t){this.options;let e=null;if(this.source instanceof jh?e=this.source.getUrls():console.error("source not supported"),null===e)return!1;let i=this.wmtsOptions&&this.wmtsOptions.wmtsServiceStatusOptions?this.wmtsOptions.wmtsServiceStatusOptions:null;var n=i&&i.layer?i.layer:"",r=i&&i.label?i.label:"WMTS lag",s=i&&i.service?i.service:"WMTS service";if(null===n)return;e=gc.appendParamsToUrl(e,"&layer="+n+"&style=default&tilematrixset=View1&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fjpeg&TileMatrix=L13&TileCol=11807&TileRow=6316&token="+gg.getToken());let o=new Ig({name:s,label:r,testUrls:e});t.registerLayer(o)}}class Ug extends Bg{constructor(t,e){(t=t||new Mg({visible:!1})).type="SKAT.BaseMap.Layer.WMTS.Ortofoto",t.isBackgroundLayer=!0,t.name=t.name?t.name:"Ortofoto",t.extent=t.extent?t.extent:xg,super(e=e||new zg({attributions:Cg,urls:[fg.getDAFUrl()+"GeoDanmarkOrto/orto_foraar_wmts/1.0.0/WMTS?"+fg.getDAFLogin()],layer:"orto_foraar_wmts",matrixSet:"KortforsyningTilingDK",wmtsServiceStatusOptions:new Vg({label:"Datafordeleren Ortoforår (WMTS)",service:"orto_foraar",layer:"orto_foraar_wmts"})}),t)}}class Zg extends Eg{constructor(t,e){let i=[],n=null;if(t)for(var r=0;r<t.length;r++)i.push(t[r].getOLLayer());n=new xr({layers:i}),super(n,e),this.olGroupLayer=n,this.groupLayers=t}registerServiceStatusInformations(t){if(this.groupLayers)for(var e=0;e<this.groupLayers.length;e++)this.groupLayers[e].registerServiceStatusInformations(t);return!0}}class Yg extends Zg{constructor(t,e,i,n){t=t||new Rg,e=e||new Mg,(i=i||new Mg).type="SKAT.BaseMap.Layer.Group.Ortofoto",i.name="Ortofoto",e.minResolution=.05,e.visible=!0,t.maxResolution=.05,t.visible=!0,i.isBackgroundLayer=!0,super([new Ug(e,n),new Ag(t)],i)}}class Wg{static create(t){const e=new iu(new pn([t.x,t.y]));return e.set("id",t.id),e}static fromOLFeature(t){if(t.getGeometry()){const e=t.getGeometry().getCoordinates();return{id:t.get("id").toString(),x:e[0],y:e[1]}}return{id:t.get("id").toString(),x:void 0,y:void 0}}}class Xg extends Mg{constructor(t){super(t),this.style=null,this.styles=[],this.updateWhileAnimating=!1,this.updateWhileInteracting=!1,this.source=null,Object.assign(this,t),this.type=null===this.type?"vector.Base":this.type}}class qg extends Eg{constructor(t){t=t instanceof Xg?t:t?new Xg(t):new Xg;let e=new H;null===t.source?t.source=new tu({features:e}):e=t.source.getFeaturesCollection();var i=new rh({source:t.source,style:t.style,updateWhileAnimating:t.updateWhileAnimating,updateWhileInteracting:t.updateWhileInteracting});t.name&&i.set("name",t.name),super(i,t),this.features=e}addFeature(t){t instanceof iu?this.features.push(t):this.features.push(Wg.create(t))}addFeatures(t){if(Array.isArray(t))for(let e=0;e<t.length;e++)this.addFeature(t[e])}getFeatures(){let t=[],e=this.features.getArray();for(let i=0;i<e.length;i++)t.push(Wg.fromOLFeature(e[i]));return t}getOLFeatures(){return this.features.getArray()}getFeaturesCollection(){return this.features}getOLFeatureById(t){var e=this.features;if(e)for(var i=0;i<e.getLength();i++)if(e.item(i).getId()===t)return e.item(i);return null}getFeatureById(t){var e=this.getOLFeatureById(t);return e?Wg.fromOLFeature(e):null}clearFeatures(){this.features.clear()}removeFeature(t){if(t instanceof iu)this.features.remove(t);else{let e=this.getOLFeatureById(t.id);e&&this.features.remove(e)}}hasFeatures(){return!!this.features.getLength()}}var Kg=i(4),Jg=6371008.8,Qg={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*Jg,kilometers:6371.0088,kilometres:6371.0088,meters:Jg,metres:Jg,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:Jg/1852,radians:1,yards:6967335.223679999};function $g(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function tf(t,e,i){void 0===i&&(i={});for(var n=0,r=t;n<r.length;n++){var s=r[n];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<s[s.length-1].length;o++)if(s[s.length-1][o]!==s[0][o])throw new Error("First and last Position are not equivalent.")}return $g({type:"Polygon",coordinates:t},e,i)}function ef(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function nf(t,e,i){return void 0===i&&(i={}),$g({type:"MultiPolygon",coordinates:t},e,i)}function rf(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function sf(t){return"Feature"===t.type?t.geometry:t}const of=function(t,e,i){void 0===i&&(i={});var n=sf(t),r=sf(e),s=Kg.union(n.coordinates,r.coordinates);return 0===s.length?null:1===s.length?tf(s[0],i.properties):nf(s,i.properties)};function af(t,e,i){if(null!==t)for(var n,r,s,o,a,l,h,u,c=0,p=0,d=t.type,g="FeatureCollection"===d,f="Feature"===d,y=g?t.features.length:1,m=0;m<y;m++){a=(u=!!(h=g?t.features[m].geometry:f?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var _=0;_<a;_++){var v=0,C=0;if(null!==(o=u?h.geometries[_]:h)){l=o.coordinates;var x=o.type;switch(c=!i||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(l,p,m,v,C))return!1;p++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===e(l[n],p,m,v,C))return!1;p++,"MultiPoint"===x&&v++}"LineString"===x&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(r=0;r<l[n].length-c;r++){if(!1===e(l[n][r],p,m,v,C))return!1;p++}"MultiLineString"===x&&v++,"Polygon"===x&&C++}"Polygon"===x&&v++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(C=0,r=0;r<l[n].length;r++){for(s=0;s<l[n][r].length-c;s++){if(!1===e(l[n][r][s],p,m,v,C))return!1;p++}C++}v++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===af(o.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function lf(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function hf(t,e){var i,n,r,s,o,a,l,h,u,c,p=0,d="FeatureCollection"===t.type,g="Feature"===t.type,f=d?t.features.length:1;for(i=0;i<f;i++){for(a=d?t.features[i].geometry:g?t.geometry:t,h=d?t.features[i].properties:g?t.properties:{},u=d?t.features[i].bbox:g?t.bbox:void 0,c=d?t.features[i].id:g?t.id:void 0,o=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<o;r++)if(null!==(s=l?a.geometries[r]:a))switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(s,p,h,u,c))return!1;break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===e(s.geometries[n],p,h,u,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,h,u,c))return!1;p++}}function uf(t){var e=[1/0,1/0,-1/0,-1/0];return af(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}uf.default=uf;const cf=uf,pf=function(t,e){void 0===e&&(e={});var i=cf(t);return function(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!rf(t[0])||!rf(t[1]))throw new Error("coordinates must contain numbers");return $g({type:"Point",coordinates:t},e,i)}([(i[0]+i[2])/2,(i[1]+i[3])/2],e.properties,e)};var df=i(39);function gf(){return new ff}function ff(){this.reset()}ff.prototype={constructor:ff,reset:function(){this.s=this.t=0},add:function(t){mf(yf,t,this.t),mf(this,yf.s,this.s),this.s?this.t+=yf.t:this.s=yf.t},valueOf:function(){return this.s}};var yf=new ff;function mf(t,e,i){var n=t.s=e+i,r=n-e,s=n-r;t.t=e-s+(i-r)}var _f=1e-6,vf=Math.PI,Cf=vf/2,xf=vf/4,wf=2*vf,Mf=180/vf,Ef=vf/180,If=Math.abs,Sf=Math.atan,Lf=Math.atan2,bf=Math.cos,Rf=(Math.ceil,Math.exp,Math.floor,Math.log,Math.pow,Math.sin),Nf=(Math.sign,Math.sqrt);Math.tan;function Af(t){return t>1?0:t<-1?vf:Math.acos(t)}function Tf(t){return t>1?Cf:t<-1?-Cf:Math.asin(t)}function Pf(){}function Of(t,e){t&&Gf.hasOwnProperty(t.type)&&Gf[t.type](t,e)}var Df,kf,Ff={Feature:function(t,e){Of(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,n=-1,r=i.length;++n<r;)Of(i[n].geometry,e)}},Gf={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){Hf(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)Hf(i[n],e,0)},Polygon:function(t,e){Vf(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)Vf(i[n],e)},GeometryCollection:function(t,e){for(var i=t.geometries,n=-1,r=i.length;++n<r;)Of(i[n],e)}};function Hf(t,e,i){var n,r=-1,s=t.length-i;for(e.lineStart();++r<s;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function Vf(t,e){var i=-1,n=t.length;for(e.polygonStart();++i<n;)Hf(t[i],e,1);e.polygonEnd()}function jf(t){return[Lf(t[1],t[0]),Tf(t[2])]}function zf(t){var e=t[0],i=t[1],n=bf(i);return[n*bf(e),n*Rf(e),Rf(i)]}function Bf(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Uf(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Zf(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Yf(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Wf(t){var e=Nf(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Xf(t,e){function i(i,n){return i=t(i,n),e(i[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,n){return(i=e.invert(i,n))&&t.invert(i[0],i[1])}),i}function qf(t,e){return[t>vf?t-wf:t<-vf?t+wf:t,e]}function Kf(t){return function(e,i){return[(e+=t)>vf?e-wf:e<-vf?e+wf:e,i]}}function Jf(t){var e=Kf(t);return e.invert=Kf(-t),e}function Qf(t,e){var i=bf(t),n=Rf(t),r=bf(e),s=Rf(e);function o(t,e){var o=bf(e),a=bf(t)*o,l=Rf(t)*o,h=Rf(e),u=h*i+a*n;return[Lf(l*r-u*s,a*i-h*n),Tf(u*r+l*s)]}return o.invert=function(t,e){var o=bf(e),a=bf(t)*o,l=Rf(t)*o,h=Rf(e),u=h*r-l*s;return[Lf(l*r+h*s,a*i+u*n),Tf(u*i-a*n)]},o}function $f(t,e){(e=zf(e))[0]-=t,Wf(e);var i=Af(-e[1]);return((-e[2]<0?-i:i)+wf-_f)%wf}function ty(){var t,e=[];return{point:function(e,i){t.push([e,i])},lineStart:function(){e.push(t=[])},lineEnd:Pf,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function ey(t,e){return If(t[0]-e[0])<_f&&If(t[1]-e[1])<_f}function iy(t,e,i,n){this.x=t,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function ny(t,e,i,n,r){var s,o,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,i,n=t[0],o=t[e];if(ey(n,o)){for(r.lineStart(),s=0;s<e;++s)r.point((n=t[s])[0],n[1]);r.lineEnd()}else a.push(i=new iy(n,t,null,!0)),l.push(i.o=new iy(n,null,i,!1)),a.push(i=new iy(o,t,null,!1)),l.push(i.o=new iy(o,null,i,!0))}})),a.length){for(l.sort(e),ry(a),ry(l),s=0,o=l.length;s<o;++s)l[s].e=i=!i;for(var h,u,c=a[0];;){for(var p=c,d=!0;p.v;)if((p=p.n)===c)return;h=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(d)for(s=0,o=h.length;s<o;++s)r.point((u=h[s])[0],u[1]);else n(p.x,p.n.x,1,r);p=p.n}else{if(d)for(h=p.p.z,s=h.length-1;s>=0;--s)r.point((u=h[s])[0],u[1]);else n(p.x,p.p.x,-1,r);p=p.p}h=(p=p.o).z,d=!d}while(!p.v);r.lineEnd()}}}function ry(t){if(e=t.length){for(var e,i,n=0,r=t[0];++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}function sy(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}gf(),gf(),gf(),qf.invert=qf,1===(Df=sy).length&&(kf=Df,Df=function(t,e){return sy(kf(t),e)});var oy=Array.prototype;function ay(t){for(var e,i,n,r=t.length,s=-1,o=0;++s<r;)o+=t[s].length;for(i=new Array(o);--r>=0;)for(e=(n=t[r]).length;--e>=0;)i[--o]=n[e];return i}oy.slice,oy.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var ly=1e9,hy=-ly;var uy=gf();gf(),gf(),gf();var cy=1/0,py=cy,dy=-cy,gy=dy;const fy={point:function(t,e){t<cy&&(cy=t),t>dy&&(dy=t),e<py&&(py=e),e>gy&&(gy=e)},lineStart:Pf,lineEnd:Pf,polygonStart:Pf,polygonEnd:Pf,result:function(){var t=[[cy,py],[dy,gy]];return dy=gy=-(py=cy=1/0),t}};function yy(t,e,i,n){return function(r,s){var o,a,l,h=e(s),u=r.invert(n[0],n[1]),c=ty(),p=e(c),d=!1,g={point:f,lineStart:m,lineEnd:_,polygonStart:function(){g.point=v,g.lineStart=C,g.lineEnd=x,a=[],o=[]},polygonEnd:function(){g.point=f,g.lineStart=m,g.lineEnd=_,a=ay(a);var t=function(t,e){var i=e[0],n=e[1],r=[Rf(i),-bf(i),0],s=0,o=0;uy.reset();for(var a=0,l=t.length;a<l;++a)if(u=(h=t[a]).length)for(var h,u,c=h[u-1],p=c[0],d=c[1]/2+xf,g=Rf(d),f=bf(d),y=0;y<u;++y,p=_,g=C,f=x,c=m){var m=h[y],_=m[0],v=m[1]/2+xf,C=Rf(v),x=bf(v),w=_-p,M=w>=0?1:-1,E=M*w,I=E>vf,S=g*C;if(uy.add(Lf(S*M*Rf(E),f*x+S*bf(E))),s+=I?w+M*wf:w,I^p>=i^_>=i){var L=Uf(zf(c),zf(m));Wf(L);var b=Uf(r,L);Wf(b);var R=(I^w>=0?-1:1)*Tf(b[2]);(n>R||n===R&&(L[0]||L[1]))&&(o+=I^w>=0?1:-1)}}return(s<-1e-6||s<_f&&uy<-1e-6)^1&o}(o,u);a.length?(d||(s.polygonStart(),d=!0),ny(a,_y,t,i,s)):t&&(d||(s.polygonStart(),d=!0),s.lineStart(),i(null,null,1,s),s.lineEnd()),d&&(s.polygonEnd(),d=!1),a=o=null},sphere:function(){s.polygonStart(),s.lineStart(),i(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function f(e,i){var n=r(e,i);t(e=n[0],i=n[1])&&s.point(e,i)}function y(t,e){var i=r(t,e);h.point(i[0],i[1])}function m(){g.point=y,h.lineStart()}function _(){g.point=f,h.lineEnd()}function v(t,e){l.push([t,e]);var i=r(t,e);p.point(i[0],i[1])}function C(){p.lineStart(),l=[]}function x(){v(l[0][0],l[0][1]),p.lineEnd();var t,e,i,n,r=p.clean(),h=c.result(),u=h.length;if(l.pop(),o.push(l),l=null,u)if(1&r){if((e=(i=h[0]).length-1)>0){for(d||(s.polygonStart(),d=!0),s.lineStart(),t=0;t<e;++t)s.point((n=i[t])[0],n[1]);s.lineEnd()}}else u>1&&2&r&&h.push(h.pop().concat(h.shift())),a.push(h.filter(my))}return g}}function my(t){return t.length>1}function _y(t,e){return((t=t.x)[0]<0?t[1]-Cf-_f:Cf-t[1])-((e=e.x)[0]<0?e[1]-Cf-_f:Cf-e[1])}gf();const vy=yy((function(){return!0}),(function(t){var e,i=NaN,n=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(s,o){var a=s>0?vf:-vf,l=If(s-i);If(l-vf)<_f?(t.point(i,n=(n+o)/2>0?Cf:-Cf),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),t.point(s,n),e=0):r!==a&&l>=vf&&(If(i-r)<_f&&(i-=r*_f),If(s-a)<_f&&(s-=a*_f),n=function(t,e,i,n){var r,s,o=Rf(t-i);return If(o)>_f?Sf((Rf(e)*(s=bf(n))*Rf(i)-Rf(n)*(r=bf(e))*Rf(t))/(r*s*o)):(e+n)/2}(i,n,s,o),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),e=0),t.point(i=s,n=o),r=a},lineEnd:function(){t.lineEnd(),i=n=NaN},clean:function(){return 2-e}}}),(function(t,e,i,n){var r;if(null==t)r=i*Cf,n.point(-vf,r),n.point(0,r),n.point(vf,r),n.point(vf,0),n.point(vf,-r),n.point(0,-r),n.point(-vf,-r),n.point(-vf,0),n.point(-vf,r);else if(If(t[0]-e[0])>_f){var s=t[0]<e[0]?vf:-vf;r=i*s/2,n.point(-s,r),n.point(0,r),n.point(s,r)}else n.point(e[0],e[1])}),[-vf,-Cf]);function Cy(t){return t}function xy(t){return function(e){var i=new wy;for(var n in t)i[n]=t[n];return i.stream=e,i}}function wy(){}function My(t,e,i){var n=e[1][0]-e[0][0],r=e[1][1]-e[0][1],s=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=s&&t.clipExtent(null),function(t,e){t&&Ff.hasOwnProperty(t.type)?Ff[t.type](t,e):Of(t,e)}(i,t.stream(fy));var o=fy.result(),a=Math.min(n/(o[1][0]-o[0][0]),r/(o[1][1]-o[0][1])),l=+e[0][0]+(n-a*(o[1][0]+o[0][0]))/2,h=+e[0][1]+(r-a*(o[1][1]+o[0][1]))/2;return null!=s&&t.clipExtent(s),t.scale(150*a).translate([l,h])}wy.prototype={constructor:wy,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Ey=bf(30*Ef);function Iy(t,e){return+e?function(t,e){function i(n,r,s,o,a,l,h,u,c,p,d,g,f,y){var m=h-n,_=u-r,v=m*m+_*_;if(v>4*e&&f--){var C=o+p,x=a+d,w=l+g,M=Nf(C*C+x*x+w*w),E=Tf(w/=M),I=If(If(w)-1)<_f||If(s-c)<_f?(s+c)/2:Lf(x,C),S=t(I,E),L=S[0],b=S[1],R=L-n,N=b-r,A=_*R-m*N;(A*A/v>e||If((m*R+_*N)/v-.5)>.3||o*p+a*d+l*g<Ey)&&(i(n,r,s,o,a,l,L,b,I,C/=M,x/=M,w,f,y),y.point(L,b),i(L,b,I,C,x,w,h,u,c,p,d,g,f,y))}}return function(e){var n,r,s,o,a,l,h,u,c,p,d,g,f={point:y,lineStart:m,lineEnd:v,polygonStart:function(){e.polygonStart(),f.lineStart=C},polygonEnd:function(){e.polygonEnd(),f.lineStart=m}};function y(i,n){i=t(i,n),e.point(i[0],i[1])}function m(){u=NaN,f.point=_,e.lineStart()}function _(n,r){var s=zf([n,r]),o=t(n,r);i(u,c,h,p,d,g,u=o[0],c=o[1],h=n,p=s[0],d=s[1],g=s[2],16,e),e.point(u,c)}function v(){f.point=y,e.lineEnd()}function C(){m(),f.point=x,f.lineEnd=w}function x(t,e){_(n=t,e),r=u,s=c,o=p,a=d,l=g,f.point=_}function w(){i(u,c,h,p,d,g,r,s,n,o,a,l,16,e),f.lineEnd=v,v()}return f}}(t,e):function(t){return xy({point:function(e,i){e=t(e,i),this.stream.point(e[0],e[1])}})}(t)}var Sy=xy({point:function(t,e){this.stream.point(t*Ef,e*Ef)}});function Ly(t){return function(t){var e,i,n,r,s,o,a,l,h,u,c=150,p=480,d=250,g=0,f=0,y=0,m=0,_=0,v=null,C=vy,x=null,w=Cy,M=.5,E=Iy(L,M);function I(t){return[(t=s(t[0]*Ef,t[1]*Ef))[0]*c+i,n-t[1]*c]}function S(t){return(t=s.invert((t[0]-i)/c,(n-t[1])/c))&&[t[0]*Mf,t[1]*Mf]}function L(t,r){return[(t=e(t,r))[0]*c+i,n-t[1]*c]}function b(){s=Xf(r=function(t,e,i){return(t%=wf)?e||i?Xf(Jf(t),Qf(e,i)):Jf(t):e||i?Qf(e,i):qf}(y,m,_),e);var t=e(g,f);return i=p-t[0]*c,n=d+t[1]*c,R()}function R(){return h=u=null,I}return I.stream=function(t){return h&&u===t?h:h=Sy(C(r,E(w(u=t))))},I.clipAngle=function(t){return arguments.length?(C=+t?function(t,e){var i=bf(t),n=i>0,r=If(i)>_f;function s(t,e){return bf(t)*bf(e)>i}function o(t,e,n){var r=[1,0,0],s=Uf(zf(t),zf(e)),o=Bf(s,s),a=s[0],l=o-a*a;if(!l)return!n&&t;var h=i*o/l,u=-i*a/l,c=Uf(r,s),p=Yf(r,h);Zf(p,Yf(s,u));var d=c,g=Bf(p,d),f=Bf(d,d),y=g*g-f*(Bf(p,p)-1);if(!(y<0)){var m=Nf(y),_=Yf(d,(-g-m)/f);if(Zf(_,p),_=jf(_),!n)return _;var v,C=t[0],x=e[0],w=t[1],M=e[1];x<C&&(v=C,C=x,x=v);var E=x-C,I=If(E-vf)<_f;if(!I&&M<w&&(v=w,w=M,M=v),I||E<_f?I?w+M>0^_[1]<(If(_[0]-C)<_f?w:M):w<=_[1]&&_[1]<=M:E>vf^(C<=_[0]&&_[0]<=x)){var S=Yf(d,(-g+m)/f);return Zf(S,p),[_,jf(S)]}}}function a(e,i){var r=n?t:vf-t,s=0;return e<-r?s|=1:e>r&&(s|=2),i<-r?s|=4:i>r&&(s|=8),s}return yy(s,(function(t){var e,i,l,h,u;return{lineStart:function(){h=l=!1,u=1},point:function(c,p){var d,g=[c,p],f=s(c,p),y=n?f?0:a(c,p):f?a(c+(c<0?vf:-vf),p):0;if(!e&&(h=l=f)&&t.lineStart(),f!==l&&(!(d=o(e,g))||ey(e,d)||ey(g,d))&&(g[0]+=_f,g[1]+=_f,f=s(g[0],g[1])),f!==l)u=0,f?(t.lineStart(),d=o(g,e),t.point(d[0],d[1])):(d=o(e,g),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(r&&e&&n^f){var m;y&i||!(m=o(g,e,!0))||(u=0,n?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!f||e&&ey(e,g)||t.point(g[0],g[1]),e=g,l=f,i=y},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return u|(h&&l)<<1}}}),(function(i,n,r,s){!function(t,e,i,n,r,s){if(i){var o=bf(e),a=Rf(e),l=n*i;null==r?(r=e+n*wf,s=e-l/2):(r=$f(o,r),s=$f(o,s),(n>0?r<s:r>s)&&(r+=n*wf));for(var h,u=r;n>0?u>s:u<s;u-=l)h=jf([o,-a*bf(u),-a*Rf(u)]),t.point(h[0],h[1])}}(s,t,e,r,i,n)}),n?[0,-t]:[-vf,t-vf])}(v=t*Ef,6*Ef):(v=null,vy),R()):v*Mf},I.clipExtent=function(t){return arguments.length?(w=null==t?(x=o=a=l=null,Cy):function(t,e,i,n){function r(r,s){return t<=r&&r<=i&&e<=s&&s<=n}function s(r,s,a,h){var u=0,c=0;if(null==r||(u=o(r,a))!==(c=o(s,a))||l(r,s)<0^a>0)do{h.point(0===u||3===u?t:i,u>1?n:e)}while((u=(u+a+4)%4)!==c);else h.point(s[0],s[1])}function o(n,r){return If(n[0]-t)<_f?r>0?0:3:If(n[0]-i)<_f?r>0?2:1:If(n[1]-e)<_f?r>0?1:0:r>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var i=o(t,1),n=o(e,1);return i!==n?i-n:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(o){var l,h,u,c,p,d,g,f,y,m,_,v=o,C=ty(),x={point:w,lineStart:function(){x.point=M,h&&h.push(u=[]),m=!0,y=!1,g=f=NaN},lineEnd:function(){l&&(M(c,p),d&&y&&C.rejoin(),l.push(C.result())),x.point=w,y&&v.lineEnd()},polygonStart:function(){v=C,l=[],h=[],_=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,r=h.length;i<r;++i)for(var s,o,a=h[i],l=1,u=a.length,c=a[0],p=c[0],d=c[1];l<u;++l)s=p,o=d,p=(c=a[l])[0],d=c[1],o<=n?d>n&&(p-s)*(n-o)>(d-o)*(t-s)&&++e:d<=n&&(p-s)*(n-o)<(d-o)*(t-s)&&--e;return e}(),i=_&&e,r=(l=ay(l)).length;(i||r)&&(o.polygonStart(),i&&(o.lineStart(),s(null,null,1,o),o.lineEnd()),r&&ny(l,a,e,s,o),o.polygonEnd()),v=o,l=h=u=null}};function w(t,e){r(t,e)&&v.point(t,e)}function M(s,o){var a=r(s,o);if(h&&u.push([s,o]),m)c=s,p=o,d=a,m=!1,a&&(v.lineStart(),v.point(s,o));else if(a&&y)v.point(s,o);else{var l=[g=Math.max(hy,Math.min(ly,g)),f=Math.max(hy,Math.min(ly,f))],C=[s=Math.max(hy,Math.min(ly,s)),o=Math.max(hy,Math.min(ly,o))];!function(t,e,i,n,r,s){var o,a=t[0],l=t[1],h=0,u=1,c=e[0]-a,p=e[1]-l;if(o=i-a,c||!(o>0)){if(o/=c,c<0){if(o<h)return;o<u&&(u=o)}else if(c>0){if(o>u)return;o>h&&(h=o)}if(o=r-a,c||!(o<0)){if(o/=c,c<0){if(o>u)return;o>h&&(h=o)}else if(c>0){if(o<h)return;o<u&&(u=o)}if(o=n-l,p||!(o>0)){if(o/=p,p<0){if(o<h)return;o<u&&(u=o)}else if(p>0){if(o>u)return;o>h&&(h=o)}if(o=s-l,p||!(o<0)){if(o/=p,p<0){if(o>u)return;o>h&&(h=o)}else if(p>0){if(o<h)return;o<u&&(u=o)}return h>0&&(t[0]=a+h*c,t[1]=l+h*p),u<1&&(e[0]=a+u*c,e[1]=l+u*p),!0}}}}}(l,C,t,e,i,n)?a&&(v.lineStart(),v.point(s,o),_=!1):(y||(v.lineStart(),v.point(l[0],l[1])),v.point(C[0],C[1]),a||v.lineEnd(),_=!1)}g=s,f=o,y=a}return x}}(x=+t[0][0],o=+t[0][1],a=+t[1][0],l=+t[1][1]),R()):null==x?null:[[x,o],[a,l]]},I.scale=function(t){return arguments.length?(c=+t,b()):c},I.translate=function(t){return arguments.length?(p=+t[0],d=+t[1],b()):[p,d]},I.center=function(t){return arguments.length?(g=t[0]%360*Ef,f=t[1]%360*Ef,b()):[g*Mf,f*Mf]},I.rotate=function(t){return arguments.length?(y=t[0]%360*Ef,m=t[1]%360*Ef,_=t.length>2?t[2]%360*Ef:0,b()):[y*Mf,m*Mf,_*Mf]},I.precision=function(t){return arguments.length?(E=Iy(L,M=t*t),R()):Nf(M)},I.fitExtent=function(t,e){return My(I,t,e)},I.fitSize=function(t,e){return function(t,e,i){return My(t,[[0,0],e],i)}(I,t,e)},function(){return e=t.apply(this,arguments),I.invert=e.invert&&S,b()}}((function(){return t}))()}function by(t){return function(e,i){var n=bf(e),r=bf(i),s=t(n*r);return[s*r*Rf(e),s*Rf(i)]}}function Ry(t){return function(e,i){var n=Nf(e*e+i*i),r=t(n),s=Rf(r),o=bf(r);return[Lf(e*s,n*o),Tf(n&&i*s/n)]}}by((function(t){return Nf(2/(1+t))})).invert=Ry((function(t){return 2*Tf(t/2)}));var Ny=by((function(t){return(t=Af(t))&&t/Rf(t)}));function Ay(t,e){return[t,e]}function Ty(t,e,i,n){var r=t.properties||{},s="Feature"===t.type?t.geometry:t;if("GeometryCollection"===s.type){var o=[];return hf(t,(function(t){var r=Ty(t,e,i,n);r&&o.push(r)})),ef(o)}var a=function(t){var e=pf(t).geometry.coordinates,i=[-e[0],-e[1]];return Ly(Ny).scale(79.4188).clipAngle(179.999).rotate(i).scale(Jg)}(s),l={type:s.type,coordinates:Oy(s.coordinates,a)},h=(new df.GeoJSONReader).read(l),u=function(t,e){void 0===e&&(e="kilometers");var i=Qg[e];if(!i)throw new Error(e+" units is invalid");return t*i}(function(t,e){void 0===e&&(e="kilometers");var i=Qg[e];if(!i)throw new Error(e+" units is invalid");return t/i}(e,i),"meters"),c=df.BufferOp.bufferOp(h,u,n);if(!Py((c=(new df.GeoJSONWriter).write(c)).coordinates))return $g({type:c.type,coordinates:Dy(c.coordinates,a)},r)}function Py(t){return Array.isArray(t[0])?Py(t[0]):isNaN(t[0])}function Oy(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return Oy(t,e)}))}function Dy(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return Dy(t,e)}))}Ny.invert=Ry((function(t){return t})),Ay.invert=Ay,Ry(Sf),Ry(Tf),Ry((function(t){return 2*Sf(t)}));const ky=function(t,e,i){var n=(i=i||{}).units||"kilometers",r=i.steps||8;if(!t)throw new Error("geojson is required");if("object"!=typeof i)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");var s=[];switch(t.type){case"GeometryCollection":return hf(t,(function(t){var i=Ty(t,e,n,r);i&&s.push(i)})),ef(s);case"FeatureCollection":return lf(t,(function(t){var i=Ty(t,e,n,r);i&&lf(i,(function(t){t&&s.push(t)}))})),ef(s)}return Ty(t,e,n,r)};class Fy{constructor(t,e){this.type="Geometry",this.geom=t,this.type=e}getGeometry(){return this.geom}getType(){return this.type}static cast(t,e){return t.map((t=>new Fy(t,e)))}}class Gy extends Fy{constructor(t){super(Gy.parsePoint(t),Gy.Type)}static parsePoint(t){try{return t?t instanceof pn?t:new pn(t):null}catch(e){return console.warn("parsePoint: parseError on "+t),null}}}Gy.Type="point";class Hy extends Fy{constructor(t){super(Hy.parsePolygon(t),Hy.Type)}static parsePolygon(t){try{return t?t instanceof bn?t:new bn([t]):null}catch(e){return console.warn("parsePolygon: parseError on "+t),null}}}Hy.Type="polygon";class Vy extends Fy{constructor(t){super(Vy.parsePolygon(t),Vy.Type)}static parsePolygon(t){try{if(!t)return null;if(t instanceof lu)return t;{let e=new lu([]);for(let i=0;i<t.length;i++){let n=Hy.parsePolygon(t[i]);e.appendPolygon(n)}return e}}catch(e){return console.warn("parsePolygon: parseError on "+t),null}}}Vy.Type="multipolygon";class jy{static parseGeom(t){if(t instanceof Fy)return t;if(1==t.length&&t[0].length>0){if(t=new Hy(t[0]))return t}else if(2==t.length&&"number"==typeof t[0]&&"number"==typeof t[1]){if(t=new Gy(t))return t}else if(t.length>1){if(t=new Vy(t))return t}else console.log("geom not supported");return null}static unionGeometries(t){if(!t||!t.length)return null;let e=jy.getGeometryAsTurfGeometry(t[0],dc.MULTI_POLYGON);for(let i=1;i<t.length;i++){let n=jy.getGeometryAsTurfGeometry(t[i],dc.MULTI_POLYGON),r=of(e,n);r&&(e="Polygon"==r.geometry.type?nf([r.geometry.coordinates]):nf(r.geometry.coordinates))}let i=[];for(let t=0;t<e.geometry.coordinates.length;t++)for(let n=0;n<e.geometry.coordinates[t].length;n++)i.push(new Hy(e.geometry.coordinates[t][n]));return i}static bufferGeometries(t,e){if(!t||!t.length||e<0)return null;let i=oi("EPSG:25832"),n=oi("EPSG:4326"),r=gi(i,n),s=gi(n,i),o=[];for(let i=0;i<t.length;i++){let n=t[i].getGeometry().clone();n.applyTransform(r);let a=jy.getGeometryAsTurfGeometry(n,t[i].getGeometry().getType()),l=ky(a,e,{units:"meters"});if(l){let t=null;if("Polygon"==l.geometry.type){let e=new bn(l.geometry.coordinates);e.applyTransform(s),t=new Hy(e)}else{let e=new lu(l.geometry.coordinates);e.applyTransform(s),t=new Vy(e)}t&&o.push(t)}}return o}static getGeometryAsTurfGeometry(t,e){switch(e){case dc.POLYGON:return tf(t instanceof zi?t.getCoordinates():t.getGeometry().getCoordinates());case dc.MULTI_POLYGON:return t instanceof zi?t.getType()==dc.POLYGON?nf([t.getCoordinates()]):nf(t.getCoordinates()):t.getGeometry().getType()==dc.POLYGON?nf([t.getGeometry().getCoordinates()]):nf(t.getGeometry().getCoordinates());default:throw"getGeometryAsTurfGeometry: type "+e+" not supported"}}}class zy extends Xg{constructor(t){super(t),this.maskGeometry=null,this.showUnionedGeometries=!0,this.maskLimitResolution=1.4,Object.assign(this,t),this.type="vector.MaskLayer",this.name=this.name?this.name:"MaskLayer",this.updateWhileAnimating=!0,this.updateWhileInteracting=!0,this.maskLimitResolution=this.maskLimitResolution?this.maskLimitResolution:1.4,this.setDefaultStyle(),this.setDefaultEvent()}setDefaultStyle(){if(!this.style||!this.styles||0==this.styles.length){const t=new Ro({fill:new wo({color:[255,255,255,.5]}),stroke:new Eo({color:[0,98,248,1],width:4})}),e=new Ro({stroke:new Eo({color:[0,98,248,1],width:4})}),i=this.maskLimitResolution;this.style=function(n,r){return r>i?[e]:[t]}}}setDefaultEvent(){this.events||(this.events=new wg),this.events.baseLayerChange||(this.events.baseLayerChange=null)}}class By extends qg{constructor(t){super(t=t instanceof zy?t:t?new zy(t):new zy)}updateMaskGeometry(t){this.features.clear(),null!=t&&this.features.push(this.createMaskFeature(t))}setMap(t){super.setMap(t);const e=this.options;e.maskGeometry&&this.features.push(this.createMaskFeature(e.maskGeometry))}supportMask(){return!0}createMaskFeature(t){let e=null;if(this.options.showUnionedGeometries){if(e=jy.unionGeometries(t),!e)return null}else e=t;var i=Rn(this.map.getOLMap().getView().getProjection().getExtent()),n=new iu(i);for(let t=0;t<e.length;t++){let n=e[t].getGeometry();if(n.getType()===dc.MULTI_POLYGON)for(var r=n.getPolygons(),s=0;s<r.length;s++)for(var o=r[s].getLinearRings(),a=0;a<o.length;a++)i.appendLinearRing(o[a]);else for(o=n.getLinearRings(),s=0;s<o.length;s++)i.appendLinearRing(o[s])}return n}}class Uy extends Ng{constructor(t){(t=t||new Rg).type="SKAT.BaseMap.Layer.WMS.Kommune",t.name=t.name?t.name:"Kommune";let e={attributions:Cg,url:fg.getDAFUrl()+"DAGIM/dagi/1.0.0/WMS?"+fg.getDAFLogin(),params:{LAYERS:"Kommuneinddeling",TRANSPARENT:"TRUE",FORMAT:"image/png",SERVICE:"WMS",VERSION:"1.1.1",STYLES:"Kommuneinddeling_gul"},ratio:1};t.wmsServiceStatusOptions=new bg({label:"Kommuneinddeling (WMS)",service:"dagi",layer:e.params.LAYERS}),super(new co({source:new Vh(e),maxResolution:t.maxResolution?t.maxResolution:6.4}),t)}setMap(t){super.setMap(t),t.getOLMap().getLayers().on("add",(t=>{this.addChangeStyleEvent(t.target)})),t.getLayers().forEach((t=>{this.addChangeStyleEvent(t)}))}addChangeStyleEvent(t){let e=null;if(t instanceof Eg?t.isBackgroundLayer&&(e=t.getOLLayer()):e=t,e){let t=e.get("type");t&&("SKAT.BaseMap.Layer.Group.Skaermkort"!==t&&"SKAT.BaseMap.Layer.WMS.Skaermkort"!==t&&"SKAT.BaseMap.Layer.WMTS.Skaermkort"!==t||e.addEventListener("change:visible",(t=>{let e=t.target.get(t.key),i=1==e?"default":"Kommuneinddeling_gul";console.log("Change visible "+e+", new style "+i);let n=this.getOLLayer().getSource();n.getParams().STYLES=i,n.refresh()})))}}}const Zy=new class{ortofoto(t=null){return t||(t=new Rg({visible:!0})),new Ag(t)}orto(t=null){return new Yg(void 0,void 0,t)}skaerm(t=null){return new Wm(t)}skaermgraa(t=null){return new Ym(t)}skaermkort(t=null){return new Pg(t)}matrikel(t=null){return new Xm(t)}adresse(t=null){return new qm(t)}vejnavn(t=null){return new Km(t)}mask(t=null){return new By(t)}bygning(t=null){return new $m(t)}kommune(t=null){return new Uy(t)}default(){return[this.orto(new Rg({visible:!0})),this.skaerm(new Mg({visible:!1})),this.matrikel(new Rg({visible:!0})),this.adresse(new Rg({visible:!0})),this.vejnavn(new Rg({visible:!0})),this.mask(new zy({visible:!0}))]}bbr(){return[this.orto(new Rg({visible:!0})),this.skaermgraa(new Mg({visible:!1})),this.matrikel(new Rg({visible:!0,maxResolution:.8})),this.kommune(new Rg({visible:!0})),this.adresse(new Rg({visible:!0,maxResolution:.7})),this.vejnavn(new Rg({visible:!0})),this.mask(new zy({visible:!0}))]}ortofotoogadresse(){return[this.ortofoto(new Rg({visible:!0})),this.matrikel(new Rg({visible:!0})),this.adresse(new Rg({visible:!0})),this.vejnavn(new Rg({visible:!0}))]}skaermkortogadresse(){return[this.skaermkort(new Tg({visible:!0})),this.matrikel(new Rg({visible:!0})),this.adresse(new Rg({visible:!0}))]}},Yy=new class{standard(t,e){return Lc.renderDefaultElem(t,e)}simplelayerswitcher(t){return[new Gg(new Fg({target:t}))]}overviewmaplayerswitcher(t){return[new Dg(new Og({target:t}))]}default(t,e){return this.standard(t,e).concat(this.overviewmaplayerswitcher(t))}};class Wy{constructor(t){this.controls=[],this.showGeoLocationButton=!1,Object.assign(this,t)}}class Xy{constructor(t,e){e=e||new Wy,this.controls=this.parseControls(t,e)}getControls(){return this.controls}getControlById(t){for(var e=0;e<this.controls.length;e++)if(this.controls[e].getId()===t)return this.controls[e];return null}containsRemove(t,e){const i=t.indexOf(e);return i>-1&&(t.splice(i,1),!0)}parseControls(t,e){e.controls||(e.controls=["default"]),e.controls.indexOf("standard")>-1&&this.containsRemove(e.controls,"default");let i=[],n={enableAttribution:this.containsRemove(e.controls,"attribution"),enableScaleLine:this.containsRemove(e.controls,"scaleline"),enableZoomControl:this.containsRemove(e.controls,"zoom"),enableGeolocationControl:this.containsRemove(e.controls,"geolocation")};n.enableAttribution||n.enableScaleLine||n.enableZoomControl||n.enableGeolocationControl?(this.containsRemove(e.controls,"default"),this.containsRemove(e.controls,"standard"),i=Lc.renderDefaultElem(t,n)):n={showGeoLocationButton:e.showGeoLocationButton};for(var r=0;r<e.controls.length;r++)if("string"==typeof e.controls[r]){const s=e.controls[r];if(!(s in Yy)){console.warn(`Unknown controlname '${s}'`);continue}const o=Yy[s](t,n);null!=o&&(Array.isArray(o)?i=i.concat(o):i.push(o))}else e.controls[r]instanceof mc?i.push(e.controls[r]):console.warn(`Unknown control object at index [${r}]`,e.controls[r]);return i.filter((t=>!!t))}}class qy{constructor(t){this.serviceStatus=null,this.layers=null,Object.assign(this,t)}}class Ky{constructor(t){this.layers=[],this.options=null,this.options=t||new qy,this.addLayersFromOption()}getLayers(){return this.layers}addLayer(t){t&&this.layers.push(t)}getLayerByName(t){for(var e=0;e<this.layers.length;e++)if(this.layers[e].getLayerName()===t)return this.layers[e];return null}addLayersFromOption(){this.options.layers||(this.options.layers=["default"]);let t=[];for(var e=0;e<this.options.layers.length;e++)if("string"==typeof this.options.layers[e]){const i=this.options.layers[e].toLowerCase();if(!(i in Zy)){console.warn(`Unknown layername '${i}'`);continue}const n=Zy[i]();null!=n&&(Array.isArray(n)?t=t.concat(n):t.push(n))}else this.options.layers[e]instanceof Eg?t.push(this.options.layers[e]):t.push(new Eg(this.options.layers[e],null));this.layers=t.filter((t=>!!t));let i=!0;for(let t=0;t<this.layers.length;t++){const e=this.layers[t];e&&e.isBackgroundLayer()&&(i?i=!1:e.setVisible(!1))}if(this.options.serviceStatus)for(e=0;e<this.layers.length;e++)this.layers[e].registerServiceStatusInformations(this.options.serviceStatus)}}var Jy,Qy,$y;(Qy=Jy||(Jy={})).center="change:center",Qy.resolution="change:resolution",Qy.onClick="on:click",Qy.onMarkerClicked="on:markerClicked",Qy.onMarkerUnClicked="on:markerUnClicked",Qy.onMarkerHovered="on:markerHovered",Qy.onMarkerUnHovered="on:markerUnHovered",Qy.onMarkerClusteredClick="on:markerClusteredClick";class tm extends mc{constructor(t,e=null){super(),this.notify=null,this.area=null,this.notifyList=[],this.callbackFunc=null,this.callbackThisRef=null,t=t||document.body;let i=this;this.area=document.createElement("ul");let n=1;this.notify=function(t,e,r){t=t||"default",e=e||"Default text",r=!1!==r;let s=null,o=document.createElement("li"),a=n++,l=document.createElement("span"),h=document.createElement("span");h.className="message",h.innerHTML=e,l.appendChild(h);const u=wc("close");let c=document.createElement("span");return c.className="close",c.innerHTML='<img alt="'+u+'" title="'+u+'" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAAA/CAYAAABXXxDfAAAACXBIWXMAABcRAAAXEQHKJvM/AAABg0lEQVRo3u3a0Y2DMBBF0ckqBbgEl+CSKIV0QAkugRK2BEpxB7NfiSKFJATPvMmKZ4lfzLmggCEnEVE55rj8yIEH8cQTTzzxxBNPPPHEE0/8beScoQdtOZ/2bMMwaGtNSynau68tW61Vl2XRlFLvvkbphV8HIkCt9TafQYD9+JSSttb0fngGuIdfxziOcWe+lAIJsAavtcZe9ogATnAbvGcAR7gd3iOAM9wWbxkAALfHWwQAwX3wPQGAcD/8ngBguC/+kwABcH/8lgBBcAz+VYB5nqPgOPyzAIFwLP5dADAcjxeR1UtdVWHvA8Lwaz9uyPcBYfhX8KAAGPyz2xnqfUAY/t19PDCAL37rA0xQAD/8p09uAQF88HsfWcEB7PG9z+rAALZ4q0UKKIAd3np1Bghgg/daljoH6Md7r8cdA/ThUS8inALsx+ecHw7Ic1m6FmCapu/4VodYjxvPZ/OtrvMMRM03noT/t+d/cognnnjiiSeeeOKJJ574/zvOInI5qP33D/M4oSECItPaAAAAAElFTkSuQmCC" />',c.onclick=function(t){this.close()}.bind(this),l.appendChild(c),o.appendChild(l),o.className="notification notification_"+t,i.area.appendChild(o),r&&(s=setTimeout(function(){this.close()}.bind(this),5e3)),this.close=function(){if(s&&(clearTimeout(s),s=null),o){o.parentNode.removeChild(o),o=null,l=null,h=null,c=null,this.element=null,i.callbackFunc&&i.callbackFunc.call(i.callbackThisRef);for(var t=0;t<i.notifyList.length;t++)if(i.notifyList[t].id===a){i.notifyList.splice(t,1);break}}},this.element=h,i.notifyList.push({id:a,notify:this}),this},this.area.className="dialog notification-area ol-hidden"+(e?" "+e:""),t.appendChild(this.area)}setVisible(t){t?this.area.classList.remove("ol-hidden"):this.area.classList.add("ol-hidden")}setMap(t){if(!gc.isObjectDefined(t))throw new Error("map cannot be null");this.map=t}createNotify(t,e,i=!1){return this.notify(t,e,i)}getTarget(){return this.area}clearAll(){for(;this.notifyList.length>0;)this.notifyList.pop().notify.close()}registerOnCloseEvent(t,e){this.callbackFunc=t,this.callbackThisRef=e}}class em{constructor(t){this.condition=null,Object.assign(this,t)}}class im extends ms{constructor(t){(t=t||new em).condition=function(t){return t.originalEvent.ctrlKey},super(t),this.options=t,this.messageCondition=function(t){return!t.originalEvent.ctrlKey},this.messageTimer=null}setMap(t){super.setMap(t),t.getViewport().appendChild(this.renderElement())}handleEvent(t){if(!this.messageCondition(t))return!this.options.condition(t)||(this.hide(),clearTimeout(this.messageTimer),this.messageTimer=null,super.handleEvent(t));if(t.type!==M)return!0;null!==this.messageTimer&&(clearTimeout(this.messageTimer),this.messageTimer=null),this.show();let e=this;return this.messageTimer=setTimeout((function(){e.hide(),e.messageTimer=null}),1e3),!1}show(){this.element.classList.remove("ol-hidden")}hide(){this.element.classList.add("ol-hidden")}renderElement(){this.element=document.createElement("div"),this.element.className="ol-mousezoom-message ol-hidden";let t=document.createElement("div");t.className="ol-mousezoom-white-div";let e=document.createElement("div");return e.className="ol-mousezoom-inner-message ol-unselectable ol-overlaycontainer-stopevent",e.innerHTML=yg.zoomUseCtrlToZoom,this.element.appendChild(t),this.element.appendChild(e),this.element}}!function(t){t[t.UNK_ERROR=0]="UNK_ERROR",t[t.AJAX_CALL_FAILED=1]="AJAX_CALL_FAILED",t[t.AJAX_SERVICE_ERROR=2]="AJAX_SERVICE_ERROR",t[t.SERVICE_PARSER_ERROR=3]="SERVICE_PARSER_ERROR",t[t.GRUNDDATA_KEYS_INVALID=100]="GRUNDDATA_KEYS_INVALID",t[t.GRUNDDATA_KEYS_PARSE_ERROR=101]="GRUNDDATA_KEYS_PARSE_ERROR",t[t.GRUNDDATA_KEYS_SERVICE_ERROR=102]="GRUNDDATA_KEYS_SERVICE_ERROR",t[t.GRUNDDATA_KEYS_SERVICE_TIMEOUT=103]="GRUNDDATA_KEYS_SERVICE_TIMEOUT",t[t.GRUNDDATA_KEYS_NOT_FOUND=104]="GRUNDDATA_KEYS_NOT_FOUND"}($y||($y={}));var nm=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class rm{static FetchMatrikler(t,e){return nm(this,void 0,void 0,(function*(){return yield Promise.all(t.map((t=>nm(this,void 0,void 0,(function*(){return yield this.FetchMatrikel(t,e)})))))}))}static FetchMatriklerFromIds(t,e){return nm(this,void 0,void 0,(function*(){const i=yield Promise.all(t.map((t=>nm(this,void 0,void 0,(function*(){return yield this.FetchMatriklerFromId(t,e)})))));let n=[];for(let t=0;t<i.length;t++)n.push(...i[t]);return n}))}static FetchMatriklerFromBfeNumbers(t,e){return nm(this,void 0,void 0,(function*(){const i=yield Promise.all(t.map((t=>nm(this,void 0,void 0,(function*(){return yield this.FetchMatriklerFromBfe(t,e)})))));let n=[];for(let t=0;t<i.length;t++)n.push(...i[t]);return n}))}static FetchMatriklerFromBfe(t,e){return nm(this,void 0,void 0,(function*(){let i=`${gg.dawaUrl}/jordstykker?sfeejendomsnr=${t.bfe}&format=geojson&srid=25832&noformat&cache=no-cache`;return yield rm.FetchMultipleMatrikelByUrl(i,t,e)}))}static FetchMatriklerFromId(t,e){return nm(this,void 0,void 0,(function*(){let i=`${gg.dawaUrl}/jordstykker?featureid=${t.id}&format=geojson&srid=25832&noformat&cache=no-cache`;return yield rm.FetchMultipleMatrikelByUrl(i,t,e)}))}static FetchMatrikel(t,e){return nm(this,void 0,void 0,(function*(){let i=`${gg.dawaUrl}/jordstykker/${t.landsejerlavskode}/${t.matrikelNr}?format=geojson&srid=25832&noformat&cache=no-cache`;return yield rm.FetchSingleMatrikelByUrl(i,t,e)}))}static FetchSingleMatrikelByUrl(t,e,i){return nm(this,void 0,void 0,(function*(){try{const n=void 0===typeof AbortController?new AbortController:null,r=n?setTimeout((()=>n.abort()),i.timeout):null,s=yield fetch(t,{signal:n?n.signal:null});if(n&&clearTimeout(r),s.ok)return yield s.json();throw 404==s.status?new lm({errorCode:$y.GRUNDDATA_KEYS_NOT_FOUND,data:{matrikelKeys:[e]}}):new lm({errorCode:$y.GRUNDDATA_KEYS_SERVICE_ERROR,data:{matrikelKeys:[e]}})}catch(t){if(i.allowExternalCallToFailed)return null;throw t instanceof lm?t:"AbortError"==t.name?new lm({errorCode:$y.GRUNDDATA_KEYS_SERVICE_TIMEOUT,data:{matrikelKeys:[e]}}):new lm({errorCode:$y.GRUNDDATA_KEYS_SERVICE_ERROR,data:{matrikelKeys:[e]}})}}))}static FetchMultipleMatrikelByUrl(t,e,i){return nm(this,void 0,void 0,(function*(){try{const n=void 0===typeof AbortController?new AbortController:null,r=n?setTimeout((()=>n.abort()),i.timeout):null,s=yield fetch(t,{signal:n?n.signal:null});if(n&&clearTimeout(r),s.ok)return(yield s.json()).features;throw 404==s.status?new lm({errorCode:$y.GRUNDDATA_KEYS_NOT_FOUND,data:{matrikelKeys:[e]}}):new lm({errorCode:$y.GRUNDDATA_KEYS_SERVICE_ERROR,data:{matrikelKeys:[e]}})}catch(t){if(i.allowExternalCallToFailed)return null;throw t instanceof lm?t:"AbortError"==t.name?new lm({errorCode:$y.GRUNDDATA_KEYS_SERVICE_TIMEOUT,data:{matrikelKeys:[e]}}):new lm({errorCode:$y.GRUNDDATA_KEYS_SERVICE_ERROR,data:{matrikelKeys:[e]}})}}))}}function sm(t){return!!(t.landsejerlavskode&&/^[0-9]{1,7}$/.test(t.landsejerlavskode.toString())&&t.matrikelNr&&/^(0|([1-9]([0-9]{0,3})([a-z|ø|æ]){0,3}))$/.test(t.matrikelNr))}class om{static Parse(t,e=!0){if(!t)return[];let i=t.map((t=>{try{if(t){if(t.geometry&&t.geometry.coordinates){let e=t.properties;return{landsejerlavskode:e.ejerlavkode,matrikelNr:e.matrikelnr,geometry:jy.parseGeom(t.geometry.coordinates)}}throw"Missing coordinates"}return null}catch(i){if(!e)throw"Failed to parse "+t.type;return null}}));return i.filter((t=>null!=t))}}class am{constructor(t){this.allowInvalidGrunddataKeys=!1,this.allowExternalCallToFailed=!1,this.allowParserError=!1,this.timeout=_g.timeoutLength,Object.assign(this,t)}}class lm{constructor(t){Object.assign(this,t)}}class hm{static Fetch(t,e){return i=this,n=void 0,s=function*(){e=e||new am;let i=[];const n=t.filter((t=>function(t){if(t.hasOwnProperty("landsejerlavskode")&&!t.hasOwnProperty("matrikelNr")||!t.hasOwnProperty("landsejerlavskode")&&t.hasOwnProperty("matrikelNr"))throw new lm({errorCode:$y.GRUNDDATA_KEYS_INVALID,data:{matrikelKeys:[t]}});return!(!t.hasOwnProperty("landsejerlavskode")||!t.hasOwnProperty("matrikelNr")||t.hasOwnProperty("bfe")||t.hasOwnProperty("id"))}(t)));if(n.length){let t=n.filter((t=>sm(t)));if(!e.allowInvalidGrunddataKeys&&n.length!=t.length)throw new lm({errorCode:$y.GRUNDDATA_KEYS_INVALID,data:{matrikelKeys:n.filter((t=>!sm(t)))}});const r=yield rm.FetchMatrikler(t,e);if(r&&r.length>0)try{i=i.concat(om.Parse(r,e.allowParserError))}catch(t){throw new lm({errorCode:$y.GRUNDDATA_KEYS_PARSE_ERROR,data:t})}}const r=t.filter((t=>{return!(!(e=t).hasOwnProperty("bfe")||e.hasOwnProperty("landsejerlavskode")||e.hasOwnProperty("matrikelNr")||e.hasOwnProperty("id"));var e}));if(r.length){let t=r.filter((t=>!0));if(!e.allowInvalidGrunddataKeys&&r.length!=t.length)throw new lm({errorCode:$y.GRUNDDATA_KEYS_INVALID,data:{matrikelKeys:r.filter((t=>!1))}});const n=yield rm.FetchMatriklerFromBfeNumbers(t,e);if(n&&n.length>0)try{i=i.concat(om.Parse(n,e.allowParserError))}catch(t){throw new lm({errorCode:$y.GRUNDDATA_KEYS_PARSE_ERROR,data:t})}}const s=t.filter((t=>{return!(!(e=t).hasOwnProperty("id")||e.hasOwnProperty("landsejerlavskode")||e.hasOwnProperty("matrikelNr")||e.hasOwnProperty("bfe"));var e}));if(s.length){let t=s.filter((t=>!0));if(!e.allowInvalidGrunddataKeys&&s.length!=t.length)throw new lm({errorCode:$y.GRUNDDATA_KEYS_INVALID,data:{matrikelKeys:s.filter((t=>!1))}});const n=yield rm.FetchMatriklerFromIds(t,e);if(n&&n.length>0)try{i=i.concat(om.Parse(n,e.allowParserError))}catch(t){throw new lm({errorCode:$y.GRUNDDATA_KEYS_PARSE_ERROR,data:t})}}return i},new((r=void 0)||(r=Promise))((function(t,e){function o(t){try{l(s.next(t))}catch(t){e(t)}}function a(t){try{l(s.throw(t))}catch(t){e(t)}}function l(e){var i;e.done?t(e.value):(i=e.value,i instanceof r?i:new r((function(t){t(i)}))).then(o,a)}l((s=s.apply(i,n||[])).next())}));var i,n,r,s}}const um="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNDYiIGhlaWdodD0iNTQiIHZpZXdCb3g9IjAgMCA0NiA1NCI+CiAgPGRlZnM+CiAgICA8ZmlsdGVyIGlkPSJFbGxpcHNlXzE3IiB4PSIwIiB5PSIwIiB3aWR0aD0iNDYiIGhlaWdodD0iNDYiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CiAgICAgIDxmZU9mZnNldCBpbnB1dD0iU291cmNlQWxwaGEiLz4KICAgICAgPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIgcmVzdWx0PSJibHVyIi8+CiAgICAgIDxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAuNDY3Ii8+CiAgICAgIDxmZUNvbXBvc2l0ZSBvcGVyYXRvcj0iaW4iIGluMj0iYmx1ciIvPgogICAgICA8ZmVDb21wb3NpdGUgaW49IlNvdXJjZUdyYXBoaWMiLz4KICAgIDwvZmlsdGVyPgogICAgPGZpbHRlciBpZD0iRWxsaXBzZV8xOCIgeD0iMCIgeT0iNCIgd2lkdGg9IjQ2IiBoZWlnaHQ9IjQ2IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiPgogICAgICA8ZmVPZmZzZXQgaW5wdXQ9IlNvdXJjZUFscGhhIi8+CiAgICAgIDxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjIiIHJlc3VsdD0iYmx1ci0yIi8+CiAgICAgIDxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAuNDY3Ii8+CiAgICAgIDxmZUNvbXBvc2l0ZSBvcGVyYXRvcj0iaW4iIGluMj0iYmx1ci0yIi8+CiAgICAgIDxmZUNvbXBvc2l0ZSBpbj0iU291cmNlR3JhcGhpYyIvPgogICAgPC9maWx0ZXI+CiAgICA8ZmlsdGVyIGlkPSJFbGxpcHNlXzE5IiB4PSIwIiB5PSI4IiB3aWR0aD0iNDYiIGhlaWdodD0iNDYiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CiAgICAgIDxmZU9mZnNldCBpbnB1dD0iU291cmNlQWxwaGEiLz4KICAgICAgPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIgcmVzdWx0PSJibHVyLTMiLz4KICAgICAgPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMC40NjciLz4KICAgICAgPGZlQ29tcG9zaXRlIG9wZXJhdG9yPSJpbiIgaW4yPSJibHVyLTMiLz4KICAgICAgPGZlQ29tcG9zaXRlIGluPSJTb3VyY2VHcmFwaGljIi8+CiAgICA8L2ZpbHRlcj4KICA8L2RlZnM+CiAgPGcgaWQ9Ikdyb3VwXzUxMiIgZGF0YS1uYW1lPSJHcm91cCA1MTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00OTAgLTQzOCkiPgogICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMSwgMCwgMCwgMSwgNDkwLCA0MzgpIiBmaWx0ZXI9InVybCgjRWxsaXBzZV8xNykiPgogICAgICA8Y2lyY2xlIGlkPSJFbGxpcHNlXzE3LTIiIGRhdGEtbmFtZT0iRWxsaXBzZSAxNyIgY3g9IjE3IiBjeT0iMTciIHI9IjE3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2IDYpIiBmaWxsPSIjZmZmIi8+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLCAwLCAwLCAxLCA0OTAsIDQzOCkiIGZpbHRlcj0idXJsKCNFbGxpcHNlXzE4KSI+CiAgICAgIDxjaXJjbGUgaWQ9IkVsbGlwc2VfMTgtMiIgZGF0YS1uYW1lPSJFbGxpcHNlIDE4IiBjeD0iMTciIGN5PSIxNyIgcj0iMTciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYgMTApIiBmaWxsPSIjZmZmIi8+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLCAwLCAwLCAxLCA0OTAsIDQzOCkiIGZpbHRlcj0idXJsKCNFbGxpcHNlXzE5KSI+CiAgICAgIDxnIGlkPSJFbGxpcHNlXzE5LTIiIGRhdGEtbmFtZT0iRWxsaXBzZSAxOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNiAxNCkiIGZpbGw9IiNlMmUyZTIiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIzIj4KICAgICAgICA8Y2lyY2xlIGN4PSIxNyIgY3k9IjE3IiByPSIxNyIgc3Ryb2tlPSJub25lIi8+CiAgICAgICAgPGNpcmNsZSBjeD0iMTciIGN5PSIxNyIgcj0iMTUuNSIgZmlsbD0ibm9uZSIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K",cm="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkM1QjkzMTIwNkEzMTFFQTg1MzVCNTU4OTEyN0VGQ0UiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkM1QjkzMTMwNkEzMTFFQTg1MzVCNTU4OTEyN0VGQ0UiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2QzVCOTMxMDA2QTMxMUVBODUzNUI1NTg5MTI3RUZDRSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2QzVCOTMxMTA2QTMxMUVBODUzNUI1NTg5MTI3RUZDRSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuBNzWwAABSNSURBVHja7J1rbBXHFcdn9+412CYBkwKN1WCSmoeVR0M/tF9SESDQ0Do8okYuaokQFGhqY0iBNqRqjL8kEJKWhy2K6AMpVQhQYaAuaUHGieBDmw/kUSJjbAIklalxg02CH+Heu9sZ13bX63mc2dfda8+RRnvv3gu6O+fnc/5zdnZGsywLKVPmt+mqC5QpsJRljBn2N5qmqR5R5sn6pZWKWMpUKlSmwFKmNNaIs3QJSUuBNbIB0gICRxtJwBkjECQtILDcgqcNR9CMEQCT5uGcjPM1zmeWBEDacIDMGIYwaRLvNRegitIaDQwNAIk1nCAzhglQUHg04OdutZHFgMwSwGUBINIyCTBjGAHFA0iT+I4bnWVRXlsMwESgWQKIMgIwIwOBYkUnyFFzAZ5XqJxHO1QaBzJRFIs0YEaGAsWKPF5eswCDinMeSJDX0FSZEYAZGQ4UDxjae9H3RHAhF1DR3rPOa5zXGQWYkSFQiYDiQcRrPMAgcLHSoAgoXtMc/54HGEuDWSMdLJko5QUgWdBEgIl0ld8NMaJZZKOXETGoRKM2SNMF753nERAuaBp0RiuTAYspeM8CTFZ/WSMJLAhULKfrAph0zjkeaH6DxQPJ7Psd9vOaADKTkiadv0OLClxGxKCCpD0eRLSjHhBcXqDqP/YDZj/aITMpEVAEeiTgMiIWpSApjwWP6D0kmtEiJERj0cQ6CyY7VPbXdrg0x1E0skQA7RWq7jIiBJVshOIBpQu+A4labsDiRSsWTM6m2QBjQdb/f4hSdNqil5FmqCA6igWFs8UAcNH+LxpkXlOhEwAIUP0tZQPJ3ixOBDMRv3ofOlxGxKDSBNFJYwAU4wAWE0WuuXPn5j355JNfLSoqunfixIl3jxs37svZ2dnjR48efWc8Hr9T1/UYtmzyY1OpVLdpmqlEIvFZT0/PZ93d3Tc6Ojr+ff369WsNDQ2Xjxw5cqmurq4dEKlSjPc65TPTAZvpGHXqAqhCh0uzPwnt8+NfbqFiRSgWMKLjkLZq1ap7SkpKvlFYWPgABukBDNFEPy8cw4Y5u36+ubn5/MGDB9/Zt2/fJ4AIJTo6v0+DllfdZ+krX+Hq5ylMsERQ8UR5jAFUjPKeCtfatWunLF++fP706dNn5+bm5oc5Qurs7GxpbGys379//8ndu3dfEUAlek2DzRIAxoMro8DyAhVLP9GA4p575JFHxlVWVs57+OGH540fP34GioDduHHjwnvvvXeqoqLi1NmzZzso8KSA51gRMK1wBQmWDFROAa1LRKZYn0Yc8nlpaemU8vLyEpzq5mF9lIUiaFin3cap8tSuXbsOVldXX2HAlBTAZjIgYxVaA4crKLDcQMXSUTFAGwTWM888U7Bp06blU6ZMmaNlyHoBuP+tq1ev1r/88st/2LNnz1UBWKzG0l+hwxUEWF6gEmkog/d69uzZ47FTVkybNq0YX0MMZaBhP6QuXrxYi/84fl9fX3+DAlaSA51JASwtcIUNFk1TsaBiRaUhR2LHjx8vnjdv3o/xyzFoGFgymbx16tSpvQsXLvwzfp20AcQ68qKXRUmPLMB8BcuvR+xlodIAUBmUFu8/Llu27J6WlpadCxYs2DhcoEL/+2sZg69pA7k2co32a2b0CW3g0t+fonujPN+lvY7lBipI2jMYgMVqamoWFBcXr8NOyEHD2HDA6qqtrd25ZMmSN21Ryt54EcyZHq0wIpefqRAyh4pXm2JBNaTl5+dnv/XWW89OnTr1O2gEWVNT04lHH3301ziKdVPgSkrARRsxsvSWJ7C8pkLRo1kap5wgBRWOUBPPnz9fNdKgIkaumVw71l2TWP3DKb/Q7pUiNPRGu4xvhebnMkaQ2QkaAC6npopv3Lhx2qFDh36Tl5c3HY1QI9f+xhtv7CF90d8vAr1FA4qnuXzTV15ToSaIUBCQYpy/wN6Oe+mllx7asGHDtng8PgYpQ4lE4tarr776882bN3/Ql/oSgvRIGzHyRoqetJYfGks0SU8k1Gmpb9AIaMeOHV8vKyvb2j+zQNn/jMywqKqqem79+vXnHHAlBLoLIug9aS2vGgs685M2XQUSrYwXX3zxQQUV3UiflJaWbiV9xOtDSmrUOOnR7SNwgWosTZASeSPBIZBt2rRpGm7bFVTcelc26SPSV4K6Fm0akcxs2dA0lpsUKBLoA0J98eLFXz5w4MCe0aNHT1D4iK2np6ft6aef/snhw4ev9aXCBEd7sTSXbynRi8ZizVXXGRGKBdYgoEibNGlSTkNDwy48AipSyMCtvb29oaioqLy1tbXLBhcNsJQALvtcessLWLKpELIwBy2Hi6JX7/szZ848q6ByVYooOnv27E8pGYF1u4elgSE+DkVjQeat60g8FcYgt2lGYvHTLyssLFxA+hDxpxnpAPHuS03LD/HOK4yKbuH0QrVs2bKvkHt/Cg9vRvqQ9CUnWkHg8kXAy2gsXupj3Qc0KLpqUMOjm6yWlpYdEyZMeFih4d3a2trez8/PX5dMJm879FaCoreSSDyHXkrE+3GvULT6C2je+vHjx59QUPlnuC+/Vltb+wTiP2wCrWW5jly6S6AQp27FKooO0VmzZs3Ke+yxx1YrHPy1OXPmrCF9i9jztCDFUuSltqX7BBMPMGZRdM+ePSvj8fgdCgV/jdxX3bt370rkrliK/IAsqFGhLkqH5MGHGTNmFCsMgjEy/5/0MSANBiLgoeJdA4h2XiHU3sjjWPHLly9vIU/TKASCs6tXr57GfbylT7TfFgh5UUUeIcBySl7EO2TJRt6Dpzp57q+goGC2cn2wNnny5Nlr1669F4kXTYGs0eq7xtIEgMmkwd5jeXn59zW1T3DgRvq4rKysBFDHEsEFZcKzxoKMDKlwkWcACwsL5yq3h2Okr0mfu9BYrkeEsmBBlr4WRSu9srLy27quj1IuD8dIX+M+fxzx1xGDPCImlRK9RiwZuHrbzJkz1UgwZMN9/l0kXojO13uGXivvIrgGjRq3bNkyY8yYMfcoV4drpM9J3yP2DAffb0R7GRVCFqEd1BYvXqzKC2myvr6XGRFCRLxrsETrcUKi1cBnWEh+S7k4bSL+W1A/CUQ8KJrJineWkBMuRLty5cqvhL2SnrL/G+l74gMEW0WaN2ALXGNB0uJAyF26dOk3lXvTa30+kEmD7kejHupXUjtv4VD8oHJt2tPhg8jdjmjSQt7rLR0eYINyOFmdWLk2vYZ98CCCb/3C8nco5QZItOpdRz07O1s9zpVmwz74EvEFEk+XcQ2UF/HOS4nUESJZnF+5NRr21FNPFSL4RlXIbTqUnegnIpr6V0B2fFAujYZNmzZtCoJP6OPtn+0ZLA3wOYvy3vNkGxHl0sjorLsRf50GDejzQDSWqGA66PW4ceMUWBEx7It8iewjPRr0S7wjAPlabm7uXcql0TDsi/GAEWBa7hVCNdjAZ1lZWWOVS6Nho0aNGivINL6YH49/Cb+DwcpVLo2GxePxXK/+DLLcABmK2v8KYsql0TDbzh2i2aKaF8D0MC6GLBKmXBoNC2sxO111tbKMBSuZTHarro6GkYVxowaWaNtX2jLO/edSyqXRMLLLGMU/EH+yzvkWsSzZ79y+fbtTuTQalkgkOr36M8xUaPH+CjBYN5VLo2FffPHFTUF2SbvGEm3wM9A6Ozs/VS6NhmFf3EDsnShEO4IFDpYF0FUDrzs6Oq4pl0bDbt68eY3nK4CPfQPLAnzOWrq59/z169cVWBGx1tbWFsRfy90C+tyXiGVJUD4knDY0NFxRLo2GXbx48QrFhxY0+0AjmNtyg8WByd5611Y6cuRIs3JpNOzo0aOXEH+3VUvga5CJFl6jPSDhXOyDtTJylu04qqur609kzrVybfqsu7v7Pzk5Od8jg0P0/4XY+o/2XSzsu4axtqKjguZl4TXISML5F2FinfVP5dr0Wp8PTIaPRCPFQEeFEKCorbm5WYGVZrt06dJ5kZ8AA7JAyw0QfWXZQ+iBAwf+oVybXnv99df/jmA7rHoumMporH4QRQva2nf1suusrM7OzgM4x6v1G9JgWOO25ObmLu3TVCJ9xVvoFvmhsUSr5TJHgrQcjtPhGeXi9FhTU9MZqJ8QrGBq+Z0KLWBzjibMmpqa08rF6bFjx47V03wi4U9fUyGt5GB/ipa2gThtffeBlPj555//Ua3qF65hCfIJ7vMfUlKgc7132sbkkN1XfSk3IMFI0GRFLNLefffdvyhXh2vnzp37C8sfgFQY2L1CmfICC6oBEVhRUfFX0zS/UO4Ox0hfkz6n+YIDFwKUHwIpN4hEPBOw+vr6G1jE1ymXh2Okr0mfA4HyXL+SAcuSFPGiqJWqqqo6aNnFnbJAjPRxdXX1IYdmkoHLkmRCSrzT6lmeN2m6cuXKloKCArWKcoCWSZs0WQIBbzIilnOkkdq2bdsfbBP7lfkfrVLbt2/f78wWiL1Nr2jkJ5VhZCOWs+wgKj3E0OBK/KCodeHChQ3Tp09fpDDw3xobG4/PmDHjFU55IYEGz2IQlRhAkMlGLNCEPkb0cv61DLQ1a9b8LpFI3FIY+GvJZPIW7tvf0vqcorUgvkSykcuPx794FXeLciEDF/n222+3nz59eq9CwV+rq6vbS/qWoZtSDLniGSY3qZCWDlki3r7DlCEQ8nHDMLJaWlp2kt3XFRLera2t7f38/Px1OGrRxLpTsCcZo0WWaBdC5ka8y0xN5pUcUraLSxLbsGHDVnzoUlh4ToFdfX1pv0WTZIh2N3WswAukSDA65NaxHC352muv/au2tnanQsObnThxYifpS04JgTfV2JfnCd2kQl465O0FTZsXT0uLRlNT0+bCwsIFChF5a25ufnPq1Kkv2UZ8vJvMrPnsnksOftaxnFGL9iNNVrSyX/CsWbN+1d7efkFhImcdHR0XSd/R+hSxC580X0F8nLZUiDjp0GRA1tsRWMR342HyL3t6etoULjAjfbV69epfkL5jAMXzgadnB4MsN0CeLxRqLHs7fPjwtRdeeOE5rD/VCjVisd5J+or0mbMfXdSvLL+ilV8RCzpK5BZL7Z2yffv2i6+88srPwlokLBON9A3pI9JXAqCgUCG/opUb8S4r5DVKbSsmEPQDxx07dny9rKxsa1jrZmYSVFVVVc+tX7/+HBr8IARPqLMA8/UeodcZpLyIhSTKD6yo1dtBpOPwX+RGcotC4TSQ/m6RPqFAxYtW0Aq7bxFLDxgmKFRJSuvtsM2bN3/w/PPPr+vu7r4+0qEifUD6gvQJI0KJRoNQfeUZMi+p0JkOWSmRV9+KCVLjQFu4cOGk/fv3v5iXlzd9JELV3t7euGLFil8cPXr03wyYaKkvBaxX8R7vk4s2fTx5BYuntRCi75bO0lxCuCZPnpxTV1f37EgropLi59y5c3/98ccfd0lCxboPCJnA5ypaBQUWL2pBBL0TLhpksZqamgXFxcXrDMPIGeZ6qovcplm0aNGbDMmQkoBK9mkcT2D5WSBlFUxlbk7z9NbA7YklS5acWL169Y/a2to+GK5QkWsj14ihOkHrA4Gu8vqIV+j3Cv2MXM6ZpzTdxYpgvUditbW1T+A0sQa/HDNcRn1kPhWOyH+2zVJIASIUbd6VBahd+QqV3+UGSFRjRS/aJEBR1OqdbkvmHD3++ONH58+f/4PGxsZjmTyHnvx2cg3kWsg19c2n4j0AwZsWk0LwNRkCMT8jlihq8QqomkNzsaIXK5r1ttLS0ikbN25cXlBQMFvz4WJCAsrCoryePPhQXV19hSILUoDGmh0qKoD6ngL9FO9+wMVahtIJmM4Dq/9zAlh5eXkJHj3O03U9K4pAmaZ5G4/2TlVVVR3avXv3ZU59jybIoXOsQoUqaLBk4WJNb6YBRotkzHNYe91VUVHx7ZkzZ343KguR3Lp16xOyfkVlZeXfsJb6FLHvn/LOmYL6lKhOFQhUYYDlFS5WzUtnAEV7PejfYUcW4dHknPvuu++R3NzcUBd/6+zsbPnoo4/OkmWcMOgNiH5T3mRAZXJSnglIfaFBlS6wIHDRwKLpL50DUUzwfW3VqlX3lJSUfAOnygcmTpz4kN+rOff09PyntbX1A5zqzh88ePCdffv2fYLoTyyZnEiUEnzfclFOCOzeYJhgeYFLlB51QUTTOe+HQItHYnmLFi0qvP/++++dMGHC3WPHjr07JydnHNmYOx6P34F1mhGLxUaTH5tKpXqwPkomEonPyYZHXV1dHWQbkba2tmsffvjh5WPHjjWfPHmyneN8UwAML825WXchNKjCBMsNXIgi6jUGGDyAWM35fzkHEc7fBCmjIMRfhpG7ZpgAOBMQoUzKbwgdKjtYRkg1LI1xzmKcNylOthz/jjZ7QgYonRIhaZAjxu9HDGeagrsNlkQkMgUw8Z5iRmFDZbcwwBLBJbpQO2RWHwD2ztVt50wgTLLRCgKWKGpBILMkRbmokp4WqMIEy35BGuMcLYpZFO2FBJCZgAilc7SdxkjXrOuBbKBgAiKYJYAJEqGsdAOVDrDcpEYenE4YNQpcZkBQ+QWXDEQ8HRWJKJVusNykRnvkMikwWJTXdqhMTsWflv68gsVLi6xzsktjRyr1RQUsHlxIEL0sQcRxfm4Kvg+JViKNBY1aXhpC8g88pG05znSCxdJdPO3ljGqsqCMLkgYECgEBszyAJpPuIgdUVMDiRS+a9hIBZgHgEQEFTYO8iAUBDAGjkuxDpJFYNDgqYMlEL1ZdiwYXknjNg0oTOE8El9vXGQdUFMFyAxgvwrGq+wgIlGzEEgEmKg24vVkcyWXNowgWFDAWZBajFGEJAHIDFQQuWYigT8pEep38KIMlAgwSxWgajQcR774mxLGWC9hkolPkgcoksGQAk0mVtO9qPv1GN/BYkv+3AisgwCCQiUagUCA1jxHFbeEyY7eFMVBmGyTaWBRILImSh4yD/Uhhw2KPIQMNH7M8aCMIXEEBMSw3qzLQ8DVoWgvL0SNqtzMDjTxT29mFYLrqAmUKLGUKLGUKLGXKghXvaptmZSpiKYu0/VeAAQCP6DgpIh05LQAAAABJRU5ErkJggg==",pm="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00Ny4yMTg2IDQ0TDI0IDNMMC43ODEzNzIgNDRINDcuMjE4NloiIGZpbGw9IiNGRkQ0MDAiLz4KPHBhdGggZD0iTTIyLjIxMzkgMzkuNjcyMlYzNi4wMjc4SDI1Ljc4NlYzOS42NzIySDIyLjIxMzlaTTIyLjk5NTMgMzMuMjk0NEwyMi4xMDIzIDE5LjYyNzhWMTMuOTMzM0gyNS44OTc2VjE5LjYyNzhMMjUuMDA0NiAzMy4yOTQ0SDIyLjk5NTNaIiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K",dm="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI0LjMuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI4MCIgaGVpZ2h0PSIxNiIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDg5LjEgMjAuMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgODkuMSAyMC4yOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe2ZpbGw6I0ZGRkZGRjt9Cjwvc3R5bGU+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik04Ni4zLDIwLjJIMi44Yy0xLjUsMC0yLjgtMS4yLTIuOC0yLjhMMCwyLjhDMCwxLjIsMS4yLDAsMi44LDBsODMuNSwwYzEuNSwwLDIuOCwxLjIsMi44LDIuOHYxNC42CglDODkuMSwxOC45LDg3LjgsMjAuMiw4Ni4zLDIwLjJ6Ii8+Cjwvc3ZnPgo=";function gm(t,e){return function(t,e,i,n){const r=t.get("features");if(r&&r.length>1){for(let t=0;t<r.length;t++){let e=r[t];e.set("selected",!1),e.set("active",!1),e.set("isClustered",!0);let i=e.get("marker");i.selected=!1,i.active=!1}return[new Ro({image:new Oo({scale:i?1.2:1,src:um}),zIndex:i?1:0}),new Ro({text:new ko({text:t.getProperties().features.length.toString(),font:i?"bold 14px sans-serif":"bold 12px sans-serif",fill:new wo({color:"#000"}),offsetY:7}),zIndex:i?1:0})]}const s=r&&r.length>0?r[0]:t;s.set("isClustered",!1);const o=s.get("marker");i=!!s.get("active"),n=!!s.get("selected");const a=i||n,l=pc.getIconProvider(),h=a?99:0,u=l.createBackgroundStyle(o,a,n,h),c=l.createIcon(o,a,n,h),p=new Ro({image:o.warning?new Oo({anchorOrigin:"top-right",anchorXUnits:0,anchorYUnits:0,scale:.4,imgSize:[48,48],src:pm}):null,zIndex:h+1}),d=new Ro({image:new Oo({anchor:[-1,-7],anchorXUnits:"pixels",anchorYUnits:"pixels",anchorOrigin:"bottom-left",scale:.18,imgSize:[150,150],src:cm}),zIndex:h+1}),g=new Ro({text:new ko({text:o.shortname||"",font:"bold 10px sans-serif",offsetX:14,offsetY:-13,fill:new wo({color:"rgb(0, 0, 0)"})}),zIndex:h+1}),f=o.label,y=new Ro({text:f?new ko({text:f,font:"bold 10px sans-serif",offsetX:0,offsetY:25,fill:new wo({color:"rgb(0, 0, 0)"})}):null,image:f?new Oo({anchor:[40,-16],anchorXUnits:"pixels",anchorYUnits:"pixels",imgSize:[80,16],src:dm}):null,zIndex:-999});return[u].concat(c).concat([p,d,g,y]).filter((function(t){return null!=t}))}(t,0,!1,!1)}class fm extends yc{constructor(t){super(t),this.autoOpen=!0,this.iconOpenPath="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzBweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMzAgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDQ3LjEgKDQ1NDIyKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5pY29uL1BsdXMgaWNvbjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJTeW1ib2xzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iUXVlc3Rpb24tYWNjb3JkaWFuLWJsdWUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMDAwMDAwLCAtMS4wMDAwMDApIiBzdHJva2U9IiMwMDNDMTYiPgogICAgICAgICAgICA8ZyBpZD0iR3JvdXAtMTAiPgogICAgICAgICAgICAgICAgPGcgaWQ9Imljb24vUGx1cy1pY29uLWJsdWUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMDAwMDAwLCAxLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJQbHVzLWljb24iPgogICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNi42NDM3LDI2LjY0MDcgQzQuMzEwNywyNS4yNDE3IC00LjA4OTMsMTQuMDQwNyA0Ljc3NjcsNS4xNzM3IEMxMy42NDM3LC0zLjY5MzMgMjUuNzc3NywyLjg0MDcgMjguMTEwNyw3Ljk3MzcgQzMwLjQ0NDcsMTMuMTA3NyAyOC41Nzc3LDIxLjUwNzcgMjEuNTc3NywyNS43MDc3IEMxNC41Nzc3LDI5LjkwODcgOC45NzY3LDI4LjA0MDcgNi42NDM3LDI2LjY0MDcgWiIgaWQ9IlN0cm9rZS0xIiBzdHJva2Utd2lkdGg9IjEuNjAzIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwb2x5bGluZSBpZD0iU3Ryb2tlLTMiIHN0cm9rZS13aWR0aD0iMS42MDMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgcG9pbnRzPSIxNS40ODM1IDcgMTUuNDgzNSAxMS42NTIzNjY3IDE1LjQ4MzUgMTguMzczMTc1NiAxNS40ODM1IDIwLjk1NzEiPjwvcG9seWxpbmU+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik04LDEzLjE3OTggTDE0LjI5MDUyNjMsMTMuMTc5OCBDMTQuMjkwNTI2MywxMy4xNzk4IDIwLjU4MTA1MjYsMTIuNjIzOCAyMywxMy4xNzk4IiBpZD0iU3Ryb2tlLTUiIHN0cm9rZS13aWR0aD0iMS42MDMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",this.iconClosedPath="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzBweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMzAgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDQ3LjEgKDQ1NDIyKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5pY29uL21pbnVzIGljb248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz48L2RlZnM+CiAgICA8ZyBpZD0iU3ltYm9scyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Imljb24vUGx1cy1pY29uIiBzdHJva2Utd2lkdGg9IjEuNjAzIj4KICAgICAgICAgICAgPGcgaWQ9Imljb24vbWludXMtaWNvbiI+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNi42NDM3LDI2LjY0MDcgQzQuMzEwNywyNS4yNDE3IC00LjA4OTMsMTQuMDQwNyA0Ljc3NjcsNS4xNzM3IEMxMy42NDM3LC0zLjY5MzMgMjUuNzc3NywyLjg0MDcgMjguMTEwNyw3Ljk3MzcgQzMwLjQ0NDcsMTMuMTA3NyAyOC41Nzc3LDIxLjUwNzcgMjEuNTc3NywyNS43MDc3IEMxNC41Nzc3LDI5LjkwODcgOC45NzY3LDI4LjA0MDcgNi42NDM3LDI2LjY0MDcgWiIgaWQ9IlN0cm9rZS0xIiBzdHJva2U9IiMwMDNDMTYiIGZpbGw9Im5vbmUiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik01LjA2NDEsMTMuMTc5OCBMMTMuMDMyMSwxMy4xNzk4IEMxMy4wMzIxLDEzLjE3OTggMjEuMDAwMSwxMi42MjM4IDI0LjA2NDEsMTMuMTc5OCIgaWQ9IlN0cm9rZS01IiBzdHJva2U9IiMwMDNDMTYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4K",this.iconHoverOpenPath="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzBweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMzAgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDQ3LjEgKDQ1NDIyKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5pY29uL1BsdXMgaWNvbjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJTeW1ib2xzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iUXVlc3Rpb24tYWNjb3JkaWFuLWJsdWUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMDAwMDAwLCAtMS4wMDAwMDApIiBzdHJva2U9IiNGRkYiPgogICAgICAgICAgICA8ZyBpZD0iR3JvdXAtMTAiPgogICAgICAgICAgICAgICAgPGcgaWQ9Imljb24vUGx1cy1pY29uLWJsdWUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMDAwMDAwLCAxLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJQbHVzLWljb24iPgogICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNi42NDM3LDI2LjY0MDcgQzQuMzEwNywyNS4yNDE3IC00LjA4OTMsMTQuMDQwNyA0Ljc3NjcsNS4xNzM3IEMxMy42NDM3LC0zLjY5MzMgMjUuNzc3NywyLjg0MDcgMjguMTEwNyw3Ljk3MzcgQzMwLjQ0NDcsMTMuMTA3NyAyOC41Nzc3LDIxLjUwNzcgMjEuNTc3NywyNS43MDc3IEMxNC41Nzc3LDI5LjkwODcgOC45NzY3LDI4LjA0MDcgNi42NDM3LDI2LjY0MDcgWiIgaWQ9IlN0cm9rZS0xIiBmaWxsPSIjMDAzQzE2IiBzdHJva2Utd2lkdGg9IjEuNjAzIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwb2x5bGluZSBpZD0iU3Ryb2tlLTMiIHN0cm9rZS13aWR0aD0iMS42MDMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgcG9pbnRzPSIxNS40ODM1IDcgMTUuNDgzNSAxMS42NTIzNjY3IDE1LjQ4MzUgMTguMzczMTc1NiAxNS40ODM1IDIwLjk1NzEiPjwvcG9seWxpbmU+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik04LDEzLjE3OTggTDE0LjI5MDUyNjMsMTMuMTc5OCBDMTQuMjkwNTI2MywxMy4xNzk4IDIwLjU4MTA1MjYsMTIuNjIzOCAyMywxMy4xNzk4IiBpZD0iU3Ryb2tlLTUiIHN0cm9rZS13aWR0aD0iMS42MDMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg==",this.iconHoverClosedPath="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzBweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMzAgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDQ3LjEgKDQ1NDIyKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5pY29uL21pbnVzIGljb248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz48L2RlZnM+CiAgICA8ZyBpZD0iU3ltYm9scyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Imljb24vUGx1cy1pY29uIiBzdHJva2Utd2lkdGg9IjEuNjAzIj4KICAgICAgICAgICAgPGcgaWQ9Imljb24vbWludXMtaWNvbiI+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNi42NDM3LDI2LjY0MDcgQzQuMzEwNywyNS4yNDE3IC00LjA4OTMsMTQuMDQwNyA0Ljc3NjcsNS4xNzM3IEMxMy42NDM3LC0zLjY5MzMgMjUuNzc3NywyLjg0MDcgMjguMTEwNyw3Ljk3MzcgQzMwLjQ0NDcsMTMuMTA3NyAyOC41Nzc3LDIxLjUwNzcgMjEuNTc3NywyNS43MDc3IEMxNC41Nzc3LDI5LjkwODcgOC45NzY3LDI4LjA0MDcgNi42NDM3LDI2LjY0MDcgWiIgaWQ9IlN0cm9rZS0xIiBzdHJva2U9IiMwMDNDMTYiIGZpbGw9IiMwMDNDMTYiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik01LjA2NDEsMTMuMTc5OCBMMTMuMDMyMSwxMy4xNzk4IEMxMy4wMzIxLDEzLjE3OTggMjEuMDAwMSwxMi42MjM4IDI0LjA2NDEsMTMuMTc5OCIgaWQ9IlN0cm9rZS01IiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",this.iconWidth=30,this.iconHeight=30,this.headingLabel="Signaturforklaring",this.content=null,this.height=null,Object.assign(this,t)}}class ym extends mc{constructor(t){(t=t?t instanceof fm?t:new fm(t):new fm).olControl=new mm(t),super(t)}updateLegend(t){this.olControl.updateLegend(t)}activateShortcut(){this.olControl.addShortcut()}show(){super.show(),this.olControl.calcHeight(!1)}}class mm extends Fr{constructor(t){(t=t||new fm).element=mm.renderMainElement(),super(t),this.curLegendWrapHeight=null,this.button=null,this.options=t,this.openicon=null,this.closeicon=null,this.legendWrap=null,this.legendInnerWrapper=null}static renderMainElement(){var t=document.createElement("div");return t.className="ol-legend ol-unselectable ol-control",t}renderElem(){this.button=document.createElement("button"),this.button.innerHTML="<span>"+this.options.headingLabel+' <img style="display: none;" class="openicon" src="'+this.options.iconOpenPath+'" /><img class="closeicon" src="'+this.options.iconClosedPath+'" /></span>',this.button.className="legend-button",this.button.title="Vis/Skjul legende",this.openicon=this.button.querySelector(".openicon"),this.openicon.alt="Åbn signaturforklaring",this.closeicon=this.button.querySelector(".closeicon"),this.closeicon.alt="Luk signaturforklaring",this.options.iconWidth&&this.options.iconHeight&&(this.openicon.width=this.options.iconWidth,this.openicon.height=this.options.iconHeight,this.openicon.style.width="auto",this.openicon.style.height="auto",this.closeicon.width=this.options.iconWidth,this.closeicon.height=this.options.iconHeight,this.closeicon.style.width="auto",this.closeicon.style.height="auto"),this.legendWrap=document.createElement("div"),this.legendWrap.className="legend-content",this.legendInnerWrapper=document.createElement("div"),this.legendInnerWrapper.className="legend-content-wrapper",this.legendInnerWrapper.innerHTML=this.options.content||"",this.legendWrap.appendChild(this.legendInnerWrapper);var t=this;void 0!==this.legendWrap.children[0]&&this.legendWrap.children[0].addEventListener("click",(function(){t.close.call(t)})),this.button.addEventListener("click",(function(){t.legendWrap.classList.contains("open")?t.close.call(t):t.open.call(t)}),!1),t.options.iconHoverOpenPath&&t.options.iconHoverClosedPath&&(this.button.addEventListener("mouseover",(function(){t.openicon.src=t.options.iconHoverOpenPath,t.closeicon.src=t.options.iconHoverClosedPath})),this.button.addEventListener("mouseout",(function(){t.openicon.src=t.options.iconOpenPath,t.closeicon.src=t.options.iconClosedPath}))),this.element.appendChild(this.button),this.element.appendChild(this.legendWrap)}setMap(t){this.renderElem(),super.setMap.call(this,t),this.delayRenderHeightAfterImgLoad((function(){var t=this.getPreferredVisibility();null!==t?t?this.open():this.close():this.options.autoOpen&&this.open()}))}updateLegend(t){this.legendInnerWrapper.innerHTML=t,this.legendWrap.classList.contains("open")&&this.delayRenderHeightAfterImgLoad(function(){this.calcHeight(!1)}.bind(this))}setPreferredVisibility(t){fc.set(mm.COOKIES_PREFIX,(t?1:0).toString())}getPreferredVisibility(){let t=fc.get(mm.COOKIES_PREFIX);return null==t?null:1===parseInt(t)}open(t){t=(void 0!==t||null===t)&&t,this.legendWrap.classList.add("open"),this.legendWrap.classList.remove("closed"),this.openicon.style.display="none",this.closeicon.style.display="block",this.setPreferredVisibility(!0),this.calcHeight(t)}close(){this.legendWrap.classList.remove("open"),this.legendWrap.classList.add("closed"),this.openicon.style.display="block",this.closeicon.style.display="none",this.setPreferredVisibility(!1),this.legendWrap.style.height="0px"}calcHeight(t){if(t&&null!==this.curLegendWrapHeight)this.legendWrap.style.height=this.curLegendWrapHeight+"px";else{var e=this.legendInnerWrapper.getBoundingClientRect();if(e){var i=e.height+15;i<10&&(i=100),this.curLegendWrapHeight=i,this.legendWrap.style.height=i+"px"}}}addShortcut(){this.button.title+=" (ctrl + i)",document.addEventListener("keyup",function(t){t.ctrlKey&&"i"===t.key&&this.button.click()}.bind(this),!1)}delayRenderHeightAfterImgLoad(t){var e=this.legendInnerWrapper.querySelectorAll("img");let i=e.length,n=this;if(i>0){let r=i;for(let s=0;s<i;s++)e[s].complete||(e[s].setAttribute("data-org-display",e[s].style.display),e[s].style.display="none"),e[s].onerror=function(e){r--,e.target.hasAttribute("data-org-display")&&(e.target.style.display=e.target.getAttribute("data-org-display"),e.target.removeAttribute("data-org-display")),e.target.style.height="20px",0===r&&t.call(n)},e[s].onload=function(e){r--,e.target.hasAttribute("data-org-display")&&(e.target.style.display=e.target.getAttribute("data-org-display"),e.target.removeAttribute("data-org-display")),0===r&&t.call(n)}}else t.call(n)}}mm.COOKIES_PREFIX="ufst-basemap-legend";class _m extends fm{constructor(t){super(t),this.showMarkerIcons=!0,this.showStatusIcons=!0,Object.assign(this,t)}}class vm extends ym{constructor(t){super(t=t?t instanceof _m?t:new _m(t):new _m)}update(t){this.updateLegend(this.updateInternal(t))}updateInternal(t){let e=!1,i=[];for(let n=0;n<t.length;n++){let r=!1;for(let s=0;s<i.length;s++)t[n].icon==i[s].icon&&(r=!0),t[n].warning&&(e=!0);r||i.push(t[n])}let n=this.options;const r=pc.getIconProvider();let s=n.showMarkerIcons&&i.length>0?i.reduce((function(t,e){return"Struktur"===e.icon?t:t+'<li class="list-item"><span class="type">'+r.getImage(e,null,"signatur").outerHTML+'</span> <span class="text align-top">'+e.title+"</span></li>"}),""):"";return n.showStatusIcons&&e&&(s+=e?'<li class="list-item"><span class="type"><img src="'+pm+'" alt="Ikke sikkert placeret" title="Ikke sikkert placeret"></span><span class="text align-top">Ikke sikkert placeret</span></li>':""),""!=s?"<ul>"+s+"</ul>":""}}class Cm{constructor(t){if(this.isClusteredLayer=!1,this.style=null,t.style instanceof Ro)t.style=t.style.clone();else if(t.style instanceof Array){let e=t.style;t.style=[];for(let i=0;i<e.length;i++)t.style.push(e[i].clone())}else t.style instanceof Function||(t.style=void 0);Object.assign(this,t)}}class xm{constructor(t){this.onClick=()=>{},Object.assign(this,t)}}class wm extends Cm{constructor(t){super(t),this.map=null,this.autoActivate=!0,this.style=null,this.limitLayer=null,this.disabledUnclick=!0,this.events=null,Object.assign(this,t),this.events=t.events?t.events:new xm,this.style=t.style?t.style.clone():void 0}}class Mm extends Wr{constructor(t){super({}),this.options=null,this.feature=null,this.layerFilter=null,this.onlyClickedEvent=!1,this.needClickHandle=!1,this.options=t||new wm,this.handleDownEvent=this.handleDownEvent,this.handleUpEvent=this.handleUpEvent,this.handleDragEvent=this.handleDragEvent,this.stopDown=this.handleStopDown,this.layerFilter=this.options.limitLayer?function(t){return t===this.options.limitLayer}.bind(this):function(){return!0},this.onClickEvent=t.events.onClick,this.clickedEvent=t.events.onClicked?t.events.onClicked:(t,e)=>!1,this.unClickedEvent=t.events.onUnClicked?t.events.onUnClicked:(t,e)=>!1,this.clickedCoordinate=null,!t.events.onClick||t.events.onClicked||t.events.onUnClicked||(this.onlyClickedEvent=!0)}clickOnFeature(t,e){if(t){if(null!==this.feature&&this.isNewFeature(t)&&this.unClickFeature(this.feature,e),this.options.style){var i=t.getGeometry().getCoordinates();this.feature=new iu({geometry:new pn(i)}),this.feature.setStyle(this.options.style)}else this.setFeature(t);return this.clickedEvent([this.feature],e)}return!1}unClickFeature(t,e){let i=this.unClickedEvent([this.feature],e);return this.feature=null,i}handleDownEvent(t){return!t.dragging&&(this.clickedCoordinate=t.coordinate,this.onlyClickedEvent,this.needClickHandle=!0,!0)}handleUpEvent(t){if(!this.needClickHandle)return!1;if(this.clickedCoordinate[0]!=t.coordinate[0]&&this.clickedCoordinate[1]!=t.coordinate[1])return this.clickedCoordinate=null,!1;if(this.onlyClickedEvent)this.onClickEvent([t.coordinate[0],t.coordinate[1]],t);else{let e=this,i=this.getMap().forEachFeatureAtPixel(t.pixel,(function(t){return t}),{layerFilter:e.layerFilter});if(i&&i instanceof iu)return this.clickOnFeature(i,t);if(null===this.feature||this.options.disabledUnclick){if(this.onClickEvent){const e=t.coordinate;this.onClickEvent([e[0],e[1]],t)}}else{const e=this.unClickFeature(this.feature,t);if(e)return e;if(this.onClickEvent){const e=t.coordinate;this.onClickEvent([e[0],e[1]],t)}}}return this.clickedCoordinate=null,this.needClickHandle=!1,!1}handleDragEvent(t){this.needClickHandle&&(this.needClickHandle=!1)}handleStopDown(t){return!this.needClickHandle}addMousePointer(t){t?t.target.getTarget().classList.add("c-pointer"):this.getMap().getTargetElement().classList.add("c-pointer")}removeMousePointer(t){t?t.target.getTarget().classList.remove("c-pointer"):this.getMap().getTargetElement().classList.remove("c-pointer")}setFeature(t){this.feature=t}isNewFeature(t){return t!==this.feature}}class Em extends xm{constructor(t){super(t),Object.assign(this,t)}}class Im extends wm{constructor(t){super(t),this.isClusteredLayer=!1,this.events=null,Object.assign(this,t)}}class Sm extends Mm{constructor(t){((t=t?t instanceof Im?t:new Im(t):new Im).events.onMarkerClicked||t.events.onMarkerUnClicked||t.events.onClusteredClick)&&(t.events.onClicked=(e,i)=>{let n=[];if(e.length>0)if(t.isClusteredLayer){let t=e[0].get("features");if(t){if(t.length>1)return this.handleClusterClick(t,i);n.push(this.markFeature(t[0]))}else n.push(this.markFeature(e[0]))}else n.push(this.markFeature(e[0]));return!!this.onMarkerClickedEvent&&this.onMarkerClickedEvent(gc.filterNulls(n),i)},t.events.onUnClicked=(e,i)=>{let n=[];if(e.length>0)if(t.isClusteredLayer){let t=e[0].get("features");if(t)for(let e=0;e<t.length;e++)n.push(this.unMarkFeature(t[e]));else n.push(this.unMarkFeature(e[0]))}else n.push(this.unMarkFeature(e[0]));return!!this.onMarkerUnClickedEvent&&this.onMarkerUnClickedEvent(gc.filterNulls(n),i)}),super(t),this.onMarkerClickedEvent=t.events.onMarkerClicked?t.events.onMarkerClicked:null,this.onMarkerUnClickedEvent=t.events.onMarkerUnClicked?t.events.onMarkerUnClicked:null,this.onClusteredClickEvent=t.events.onClusteredClick?t.events.onClusteredClick:null}addEvent(t,e){switch(t){case Jy.onClick:this.onClickEvent=e,this.onlyClickedEvent=!(this.onMarkerClickedEvent||this.onMarkerUnClickedEvent||Jy.onMarkerClusteredClick);break;case Jy.onMarkerClicked:this.onMarkerClickedEvent=e,this.onlyClickedEvent=!1;break;case Jy.onMarkerUnClicked:this.onMarkerUnClickedEvent=e,this.onlyClickedEvent=!1,this.options.disabledUnclick=!1;break;case Jy.onMarkerClusteredClick:this.onClusteredClickEvent=e,this.onlyClickedEvent=!1;break;default:return}}markFeature(t){let e=t.get("marker");return e?(this.options.map.setMarkerSelectedState(e.id,!0,!0),e):null}unMarkFeature(t){let e=t.get("marker");return e?(this.options.map.setMarkerSelectedState(e.id,!1),e):null}handleClusterClick(t,e){if(this.onClusteredClickEvent){let i=[];for(let e=0;e<t.length;e++)i.push(t[e].get("marker"));return this.removeMousePointer(e),this.onClusteredClickEvent(i,e)}var i=null;for(let e=0;e<t.length;e++)i=i?gt(i,t[e].getGeometry().getExtent()):t[e].getGeometry().getExtent();if(this.removeMousePointer(e),this.options.map){const t=this.getMap().getView();this.options.map.fit(gc.extentToArray(i),{minResolution:t.getMinResolution()})}return!0}isNewFeature(t){if(this.options.isClusteredLayer){let e=t.get("features");const i=this.feature?this.feature.get("features"):null;return!(e&&i&&e.length>0&&i.length>0)||e[0]!==i[0]}return super.isNewFeature(t)}}class Lm{constructor(t){this.onHovered=function(){return!1},this.onUnHovered=function(){return!1},this.onMouseMove=function(){},Object.assign(this,t)}}class bm extends Cm{constructor(t){super(t),this.map=null,this.isClusteredLayer=!1,this.autoActivate=!0,this.events=null,this.limitLayers=null,this.limitFeatures=null,this.condition=()=>!0,Object.assign(this,t)}}class Rm extends Wr{constructor(t){super(),this.options=null,this.feature=null,this.layerFilter=null,this.featureFilter=null,this.options=t||new bm,this.handleMoveEvent=this.handlePointerMoveEvent,this.layerFilter=this.options.limitLayers?t=>{for(let e=0;e<this.options.limitLayers.length;e++)if(t===this.options.limitLayers[e])return!0;return!1}:()=>!0,this.featureFilter=this.createFeatureFilter(),this.hoverEvent=t.events&&t.events.onHovered?t.events.onHovered:(t,e)=>!1,this.unHoverEvent=t.events&&t.events.onUnHovered?t.events.onUnHovered:(t,e)=>!1,this.onMouseMove=t.events&&t.events.onMouseMove?t.events.onMouseMove:t=>{}}createFeatureFilter(){return this.options.limitFeatures?this.options.isClusteredLayer?function(t){let e=t.get("features");if(e.length>1)return t;{let i=!1;for(let t=0;t<this.options.limitFeatures.length;t++)if(this.options.limitFeatures[t]==e[0]){i=!0;break}return i?t:null}}.bind(this):function(t){let e=!1;for(let i=0;i<this.options.limitFeatures.length;i++)if(this.options.limitFeatures[i]==t){e=!0;break}return e?t:null}.bind(this):function(t){return t}}handlePointerMoveEvent(t){if(!this.options.condition(t))return console.log("move disabled"),!1;if(this.onMouseMove(t),t.dragging)return!1;let e=this.getMap().forEachFeatureAtPixel(t.pixel,this.featureFilter,{layerFilter:this.layerFilter});return e&&e instanceof iu?this.isNewFeature(e)&&this.hoverOnFeature(e,t):null!==this.feature&&this.unHoverFeature(this.feature,t),!1}hoverOnFeature(t,e,i=!0){return t&&(null!==this.feature&&this.feature!=t&&i&&this.unHoverEvent([this.feature],e),this.feature=t,this.addMousePointer(e),i&&this.hoverEvent([this.feature],e)),!1}unHoverFeature(t,e,i=!0){i&&this.unHoverEvent([this.feature],e),this.feature=null,this.removeMousePointer(e)}isNewFeature(t){if(!this.feature)return!0;if(this.options.isClusteredLayer){let e=t.get("features");if(e){if(1==e.length){let t=e[0].get("id"),i=this.feature.get("features");return!i||1!=i.length||t!==i[0].get("id")}return t!=this.feature}return t!=this.feature}return t!=this.feature}addMousePointer(t){t?t.target.getTarget().classList.add("c-pointer"):this.getMap().getTargetElement().classList.add("c-pointer")}removeMousePointer(t){t?t.target.getTarget().classList.remove("c-pointer"):this.getMap().getTargetElement().classList.remove("c-pointer")}}class Nm{constructor(t){this.onMenuItemClicked=function(){},this.onZoomStart=function(){},this.onZoomEnd=function(){},Object.assign(this,t)}}class Am{constructor(t){this.events=null,this.zoomDuration=300,this.map=null,Object.assign(this,t),this.events=this.events?this.events:new Nm}}class Tm extends ks{constructor(t){t=t||new Am,super({positioning:"bottom-center",autoPan:!1,className:"cluster-popup-label ol-overlay-container ol-selectable",offset:[0,-15]}),this.isPopupOpened=!1,this.mOptions=t}setMap(t){super.setMap(t),this.popupList=document.createElement("ul"),this.popupList.className="list-group",this.element.appendChild(this.popupList),this.element.addEventListener("mouseenter",(t=>{this.timerPopupClose&&(clearTimeout(this.timerPopupClose),this.timerPopupClose=null)})),this.element.addEventListener("mouseover",(t=>{this.timerPopupClose&&(clearTimeout(this.timerPopupClose),this.timerPopupClose=null)})),this.element.addEventListener("mouseleave",(t=>{this.removePopup()})),t.getView().on("change",function(){this.removePopup()}.bind(this))}showPopup(t,e){if(this.timerPopupClose&&(clearTimeout(this.timerPopupClose),this.timerPopupClose=null),this.isPopupOpened)return;this.popupList.innerHTML="";const i=pc.getIconProvider();let n=t.filter((t=>"tekniskanlaeg"!=t.get("marker").type?t:null)),r=t.filter((t=>"tekniskanlaeg"==t.get("marker").type?t:null));n.sort(this.sortMarker),r.sort(this.sortMarker);const s=n.concat(r);for(let t=0;t<s.length;t++){let e=s[t],n=e.get("marker"),r=document.createElement("li");r.setAttribute("id",n.id),r.className="list-group-item list-group-item-action type";let o=document.createElement("span");o.className="icon-span",o.appendChild(i.getImage(n)),r.appendChild(o);let a=document.createElement("span");a.innerHTML="<strong>"+("tekniskanlaeg"==n.type?"Teknisk anlæg "+n.shortname.replace("T",""):"Bygning "+n.shortname)+"</strong>",r.appendChild(a),r.addEventListener("click",(t=>{this.handleMenuClick(e)})),this.popupList.appendChild(r)}this.setPosition(e),this.isPopupOpened=!0}removePopup(){this.isPopupOpened&&(this.timerPopupClose&&(clearTimeout(this.timerPopupClose),this.timerPopupClose=null),this.timerPopupClose=setTimeout((()=>{this.setPosition(null),this.isPopupOpened=!1,this.timerPopupClose=null}),100))}handleMenuClick(t){this.mOptions.events.onMenuItemClicked(t),this.mOptions.map&&this.mOptions.map.setMarkerSelectedState(t.get("id"),!0),this.mOptions.events.onZoomStart(t),this.getMap().getView().fit(t.getGeometry(),{duration:this.mOptions.zoomDuration,padding:this.getZoomPadding(),callback:function(){this.mOptions.events.onZoomEnd(t)}.bind(this)})}sortMarker(t,e){const i=t.get("marker"),n=e.get("marker");return i.shortname>n.shortname?1:i.shortname<n.shortname?-1:0}getZoomPadding(){return this.mOptions.view&&this.mOptions.view.padding?this.mOptions.view.padding:void 0}}class Pm extends Lm{constructor(t){super(t),Object.assign(this,t)}}class Om extends bm{constructor(t){super(t),this.events=null,this.clickHandler=null,Object.assign(this,t)}}class Dm extends Rm{constructor(t){(t=null!==t?t:new Om).events=t.events?t.events:new Pm,t.events.onHovered=(e,i)=>{let n=[];if(e.length>0)if(t.isClusteredLayer){let t=e[0].get("features");if(t){if(t.length>1)return this.markerOverlay.showPopup(t,e[0].getGeometry().getCoordinates()),!0;n.push(this.hoverFeatureInternal(t[0]))}else n.push(this.hoverFeatureInternal(e[0]))}else n.push(this.hoverFeatureInternal(e[0]));return!this.onMarkerHoveredEvent||this.onMarkerHoveredEvent(gc.filterNulls(n),i)},t.events.onUnHovered=(e,i)=>{let n=[];if(e.length>0)if(t.isClusteredLayer){let t=e[0].get("features");if(t){if(t.length>1)return this.markerOverlay.removePopup(),!0;n.push(this.unHoverFeatureInternal(t[0]))}else n.push(this.unHoverFeatureInternal(e[0]))}else n.push(this.unHoverFeatureInternal(e[0]));return!this.onMarkerUnHoveredEvent||this.onMarkerUnHoveredEvent(gc.filterNulls(n),i)},super(t),this.onMarkerHoveredEvent=t.events.onMarkerHovered?t.events.onMarkerHovered:null,this.onMarkerUnHoveredEvent=t.events.onMarkerUnHovered?t.events.onMarkerUnHovered:null}addEvent(t,e){switch(t){case Jy.onMarkerHovered:this.onMarkerHoveredEvent=e;break;case Jy.onMarkerUnHovered:this.onMarkerUnHoveredEvent=e;break;default:return}}setMap(t){super.setMap(t),this.markerOverlay=new Tm(new Am({events:new Nm({onZoomStart:function(t){this.removeMousePointer(),this.options.clickHandler.clickOnFeature(t,null)}.bind(this),onZoomEnd:function(t){}.bind(this)})})),t.addOverlay(this.markerOverlay)}hoverFeatureInternal(t){let e=t.get("marker");return e?(this.options.map.setMarkerActiveState(e.id,!0),e):null}unHoverFeatureInternal(t){let e=t.get("marker");return e?(this.options.map.setMarkerActiveState(e.id,!1),e):null}}class km{constructor(t){Object.assign(this,t)}}class Fm{static addEvent(t,e,i,n){let r=null,s=null,o=t.getInteractions().getArray();switch(e){case Jy.onClick:r=Sm,s=new Im({limitLayer:n.limitLayer,isClusteredLayer:n.isClusteredLayer,events:new Em({onClick:i}),map:n.map});break;case Jy.onMarkerClicked:r=Sm,s=new Im({limitLayer:n.limitLayer,isClusteredLayer:n.isClusteredLayer,events:new Em({onMarkerClicked:i}),map:n.map});break;case Jy.onMarkerUnClicked:r=Sm,s=new Im({limitLayer:n.limitLayer,isClusteredLayer:n.isClusteredLayer,events:new Em({onMarkerUnClicked:i}),map:n.map});break;case Jy.onMarkerHovered:r=Dm,s=new Om({limitLayers:[n.limitLayer],isClusteredLayer:n.isClusteredLayer,clickHandler:Fm.findInteraction(o,Sm),events:new Pm({onMarkerHovered:i}),map:n.map});break;case Jy.onMarkerUnHovered:r=Dm,s=new Om({limitLayers:[n.limitLayer],isClusteredLayer:n.isClusteredLayer,clickHandler:Fm.findInteraction(o,Sm),events:new Pm({onMarkerUnHovered:i}),map:n.map});break;default:return}let a=o.find((function(t){if(t instanceof r)return t}));if(a)switch(r){case Sm:case Dm:a.addEvent(e,i);break;default:return}else t.addInteraction(new r(s))}static findInteraction(t,e){for(let i=0;i<t.length;i++)if(t[i]instanceof e)return t[i];return null}}class Gm{constructor(t){this.allowInvalidGrunddataKeys=!0,this.allowExternalCallToFailed=!0,this.allowParserError=!0,this.timeout=_g.timeoutLength,Object.assign(this,t)}getFetcherOptions(){return new am({allowInvalidGrunddataKeys:this.allowInvalidGrunddataKeys,allowExternalCallToFailed:this.allowExternalCallToFailed,allowParserError:this.allowParserError,timeout:this.timeout})}}class Hm{constructor(t){this.startupCenter=null,this.startupZoom=null,this.maxZoom=null,this.startupExtent=null,this.grunddataKeys=null,this.grunddataKeysOptions=null,this.markers=null,this.profile="bbr",this.useCluster=!0,this.padding=null,this.defaultDuration=300,this.skipAnimateOnFirstLoad=!1,t?(t.grunddataKeysOptions=t.grunddataKeysOptions instanceof Gm?t.grunddataKeysOptions:t.grunddataKeysOptions?new Gm(t.grunddataKeysOptions):new Gm,Object.assign(this,t)):this.grunddataKeysOptions=new Gm}}class Vm{constructor(t){this.controls=null,this.layers=null,this.interactions={},this.view=null,this.events=null,this.activateDefaultShortcut=!1,this.controlContainerClass=null,this.showGeoLocationButton=!1,t?t.view=t.view instanceof Hm?t.view:t.view?new Hm(t.view):new Hm:t={view:new Hm},Object.assign(this,t)}}class jm{constructor(t,e){this.dkCenter=[6e5,6237500],this.resolutions=[1638.4,819.2,409.6,204.8,102.4,51.2,25.6,12.8,6.4,3.2,1.6,.8,.4,.2,.1,.05,.025],this.layers=null,this.legendCtrl=null,this.markerFeatures=new H,this.markerSource=new tu({features:this.markerFeatures}),this.notificationCenterOverlay=null,this.serviceStatus=null,this.controls=[],this.evtMoveStarted=null,this.evtHandleMoveEventAdded=null,this.evtHandleCenterEventFunc=null,this.evtZoomStartet=!1,this.maskGeometry=null,this.controlContainer=null,this.grunddataKeys=[];let i=document.getElementById(t);if(null===i)throw new Error("mapDiv "+t+" was not found in the DOM model");this.options=e instanceof Vm?e:e?new Vm(e):new Vm,"retbbr"===this.options.view.profile&&(i.className+=" ret-bbr-basemap ret-bbr-profile"),i.className="ufst-basemap",this.setupMap(i,this.options)}getOLMap(){return this.map}getMarkerLayer(){return this.overlayLayer}getClusterSource(){return this.markerClusterSource}addControl(t){if(t.setMap(this),this.controls.push(t),t.getTargetElem()||t.getOLControl().setTarget(this.controlContainer),this.map.addControl(t.getOLControl()),t instanceof vm){this.legendCtrl=t;let e=this.getMarkers();e.length>0&&this.legendCtrl.update(e)}this.options.activateDefaultShortcut&&t.activateShortcut()}getControls(){return this.controls}getControlById(t){for(let e=0;e<this.controls.length;e++)if(this.controls[e].getId()===t)return this.controls[e]}addLayer(t){this.layers||(this.layers=[]),t.setMap(this),this.layers.push(t);let e=this.map.getLayers();if(e.getLength()>0&&e.item(e.getLength()-1)==this.overlayLayer?e.insertAt(e.getLength()-1,t.getOLLayer()):this.map.addLayer(t.getOLLayer()),t.supportMask()&&t.updateMaskGeometry(this.maskGeometry),t.supportMarkers()&&t.updateMarkers(this.getMarkers()),t.isBackgroundLayer())if(1==e.getLength())t.setVisible(!0);else{let e=0;for(let t=0;t<this.layers.length;t++){let i=this.layers[t];i.isBackgroundLayer()&&i.getVisible()&&e++}0==e&&t.setVisible(!0)}}getLayers(){return this.layers}getLayerByName(t){for(var e=0;e<this.layers.length;e++)if(this.layers[e].getLayerName()===t)return this.layers[e];return null}zoomTo(t){this.setZoomLevel(t)}zoomToMaxLevel(){this.setMaxZoomLevel()}getCurrentZoomLevel(){return this.getZoomLevel()}setZoomLevel(t){this.view.setZoom(t)}setMaxZoomLevel(){this.view.setZoom(this.view.getMaxZoom())}getMaxZoomLevel(){return this.view.getMaxZoom()}getZoomLevel(){return this.view.getZoom()}zoomToExtent(t){const e=this.view.getResolutionForExtent(t),i=this.view.getResolutions();if(i){let n=null;for(let t=i.length-1;t>=0;t--)if(e<i[t]){n=i[t];break}null===n&&(n=i[0]),this.fit(t,{minResolution:n})}else this.fit(t)}goToExtent(t){this.fit(t,{maxZoom:this.view.getZoom()})}fit(t,e){const i=this.options.view.padding,n=this.options.view.maxZoom;let r=Object.assign({},this.view.isDef()?{duration:this.options.view.defaultDuration}:{},e||{});i&&(r=Object.assign(r,{padding:i})),!e.maxZoom&&n&&(r=Object.assign(r,{maxZoom:n})),this.options.view.skipAnimateOnFirstLoad&&isNaN(this.view.getZoom())&&delete r.duration,this.view.fit(t,r)}zoomToGeometry(t){if(!t)return;let e=null;if(t instanceof Fy)e=t.getGeometry().getExtent();else{const i=jy.parseGeom(t);i&&(e=i.getGeometry().getExtent())}e&&this.zoomToExtent(gc.extentToArray(e))}zoomToGeometries(t){if(!t)return;t.length||this.zoomToGeometry(t[0]);const e=[1/0,1/0,-1/0,-1/0];for(let i=0;i<t.length;i++){let n=t[i],r=null;if(n instanceof Fy)r=t[i].getGeometry().getExtent();else{let t=jy.parseGeom(n);t&&(r=t.getGeometry().getExtent())}r&&gt(e,r)}this.zoomToExtent(gc.extentToArray(e))}zoomToGeoLocation(){const t=this.getControlById(Mc);t&&t instanceof Ic&&t.zoomToGeoLocation()}setPadding(t){this.options.view.padding=t}setCenter(t,e){this.view.setCenter([t,e])}getCurrentExtent(){return gc.extentToArray(this.view.calculateExtent())}currentExtentContainsXY(t,e){return this.isCoordinateInView(t,e)}isCoordinateInView(t,e){return at(this.getCurrentExtent(),t,e)}getTarget(){return this.map.getTargetElement()}getNotificationCenterInline(){return this.notificationCenterInline}setNotificationOverlayPosition(t){this.notificationCenterInline.setVisible(!0),this.notificationCenterOverlay.setPosition(t)}getStatusService(){return this.serviceStatus}addEvent(t,e){this.handleAddEvent(t,e)}updateMapSize(){this.map.updateSize()}getMaskGeometry(){return this.maskGeometry}zoomToMask(){const t=this.getMaskGeometry();t&&0!=t.length&&this.zoomToGeometries(t)}clearMask(){this.updateMaskGeometries(null)}clear(){this.clearMarkers(),this.clearMask(),this.clearGrunddataKeys()}updateMaskGeometry(t){this.updateMaskGeometries([t])}updateMaskGeometries(t){this.maskGeometry=t;for(let e=0;e<this.layers.length;e++)this.layers[e].supportMask()&&this.layers[e].updateMaskGeometry(t)}setMaskAndZoomToGeometry(t,e=!0){this.updateMaskGeometry(t),e&&this.zoomToGeometry(t)}setMaskAndZoomToGeometries(t,e=!0){this.updateMaskGeometries(t),e&&this.zoomToGeometries(t)}setMatrikel(t,e,i=!0){return this.setGrunddataKeys([{landsejerlavskode:t,matrikelNr:e}],!1,i)}setGrunddataKey(t,e=!1,i=!0){return this.setGrunddataKeys([t],e,i)}setGrunddataKeys(t,e=!1,i=!0){return hm.Fetch(t,this.options.view.grunddataKeysOptions.getFetcherOptions()).then((t=>{let n=[];this.grunddataKeys=e?this.grunddataKeys.concat(t):t,this.grunddataKeys.forEach((t=>{n.push(t.geometry)})),this.setMaskAndZoomToGeometries(n,i)})).catch((t=>{let e=$y.UNK_ERROR,i=null;t instanceof lm?(e=t.errorCode,i=t.data):i=t,this.options.events&&this.options.events.onMapError&&this.options.events.onMapError(e,i)}))}getGrunddataKeys(){return this.grunddataKeys}clearGrunddataKeys(){this.grunddataKeys=[]}zoomToMarkers(){const t=this.markerFeatures.getLength();if(0===t)return;let e=[1/0,1/0,-1/0,-1/0];for(let i=0;i<t;i++)e=gt(e,this.markerFeatures.item(i).getGeometry().getExtent());this.zoomToExtent(gc.extentToArray(e))}zoomToMarker(t){let e=this.getMarkerFeature(t);e&&this.fit(gc.extentToArray(e.getGeometry().getExtent()))}goToMarker(t){let e=this.getMarkerFeature(t);e&&this.goToExtent(gc.extentToArray(e.getGeometry().getExtent()))}clearMarkers(){this.markerFeatures.clear()}setMarker(t){this.setMarkers([t])}setMarkers(t){this.markerFeatures.clear();for(let e=0;e<t.length;e++){const i=t[e],n=new iu({id:i.id,geometry:new pn([i.x,i.y]),marker:i,selected:i.selected,active:i.active});n.set("markerProp",i),this.markerFeatures.push(n)}if(this.legendCtrl&&this.legendCtrl.update(t),this.layers)for(let e=0;e<this.layers.length;e++)this.layers[e].supportMarkers()&&this.layers[e].updateMarkers(t)}getMarkers(){let t=[];for(let e=0;e<this.markerFeatures.getLength();e++)t.push(this.markerFeatures.item(e).get("markerProp"));return t}getMarkerById(t){for(let e=0;e<this.markerFeatures.getLength();e++){let i=this.markerFeatures.item(e).get("markerProp");if(i&&i.id==t)return i}return null}removeMarker(t){let e=null,i=[];for(let n=0;n<this.markerFeatures.getLength();n++){let r=this.markerFeatures.item(n).get("markerProp");r&&r.id==t.id?e=this.markerFeatures.item(n):i.push(r)}if(e&&(this.markerFeatures.remove(e),this.legendCtrl&&this.legendCtrl.update(i),this.layers))for(let t=0;t<this.layers.length;t++)this.layers[t].supportMarkers()&&this.layers[t].updateMarkers(i)}setMarkerActiveState(t,e,i=!0){function n(t,e){let i=t.get("marker");i.active!=e&&(i.active=e,t.set("active",e),t.changed())}if(i)for(let i=0;i<this.markerFeatures.getLength();i++){let r=this.markerFeatures.item(i);n(r,r.get("id")==t&&e)}else{let i=this.getMarkerFeature(t);i&&n(i,e)}}setMarkerSelectedState(t,e,i=!0){function n(t,e){let i=t.get("marker");i.selected!=e&&(i.selected=e,t.set("selected",e),t.changed())}if(i)for(let i=0;i<this.markerFeatures.getLength();i++){let r=this.markerFeatures.item(i);n(r,r.get("id")==t&&e)}else{let i=this.getMarkerFeature(t);i&&n(i,e)}}setMarkerCoordinate(t,e){let i=this.getMarkerFeature(t);if(i){let t=i.get("marker");t&&(e?(t.x=e[0],t.y=e[1]):(t.x=0,t.y=0),i.getGeometry().setCoordinates([t.x,t.y]))}}setMarkerProperty(t,e,i){let n=this.getMarkerFeature(t);if(n){let t=n.get("marker");t&&(t[e]=i)}}handleMapLoad(){const t=this.options.events&&this.options.events.onMapLoaded?this.options.events.onMapLoaded:null;t&&t()}setupMap(t,e){try{this.serviceStatus=new Lg,this.notificationCenterOverlay=this.createNotificationCenter(t),this.map=new Is({target:t,controls:[],interactions:[],layers:[],overlays:[this.notificationCenterOverlay],view:this.parseView(e),loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0}),this.controlContainer=document.createElement("div"),this.controlContainer.className=e.controlContainerClass||"ctrl-container",t.appendChild(this.controlContainer),this.parseAndAddLayers(t,e);let i=this.parseInteractions(e);for(let t=0;t<i.getLength();t++)this.map.addInteraction(i.item(t));this.view=this.map.getView(),this.view.set("dkCenterCoordinate",this.dkCenter),this.parseAndAddControls(this.controlContainer,e),e.events&&e.events.onMapViewChanged&&this.map.on(["moveend"],(()=>{const t=this.map.getSize();e.events.onMapViewChanged(this.view.getCenter(),[t[0],t[1]],this.view.getZoom())}))}catch(t){console.error("Map setmap"),console.error(t)}}setControlContainerClass(t){this.controlContainer.className=t}getMarkerFeature(t){for(let e=0;e<this.markerFeatures.getLength();e++){let i=this.markerFeatures.item(e);if(i.get("id")==t)return i}return null}parseAndAddLayers(t,e){var i=new Ky({layers:e.layers,serviceStatus:this.serviceStatus});for(let t of i.getLayers())this.addLayer(t);this.map.addLayer(this.overlayLayer)}parseView(t){this.dkProjection=this.createDKProjection(),si(this.dkProjection);let e=oi("EPSG:25832"),i=null;pc.setProvider(this.options.view.profile);let n=!0,r=t.view.startupCenter;t.view.startupExtent&&4===t.view.startupExtent.length&&(i=t.view.startupExtent,r||(r=wt(i)));const s=new Pn({center:r||this.dkCenter,projection:e,resolutions:this.resolutions});return this.createClusterSource(s),this.overlayLayer=new rh({source:t.view.useCluster?this.markerClusterSource:this.markerSource,visible:!0,style:gm,properties:{name:"featureOverlay"}}),i&&(n=!1,s.fit(i)),t.view.grunddataKeys&&t.view.grunddataKeys.length&&(n=!1,this.setGrunddataKeys(t.view.grunddataKeys).then((t=>{this.handleMapLoad()}))),t.view.markers&&t.view.markers.length&&this.setMarkers(t.view.markers),n&&s.setZoom(null!==t.view.startupZoom?t.view.startupZoom:2),s}createClusterSource(t){if(this.options.view.useCluster){let t=30;this.markerClusterSource=new nu({distance:t,source:this.markerSource,geometryFunction:function(t){return t.get("disabledCluster")?null:t.getGeometry()}})}else this.markerClusterSource=null}parseAndAddControls(t,e){let i=new Xy(t,{controls:e.controls,showGeoLocationButton:e.showGeoLocationButton});for(let t of i.getControls())this.addControl(t)}parseInteractions(t){const e=t.interactions||{},i=1==e.useCtrlOnMouseWheelZoom;let n=null;return n=Cs({dragPan:0!=e.enableMapMouseDrag,pinchRotate:0!=e.enablePinchRotate,mouseWheelZoom:!i&&0!=e.enableMouseWheelScroll,pinchZoom:0!=e.enablePinchZoom,doubleClickZoom:0!=e.enableDoubleClickZoom,shiftDragZoom:0!=e.shiftDragZoom}),i&&0!=e.enableMouseWheelScroll&&n.push(new im),t.events&&(t.events.onMarkerClicked&&this.handleAddEvent(Jy.onMarkerClicked,t.events.onMarkerClicked),t.events.onMarkerUnClicked&&this.handleAddEvent(Jy.onMarkerUnClicked,t.events.onMarkerUnClicked),t.events.onClick&&this.handleAddEvent(Jy.onClick,t.events.onClick),t.events.onMarkerHovered&&this.handleAddEvent(Jy.onMarkerHovered,t.events.onMarkerHovered),t.events.onMarkerUnHovered&&this.handleAddEvent(Jy.onMarkerUnHovered,t.events.onMarkerUnHovered)),n}createDKProjection(){let t=new be({code:"EPSG:25832",extent:[12e4,5661139.2,958860.8,65e5],units:"m",getPointResolution:function(e,i){var n=[i[0]-e/2,i[0]+e/2,i[1]-e/2,i[1]+e/2];return(n[1]-n[0]+(n[3]-n[2]))/2/t.getMetersPerUnit()}});return t}createNotificationCenter(t){this.notificationCenter=new tm(t),this.notificationCenterInline=new tm(t,"inline");var e=this.notificationCenterInline.getTarget();let i=new ks({element:e,autoPan:!0,positioning:"center-center"});return e.style.width="20em",this.notificationCenterInline.registerOnCloseEvent((function(){e.children.length||i.setPosition(void 0)}),this),i}handleAddEvent(t,e){let i=this,n=t;switch(n){case"change:center":case"change:resolution":if(null===this.evtHandleMoveEventAdded&&(this.map.on("pointerdrag",(function(){i.evtMoveStarted=!0})),this.map.on("moveend",(function(t){if(null!==i.evtHandleCenterEventFunc){var e=t.map.getView().getCenter();i.evtHandleCenterEventFunc.call(i,e)}i.evtMoveStarted=!1})),this.evtHandleMoveEventAdded=!0),"change:resolution"===n){var r=null;this.map.getView().on(n,(function(t){this.evtMoveStarted||null===r&&(this.evtZoomStartet=!0,r=setTimeout((function(){var t=i.map.getView().getZoom();e.call(i,t),i.evtZoomStartet=!1,r=null}),255))}))}if("change:center"===n){this.evtHandleCenterEventFunc=e;var s=null;this.map.getView().on(n,(function(t){i.evtMoveStarted||i.evtZoomStartet||null===s&&(s=setTimeout((function(){var t=i.map.getView().getCenter();e.call(i,t),s=null}),255))}))}break;case Jy.onClick:case Jy.onMarkerClicked:case Jy.onMarkerUnClicked:case Jy.onMarkerHovered:case Jy.onMarkerUnHovered:let o=new km({limitLayer:this.overlayLayer,isClusteredLayer:this.options.view.useCluster,map:this});Fm.addEvent(this.map,t,e,o);break;default:this.map.on(n,(function(t){e.call(i,t)}))}}}class zm extends Mg{constructor(t){super(t),this.useDimLayer=!0,this.useGrayLayer=!1,Object.assign(this,t)}}class Bm extends Bg{constructor(t,e){(t=t?t instanceof zm?t:new zm(t):new zm).type="SKAT.BaseMap.Layer.WMTS.Skaermkort",t.isBackgroundLayer=!0,t.name=t.name?t.name:"Skærmkort",t.extent=t.extent?t.extent:xg;let i=t.useDimLayer?"topo_skaermkort_daempet":t.useGrayLayer?"topo_skaermkort_graa":"topo_skaermkort",n=t.useDimLayer?"topo_skaermkort_daempet":t.useGrayLayer?"topo_skaermkort_graa":"topo_skaermkort_wmts";super(e=e||new zg({attributions:Cg,urls:[fg.getDAFUrl()+"Dkskaermkort/"+n+"/1.0.0/wmts?"+fg.getDAFLogin()],layer:i,wmtsServiceStatusOptions:new Vg({label:"Dafordeleren Skærmkort (WMTS)",service:n,layer:i})}),t)}}class Um extends Zg{constructor(t,e,i,n){t=t?t instanceof Tg?t:new Tg(t):new Tg,e=e?e instanceof zm?e:new zm(e):new zm,(i=i?i instanceof Mg?i:new Mg(i):new Mg({visible:!1})).type="SKAT.BaseMap.Layer.Group.Skaermkort",i.name="Skærmkort",e.minResolution=.05,e.visible=!0,t.maxResolution=.05,t.visible=!0,i.isBackgroundLayer=!0,super([new Bm(e,n),new Pg(t)],i)}}class Zm extends Um{constructor(t){super(new Tg({useGrayLayer:!1,useDimLayer:!1}),new zm({useGrayLayer:!1,useDimLayer:!1}),t)}}class Ym extends Um{constructor(t){super(new Tg({useDimLayer:!1,useGrayLayer:!0}),new zm({useDimLayer:!1,useGrayLayer:!0}),t)}}class Wm extends Um{constructor(t){super(new Tg({useDimLayer:!0,useGrayLayer:!1}),new zm({useDimLayer:!0,useGrayLayer:!1}),t)}}class Xm extends Ng{constructor(t){(t=t||new Rg).type="SKAT.BaseMap.Layer.WMS.Matrikel",t.name=t.name?t.name:"Matrikel";let e={attributions:Cg,url:gc.appendParamsToUrl(gg.url,"forvaltning2?Token="+gg.getToken()),params:{LAYERS:"matrikelskel,matrikeltekst",TRANSPARENT:"TRUE",SERVICE:"WMS",VERSION:"1.1.1"},ratio:1};t.wmsServiceStatusOptions=new bg({label:"Kortforsyningen Forvaltning (matrikelskel)",service:"forvaltning2",layer:e.params.LAYERS}),super(new co({source:new Vh(e),maxResolution:t.maxResolution?t.maxResolution:1.5}),t)}}class qm extends Ng{constructor(t){(t=t||new Rg).name=t.name?t.name:"Adresse";let e={attributions:Cg,url:`${fg.getDAFUrl()}DAR/WMSadgangsadresser/1.0.0/Wms?${fg.getDAFLogin()}`,params:{LAYERS:"adgangsadresser",TRANSPARENT:"TRUE",SERVICE:"WMS",VERSION:"1.3.0"}};t.wmsServiceStatusOptions=new bg({service:"dawa",label:"Kortforsyningen Forvaltning (matrikelskel)",layer:e.params.LAYERS}),super(new co({source:new Vh(e),maxResolution:t.maxResolution?t.maxResolution:6.4}),t)}}class Km extends Ng{constructor(t){t=t||new Rg({visible:!0});let e={attributions:Cg,url:gc.appendParamsToUrl(gg.url,"forvaltning2?Token="+gg.getToken()),params:{LAYERS:"Vejnavne_ortofoto",TRANSPARENT:"TRUE",SERVICE:"WMS",VERSION:"1.1.1"}};t.wmsServiceStatusOptions=new bg({label:"Kortforsyningen Forvaltning (Vejnavn)",service:"forvaltning2",layer:e.params.LAYERS}),super(new co({source:new Vh(e),maxResolution:6.4}),t),this.eventMap=[]}setMap(t){super.setMap(t),t.getOLMap().getLayers().on("add",(t=>{var e=t&&t.element?t.element:null;this.addVisibleEvent(e)})),t.getLayers().forEach((t=>{this.addVisibleEvent(t,!0)}))}addVisibleEvent(t,e){let i=null,n=this;if(t&&(i=t instanceof Zg||t instanceof Eg?t.getOLLayer():t),null==i)throw"Layer missing OlLayer";let r=i.get("type");r&&("SKAT.BaseMap.Layer.Group.Ortofoto"!==r&&"SKAT.BaseMap.Layer.WMTS.Ortofoto"!==r&&"SKAT.BaseMap.Layer.WMS.Ortofoto"!==r||(void 0!==this.eventMap[r]&&(b(this.eventMap[r]),this.eventMap[r]=void 0),this.eventMap[r]=i.on("change:visible",(function(t){n.layer.setVisible(!t.oldValue)})),e&&(this.options.visible=!0)))}}class Jm extends wg{constructor(t){super(t),this.onError=null,this.onSuccess=null,Object.assign(this,t)}}class Qm extends Xg{constructor(t){super(t),this.events=null,this.includeOnlyBygningWithMatchingMarkerId=!0,this.includeOnlyBygningWithinGeometry=!0,this.markers=null,Object.assign(this,t),null==this.style&&(this.style=new Ro({stroke:new Eo({color:"white",width:3})})),this.name=this.name?this.name:"Bygning",this.events=this.events?this.events:new Jm}}class $m extends qg{constructor(t){super(t=t instanceof Qm?t:t?new Qm(t):new Qm),this.geometry=null,this.markers=t.markers&&t.markers.length?t.markers:[],this.bygningLoaded=!1,this.abortControler=null,this.loadedFeatures=[]}clear(){this.features.clear(),this.bygningLoaded=!1,this.loadedFeatures=[]}updateMaskGeometry(t){this.clear(),this.geometry=t,null!=t&&this.updateBygningsGeometri(t)}supportMask(){return!0}supportMarkers(){return!0}updateMarkers(t){if(this.markers=t,this.bygningLoaded&&this.loadedFeatures.length>0){let t=[];for(let e=0;e<this.loadedFeatures.length;e++)this.isBygningVisible(this.loadedFeatures[e],this.geometry)&&t.push(this.loadedFeatures[e]);this.features.clear(),this.addFeatures(t)}}retryLoad(){this.clear(),this.geometry&&this.updateBygningsGeometri(this.geometry)}getErrorHandler(){const t=this.options;return t.events&&t.events&&t.events.onError?t.events.onError:()=>{}}getSuccessHandler(){const t=this.options;return t.events&&t.events&&t.events.onSuccess?t.events.onSuccess:()=>{}}updateBygningsGeometri(t){let e=this.getErrorHandler();this.loadedFeatures=[];try{let r=this,s=fg.getDAFUrl()+"GeoDanmarkVektor/GeoDanmark60_NOHIST_GML3/1.0.0/Wfs?"+fg.getDAFLogin()+"&SERVICE=WFS&REQUEST=GetFeature&VERSION=1.1.0",o=[],a=[],l=0;for(let e=0;e<t.length;e++){let r=t[e].getGeometry();(r.getType()===dc.MULTI_POLYGON||r.getType()===dc.POLYGON)&&(a=r.getCoordinates());for(let t=0;t<a.length;t++){var i=[],n=0;if(r.getType()===dc.MULTI_POLYGON)for(n=0;n<a[t][0].length;n++)i.push(a[t][0][n][0]+" "+a[t][0][n][1]);else for(n=0;n<a[t].length;n++)i.push(a[t][n][0]+" "+a[t][n][1]);o.push('<ogc:Intersects><ogc:PropertyName>Polygon</ogc:PropertyName><gml:Polygon xmlns:gml="http://www.opengis.net/gml" srsName="EPSG:25832"><gml:exterior><gml:LinearRing><gml:posList>'+i.join(" ")+"</gml:posList></gml:LinearRing></gml:exterior></gml:Polygon></ogc:Intersects>"),l++}}let h='<wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" service="WFS" version="1.1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/WFS-transaction.xsd"><wfs:Query typeName="Bygning"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc">'+(l>1?"<ogc:Or>":"")+o.join("\r\n")+(l>1?"</ogc:Or>":"")+"</ogc:Filter></wfs:Query></wfs:GetFeature>",u=!1;const c=window.setTimeout((function(){u=!0,null!=r.abortControler&&r.abortControler.abort(),e($y.AJAX_CALL_FAILED,{message:yg.timeout})}),_g.timeoutLength);this.abortControler=void 0===typeof AbortController?new AbortController:null,fetch(s,{method:"POST",body:h,signal:null!=this.abortControler?this.abortControler.signal:void 0}).then(function(t){if(clearTimeout(c),u)return null;if(r.abortControler,t.ok)return t.text();if(e)throw{error:!0,type:$y.AJAX_SERVICE_ERROR,message:t.status};return null}.bind(this)).then(function(e){u||this.parseBygningResponse(e,t)}.bind(this)).catch(function(t){u||(t.error?e(t.type,t.message):e($y.AJAX_CALL_FAILED,t))}.bind(this))}catch(t){e($y.UNK_ERROR,t)}}parseBygningResponse(t,e){let i=this.getErrorHandler(),n=this.getSuccessHandler();if(this.options,null!=t)try{t=(t=t.replace(/urn:ogc:def:crs:EPSG::25832/g,"EPSG:25832")).replace(/wfs:member/g,"wfs:featureMember");let i=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagNameNS("*","featureMember"),r=new ac({featureNS:"http://www.opengis.net/gml/3.2",srsName:"EPSG:25832",hasZ:!0}),s=[],o=[],a=null;for(let t=0;t<i.length;t++){let n=i[t].outerHTML;n||(a||(a=new XMLSerializer),n=a.serializeToString(i[t]));let l=r.readFeature(n);l&&(this.loadedFeatures.push(l),this.isBygningVisible(l,e)&&(s.push({id:l.get("BBRUUID"),x:null,y:null,olFeature:l}),o.push(l)))}this.addFeatures(o),this.bygningLoaded=!0,n(s)}catch(t){i($y.SERVICE_PARSER_ERROR,t)}}isBygningVisible(t,e){const i=this.options;if(!i.includeOnlyBygningWithMatchingMarkerId&&!i.includeOnlyBygningWithinGeometry)return!0;if(i.includeOnlyBygningWithMatchingMarkerId&&t.get("BBRUUID")){if(!this.markers||!this.markers.length)return!1;for(let e=0;e<this.markers.length;e++)if(this.markers[e].id==t.get("BBRUUID"))return!0}return!!i.includeOnlyBygningWithinGeometry&&i.includeOnlyBygningWithinGeometry&&this.isWithinGeometryBoundary(t,e)}isWithinGeometryBoundary(t,e){const i=t.getGeometry();if(i.getType()==dc.MULTI_POLYGON){const t=i.getPolygons();for(let i=0;i<t.length;i++){const n=wt(t[i].getExtent());for(let t=0;t<e.length;t++)if(e[t].getGeometry().intersectsCoordinate(n))return!0}return!1}if(i.getType()!=dc.POLYGON)return console.log("isWithinGeometryBoundary ikke multipoly eller poly, men "+i.getType().toString()),!1;{const t=wt(i.getExtent());for(let i=0;i<e.length;i++)if(e[i].getGeometry().intersectsCoordinate(t))return!0}}}var t_=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class e_ extends yc{constructor(t){super(t),this.LocationIconAltText="Billede af grund og bygninger",this.CloseBottonAltText="Luk",this.ShowPropertyButtonText="Vis ejendom",this.MetadataTitleKommuneName="Kommune",this.MetadataTitleBfeName="BFE-nr",this.MaxZoomLevel=11,Object.assign(this,t),"function"!=typeof this.IsNewProperty&&(this.IsNewProperty=()=>!0),"function"!=typeof this.OnShowProperty&&(this.OnShowProperty=()=>{})}}class i_{}class n_ extends mc{constructor(t){(t=t?t instanceof e_?t:new e_(t):new e_).olControl=new r_(t),super(t),this.abortControler=null}setMap(t){super.setMap.call(this,t),t.addEvent(Jy.onClick,(t=>{this.handleClick(t)}))}handleClick(t){this.map.getOLMap().getView().getZoom()<this.options.MaxZoomLevel||gc.isObjectDefined(t)&&2==t.length&&this.fetchFromNet(t).then((t=>{null==t?this.updateDialog(null):this.updateDialog(t)})).catch((t=>{console.log(t)}))}updateDialog(t){this.options.IsNewProperty(t)&&(this.show(),this.olControl.updateElement(t))}fetchFromNet(t){return t_(this,void 0,void 0,(function*(){let e=new i_;this.abortControler=void 0===typeof AbortController?new AbortController:null;let i="https://dawa.aws.dk/jordstykker?x="+t[0]+"&y="+t[1]+"&srid=25832",n=yield fetch(i,{signal:null!=this.abortControler?this.abortControler.signal:void 0});if(!n.ok)return null;let r=yield n.json();if(!gc.isObjectDefined(r)||0==r.length)return null;if(this.abortControler=void 0===typeof AbortController?new AbortController:null,i=r[0].href+"?format=geojson&srid=25832",n=yield fetch(i,{signal:null!=this.abortControler?this.abortControler.signal:void 0}),!n.ok)return null;let s=yield n.json();e.MatrikelNr=r[0].matrikelnr,e.EjerlavKode=r[0].ejerlav.kode,e.EjerlavNavn=r[0].ejerlav.navn,e.JordstykkeId=r[0].featureid,e.Geometri=s.geometry,e.BfeNr=r[0].sfeejendomsnr,e.DAWARaw=r[0];var o=yield this.getEjendomsbeliggenhed(e.BfeNr);if(null==o||0==o.length)return null;const a=o[0];return a.properties.husnummer.length>0?(e.AdresseBetegnelse=a.properties.husnummer[0].adgangsadressebetegnelse,e.VejNavn=a.properties.husnummer[0].navngivenVej.vejnavn,e.HusNummerTekst=a.properties.husnummer[0].husnummertekst,e.PostNr=a.properties.husnummer[0].postnummer.postnr,e.PostDistrikt=a.properties.husnummer[0].postnummer.navn,e.KommuneNavn=a.properties.husnummer[0].kommuneinddeling.navn):a.properties.adresse.length>0?(e.AdresseBetegnelse=a.properties.adresse[0].adressebetegnelse,e.VejNavn=a.properties.adresse[0].husnummer.navngivenVej.vejnavn,e.HusNummerTekst=a.properties.adresse[0].husnummer.husnummertekst,e.EtageBetegnelse=a.properties.adresse[0].etagebetegnelse,e.DørBetegnelse=a.properties.adresse[0].dørbetegnelse,e.PostNr=a.properties.adresse[0].husnummer[0].postnummer.postnr,e.PostDistrikt=a.properties.adresse[0].husnummer[0].postnummer.navn,e.KommuneNavn=a.properties.adresse[0].husnummer[0].kommuneinddeling.navn):(e.AdresseBetegnelse=a.properties.betegnelse,e.VejNavn=a.properties.betegnelse,e.HusNummerTekst="",e.PostNr="",e.PostDistrikt="",e.KommuneNavn=r[0].kommune.navn),e}))}getEjendomsbeliggenhed(t){return t_(this,void 0,void 0,(function*(){this.abortControler=void 0===typeof AbortController?new AbortController:null;let e=fg.getDAFUrl()+"/EBR/Ejendomsbeliggenhed/1/REST/Ejendomsbeliggenhed?bfenr="+t+"&"+fg.getDAFLogin();const i=yield fetch(e,{signal:null!=this.abortControler?this.abortControler.signal:void 0});return i.ok?(yield i.json()).features:null}))}}class r_ extends Fr{constructor(t){(t=t||new e_).element=r_.renderMainElement(),super(t),this.options=t,this.currentData=null}static renderMainElement(){var t=document.createElement("div");return t.className="ol-matrikel-selector ol-unselectable ol-control ol-hidden",t}setMap(t){this.renderElem(),super.setMap.call(this,t)}updateElement(t){null!=t?(this.messageTitleDiv.innerText=t.VejNavn+" "+t.HusNummerTekst,this.postCodeElem.innerText=t.PostNr+" "+t.PostDistrikt,this.muniplacityName.innerText=" "+t.KommuneNavn,this.bfeName.innerText=t.BfeNr):(this.messageTitleDiv.innerText="",this.postCodeElem.innerText="",this.muniplacityName.innerText="",this.bfeName.innerText=""),this.currentData=t}renderElem(){let t=document.createElement("div");t.className="row",this.locationIconDiv=document.createElement("div"),this.locationIconDiv.className="col location";let e=document.createElement("span"),i=document.createElement("img");i.src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI0LjAuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9ImxvY2F0aW9uLWJiciIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IgoJIHk9IjBweCIgdmlld0JveD0iMCAwIDI0LjYgMzMuNiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMjQuNiAzMy42OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxnPgoJPGc+CgkJPHBhdGggZD0iTTE0LDMzLjVjLTAuMSwwLTAuMSwwLTAuMiwwQzEzLjksMzMuNiwxNCwzMy42LDE0LDMzLjVjMC4yLDAsMC40LTAuMSwwLjUtMC4zQzE0LjQsMzMuNCwxNC4yLDMzLjUsMTQsMzMuNXogTTEzLjIsMzMuMgoJCQljMCwwLDAuMSwwLjEsMC4xLDAuMWwwLjEsMC4xbDAuMSwwLjFsMC4yLDAuMWMwLDAsMC4xLDAsMC4xLDBjLTAuMSwwLTAuMy0wLjEtMC40LTAuMkwxMy4yLDMzLjJ6Ii8+CgkJPHBhdGggZD0iTTIzLjcsNi40Yy0wLjktMi4xLTIuNS0zLjgtNC41LTQuOGMtMy43LTEuOC04LjEtMi0xMS45LTAuNGMtMy45LDEuNi02LjYsNS4zLTcuMiw5LjVjLTAuMSwxLjYsMCwzLjMsMC40LDQuOQoJCQljMSw0LjksMy44LDguNyw5LjcsMTQuN2wzLDNsMC4yLDAuMmMwLjEsMC4xLDAuMiwwLjIsMC40LDAuMmMwLDAsMC4xLDAsMC4xLDBoMGMwLDAsMC4xLDAsMC4yLDBjMC4yLDAsMC40LTAuMSwwLjUtMC4zdjAKCQkJYzAsMCwwLjEtMC4xLDAuMS0wLjF2MGMwLDAsMCwwLDAsMGMxLjMtMiwyLjUtNCwzLjgtNi4zbDAuOS0xLjdsMC44LTEuNWwwLjQtMC43bDAuNC0wLjhjMC43LTEuMiwxLjItMi4xLDEuNy0zLjEKCQkJYzAuNy0xLjUsMS4zLTMuMSwxLjYtNC43QzI0LjksMTEuNywyNC43LDguOSwyMy43LDYuNHogTTIyLjcsMTQuMWMtMC4zLDEuNS0wLjcsMi45LTEuNCw0LjNjLTAuNSwxLTEuMSwxLjktMS43LDMuMWwtMC40LDAuNwoJCQlMMTguOCwyM0wxOCwyNC40Yy0wLjMsMC42LTAuNiwxLjEtMC45LDEuN2MtMS4yLDItMi4yLDMuNi0zLjMsNS40TDExLjMsMjljLTUuNy01LjctOC4zLTkuNC05LjMtMTMuOWMtMC4zLTEuNC0wLjUtMi45LTAuNC00LjMKCQkJYzAuNS0zLjYsMi44LTYuOCw2LjItOC4yYzMuNC0xLjQsNy4zLTEuMiwxMC42LDAuNGMxLjYsMC45LDIuOSwyLjMsMy43LDRDMjMuMSw5LjMsMjMuMiwxMS43LDIyLjcsMTQuMXoiLz4KCQk8cGF0aCBkPSJNMTIuMSw3LjhjLTAuNSwwLTEuMSwwLjEtMS42LDAuNGMtMC4yLDAuMS0wLjMsMC4yLTAuNSwwLjNMOS45LDguNkM5LjgsOC43LDkuNyw4LjgsOS42LDguOWMtMC42LDAuOC0xLDEuNy0xLDIuNwoJCQljMCwwLjQsMC4xLDAuOCwwLjMsMS4yYzAuNCwwLjUsMSwwLjksMS42LDEuMWMwLjcsMC4zLDEuNCwwLjUsMi4yLDAuNWMwLjYsMC4xLDEuMy0wLjEsMS44LTAuNWMwLjYtMC41LDAuOS0xLjIsMC44LTIKCQkJYzAtMC45LTAuMy0xLjctMC43LTIuNWMtMC4yLTAuNS0wLjYtMS0xLTEuNGMtMC4zLTAuMi0wLjYtMC4zLTAuOS0wLjNDMTIuNCw3LjgsMTIuMyw3LjgsMTIuMSw3Ljh6IE0xMS41LDYuMQoJCQljMS0wLjIsMi4xLDAsMi45LDAuNmMwLjcsMC41LDEuMiwxLjIsMS41LDJjMC41LDEsMC44LDIuMSwwLjgsMy4yYzAsMS4yLTAuNSwyLjQtMS40LDMuM2MtMC44LDAuNi0xLjgsMC45LTIuOSwwLjkKCQkJYy0wLjktMC4xLTEuOC0wLjMtMi43LTAuNmMtMS0wLjMtMS44LTAuOS0yLjQtMS43Yy0wLjMtMC42LTAuNS0xLjMtMC41LTJjMC0xLjQsMC41LTIuNywxLjQtMy44YzAuNC0wLjQsMC44LTAuOCwxLjMtMS4xCgkJCUMxMC4yLDYuNSwxMC45LDYuMiwxMS41LDYuMXoiLz4KCTwvZz4KPC9nPgo8L3N2Zz4K",i.title=this.options.LocationIconAltText,i.alt=i.title,e.appendChild(i),this.locationIconDiv.appendChild(e),t.appendChild(this.locationIconDiv),this.messageDiv=document.createElement("div"),this.messageDiv.className="col metadata",this.messageTitleDiv=document.createElement("h5"),this.messageDiv.appendChild(this.messageTitleDiv),this.messageMetadataDiv=document.createElement("div"),this.postCodeElem=document.createElement("div"),this.postCodeElem.className="postcode",this.messageMetadataDiv.appendChild(this.postCodeElem);let n=document.createElement("div");n.className="muniplacity";let r=document.createElement("strong");r.innerText=this.options.MetadataTitleKommuneName+":",n.appendChild(r),this.muniplacityName=document.createElement("span"),n.appendChild(this.muniplacityName),this.messageMetadataDiv.appendChild(n);let s=document.createElement("div"),o=document.createElement("strong");o.innerText=this.options.MetadataTitleBfeName+":",s.appendChild(o),this.bfeName=document.createElement("span"),s.appendChild(this.bfeName),this.messageMetadataDiv.appendChild(s),this.messageDiv.appendChild(this.messageMetadataDiv),this.showProperties=document.createElement("button"),this.showProperties.title=this.options.ShowPropertyButtonText,this.showProperties.innerText=this.options.ShowPropertyButtonText,this.showProperties.addEventListener("click",(()=>{null!=this.currentData&&(this.options.OnShowProperty(this.currentData),this.element.classList.add("ol-hidden"))})),this.messageDiv.appendChild(this.showProperties),t.appendChild(this.messageDiv),this.closeBtnDiv=document.createElement("div"),this.closeBtnDiv.className="col close",this.closeBtn=document.createElement("button");let a=document.createElement("img");a.src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI0LjAuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiCgkgdmlld0JveD0iMCAwIDMwLjMgMzUiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwLjMgMzU7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPGcgaWQ9IlN5bWJvbHNfMV8iPgoJPGcgaWQ9IlF1ZXN0aW9uLWFjY29yZGlhbi1ibHVlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgLTEuMDAwMDAwKSI+CgkJPGcgaWQ9Ikdyb3VwLTEwIj4KCQkJPGcgaWQ9Imljb25feDJGX1BsdXMtaWNvbi1ibHVlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KCQkJCTxnIGlkPSJQbHVzLWljb24iPgoJCQkJCTxnIGlkPSJTdHJva2UtM18xXyI+CgkJCQkJCTxwYXRoIGQ9Ik0yOS44LDMyLjZjLTAuMiwwLjItMC40LDAuMy0wLjYsMC4zYy0wLjIsMC0wLjUtMC4xLTAuNi0wLjNMMTQuNywxOC43Yy0wLjksMS0xLjQsMS43LTEuNCwxLjdMMS42LDMyLjEKCQkJCQkJCWMtMC4yLDAuMi0wLjQsMC4zLTAuNiwwLjNjLTAuMiwwLTAuNS0wLjEtMC42LTAuM2MtMC4zLTAuMy0wLjMtMC45LDAtMS4yTDEyLDE5LjNjMC4xLTAuMSwwLjYtMC44LDEuNS0xLjhMMi45LDYuOQoJCQkJCQkJQzIuNiw2LjYsMi42LDYsMi45LDUuN2MwLjMtMC40LDAuOS0wLjQsMS4yLDBsMTAuNSwxMC41YzMuNS00LDkuNy0xMC43LDEzLjYtMTMuMWMwLjQtMC4yLDEtMC4xLDEuMiwwLjMKCQkJCQkJCWMwLjIsMC40LDAuMSwxLTAuMywxLjJjLTMuNywyLjMtOS44LDguOS0xMy4zLDEyLjlsMTMuOSwxMy45QzMwLjIsMzEuNywzMC4yLDMyLjIsMjkuOCwzMi42eiIvPgoJCQkJCTwvZz4KCQkJCTwvZz4KCQkJPC9nPgoJCTwvZz4KCTwvZz4KPC9nPgo8L3N2Zz4K",a.title=this.options.CloseBottonAltText,this.closeBtn.appendChild(a),this.closeBtn.addEventListener("click",(()=>{this.element.classList.add("ol-hidden")})),this.closeBtnDiv.appendChild(this.closeBtn),t.appendChild(this.closeBtnDiv),this.element.appendChild(t)}}class s_{constructor(t){this.onDragStart=function(){},this.onDragEnd=function(){},this.onDraging=function(){},Object.assign(this,t)}}class o_{constructor(t){this.sourceLayer=null,this.limitFeatures=null,this.isClusteredLayer=!1,this.events=null,this.map=null,Object.assign(this,t)}}class a_ extends Wr{constructor(t){super(),this.layerFilter=null,this.featureFilter=null,this.dragVectorSource=null,this.dragVectorLayer=null,this.dragFeatures=null,t.events=t.events?t.events:new s_,this.options=t,this.dragGeom=null,this.handleDownEvent=this.handleSelect,this.handleDragEvent=this.handleDrag,this.handleUpEvent=this.handleDragEnd,this.layerFilter=this.options.sourceLayer?t=>t===this.options.sourceLayer||t===this.dragVectorLayer:()=>!0,this.featureFilter=this.createFeatureFilter(),this.dragFeatures=new H,this.dragVectorSource=new tu({features:this.dragFeatures}),this.dragVectorLayer=new rh({source:this.dragVectorSource,style:gm})}setMap(t){super.setMap(t),t.addLayer(this.dragVectorLayer)}createFeatureFilter(){return this.options.limitFeatures?this.options.isClusteredLayer?function(t){let e=t.get("features");if(e.length>1)return t;{let i=!1;for(let t=0;t<this.options.limitFeatures.length;t++)if(this.options.limitFeatures[t]==e[0]){i=!0;break}return i?t:null}}.bind(this):function(t){let e=!1;for(let i=0;i<this.options.limitFeatures.length;i++)if(this.options.limitFeatures[i]==t){e=!0;break}return e?t:null}.bind(this):function(t){return t}}handleSelect(t){if(t.dragging)return!1;let e=this.getMap().forEachFeatureAtPixel(t.pixel,this.featureFilter,{layerFilter:this.layerFilter});if(e&&e instanceof iu){if(this.isNewFeature(e)){if(this.isClusteredClick(e)){if(this.dragFeature){this.addFeature(this.dragFeature);const t=this.getMarker(this.dragFeature);t&&this.options.map.setMarkerSelectedState(t.id,!1),this.dragFeature=null,this.dragFeatures.clear()}return this.handleClusteredClick(e)}return this.activateDrag(e)}return!!this.dragFeature}if(this.dragFeature){this.addFeature(this.dragFeature);const t=this.getMarker(this.dragFeature);t&&this.options.map.setMarkerSelectedState(t.id,!1),this.dragFeature=null,this.dragFeatures.clear()}return!1}handleDrag(t){return!!this.dragFeature&&(this.dragGeom||(this.dragGeom=this.dragFeature.getGeometry(),this.handleMoveStartBeforeEventSend(),this.options.events&&this.options.events.onDragStart(this.dragFeature,t)),this.dragGeom.setCoordinates(t.coordinate),this.options.events&&this.options.events.onDraging(this.dragFeature,t),!0)}handleDragEnd(t){return!(!this.dragFeature||this.dragFeature&&!this.dragGeom||(this.handleMoveEndBeforeEventSend(),this.options.events&&this.options.events.onDragEnd(this.dragFeature,t),this.addFeature(this.dragFeature),this.dragGeom=null,this.dragFeatures.clear(),0))}handleMoveStartBeforeEventSend(){}handleMoveEndBeforeEventSend(){}handleUnselectedPrev(){}getFeature(t){if(1==t.length){const e=t[0].getProperties();if(e&&e.features&&1==e.features.length)return e.features[0];if(e&&e.marker)return t[0]}return null}removeFeature(t){(this.options.isClusteredLayer?this.options.sourceLayer.getSource().getSource():this.options.sourceLayer.getSource()).removeFeature(t)}addFeature(t){const e=this.options.isClusteredLayer?this.options.sourceLayer.getSource().getSource():this.options.sourceLayer.getSource();e.hasFeature(t)||e.addFeature(t)}activateDrag(t){if(this.dragFeature){const t=this.getMarker(this.dragFeature);t&&(this.options.map.setMarkerActiveState(t.id,!1),this.options.map.setMarkerSelectedState(t.id,!1)),this.addFeature(this.dragFeature)}if(this.dragFeatures.clear(),this.dragFeature=this.getFeature([t]),!this.dragFeature)return!1;const e=this.getMarker(this.dragFeature);return e?(this.options.map.setMarkerSelectedState(e.id,!0),this.removeFeature(this.dragFeature),this.dragFeatures.push(this.dragFeature),!0):(this.addFeature(this.dragFeature),this.dragFeature=null,this.dragFeatures.clear(),!1)}handleClusteredClick(t){if(!this.options.isClusteredLayer)return!1;if(t){const e=t.get("features");if(e&&e.length>1){let t=null;for(let i=0;i<e.length;i++)t=t?gt(t,e[i].getGeometry().getExtent()):e[i].getGeometry().getExtent();if(this.options.map){const e=this.getMap().getView();this.options.map.fit(gc.extentToArray(t),{minResolution:e.getMinResolution()})}return!0}}return!1}isClusteredClick(t){if(!this.options.isClusteredLayer)return!1;if(t){const e=t.get("features");return e&&e.length>1}return!1}isNewFeature(t){if(!this.dragFeature)return!0;if(!this.options.isClusteredLayer)return t!=this.dragFeature;{let e=t.get("features");if(!e)return t!=this.dragFeature;if(1!=e.length)return t!=this.dragFeature;{const t=this.getFeature(e);if(t){let e=t.get("id"),i=this.dragFeature.get("features");return!i||1!=i.length||e!==i[0].get("id")}}}return!1}getMarker(t){if(!t)return null;return t.get("marker")||null}}class l_ extends o_{constructor(t){super(t),this.events=null,Object.assign(this,t)}}class h_ extends a_{constructor(t){super(t),this.disabledHover=!1,this.hoverInteraction=new Rm(new bm({map:t.map,limitLayers:[t.sourceLayer,this.dragVectorLayer],events:new Lm({onHovered:t.isClusteredLayer?this.handleOverFeaturesClustered.bind(this):this.handleOverFeatures.bind(this),onUnHovered:t.isClusteredLayer?this.handleUnOverFeaturesClustered.bind(this):this.handleUnOverFeatures.bind(this)}),condition:this.isActive}))}setMap(t){super.setMap(t),t.addInteraction(this.hoverInteraction),this.markerOverlay=new Tm(new Am({map:this.options.map,events:new Nm({onMenuItemClicked:t=>{this.activateDrag(t)},onZoomStart:()=>{this.disabledHover=!0},onZoomEnd:()=>{this.disabledHover=!1}})})),t.addOverlay(this.markerOverlay)}activateFeature(t,e=!0){}isActive(t){return!this.dragGeom&&!this.disabledHover&&!ns(t)}handleSelect(t){const e=super.handleSelect(t);return!e&&ns(t)&&this.markerOverlay.removePopup(),e}handleMoveStartBeforeEventSend(){this.dragFeature}handleMoveEndBeforeEventSend(){this.dragFeature}handleUnselectedPrev(){let t=this.options,e=this.dragFeature.get("marker");t.map.setMarkerSelectedState(e.id,!1)}handleOverFeaturesClustered(t){if(this.dragGeom)return;if(t.length>0){let e=t[0].get("features");return this.handleOverFeatures(e,null,t[0].getGeometry().getCoordinates())}let e=this.options;if(t.length>0&&this.dragFeature)if(1==t[0].get("features").length){let t=this.dragFeature.get("marker");e.map.setMarkerActiveState(t.id,!0)}else e.map.setMarkerActiveState(null,!1);else e.map.setMarkerActiveState(null,!1);return!1}handleUnOverFeaturesClustered(t,e){if(this.dragGeom)return;let i=this.options;if(t.length>0&&this.dragFeature){let t=this.dragFeature.get("marker");i.map.setMarkerActiveState(t.id,!1)}else i.map.setMarkerActiveState(null,!1);return t.length>0&&this.handleUnOverFeatures(t[0].get("features"),e)}handleOverFeatures(t,e,i){let n=this.options;if(t)if(t.length>1)this.markerOverlay.showPopup(t,i||t[0].getGeometry().getCoordinates()),n.map.setMarkerActiveState(null,!1);else{const i=this.getFeature(t),r=this.getMarker(i);if(r)return n.map.setMarkerActiveState(r.id,!0),this.options.events.onHovered([i],e)}return!1}handleUnOverFeatures(t,e){let i=this.options,n=!1;if(t&&1==t.length){const r=this.getFeature(t),s=this.getMarker(r);s&&(i.map.setMarkerActiveState(s.id,!1),n=this.options.events.onUnHovered(t,e))}return this.markerOverlay.removePopup(),n}handleClusteredClick(t){const e=this.getMap().getView();if(e.getZoom()>e.getMaxZoom()-2){const e=t.getGeometry().getCoordinates(),i=t.get("features");return this.markerOverlay.showPopup(i,e),!0}return super.handleClusteredClick(t)}}function u_(){return"1.0.8"}function c_(t,e=null,i=null,n="bbr"){return pc.getIconProvider(n).getImage(t,e,i)}})(),n})()));
/*Fetched from https://basiskort.bbr.dk/ */
